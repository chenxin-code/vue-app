(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[17],{

/***/ "./src/components/mall2/cart/js/cart.js":
/*!**********************************************!*\
  !*** ./src/components/mall2/cart/js/cart.js ***!
  \**********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.regexp.exec.js */ \"./node_modules/core-js/modules/es.regexp.exec.js\");\n/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var core_js_modules_es_string_split_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.string.split.js */ \"./node_modules/core-js/modules/es.string.split.js\");\n/* harmony import */ var core_js_modules_es_string_split_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_string_split_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! core-js/modules/es.array.concat.js */ \"./node_modules/core-js/modules/es.array.concat.js\");\n/* harmony import */ var core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var vue__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! vue */ \"./node_modules/vue/dist/vue.esm.js\");\n/* harmony import */ var _utils_util__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../utils/util */ \"./src/utils/util.js\");\n/* harmony import */ var _vuex_store__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../vuex/store */ \"./src/vuex/store.js\");\n/* harmony import */ var _utils_market__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../utils/market */ \"./src/utils/market.js\");\n\n\n\n\n\n\n\nvar cart = {\n  getTopArr: function getTopArr() {\n    var arr = [{\n      name: '配送',\n      type: 2,\n      hasShow: false,\n      \"class\": 'mall-peisong',\n      occurArr: []\n    } // ,\n    // {\n    //   name: '自提',\n    //   type: 1,\n    //   hasShow: false,\n    //   class: 'mall-ziti',\n    //   occurArr: []\n    // },\n    ];\n\n    if (_vuex_store__WEBPACK_IMPORTED_MODULE_5__[\"default\"].state.globalConfig.app_home_special_flag == 'cnooc') {\n      var dt = _utils_market__WEBPACK_IMPORTED_MODULE_6__[\"default\"].returnCnoocDeliveryType();\n\n      if (dt == '2' || dt == '') {\n        _vuex_store__WEBPACK_IMPORTED_MODULE_5__[\"default\"].state.mall2.staticDeliverType = 2;\n        arr = [{\n          name: '配送',\n          type: 2,\n          hasShow: false,\n          \"class\": 'mall-peisong',\n          occurArr: []\n        }];\n      }\n    } // if (store.state.globalConfig.delivertype_default == '1') {\n    //   arr = [{\n    //     name: '自提',\n    //     type: 1,\n    //     hasShow: false,\n    //     class: 'mall-ziti',\n    //     occurArr: []\n    //   }];\n    // } else if (store.state.globalConfig.delivertype_default == '2') {\n    //   arr = [{\n    //     name: '配送',\n    //     type: 2,\n    //     hasShow: false,\n    //     class: 'mall-peisong',\n    //     occurArr: []\n    //   }];\n    // }\n\n\n    return arr;\n  },\n  dealCartList: function dealCartList(arr) {\n    for (var i = 0; i < arr.length; i++) {\n      var occuritem = arr[i];\n      occuritem.checked = true;\n\n      for (var j = 0; j < occuritem.store.length; j++) {\n        var storeitem = occuritem.store[j];\n        storeitem.checked = this.judgeStoreIsSel(storeitem, false);\n\n        if (!storeitem.checked) {\n          occuritem.checked = false;\n        } //接下来计算 每个活动的勾选的数目\n\n\n        var activitys = storeitem.activity;\n\n        for (var k = 0; k < activitys.length; k++) {\n          var activityItem = activitys[k];\n          activityItem.number = this.getActivityNum(activityItem);\n        }\n      }\n    }\n\n    return arr;\n  },\n  getActivityNum: function getActivityNum(activityItem) {\n    var num = 0;\n\n    for (var k = 0; k < activityItem.cart.length; k++) {\n      var cartItem = activityItem.cart[k];\n\n      if (cartItem.isGift == 0 && cartItem.checked == 1) {\n        num += cartItem.number;\n      }\n    }\n\n    return num;\n  },\n  judgeStoreIsSel: function judgeStoreIsSel(storeitem, isEditing) {\n    var checkKey = this.getCheckKey(isEditing);\n\n    for (var activityIndex = 0; activityIndex < storeitem.activity.length; activityIndex++) {\n      var activityitem = storeitem.activity[activityIndex];\n\n      for (var cartIndex = 0; cartIndex < activityitem.cart.length; cartIndex++) {\n        var cartitem = activityitem.cart[cartIndex];\n\n        if (!cartitem[checkKey]) {\n          return false;\n        }\n      }\n    }\n\n    for (var _activityIndex = 0; _activityIndex < storeitem.noActivityCart.length; _activityIndex++) {\n      var _cartitem = storeitem.noActivityCart[_activityIndex];\n\n      if (!_cartitem[checkKey]) {\n        return false;\n      }\n    }\n\n    return true;\n  },\n  getItemAmount: function getItemAmount(amount, index) {\n    var str = _utils_util__WEBPACK_IMPORTED_MODULE_4__[\"default\"].toDecimal2(amount);\n    var arr = str.split('.');\n\n    if (arr.length > index) {\n      return arr[index];\n    } else {\n      return '00';\n    } // if (amount) {\n    //   let money = amount + '';\n    //   let arr = [];\n    //   if (money) {\n    //     arr = money.split(\".\");\n    //   }\n    //   if (arr.length > index) {\n    //     return arr[index]\n    //   } else {\n    //     return '00'\n    //   }\n    // } else {\n    //   return '00'\n    // }\n\n  },\n  getXZClass: function getXZClass(isEditing, checked, dchecked) {\n    if (isEditing) {\n      if (dchecked) {\n        return 'mall-xuanzhong theme_standard_font';\n      } else {\n        return 'mall-weixuanzhong theme_font_gray';\n      }\n    } else {\n      if (checked) {\n        return 'mall-xuanzhong theme_standard_font';\n      } else {\n        return 'mall-weixuanzhong theme_font_gray';\n      }\n    }\n\n    return '';\n  },\n  getOccClass: function getOccClass(isEditing, checked, dchecked) {\n    if (isEditing) {\n      if (dchecked) {\n        return 'mall-xuanzhong theme_standard_font';\n      } else {\n        return 'mall-weixuanzhong theme_font_gray';\n      }\n    } else {\n      if (checked) {\n        return 'mall-xuanzhong theme_standard_font';\n      } else {\n        return 'mall-weixuanzhong theme_font_gray';\n      }\n    }\n\n    return '';\n  },\n  setAllUnSel: function setAllUnSel(arr) {\n    for (var i = 0; i < arr.length; i++) {\n      var occuritem = arr[i];\n      vue__WEBPACK_IMPORTED_MODULE_3__[\"default\"].set(occuritem, 'dchecked', false);\n\n      for (var j = 0; j < occuritem.store.length; j++) {\n        var storeitem = occuritem.store[j];\n        vue__WEBPACK_IMPORTED_MODULE_3__[\"default\"].set(storeitem, 'dchecked', false);\n\n        for (var activityIndex = 0; activityIndex < storeitem.activity.length; activityIndex++) {\n          var activityitem = storeitem.activity[activityIndex];\n\n          for (var cartIndex = 0; cartIndex < activityitem.cart.length; cartIndex++) {\n            var cartitem = activityitem.cart[cartIndex];\n            vue__WEBPACK_IMPORTED_MODULE_3__[\"default\"].set(cartitem, 'dchecked', false);\n          }\n        }\n\n        for (var _activityIndex2 = 0; _activityIndex2 < storeitem.noActivityCart.length; _activityIndex2++) {\n          var _cartitem2 = storeitem.noActivityCart[_activityIndex2];\n          vue__WEBPACK_IMPORTED_MODULE_3__[\"default\"].set(_cartitem2, 'dchecked', false);\n        }\n      }\n    }\n\n    return arr;\n  },\n  setOccSel: function setOccSel(occuritem, isEditing) {\n    var checkKey = this.getCheckKey(isEditing);\n    occuritem[checkKey] = !occuritem[checkKey];\n\n    for (var j = 0; j < occuritem.store.length; j++) {\n      var storeitem = occuritem.store[j];\n      this.setStoreSel(storeitem, isEditing, occuritem[checkKey]);\n    }\n  },\n  setStoreSel: function setStoreSel(storeitem, isEditing, isSel, occuritem) {\n    var checkKey = this.getCheckKey(isEditing);\n\n    if (isSel == undefined) {\n      isSel = !storeitem[checkKey];\n    }\n\n    storeitem[checkKey] = isSel;\n\n    for (var activityIndex = 0; activityIndex < storeitem.activity.length; activityIndex++) {\n      var activityitem = storeitem.activity[activityIndex];\n\n      for (var cartIndex = 0; cartIndex < activityitem.cart.length; cartIndex++) {\n        var cartitem = activityitem.cart[cartIndex];\n        cartitem[checkKey] = isSel;\n      }\n    }\n\n    for (var _activityIndex3 = 0; _activityIndex3 < storeitem.noActivityCart.length; _activityIndex3++) {\n      var _cartitem3 = storeitem.noActivityCart[_activityIndex3];\n      _cartitem3[checkKey] = isSel;\n    } //如果有occ 说明要向上检测\n\n\n    if (occuritem) {\n      this.resetOccurItem(occuritem, isEditing, isSel);\n    }\n  },\n  resetOccurItem: function resetOccurItem(occuritem, isEditing, isSel) {\n    var checkKey = this.getCheckKey(isEditing);\n    var occSel = true;\n\n    if (isSel) {\n      for (var j = 0; j < occuritem.store.length; j++) {\n        var storeitem = occuritem.store[j];\n        var isStoreSel = storeitem[checkKey];\n\n        if (!isStoreSel) {\n          occSel = false;\n          break;\n        }\n      }\n    } else {\n      occSel = false;\n    }\n\n    occuritem[checkKey] = occSel;\n  },\n  setCartSel: function setCartSel(cartitem, isEditing, storeitem, occuritem) {\n    var checkKey = this.getCheckKey(isEditing);\n    cartitem[checkKey] = !cartitem[checkKey];\n    var isStoreSel = true;\n\n    if (cartitem[checkKey]) {\n      isStoreSel = this.judgeStoreIsSel(storeitem, isEditing);\n    } else {\n      isStoreSel = false;\n    }\n\n    storeitem[checkKey] = isStoreSel;\n    this.resetOccurItem(occuritem, isEditing, isStoreSel);\n  },\n  getPayNum: function getPayNum(occuritem, isEditing) {\n    if (isEditing) {\n      return 0;\n    } else {\n      var checkKey = this.getCheckKey(isEditing);\n      var num = 0;\n\n      for (var j = 0; j < occuritem.store.length; j++) {\n        var storeitem = occuritem.store[j];\n\n        for (var activityIndex = 0; activityIndex < storeitem.activity.length; activityIndex++) {\n          var activityitem = storeitem.activity[activityIndex];\n\n          for (var cartIndex = 0; cartIndex < activityitem.cart.length; cartIndex++) {\n            var cartitem = activityitem.cart[cartIndex];\n\n            if (cartitem[checkKey] && cartitem.isGift == '0') {\n              num += cartitem.number;\n            }\n          }\n        }\n\n        for (var _activityIndex4 = 0; _activityIndex4 < storeitem.noActivityCart.length; _activityIndex4++) {\n          var _cartitem4 = storeitem.noActivityCart[_activityIndex4];\n\n          if (_cartitem4[checkKey]) {\n            num += _cartitem4.number;\n          }\n        }\n      }\n\n      return num;\n    }\n  },\n  getCheckKey: function getCheckKey(isEditing) {\n    if (isEditing) {\n      return 'dchecked';\n    } else {\n      return 'checked';\n    }\n  },\n  ///获取收单机构下 所有的项目\n  getSelOccur: function getSelOccur(occuritem, isEditing, type) {\n    var checkKey = this.getCheckKey(isEditing);\n    var selArr = [];\n\n    for (var j = 0; j < occuritem.store.length; j++) {\n      var storeitem = occuritem.store[j];\n      var arr = this.getSelStore(storeitem, isEditing, type);\n      selArr = selArr.concat(arr);\n    }\n\n    if (type == 'update') {\n      for (var i = 0; i < selArr.length; i++) {\n        var item = selArr[i];\n        item.checked = occuritem.checked ? 0 : 1;\n      }\n    }\n\n    return selArr;\n  },\n  //获取所有商铺下面商品的集合\n  getSelStore: function getSelStore(storeitem, isEditing, type) {\n    var checkKey = this.getCheckKey(isEditing);\n    var selArr = [];\n\n    for (var activityIndex = 0; activityIndex < storeitem.activity.length; activityIndex++) {\n      var activityitem = storeitem.activity[activityIndex];\n\n      for (var cartIndex = 0; cartIndex < activityitem.cart.length; cartIndex++) {\n        var cartitem = activityitem.cart[cartIndex]; //更新要是所有\n\n        if (cartitem[checkKey] || type == 'update') {\n          selArr.push(this.revertCartitemToDic(cartitem, type, storeitem));\n        }\n      }\n    }\n\n    for (var _activityIndex5 = 0; _activityIndex5 < storeitem.noActivityCart.length; _activityIndex5++) {\n      var _cartitem5 = storeitem.noActivityCart[_activityIndex5]; //更新要是所有\n\n      if (_cartitem5[checkKey] || type == 'update') {\n        selArr.push(this.revertCartitemToDic(_cartitem5, type, storeitem));\n      }\n    }\n\n    return selArr;\n  },\n  //获取所有失效的集合\n  getInvalidArr: function getInvalidArr(arr) {\n    var selArr = [];\n\n    for (var index = 0; index < arr.length; index++) {\n      var cartitem = arr[index];\n      selArr.push(this.revertCartitemToDic(cartitem, 'delete'));\n    }\n\n    return selArr;\n  },\n  revertCartitemToDic: function revertCartitemToDic(cartitem, type, storeitem) {\n    var dic = {};\n\n    if (type == 'update') {\n      dic = {\n        skuId: cartitem.skuId,\n        storeOuCode: cartitem.storeOuCode,\n        checked: storeitem.checked ? 0 : 1,\n        activityId: cartitem.activityId,\n        isGift: cartitem.isGift\n      };\n\n      if (cartitem.currentSelfActivity && cartitem.currentSelfActivity != '' && cartitem.currentSelfActivity.mktActivityId && cartitem.currentSelfActivity.mktActivityId != '') {\n        dic.selfActivityId = cartitem.currentSelfActivity.mktActivityId;\n      }\n    } else if (type == 'pay') {\n      dic = {\n        id: cartitem.id,\n        skuId: cartitem.skuId,\n        storeOuCode: cartitem.storeOuCode,\n        number: cartitem.number,\n        activityId: cartitem.activityId,\n        checked: cartitem.checked,\n        isGift: cartitem.isGift\n      };\n\n      if (cartitem.currentSelfActivity && cartitem.currentSelfActivity != '' && cartitem.currentSelfActivity.mktActivityId && cartitem.currentSelfActivity.mktActivityId != '') {\n        dic.selfActivityId = cartitem.currentSelfActivity.mktActivityId;\n      } // 特定处理，不参加活动的时候，的时候需要传-2\n\n\n      if (cartitem.currentSelfActivity != null && cartitem.currentSelfActivity == '' && cartitem.selfActivity && cartitem.selfActivity != '' && cartitem.selfActivity.length > 0) {\n        dic.selfActivityId = '-2';\n      }\n    } else if (type == 'delete') {\n      dic = {\n        skuId: cartitem.skuId,\n        storeOuCode: cartitem.storeOuCode,\n        isGift: cartitem.isGift,\n        activityId: cartitem.activityId\n      };\n    }\n\n    return dic;\n  },\n  // linkType  1去凑单  2再逛逛 3领赠品 4去换购  5赠品未满足  6换购未满足\n  getActivityRightTitle: function getActivityRightTitle(activityitem) {\n    //没有完成条件\n    if (activityitem.linkType == 1 || activityitem.linkType == 5 || activityitem.linkType == 6) {\n      return '去凑单';\n    } else if (activityitem.linkType == 2) {\n      return '再逛逛';\n    } else if (activityitem.linkType == 3) {\n      var isHasGift = false;\n\n      for (var i = 0; i < activityitem.cart.length; i++) {\n        var cartItem = activityitem.cart[i];\n\n        if (cartItem.isGift == 1) {\n          isHasGift = true;\n          break;\n        }\n      }\n\n      if (isHasGift) {\n        return '重新领取';\n      } else {\n        return '领赠品';\n      }\n    } else if (activityitem.linkType == 4) {\n      var isHasHG = false;\n\n      for (var _i = 0; _i < activityitem.cart.length; _i++) {\n        var _cartItem = activityitem.cart[_i];\n\n        if (_cartItem.isGift == 2) {\n          isHasHG = true;\n          break;\n        }\n      }\n\n      if (isHasHG) {\n        return '重新领取';\n      } else {\n        return '去换购';\n      }\n    } //  什么也不显示\n\n\n    return '再逛逛';\n  },\n  getGiftIsOnlyScan: function getGiftIsOnlyScan(activityInfo) {\n    var isScan = true; //3选赠品  4选换购   这两个值 表示满足了条件\n\n    if (activityInfo.linkType == 3 || activityInfo.linkType == 4) {\n      isScan = false;\n    }\n\n    return isScan;\n  },\n  getGiftType: function getGiftType(activityInfo) {\n    //1赠品  2换购\n    var giftType = 1;\n\n    if (activityInfo.linkType == 4 || activityInfo.linkType == 6) {\n      giftType = 2;\n    }\n\n    return giftType;\n  }\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = (cart);\n\n//# sourceURL=webpack:///./src/components/mall2/cart/js/cart.js?");

/***/ })

}]);