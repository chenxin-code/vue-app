(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[1048],{

/***/ "./src/utils/staticData/staticDataRequest.js":
/*!***************************************************!*\
  !*** ./src/utils/staticData/staticDataRequest.js ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var E_part_vue_app_bate_node_modules_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./node_modules/@babel/runtime/helpers/esm/typeof */ \"./node_modules/@babel/runtime/helpers/esm/typeof.js\");\n/* harmony import */ var E_part_vue_app_bate_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./node_modules/@babel/runtime/helpers/esm/classCallCheck */ \"./node_modules/@babel/runtime/helpers/esm/classCallCheck.js\");\n/* harmony import */ var E_part_vue_app_bate_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./node_modules/@babel/runtime/helpers/esm/createClass */ \"./node_modules/@babel/runtime/helpers/esm/createClass.js\");\n/* harmony import */ var core_js_modules_es_array_index_of_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! core-js/modules/es.array.index-of.js */ \"./node_modules/core-js/modules/es.array.index-of.js\");\n/* harmony import */ var core_js_modules_es_array_index_of_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_index_of_js__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var core_js_modules_web_timers_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! core-js/modules/web.timers.js */ \"./node_modules/core-js/modules/web.timers.js\");\n/* harmony import */ var core_js_modules_web_timers_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_timers_js__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var core_js_modules_es_array_for_each_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! core-js/modules/es.array.for-each.js */ \"./node_modules/core-js/modules/es.array.for-each.js\");\n/* harmony import */ var core_js_modules_es_array_for_each_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_for_each_js__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ \"./node_modules/core-js/modules/web.dom-collections.for-each.js\");\n/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var _api_config__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../api/config */ \"./src/api/config.js\");\n\n\n\n\n\n\n\n\nvar _headContainer = document.getElementsByTagName('head')[0];\nvar _requestingArray = {};\n\nvar DataRequestJsonp = /*#__PURE__*/function () {\n  function DataRequestJsonp(url, funcName) {\n    var _this = this;\n\n    Object(E_part_vue_app_bate_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(this, DataRequestJsonp);\n\n    this.url = url || '';\n    this.funcName = funcName;\n    var scriptNode = document.createElement('script');\n    url += (~url.indexOf('?') ? '&' : '?') + 'callback=' + funcName;\n    scriptNode.src = url;\n    scriptNode.type = 'text/javascript';\n    this.myTimer = setTimeout(function () {\n      _this.callCallback({\n        status: 1,\n        info: '网络加载较慢！'\n      });\n\n      _this.clearup();\n    }, 10 * 1000);\n\n    window[funcName] = function (res) {\n      _this.callCallback({\n        status: 0,\n        data: res,\n        info: ''\n      });\n\n      _this.clearup();\n    };\n\n    scriptNode.onerror = function () {\n      _this.callCallback({\n        status: 1,\n        info: '网络加载较慢！'\n      });\n\n      _this.clearup();\n    };\n\n    this.scriptNode = scriptNode;\n\n    _headContainer.appendChild(this.scriptNode);\n  }\n\n  Object(E_part_vue_app_bate_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(DataRequestJsonp, [{\n    key: \"then\",\n    value: function then(func) {\n      this.callbackFunc = func;\n    }\n  }, {\n    key: \"callCallback\",\n    value: function callCallback(d) {\n      var _this2 = this;\n\n      setTimeout(function () {\n        _this2.callbackFunc(d);\n      }, 0);\n    }\n  }, {\n    key: \"clearup\",\n    value: function clearup() {\n      if (this.myTimer) {\n        clearTimeout(this.myTimer);\n      }\n\n      this.myTimer = null;\n      this.scriptNode.src = ''; // delete _requestingArray[this.funcName]\n\n      _headContainer.removeChild(this.scriptNode); // window[this.funcName] && delete window[this.funcName]\n\n    }\n  }]);\n\n  return DataRequestJsonp;\n}();\n\nvar staticDataRequest = {\n  /**\r\n   * @param url 请求url\r\n   * @param funcName 请求回调名称，得写死，确保能缓存\r\n   * @param args 有序数组\r\n   * @returns {DataRequestJsonp} 返回请求对象\r\n   */\n  request: function request(url, funcName) {\n    var args = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n\n    if (!url) {\n      throw new Error('url 不能为空');\n    }\n\n    if (url.indexOf('http') != 0) {\n      url = _api_config__WEBPACK_IMPORTED_MODULE_7__[\"default\"].baseURL + url;\n    }\n\n    args.forEach(function (item) {\n      if (Object(E_part_vue_app_bate_node_modules_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(item) === 'object') {\n        for (var key in item) {\n          url += ~url.indexOf('?') ? '&' : '?';\n          url += key + '=' + item[key];\n        }\n      }\n    });\n    var req = new DataRequestJsonp(url, funcName); // 去掉移除重复\n    // if (_requestingArray[funcName]) {\n    //   _requestingArray[funcName].cancel()\n    //   delete _requestingArray[funcName]\n    // }\n    // _requestingArray[funcName] = req\n\n    return req;\n  },\n  cancelAll: function cancelAll() {// _requestingArray.forEach((key, req) => {\n    //   req.cancel()\n    // })\n    // _requestingArray = {}\n  }\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = (staticDataRequest);\n\n//# sourceURL=webpack:///./src/utils/staticData/staticDataRequest.js?");

/***/ })

}]);