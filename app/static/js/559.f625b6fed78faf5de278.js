(window.webpackJsonp=window.webpackJsonp||[]).push([[559],{aIPj:function(t,n,e){},"jfi+":function(t,n,e){"use strict";var s=e("aIPj");e.n(s).a},mTnm:function(t,n,e){"use strict";e("5+UC");var s=e("05lO"),a=e("oCYn"),i=(e("ygAv"),e("oYx3"),e("dRp0")),o=e("ZToj"),c=function(){function t(t,n){for(var e=0;e<n.length;e++){var s=n[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(n,e,s){return e&&t(n.prototype,e),s&&t(n,s),n}}();a.default.use(s.a);var r=function(){function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.jsApiList=n}return c(t,[{key:"hideAllBaseMenu",value:function(){this._init(["hideAllNonBaseMenuItem"]).then((function(){wx.hideAllNonBaseMenuItem()}))}},{key:"getEtpLocation",value:function(t){this._init(["getLocation"]).then((function(){wx.getLocation({type:"gcj02",success:function(n){t&&t(n)}})}))}},{key:"createEnterpriseChat",value:function(t,n,e){t&&n?this._init(["openEnterpriseChat"]).then((function(){wx.openEnterpriseChat({userIds:t.join(";"),externalUserIds:n.join(";"),groupName:"群聊",success:function(t){e&&e(t)},fail:function(t){t.errMsg.indexOf("function not exist")>-1&&alert("版本过低请升级")}})})):console.log("传参有误")}},{key:"getExternalContact",value:function(t){var n=this;this._init(["getCurExternalContact"]).then((function(){n._initAgent(["getCurExternalContact"]).then((function(n){wx.invoke("getCurExternalContact",{},(function(n){"getCurExternalContact:ok"==n.err_msg?(console.log("wxfunc-etp getCurExternalContact res",n),t&&t(n.userId)):console.log("wxfunc-etp getCurExternalContact err")}))}))}))}},{key:"_init",value:function(t){var n=this;return new Promise((function(e,s){n._getConfig().then((function(n){wx.config({beta:!0,debug:!1,appId:n.corpId,timestamp:n.timestamp,nonceStr:n.nonceStr,signature:n.signature,jsApiList:t}),wx.ready((function(){e(n)})),wx.error((function(t){s(t),console.log("we error",t)}))})).catch((function(t){console.log("发生错误！",t)}))}))}},{key:"_getConfig",value:function(){return new Promise((function(t,n){navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);var e={url:window.location.href.split("#")[0],agentId:o.a.state.etpAgentId,appId:o.a.state.etpAppId,hbsy_web_tag_type:1};i.a.post("/app/json/wechat_qy/signature",e).then((function(e){var s=e.data;0===s.status?t(s.data):n("获取签名信息失败!")})).catch((function(t){n(t)}))}))}},{key:"_initAgent",value:function(t){var n=this;return new Promise((function(e,s){n._getAgentConfig().then((function(n){wx.agentConfig({corpid:n.corpId,agentid:n.agentId,timestamp:n.timestamp,nonceStr:n.nonceStr,signature:n.signature,jsApiList:t,success:function(t){e(t)},fail:function(t){t.errMsg.indexOf("function not exist")>-1&&alert("版本过低请升级")},complete:function(t){console.log("agentConfig complete",t)}})})).catch((function(t){console.log("发生错误！",t)}))}))}},{key:"_getAgentConfig",value:function(){return new Promise((function(t,n){navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);var e={url:window.location.href.split("#")[0],agentId:o.a.state.etpAgentId,appId:o.a.state.etpAppId,hbsy_web_tag_type:1};i.a.post("/app/json/wechat_qy/agentSignature",e).then((function(e){var s=e.data;0===s.status?t(s.data):n("获取签名信息失败!")})).catch((function(t){n(t)}))}))}}]),t}();n.a=new r},zaXI:function(t,n,e){"use strict";e.r(n);var s=e("mTnm"),a={data:function(){return{userInfo:{}}},mounted:function(){var t=this;this.$route.query.qyUserId?this.getDetailInfo(this.$route.query.qyUserId):this.$route.query.token?(this.$store.state.login.token=this.$route.query.token,s.a.getExternalContact((function(n){console.log("getExternalContact qyUserId ---\x3e ",n),t.getDetailInfo(n)}))):alert("获取token错误！")},methods:{showEruda:function(){var t=(new Date).getTime();t-this.clickTime<1e3||-1==this.clickTime?(this.vConsoleTimes+=1,this.clickTime=t,5==this.vConsoleTimes&&(eruda.init(),this.vConsoleTimes=0,this.clickTime=-1)):(this.vConsoleTimes=0,this.clickTime=-1)},showMsg:function(){var t=this;s.a.getExternalContact((function(n){console.log("getExternalContact qyUserId ---\x3e ",n),t.getDetailInfo(n)}))},getDetailInfo:function(t){var n=this;this.$Loading.open(),this.$http.post("/app/json/wechat_qy/queryCustomerDetail",{qyUserId:t}).then((function(t){n.$Loading.close();var e=t.data;0==e.status?n.userInfo=e.data||{}:n.$Toast(e.info)})).catch((function(t){n.$Loading.close(),n.$Toast("queryCustomerDetail err "+t)}))},dealwithSex:function(t){return 1==t?"男":2==t?"女":"未知"},dealwithIsAcctYoudi:function(t){return 0==t?"未开通":1==t?"开通":"未知"},sendMsg:function(){var t=[this.userInfo.empQyUserId],n=[this.userInfo.qyUserId];s.a.createEnterpriseChat(t,n,(function(t){console.log("拉起成功！")}))}}},i=(e("jfi+"),e("KHd+")),o=Object(i.a)(a,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"container"},[e("div",{staticClass:"user-info"},[e("img",{staticClass:"avatar",attrs:{src:t.userInfo.avtUrl,alt:""},on:{click:t.showEruda}}),t._v(" "),e("div",{staticClass:"info"},[e("p",{staticClass:"name"},[t._v(t._s(t.userInfo.nickName))]),t._v(" "),e("p",{staticClass:"phone"},[t._v(t._s(t.userInfo.userPhone))])])]),t._v(" "),e("ul",{staticClass:"basic-info-list"},[e("li",{staticClass:"item",on:{click:t.showMsg}},[e("span",{staticClass:"label"},[t._v("性别")]),t._v(" "),e("span",{staticClass:"content"},[t._v(t._s(t.dealwithSex(t.userInfo.sex)))])]),t._v(" "),e("li",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("客户归属")]),t._v(" "),e("span",{staticClass:"content"},[t._v(t._s(t.userInfo.empName))])]),t._v(" "),e("li",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("油滴余额")]),t._v(" "),e("span",{staticClass:"content"},[t._v(t._s(t.userInfo.oilDropAmount||0))])]),t._v(" "),e("li",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("加油频次")]),t._v(" "),e("span",{staticClass:"content"},[t._v(t._s(t.userInfo.refuelFre||0)+"次/月")])]),t._v(" "),e("li",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("油品偏好")]),t._v(" "),e("span",{staticClass:"content"},[t._v(t._s(t.userInfo.oilPre))])]),t._v(" "),e("li",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("支付偏好")]),t._v(" "),e("span",{staticClass:"content"},[t._v(t._s(t.userInfo.payPre))])]),t._v(" "),e("li",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("油滴会员")]),t._v(" "),e("span",{staticClass:"content"},[t._v(t._s(t.dealwithIsAcctYoudi(t.userInfo.isAcctYoudi)))])]),t._v(" "),e("li",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("添加好友时间")]),t._v(" "),e("span",{staticClass:"content"},[t._v(t._s(t.userInfo.createTime))])]),t._v(" "),e("li",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("最近活跃时间")]),t._v(" "),e("span",{staticClass:"content"},[t._v(t._s(t.userInfo.lastRefuelTime))])]),t._v(" "),e("li",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("常去油站")]),t._v(" "),e("span",{staticClass:"content"},[t._v(t._s(t.userInfo.commonSta))])])]),t._v(" "),e("div",{staticClass:"send-msg",on:{click:t.sendMsg}},[t._v("发送消息")])])}),[],!1,null,"2c4b37da",null);n.default=o.exports}}]);