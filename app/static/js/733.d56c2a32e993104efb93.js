(window.webpackJsonp=window.webpackJsonp||[]).push([[733],{"c9W+":function(t,e,a){},iQCv:function(t,e,a){"use strict";a.r(e);var o=a("0ERz"),i=a.n(o),n=a("YsXA"),s=a.n(n),r=a("7//l"),c=a("Gedb"),d={name:"my-qrcode",components:{QRCode:i.a},data:function(){return{myInfo:{},complete:!1,myTimeout:null,brightnessResult:{}}},mounted:function(){this.makePayQrcode()},methods:{makePayQrcode:function(){var t=this;this.$Loading.open();var e={token:this.$store.state.login.token,payMode:120,distOuCode:1,imgVerifyCode:this.$route.query.verifyCode||"",uuid:this.$route.query.uuid||""};this.$http.post("/app/json/app_pay/makePayQrcode",e).then((function(e){t.$Loading.close();var a=e.data;0==a.status?(t.complete=!0,t.myInfo=a.data,t.$nextTick((function(){t.toCanvas(),clearInterval(t.queryPayStateTimer),t.queryPayStateTimer=setInterval((function(){t.payQrcodeCheck(t.myInfo.qrcode)}),2e3)}))):("1"==t.$store.state.globalConfig.qrcodePayVerify&&t.$router.go(-1),t.$Toast(a.info))}),(function(e){t.$Loading.close()}))},payQrcodeCheck:function(t){var e=this;this.digitalPWD="";var a={token:this.$store.state.login.token,payMode:120,qrcode:t};this.$http.post("/app/json/app_pay/payQrcodeCheck",a).then((function(a){var o=a.data;if(0==o.status&&(e.payDetais=o.data,e.payDetais.payUnit))if(clearInterval(e.queryPayStateTimer),e.payDetais.needPayPwd){if("1"==e.payDetais.payPwdState)return void e.$Toast("支付密码已锁定，请稍后再试！");r.a.open({initData:{payPwdState:e.payDetais.payPwdState},toSettingPwd:function(){e.$router.push({path:"/usercenter/nosetpwd",query:{isSet:e.payDetais.payPwdState,source:"rebate"}}),r.a.close()},inputFinished:function(a){e.digitalPWD=a,e.payQrcodePay(e.digitalPWD,t),r.a.close()}})}else e.payQrcodePay(e.digitalPWD,t)}),(function(t){}))},payQrcodePay:function(t,e){var a=this,o="";t&&(o=Object(c.a)(t)),this.$request.post("/app/json/app_pay/payQrcodePay",{payMode:120,qrcode:e,PayPwd:o}).then((function(t){0===t.status?a.$router.push({path:"/usercenter/pay-results",query:{payInfo:JSON.stringify(a.payDetais)}}):a.$Toast(t.info)}))},toCanvas:function(){var t=document.getElementById("barcode");s()(t,this.myInfo.qrcode),document.getElementById("qrcode").innerHTML="",new i.a("qrcode",{width:200,height:200,text:this.myInfo.qrcode});var e=document.getElementById("qrcode").getElementsByTagName("img")[0];e.style.width="100%",e.style.height="100%"},backEvent:function(){this.$keepaliveHelper.deleteCache(this),this.$router.go(-1)}},destroyed:function(){clearInterval(this.queryPayStateTimer)}},y=(a("x6xT"),a("KHd+")),u=Object(y.a)(d,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"my-qrcode"},[a("nav-top",{attrs:{title:"积分支付"},on:{backEvent:t.backEvent}}),t._v(" "),t.complete?a("nav-content",{staticClass:"my-qrcode-container"},[a("div",{staticClass:"code-content"},[a("div",{staticClass:"top-div"}),t._v(" "),a("div",{staticClass:"qr-div"},[a("div",{staticClass:"phone"},[t._v("积分："+t._s(t.$route.query.integralinfo||0))]),t._v(" "),a("div",{staticClass:"barcode"},[a("canvas",{attrs:{id:"barcode"}})]),t._v(" "),a("p",{staticClass:"code"},[t._v(t._s(t.myInfo.qrCode))]),t._v(" "),a("div",{staticClass:"codeimg-content"},[a("div",{ref:"qrcode",staticClass:"qrcode",attrs:{id:"qrcode"}}),t._v(" "),a("div",{staticClass:"icon"},[t._v("五分钟有效")])])])])]):t._e()],1)}),[],!1,null,"4809a3be",null);e.default=u.exports},x6xT:function(t,e,a){"use strict";var o=a("c9W+");a.n(o).a}}]);