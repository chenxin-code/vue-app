(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3879f197"],{1148:function(t,i,e){"use strict";var s=e("a691"),a=e("1d80");t.exports=function(t){var i=String(a(this)),e="",n=s(t);if(n<0||n==1/0)throw RangeError("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(i+=i))1&n&&(e+=i);return e}},"161e":function(t,i,e){"use strict";e.r(i);var s,a=function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"oil-sale-container"},[s("nav-top",{attrs:{title:"约单详情"},on:{backEvent:function(i){return t.$router.go(-1)}}}),s("nav-content",{staticClass:"bill-details-container"},[s("div",{staticClass:"bill-content"},[2==t.appointmentItem.state?s("div",{staticClass:"tips-appointment"},[t._v("您有约单订单处理待确定状态，订单审批通过后才能再次进行约单。")]):t._e(),s("div",{staticClass:"buy-bill"},[s("div",{staticClass:"table-view"},[s("div",{staticClass:"table-view-cell"},[s("div",{staticClass:"table-view-cell-text"},[s("div",{staticClass:"bill-item"},[s("div",{staticClass:"img-wrapper"},[s("img",{staticClass:"img",attrs:{src:e("3d83"),alt:""}})]),s("div",{staticClass:"center-text"},[s("div",{staticClass:"title"},[t._v(t._s(t.appointmentItem.matertialName))]),2==t.appointmentItem.state?s("div",{staticClass:"time"},[t._v("约单时间："+t._s(t.appointmentItem.submitTime))]):s("div",{staticClass:"time"},[t._v("活动结束时间:"+t._s(t.appointmentItem.endDate))]),2==t.appointmentItem.state?s("div",{staticClass:"tips"},[t._v("约单单价："+t._s(t.appointmentItem.price))]):s("div",{staticClass:"tips"},[t._v(" 约单吨数范围："+t._s(t.appointmentItem.tonnesLowerLimit)+"t~"+t._s(t.appointmentItem.tonnesUpperLimit)+"t ")])]),2==t.appointmentItem.state?s("div",{staticClass:"bill-btn",on:{click:t.cacelAppointmentBill}},[s("div",{staticClass:"appointment-circle"},[t._v("约单中")]),s("div",{staticClass:"btn-show"},[t._v("取消约单")])]):t._e()])])]),s("div",{staticClass:"table-view-cell"},[s("div",{staticClass:"table-view-cell-text"},[s("ul",{staticClass:"details-list"},[s("li",{staticClass:"details-item"},[s("div",{staticClass:"left"},[t._v("购油量")]),s("div",{staticClass:"right"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.oilNum,expression:"oilNum"}],attrs:{type:"number",disabled:t.disabled,placeholder:"请输入购油量(t)"},domProps:{value:t.oilNum},on:{blur:t.blurOilNum,input:[function(i){i.target.composing||(t.oilNum=i.target.value)},t.input],keyup:t.keyup}})])]),s("li",{staticClass:"details-item"},[s("div",{staticClass:"left"},[t._v("约单油品单价")]),s("div",{staticClass:"right"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.price,expression:"price"}],attrs:{type:"number",disabled:t.disabled,placeholder:"请输入约单油品单价"},domProps:{value:t.price},on:{input:[function(i){i.target.composing||(t.price=i.target.value)},t.inputPrice],keyup:t.keyupPrice}})])]),s("li",{staticClass:"details-item"},[s("div",{staticClass:"left"},[t._v("配送方式")]),s("div",{staticClass:"right"},[s("div",{staticClass:"switch-bar"},t._l(t.switchBar,(function(i){return s("div",{staticClass:"switch-bar-item",class:[i.type===t.switchBarType?"theme_bg_blue theme_font_white active":""],on:{click:function(e){return t.switchHandler(i.type)}}},[t._v(t._s(i.name)+" ")])})),0)])]),2==t.switchBarType?s("Address",{attrs:{receiver:t.receiver},on:{info:t.info}}):t._e(),1==t.switchBarType?s("li",{staticClass:"details-item",on:{click:t.openOilWarehouse}},[s("div",{staticClass:"left"},[t._v("自提油库")]),s("div",{staticClass:"right"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.oilLibrary,expression:"oilLibrary"}],attrs:{type:"text",disabled:"",placeholder:"选择油库"},domProps:{value:t.oilLibrary},on:{input:function(i){i.target.composing||(t.oilLibrary=i.target.value)}}})]),s("TipsPopup",{ref:"mychild",attrs:{isOpenPopup:t.isOpenPopup},on:{getOilInfo:t.getOilInfo}})],1):t._e(),1==t.switchBarType?s("li",{staticClass:"details-item"},[s("div",{staticClass:"left"},[t._v("提货人")]),s("div",{staticClass:"right"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.people,expression:"people"}],attrs:{type:"text",disabled:t.disabled,placeholder:"请输入提货人"},domProps:{value:t.people},on:{input:function(i){i.target.composing||(t.people=i.target.value)}}})])]):t._e(),1==t.switchBarType?s("li",{staticClass:"details-item"},[s("div",{staticClass:"left"},[t._v("提货人手机号")]),s("div",{staticClass:"right"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.phone,expression:"phone"}],attrs:{maxlength:"11",type:"tel",pattern:"[0-9]*",disabled:t.disabled,onkeypress:"return( /[\\d]/.test(String.fromCharCode(event.keyCode)))",placeholder:"请输入提货人手机号"},domProps:{value:t.phone},on:{input:function(i){i.target.composing||(t.phone=i.target.value)}}})])]):t._e()],1)])]),s("div",{staticClass:"table-view-cell"},[s("div",{staticClass:"table-view-cell-text"},[s("ul",{staticClass:"buy-bill-money-list"},[s("li",{staticClass:"buy-bill-money-item"},[s("div",{staticClass:"money"},[s("div",{staticClass:"left"},[t._v("油品总金额")]),s("div",{staticClass:"right"},[t._v(" ￥"),s("span",{staticClass:"num"},[t._v(t._s(t.dealNum()))])])]),s("div",{staticClass:"money"},[s("div",{staticClass:"left"},[t._v("活动优惠")]),s("div",{staticClass:"right special"},[t._v(" ￥"),s("span",{staticClass:"num"},[t._v(t._s(t.calculatePrice()))])])]),s("div",{staticClass:"money"},[s("div",{staticClass:"left"},[t._v("实际需支付")]),s("div",{staticClass:"right special"},[t._v(" ￥"),s("span",{staticClass:"num"},[t._v(t._s((t.dealNum()-t.calculatePrice()).toFixed(2)))])])])])])])])])]),s("div",{staticClass:"now-buy-bill-btn",on:{click:t.nowBuyBill}},[s("div",{staticClass:"btn",class:{active:2==t.appointmentItem.state}},[t._v("立即约单")])]),s("van-popup",{attrs:{"close-on-click-overlay":t.overlay},model:{value:t.showTips,callback:function(i){t.showTips=i},expression:"showTips"}},[s("div",{staticClass:"tips-content"},[s("div",{staticClass:"title"},[t._v("温馨提示")]),s("div",{staticClass:"content"},[t._v("确认约单"+t._s(t.oilNum)+"t"+t._s(t.appointmentItem.matertialName)+"，约单价为"+t._s(t.price)+"元的订单吗")]),s("div",{staticClass:"btn-group"},[s("div",{staticClass:"btn",on:{click:function(i){t.showTips=!1}}},[t._v("再想想")]),s("div",{staticClass:"btn",on:{click:t.queryAppointmentBill}},[t._v("确定约单")])])])])],1)])],1)},n=[],o=e("ade3"),r=(e("e17f"),e("2241")),l=e("5530"),c=(e("b680"),e("ac1f"),e("5319"),e("b64b"),e("b0c0"),e("9537")),p=e("2f62"),d=e("51eb"),u={data:function(){return{receiver:{},addressInfo:{},switchBarType:1,switchBar:[{name:"配送",type:2},{name:"自提",type:1}],showTips:!1,overlay:!1,oilNum:"",price:"",oilLibrary:"",people:"",isOpenPopup:!0,appointmentItem:"",activityRecord:"",oilInfo:"",phone:"",disabled:!1}},mounted:function(){this.appointmentItem=JSON.parse(this.$route.query.appointmentItem),2==this.appointmentItem.state&&(this.loadOilSaleActivityRecord(),this.disabled=!0,this.isOpenPopup=!1)},computed:Object(l["a"])({},Object(p["c"])(["vipUnitUser"])),methods:{switchHandler:function(t){this.switchBarType=t,this.switchBarType},info:function(t){this.addressInfo=t},calculatePrice:function(){if(this.appointmentItem.basePrice){var t=this.appointmentItem.basePrice*this.oilNum,i=this.oilNum*this.price,e=(Math.round(100*t)-Math.round(100*i))/100;return e>0?e.toFixed(2):0}return 0},dealNum:function(){var t=(this.oilNum*this.price).toFixed(2);return(Math.round(100*t)/100).toFixed(2)},loadOilSaleActivityRecord:function(){var t=this;this.$request.post("/app/json/app_oil_sale/loadOilSaleActivityRecord",{id:this.appointmentItem.recordId,vipUnitUserCode:this.vipUnitUser.vipUnitUserId}).then((function(i){0===i.status?(t.activityRecord=i.data,t.oilNum=t.activityRecord.tonnes,t.oilLibrary=t.activityRecord.pickUpOilDepotName,t.people=t.activityRecord.consignee,t.price=t.activityRecord.price,t.phone=t.activityRecord.consigneePhone):t.$Toast(i.info?i.info:"获取详情失败")}))},cacelAppointmentBill:function(){var t=this;this.$dialog.confirm({message:"确定取消当前约单吗？"}).then((function(){t.$request.post("/app/json/app_oil_sale/cancelReserveOrder",{id:t.appointmentItem.recordId,vipUnitUserCode:t.vipUnitUser.vipUnitUserId}).then((function(i){0===i.status?t.$dialog.alert({message:"取消成功"}).then((function(){t.$router.go(-1)})):t.$Toast(i.info?i.info:"约单取消失败")}))}))},nowBuyBill:function(){if(2!=this.appointmentItem.state){var t=this.phone;t=t.replace(/\s*/g,"");var i=/^(13[0-9]|14[0-9]|15[0-9]|16[0-9]|17[0-9]|18[0-9]|19[0-9])\d{8}$/;""==this.oilNum||this.oilNum<=0?this.$Toast("请输入正确购油量"):""==this.price?this.$Toast("请输入单价"):2==this.switchBarType?0==Object.keys(this.receiver).length||""==this.receiver.receiverName?this.$Toast("请输入收货人姓名"):""==this.receiver.mobile?this.$Toast("请输入收货人手机号"):i.test(this.receiver.mobile)?this.receiver.regionText?this.receiver.address?this.showTips=!0:this.$Toast("请输入详细地址"):this.$Toast("请选择区域"):(this.$Toast("请输入请输入有效收货人手机号"),this.receiver.mobile=""):1==this.switchBarType&&(""==this.oilLibrary?this.$Toast("请选择自提油库"):""==this.people?this.$Toast("请输入提货人"):""==this.phone?this.$Toast("请输入联系方式"):i.test(t)?this.showTips=!0:(this.phone="",this.$Toast("请输入有效手机号！")))}else this.showTips=!1,this.isOpenPopup=!1},openOilWarehouse:function(){2!=this.appointmentItem.state&&this.$refs.mychild.queryPickUpDepot()},blurOilNum:function(){(this.oilNum<this.appointmentItem.tonnesLowerLimit||this.oilNum>this.appointmentItem.tonnesUpperLimit)&&(this.oilNum="",this.$Toast("请在约单的吨数范围内填写！"))},input:function(){this.oilNum=this.oilNum.replace(/\.{2,}/g,".").replace(".","$#$").replace(/\./g,"").replace("$#$",".").replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3"),("0"===this.oilNum.substring(0,1)&&"."!=this.oilNum.substring(1,2)||"."===this.oilNum.substring(0,1))&&(this.$Toast("请输入正确购油量"),this.oilNum="")},keyup:function(){this.oilNum=this.oilNum.replace(/\.{2,}/g,".").replace(".","$#$").replace(/\./g,"").replace("$#$",".").replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3")},inputPrice:function(){this.price=this.price.replace(/\.{2,}/g,".").replace(".","$#$").replace(/\./g,"").replace("$#$",".").replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3"),("0"===this.price.substring(0,1)&&"."!=this.price.substring(1,2)||"."===this.price.substring(0,1))&&(this.$Toast("请输入正确价格"),this.price="")},keyupPrice:function(){this.price=this.price.replace(/\.{2,}/g,".").replace(".","$#$").replace(/\./g,"").replace("$#$",".").replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3")},getOilInfo:function(t){this.oilInfo=t,this.oilLibrary=t.text},queryAppointmentBill:function(){var t=this;this.showTips=!1;var i={};i=1==this.switchBarType?{deliveryType:this.switchBarType,tonnes:this.oilNum,skuId:this.appointmentItem.skuId,pickUpOilDepot:this.oilInfo.code,pickUpOilDepotName:this.oilInfo.text,activityId:this.appointmentItem.activityId,activityDetailId:this.appointmentItem.id,price:this.price,consignee:this.people,vipUnitUserCode:this.vipUnitUser.vipUnitUserId,consigneePhone:this.phone}:{deliveryType:this.switchBarType,consignee:this.receiver.receiverName,consigneePhone:this.receiver.mobile,activityDetailId:this.appointmentItem.id,skuId:this.appointmentItem.skuId,activityId:this.appointmentItem.activityId,vipUnitUserCode:this.vipUnitUser.vipUnitUserId,tonnes:this.oilNum,price:this.price,addressInfo:{address:this.receiver.address,regionText:this.receiver.regionText,mobile:this.receiver.mobile,receiverName:this.receiver.receiverName,cityId:this.addressInfo.cityId,cityName:this.addressInfo.cityName,countryId:this.addressInfo.countryId,countryName:this.addressInfo.countryName,provinceId:this.addressInfo.provinceId,provinceName:this.addressInfo.provinceName,townId:this.addressInfo.townId,townName:this.addressInfo.townName}},this.$request.post("/app/json/app_oil_sale/submitReserveOilSaleActivityOrder",i).then((function(i){0===i.status?t.$router.push({path:"/appointment-bill-results",query:{queryInfo:JSON.stringify(i.data)}}):t.$Toast(i.info?i.info:"约单失败")}))}},components:(s={},Object(o["a"])(s,r["a"].name,r["a"]),Object(o["a"])(s,"TipsPopup",c["a"]),Object(o["a"])(s,"Address",d["a"]),s)},h=u,v=(e("38bc"),e("0c7c")),m=Object(v["a"])(h,a,n,!1,null,"6f56d5f0",null);i["default"]=m.exports},"38bc":function(t,i,e){"use strict";e("65f9")},"3d83":function(t,i){t.exports="data:image/png;base64,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"},"408a":function(t,i,e){var s=e("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=s(t))throw TypeError("Incorrect invocation");return+t}},"65f9":function(t,i,e){},b680:function(t,i,e){"use strict";var s=e("23e7"),a=e("a691"),n=e("408a"),o=e("1148"),r=e("d039"),l=1..toFixed,c=Math.floor,p=function(t,i,e){return 0===i?e:i%2===1?p(t,i-1,e*t):p(t*t,i/2,e)},d=function(t){var i=0,e=t;while(e>=4096)i+=12,e/=4096;while(e>=2)i+=1,e/=2;return i},u=function(t,i,e){var s=-1,a=e;while(++s<6)a+=i*t[s],t[s]=a%1e7,a=c(a/1e7)},h=function(t,i){var e=6,s=0;while(--e>=0)s+=t[e],t[e]=c(s/i),s=s%i*1e7},v=function(t){var i=6,e="";while(--i>=0)if(""!==e||0===i||0!==t[i]){var s=String(t[i]);e=""===e?s:e+o.call("0",7-s.length)+s}return e},m=l&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r((function(){l.call({})}));s({target:"Number",proto:!0,forced:m},{toFixed:function(t){var i,e,s,r,l=n(this),c=a(t),m=[0,0,0,0,0,0],f="",b="0";if(c<0||c>20)throw RangeError("Incorrect fraction digits");if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(f="-",l=-l),l>1e-21)if(i=d(l*p(2,69,1))-69,e=i<0?l*p(2,-i,1):l/p(2,i,1),e*=4503599627370496,i=52-i,i>0){u(m,0,e),s=c;while(s>=7)u(m,1e7,0),s-=7;u(m,p(10,s,1),0),s=i-1;while(s>=23)h(m,1<<23),s-=23;h(m,1<<s),u(m,1,1),h(m,2),b=v(m)}else u(m,0,e),u(m,1<<-i,0),b=v(m)+o.call("0",c);return c>0?(r=b.length,b=f+(r<=c?"0."+o.call("0",c-r)+b:b.slice(0,r-c)+"."+b.slice(r-c))):b=f+b,b}})}}]);