(window.webpackJsonp=window.webpackJsonp||[]).push([[147,348],{"+6ky":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkEwNDQ1REE3RENFMjExRThCMEE1QjE1MjEzODU2Rjc0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkEwNDQ1REE4RENFMjExRThCMEE1QjE1MjEzODU2Rjc0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QTA0NDVEQTVEQ0UyMTFFOEIwQTVCMTUyMTM4NTZGNzQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QTA0NDVEQTZEQ0UyMTFFOEIwQTVCMTUyMTM4NTZGNzQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5KZ6ijAAABVElEQVR42rTXsUvDQBTH8fQhCC6dOtlB6CbOgoNSOxSEUvpXRHAUhP4JTu7J3N0iDtJBS7GLs3QrdHBzculY/D3oEEIuuffu5eCb0jTwIdfr0TSSJLmLougBfaJbtI0EI45jr+vSNG3h5RldoMcDHJ7QITpBx2ggxT3Rd3S2PzUmHFaZa67RKzqqEeWxYHiI1nXgDvQLjRj+QV1rvATtY1380f6EKV6F8hvKfGCC+6B5OBj3RYtgNS5BXbAYl6I8Gti5ymavjeaokzn3kdtkxGjZHVfd+RtqalEf2IVfopkW9YVd+LkWlcAuXIVKYdMhgYtWeHbaZ/hZNa3hIpSn91uLkxJd8HeKelqcFChvIDeIF9KvFqfAXYv/c6lwCkFDcApFtThZoBqcrFApTpaoBCdr1Bdn+MUa9cCnDJ/WgVbgVwzfow2a1PHclMOXaMcPbf8CDAAKSNzDF/bAzAAAAABJRU5ErkJggg=="},"02kl":function(t,e,a){"use strict";var i=a("C3sG");a.n(i).a},C3sG:function(t,e,a){},Fybm:function(t,e,a){"use strict";var i={name:"agreement-content",components:{},props:["value","noloading"],data:function(){return{agreementContent:""}},methods:{getAgreement:function(){var t=this;"true"!=this.noloading&&this.$Loading.open();var e=void 0,a=void 0;18==this.value?(e="/app/json/news/getNewsList",a={values:52}):(e="/app/json/news/getList",a={token:this.$store.state.login.token,value:this.value}),this.$http.post(e,a).then((function(e){"true"!=t.noloading&&t.$Loading.close();var a=e.data.data;if(a&&""!=a){var i=a[0];t.agreementContent=i.content}else console.log("协议内容为空")}),(function(e){"true"!=t.noloading&&t.$Loading.close(),t.$Toast("请求数据失败！")}))}},mounted:function(){this.getAgreement()},created:function(){}},s=(a("02kl"),a("KHd+")),o=Object(s.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"agreement-content"},[e("div",{staticClass:"content",domProps:{innerHTML:this._s(this.agreementContent)}})])}),[],!1,null,"5e72c5d8",null);e.a=o.exports},GGi1:function(t,e,a){"use strict";a.r(e);var i={name:"agreement",components:{AgreementContent:a("Fybm").a},props:["propsValue"],data:function(){return{value:"",topTitle:"协议"}},methods:{backEvent:function(){this.propsValue?this.$emit("backEvent"):this.$router.go(-1)}},created:function(){this.value=this.$route.query.value?this.$route.query.value:3,this.topTitle="协议",this.propsValue&&(this.value=this.propsValue),3!=this.$store.state.webtype&&(9==this.value?(this.topTitle="发票须知",document.title="发票须知"):10==this.value?(this.topTitle="积分规则",document.title="积分规则"):11==this.value?(this.topTitle="积分使用规则",document.title="积分使用规则"):17==this.value?(this.topTitle="用户协议",document.title="用户协议"):18==this.value?(this.topTitle="捐赠协议",document.title="捐赠协议"):63==this.value?(this.topTitle="隐私协议",document.title="隐私协议"):65==this.value?(this.topTitle="使用规则",document.title="使用规则"):80==this.value&&(this.topTitle="使用规则",document.title="使用规则"))}},s=(a("XXIG"),a("KHd+")),o=Object(s.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"agreement theme_bg_white"},[e("nav-top",{attrs:{title:this.topTitle},on:{backEvent:this.backEvent}}),this._v(" "),e("nav-content",[e("div",{staticClass:"content"},[e("AgreementContent",{attrs:{value:this.value}})],1)])],1)}),[],!1,null,"281a2789",null);e.default=o.exports},Kna2:function(t,e,a){"use strict";a.r(e);var i=a("Ziuy"),s=a("Xt+m"),o=a("Qcq2"),r=a("tpV1"),n=a("7//l"),c=a("WQzh"),l=a("GGi1"),u=a("Gedb"),d=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t},v={name:"placeorder",components:{PriceOrder:c.a,Agreement:l.default},data:function(){return{paramsData:{},payWays:[{text:"在线支付",tag:"1"},{text:"货到付款",tag:"0"},{text:"提货付款",tag:"0"}],payWaySelected:1,payWayText:"在线支付",payWayPopShow:!1,usePoints:!1,payDigitals:[],useInvoice:!1,lastRes:{},pointsGain:0,occurData:{},usedCoupons:[],invoiceData:null,invoiceInfo:"",currentInvoice:{},proImgArr:[],showProsDetail:!1,pickupPhone:this.$store.state.login.phone,pickupTime:"",currentStore:{},isFirst:!0,referrer:"",canEditReferrer:!0,scanCode:"",showAgreement:!1,showPointsRule:!1,digitalPWD:"",dictByAlias:[],easyCardId:"",cardBalance:"",showYjPayInfo:!1,cardType:"",showYJChange:!1,radio:1,cardList:[],cardDetails:"",userCanUseDigital:"",cardAmount:"",limitType:"",deliveryType:"",complete:!1,backReloadCoupon:!1,pickUpEndTime:"",hasShengxian:!1,wishData:{payNiceName:"",payMsg:""}}},computed:{recommendDisabled:function(){return!this.$store.state.globalConfig.recommendDisabled||!Number(this.$store.state.globalConfig.recommendDisabled)}},created:function(){var t=this,e=sessionStorage.getItem("Address_City_Seleted");e&&(e=JSON.parse(e),this.location=e,this.$store.state.mall2.selectAddress.id>0&&this.$store.state.mall2.selectAddress.cityId!=this.location.cityId&&(this.$store.state.mall2.selectAddress=this.location,this.$MessageBox.confirm("同城配送只支持同城地址，请选择收货地址","提示",{confirmButtonText:"确定"}).then((function(e){t.$router.push({path:"/mall2/addresslist",query:{type:"citydelivery"}})})).catch((function(t){}))));var a=this.$store.state.globalConfig.order_timeout_pickup_cancel||360;0==parseInt(a)&&(a=360);var i=(new Date).getTime();i+=3600*parseInt(a)*1e3,this.pickUpEndTime=this.$util.getPreTime(i);var s="";if((this.$store.state.globalConfig.acctList||[]).forEach((function(t){"LimitWallet"==t.acctType&&(s=t.startUsing)})),this.limitType=s,this.$route.query.SCREEN)this.getShortAddress(this.$route.query.SCREEN);else{this.complete=!0,this.lastRes=this.$route.params.res?this.$route.params.res:{},this.easyCardId=this.$route.params.easyCardId,this.cardType=this.$route.params.cardType,this.paramsData=this.$route.params.paramsData?this.$route.params.paramsData:{},this.deliveryType=this.$route.params.deliveryType?this.$route.params.deliveryType:"2";var o=this.$route.params.recommendPhone;o&&null!=o&&o.length&&(this.referrer=o,this.canEditReferrer=!1),this.initData(),"true"==this.limitType&&this.getCardList()}null!=this.$store.state.mall2.pickUpUser&&""!=this.$store.state.mall2.pickUpUser||(this.$store.state.mall2.pickUpUser=this.$store.state.login.nickName);var r=this.$store.state.mall2.behalf.referrerInvalidDate;r&&null!=r&&""!=r&&new Date(r).getTime()>=(new Date).getTime()&&(this.referrer=this.$store.state.mall2.behalf.referrer);var n=this.$store.state.globalConfig.order_timeout_pickup_cancel||0,c=new Date;c.setHours(c.getHours()+parseInt(n)),this.pickupTime=c,"wish"==this.$route.query.entryType&&this.getWishMsg(1)},mounted:function(){},methods:{getSelectReceiveTime:function(){var t=this.$store.state.globalConfig.order_fresh_pickup_timeout_startday||0,e=this.$util.nextDate(t),a=this.$store.state.globalConfig.order_fresh_pickup_timeout_starttime||"09:00:00";return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" "+a},getReceiveEndTime:function(){var t=this.$store.state.globalConfig.order_fresh_pickup_timeout_endday||1,e=this.$util.nextDate(t),a=this.$store.state.globalConfig.order_fresh_pickup_timeout_endtime||"15:00:00";return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" "+a},getShortAddress:function(t){var e=this;this.$request.post("/app/json/short_address/getShortAddress",{code:t}).then((function(t){if(0==t.status){var a=JSON.parse(t.data.addressData);e.deliveryType=a.deliveryType,a.token=e.$store.state.login.token,e.paramsData=a,console.log(a),e._reSettleCart(a.carts)}else e.$toast(t.info)}))},getTotalPriceDuan:function(t){return this.$util.toDecimal2(this.occurData.payAmount).split(".")[t]},queryBtn:function(){this.showYJChange=!1,"a"==this.radio?this._reSettleCart(null,""):this._reSettleCart(null,this.cardDetails.cardNo)},getCardList:function(){var t=this,e=[];this.occurData.store.forEach((function(t){t.noActivityCart.forEach((function(t){e.push({skuId:t.skuId})}))})),this.$request.post("/app/json/app_user_easy_card/getCardList",{proSkus:e}).then((function(e){if(0==e.status){if(t.cardList=e.data||[],t.cardList.length)for(var a in t.cardList)t.cardList[a].cardNo==t.$route.params.cardNo&&(t.radio=parseInt(a))}else t.$Toast(e.info)}))},changeYjCard:function(t){"a"!=this.radio?(this.cardAmount=t.balance,this.cardDetails=t):(this.cardAmount=0,this.cardDetails="")},getCanNotUseStr:function(t){return 1==t||3==t?"余额不足":1==t?"订单金额不够":"未知原因"},getDictByAlias:function(){var t=this,e={token:this.$store.state.login.token,alias:"rewards_group"};this.$http.post("/app/json/app_dict/getDictByAlias",e).then((function(e){var a=e.data;0==a.status&&0!=a.data.length&&(t.dictByAlias=a.data)}))},getDigitalDisplayName:function(t){return this.$mallCommon.accTypeToName(t,"200001")},pointsRuleEvent:function(){this.showPointsRule=!0},getEndDate:function(){var t=this.$store.state.globalConfig.order_timeout_pickup_cancel||0,e=new Date;return t?e.setHours(e.getHours()+parseInt(t)):e.setDate(e.getDate()+14),e},scanCodeFunc:function(){var t=this;this.$bridgefunc.scanCode((function(e){t.scanCode=e.code,t.referrer=e.code}))},getTotalPrice:function(){return this.$util.toDecimal2(this.occurData.payAmount)},getImgArrs:function(t){for(var e=[],a=0;a<t.activity.length;a++)for(var i=t.activity[a].cart,s=0;s<i.length;s++)e.push(i[s].phPictureUrl);for(var o=t.noActivityCart,r=0;r<o.length;r++)e.push(o[r].phPictureUrl);return e},getNoStockImgArrs:function(t){for(var e=[],a=[],i=0;i<t.activity.length;i++)for(var s=t.activity[i].cart,o=0;o<s.length;o++){var r=s[o];if(r.number>r.stockNumber)""!=r.currentSelfActivity&&r.currentSelfActivity.mktActivityId&&""!=r.currentSelfActivity.mktActivityId&&(r.selfActivityId=r.currentSelfActivity.mktActivityId),e.push(r);else{var n={id:"",skuId:r.skuId,storeOuCode:r.storeOuCode,number:r.number,activityId:r.activityId,checked:r.checked,isGift:r.isGift};""!=r.currentSelfActivity&&r.currentSelfActivity.mktActivityId&&""!=r.currentSelfActivity.mktActivityId&&(n.selfActivityId=r.currentSelfActivity.mktActivityId),a.push(n)}}for(var c=t.noActivityCart,l=0;l<c.length;l++){var u=c[l];if(u.number>u.stockNumber)""!=u.currentSelfActivity&&u.currentSelfActivity.mktActivityId&&""!=u.currentSelfActivity.mktActivityId&&(u.selfActivityId=u.currentSelfActivity.mktActivityId),e.push(u);else{var d={id:"",skuId:u.skuId,storeOuCode:u.storeOuCode,number:u.number,activityId:u.activityId,checked:u.checked,isGift:u.isGift};""!=u.currentSelfActivity&&u.currentSelfActivity.mktActivityId&&""!=u.currentSelfActivity.mktActivityId&&(d.selfActivityId=u.currentSelfActivity.mktActivityId),a.push(d)}}return{noStockArr:e,canBuyArr:a}},showFreightDetail:function(){for(var t=[],e=0;e<this.occurData.store.length;e++){var a=this.occurData.store[e],i={};i.storeName=a.storeName,i.freightAmount=a.freightAmount,i.freightDiscountAmount=a.freightDiscountAmount,i.proImgs=this.getImgArrs(a),t.push(i)}o.a.open({initData:{listData:t},sureEvent:function(){o.a.close()}})},pickerConfirm:function(t){var e="星期"+"天一二三四五六 ".charAt(new Date(t).getDay()),a=this.$util.getMyDate(t);return console.log(t),a+" 【"+e+"】"},openPicker:function(){this.$refs.dateDom.open()},showProsDetailEvent:function(t){this.currentStore=t,this.showProsDetail=!0},getPeisongString:function(t){return"0"==t?"快递配送":"1"==t?"京东配送":"第三方配送"},toSelectZitiAddress:function(){console.log(this.paramsData);for(var t=this.paramsData.carts,e=[],a=0;a<t.length;a++)e.push(t[a].skuId);this.$router.push({path:"/mall2/mypickupaddress",query:{skuIds:JSON.stringify(e)}})},toSelectAddress:function(){this.$router.push({path:"/mall2/addresslist",query:{type:"citydelivery"}})},useInvoiceEvent:function(){var t=this;if(this.useInvoice=!this.useInvoice,this.useInvoice&&null==this.invoiceData){this.$Loading.open();var e={token:this.$store.state.login.token};this.$http.post("/app/json/order_invoice/loadTwoTypeDefaultUserInvoiceHead",e).then((function(e){t.$Loading.close();var a=e.data;0==a.status?(t.invoiceData=a.data,"personal"==t.invoiceData.current?(t.currentInvoice=t.invoiceData.personal,t.currentInvoice.name=t.invoiceData.personal.title,t.invoiceInfo=t.invoiceData.personal.title,t.currentInvoice.type=0):(t.currentInvoice.type=1,t.currentInvoice=t.invoiceData.company,t.currentInvoice.invoiceTitle=t.invoiceData.company.title,t.invoiceInfo=t.invoiceData.company.title),t.invoiceData.phone=t.$store.state.login.phone,t.invoiceData.email=t.$store.state.userInfo.email,t.invoiceData.name=t.$store.state.userInfo.nickName):t.$Toast(a.info)}),(function(e){t.$Loading.close(),t.$Toast("请求数据失败！")}))}},changeInvoice:function(){var t=this;s.a.open({initData:d({},this.invoiceData,{token:this.$store.state.login.token}),selectedInvoice:function(e){console.log(e),t.currentInvoice=e,0==e.type?(t.invoiceInfo="个人",t.invoiceData.personal.title=e.name,t.invoiceData.personal.userPhone=e.phone,t.invoiceData.personal.userEmail=e.email):(t.invoiceInfo=e.company,t.invoiceData.company.userPhone=e.phone,t.invoiceData.company.userEmail=e.email,t.invoiceData.company.orgTaxNo=e.identifyNumber,t.invoiceData.company.title=e.company),s.a.close()},invoiceInformation:function(){t.showAgreement=!0}})},reloadSelectedCoupon:function(){if(0!=this.backReloadCoupon){this.backReloadCoupon=!1;var t=this.occurData.couNo;if(this.usedCoupons=[],t.length>0)for(var e=0;e<t.length;e++)this.usedCoupons.push({couNo:t[e]});for(var a=0;a<this.occurData.userCanUseCoupon.length;a++){var s=this.occurData.userCanUseCoupon[a].couNo;this.occurData.userCanUseCoupon[a].selected=!1;for(var o=0;o<this.usedCoupons.length;o++)if(this.usedCoupons[o].couNo==s){this.occurData.userCanUseCoupon[a].selected=!0;break}}i.a.reloadSelectedCoupon(this.occurData.userCanUseCoupon)}},couponEvent:function(){for(var t=this,e=0;e<this.occurData.userCanUseCoupon.length;e++){var a=this.occurData.userCanUseCoupon[e].couNo;this.occurData.userCanUseCoupon[e].selected=!1;for(var s=0;s<this.usedCoupons.length;s++)if(this.usedCoupons[s].couNo==a){this.occurData.userCanUseCoupon[e].selected=!0;break}}i.a.open({initData:{listData:[],userCanNotUseCoupon:this.occurData.userCanNotUseCoupon,userCanUseCoupon:this.occurData.userCanUseCoupon,type:"use",skuId:"",categoryId:"",storeOuCode:"",token:this.$store.state.login.token,payAmount:this.$util.toDecimal2(parseFloat(this.occurData.payAmount)+parseFloat(this.occurData.couponAmount))},selectedCoupon:function(e){t.usedCoupons=e,t.backReloadCoupon=!0,t._reSettleCart(null)}})},useDigitalEvent:function(t){if(t.userCanUseDigital<=0){var e=this.getCanNotUseStr(t.deductionState);this.$Toast(e+"，不支持"+this.getDigitalDisplayName(t.acctType)+"支付！")}else{var a=t.acctType;if(t.payDigital<=t.fixedDigital){for(var i=[],s=0;s<this.payDigitals.length;s++)this.payDigitals[s].acctType!=a&&i.push(this.payDigitals[s]);this.payDigitals=i,this.payDigitals.push({acctType:a,payDigital:t.userCanUseDigital+t.fixedDigital})}else{for(var o=[],r=0;r<this.payDigitals.length;r++)this.payDigitals[r].acctType!=a?o.push(this.payDigitals[r]):o.push({acctType:a,payDigital:0});this.payDigitals=o}this._reSettleCart(null)}},usePointsEvent:function(){0!=this.occurData.userCanUsePoints?(this.usePoints=!this.usePoints,this._reSettleCart(null)):this.$Toast("您没有当前订单可用积分！")},payWayShow:function(){this.payWayPopShow=!0},payWayEvent:function(t){0!=t.tag?(this.payWaySelected=t.tag,this.payWayText=t.text):this.$Toast("暂不支持！")},popSureEvent:function(){this.payWayPopShow=!1},popClose:function(){this.payWayPopShow=!1},_reSettleCart:function(t,e){var a=this;this.$Loading.open();var i=this.paramsData;if(i.couNo=[],t)i.carts=t;else if(this.usedCoupons.length>0)for(var s=0;s<this.usedCoupons.length;s++)i.couNo.push(this.usedCoupons[s].couNo);else i.couNo.push("-1");i.limitWalletCardNo=e,2==this.deliveryType?""!=this.$store.state.mall2.selectAddress.id&&(i.userAddressId=this.$store.state.mall2.selectAddress.id):i.pickupId=this.$store.state.mall2.zitiAddress.id;for(var o=[],r=0;r<this.payDigitals.length;r++){var n=this.payDigitals[r];"LimitWallet"!=n.acctType&&o.push(n)}i.payDigital=o,this.$http.post("/app/json/app_cart/SettleCart",i).then((function(t){a.$Loading.close();var e=t.data;a.complete=!0,0==e.status?(a.hasShengxian=!1,a.lastRes=e.data,a.paramsData=i,a.initData(),"true"==a.limitType&&a.getCardList(),a.$mallCommon.isExistCanNotAttendActivity(e.data.occur,!0)):(a.$Toast(e.info),a.reloadSelectedCoupon())}),(function(t){a.$Loading.close(),a.$Toast("请求数据失败！"),a.reloadSelectedCoupon()}))},checkProductStock:function(){var t=this;if(1==this.deliveryType){if(null==this.$store.state.mall2.pickUpUser||""==this.$store.state.mall2.pickUpUser)return void this.$Toast("请完善自提人信息");if(""==this.pickupPhone)return void this.$Toast("请完善自提人信息");this.$bridgefunc.vuexStorage()}if(this.$store.state.mall2.selectAddress.id>0||2!=this.deliveryType||"1"==this.occurData.needVirtualUserPhone){for(var e=0;e<this.payDigitals.length;e++){var a=this.payDigitals[e];if(a.payDigital>0&&a.payDigital>a.userBalanceDigital){var i="可用";return i+=this.getDigitalDisplayName(a.acctType),i+="余额不足！",void this.$Toast(i)}}for(var s=[],o=[],n=!1,c=0;c<this.occurData.store.length;c++){var l=this.occurData.store[c],u={};u.storeName=l.storeName;var d=this.getNoStockImgArrs(l);o=o.concat(d.canBuyArr),u.noStockArr=d.noStockArr,d.noStockArr.length>0&&(n=!0),s.push(u)}0!=o.length?this.cardBalance.balance-this.number<=0?this.$Toast("当前区域商品库存不足！"):n?r.a.open({initData:{listData:s},cancelEvent:function(){r.a.close()},submitEvent:function(){r.a.close(),t._reSettleCart(o)}}):this.checkNeedPwd(o):this.$Toast("当前区域商品库存不足！")}else this.$Toast("请维护并选择收货地址！")},checkNeedPwd:function(t){var e=this;if(this.digitalPWD="",this.occurData.needPayPwd){if("1"==this.occurData.payPwdState)return void this.$Toast("支付密码已锁定，请稍后再试！");n.a.open({initData:{payPwdState:this.occurData.payPwdState},toSettingPwd:function(){e.$router.push({path:"/usercenter/nosetpwd",query:{isSet:0}}),n.a.close()},inputFinished:function(a){e.digitalPWD=a,e._submitOrder(t),n.a.close()}})}else this._submitOrder(t)},_submitOrder:function(t){var e=this,a=this.$util.deepClone(this.paramsData);if(1==this.deliveryType){a.pickupReceiver=this.$store.state.mall2.pickUpUser,a.pickupMobile=this.pickupPhone;var i=this.$util.getMyDate(this.pickupTime);a.selectReceiveTime=i}if(a.orderScene=this.$util.orderScene(),a.carts=t,a.couNo=[],this.usedCoupons.length>0)for(var s=0;s<this.usedCoupons.length;s++)a.couNo.push(this.usedCoupons[s].couNo);a.remark=[];for(var o=0;o<this.occurData.store.length;o++){var r=this.occurData.store[o],n={storeOuCode:r.storeOuCode,remark:r.remark};a.remark.push(n)}if("1"==this.occurData.needVirtualUserPhone&&(a.virtualUserPhone=this.$store.state.login.phone),a.userAddress=this.$store.state.mall2.selectAddress,a.userAddressId=this.$store.state.mall2.selectAddress.id,a.token=this.$store.state.login.token,a.payDigital=this.payDigitals,""!=this.digitalPWD&&(a.payPwd=Object(u.a)(this.digitalPWD)),this.referrer&&this.referrer.length&&(a.rfrCode=this.referrer,this.referrer==this.scanCode?a.rfrCodeType=2:a.rfrCodeType=1),a.userInvoice={},null!=this.currentInvoice&&1==this.useInvoice&&(a.userInvoice.invoiceUse="1",a.userInvoice.invoiceType="1",0==this.currentInvoice.type?(a.userInvoice.invoiceTitleType="4",a.userInvoice.invoiceTitle="个人"):(a.userInvoice.invoiceTitleType="5",a.userInvoice.invoiceTitle=this.currentInvoice.company),a.userInvoice.invoiceUserName=this.currentInvoice.name,a.userInvoice.invoiceUserEmail=this.currentInvoice.email,a.userInvoice.invoiceUserMobile=this.currentInvoice.phone,a.userInvoice.invoiceUserOrgTaxNo=this.currentInvoice.identifyNumber,a.userInvoice.invoiceDetailType=this.currentInvoice.selectedGoodsType),"wish"==this.$route.query.entryType){if(!this.wishData.payMsg||!this.wishData.payNiceName)return!1;a.payUserNickName=this.wishData.payNiceName,a.payUserMsg=this.wishData.payMsg,a.userAddressId=this.paramsData.userAddressId,a.provinceId=this.paramsData.provinceId,a.cityId=this.paramsData.cityId,a.countryId=this.paramsData.countryId,delete a.payDigital,delete a.userAddress}this.$Loading.open(),this.$http.post("/app/json/app_shopping_order/submit",a).then((function(t){e.$Loading.close();var a=t.data;0==a.status?(sessionStorage.removeItem("TCPS_Carts"),0==e.getTotalPrice()?e.$router.replace({path:"/mall2/paysuccess",query:{selectedIndex:1,orderCategory:e.paramsData.orderCategory,vipUnitUserCode:e.paramsData.vipUnitUserCode}}):e.$router.replace({path:"/mall2/checkstand",query:{payInfo:JSON.stringify(a.data),occurOuCode:e.occurData.ouCode,orderCategory:e.paramsData.orderCategory,vipUnitUserCode:e.paramsData.vipUnitUserCode}})):e.$Toast(a.info)}),(function(t){e.$Loading.close(),e.$Toast("请求数据失败！")}))},returnStoreProducts:function(t){for(var e=t.noActivityCart.length,a=0,i=[],s=0;s<t.noActivityCart.length;s++)i.push(t.noActivityCart[s].phPictureUrl),a+=t.noActivityCart[s].number,6==t.noActivityCart[s].productType&&(this.hasShengxian=!0);for(var o=0;o<t.activity.length;o++){e+=t.activity[o].cart.length;for(var r=0;r<t.activity[o].cart.length;r++)i.push(t.activity[o].cart[r].phPictureUrl),a+=t.activity[o].cart[r].number,6==t.activity[o].cart[r].productType&&(this.hasShengxian=!0)}var n={num:e,proNum:a,proImgArr:i};t.storeProData=n,console.log(1234,t)},initData:function(){if(2==this.$store.state.webtype){var t=sessionStorage.getItem("recommendPhone");t&&t.length&&(this.referrer=t,this.canEditReferrer=!1)}this.pointsGain=this.lastRes.pointsGain,this.occurData=this.lastRes.occur[0];var e=this.occurData.couNo;if(this.usedCoupons=[],e.length>0)for(var a=0;a<e.length;a++)this.usedCoupons.push({couNo:e[a]});this.payDigitals=[];for(var i=0;i<this.occurData.digitalList.length;i++){var s=this.occurData.digitalList[i];"LimitWallet"==s.acctType&&(this.cardAmount=s.userBalanceDigital,this.userCanUseDigital=s.userCanUseDigital),s.payDigital>s.fixedDigital?this.payDigitals.push({acctType:s.acctType,userBalanceDigital:s.userBalanceDigital,payDigital:s.userCanUseDigital+s.fixedDigital}):this.payDigitals.push({acctType:s.acctType,userBalanceDigital:s.userBalanceDigital,payDigital:s.fixedDigital})}this.reloadSelectedCoupon()},noMath:function(){var t=this;this.$route.params.noMatch&&this.$route.params.noMatch&&this.$MessageBox.confirm("没有相关区域的收货地址，是否要添加？","提示",{confirmButtonText:"确定"}).then((function(e){t.$router.push({path:"/mall2/addaddress",query:{type:1,isSave:!0,direct:"direct"}})})).catch((function(t){}))},getWishMsg:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$http.post("/app/json/wish_order/getRandomWishOrderConfig",{type:2,isDefault:e}).then((function(e){var a=e.data;0==a.status?t.wishData=a.data:t.$Toast(a.info)})).catch((function(e){t.$Toast(e)}))}},activated:function(){this.isFirst?this.isFirst=!1:this._reSettleCart(null)},beforeRouteLeave:function(t,e,a){"/mall2/addresslist"==t.path||"/mall2/mypickupaddress"==t.path||"/mall2/addaddress"==t.path||"/usercenter/agreement"==t.path||"/usercenter/nosetpwd"==t.path||this.$keepaliveHelper.deleteCache(this),a()}},h=(a("jfzV"),a("KHd+")),p=Object(h.a)(v,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"placeorder mall2"},[i("nav-top",{attrs:{title:"同城配送"},on:{backEvent:function(e){return t.$router.go(-1)}}}),t._v(" "),t.complete?i("nav-content",[i("div",{staticClass:"flex-div"},[i("div",{staticClass:"scroll-div"},[2==t.deliveryType&&1==t.occurData.needAddress||1==t.deliveryType?i("div",{staticClass:"block-div no-padding-bottom"},[t.$store.state.mall2.selectAddress.id>0&&2==t.deliveryType?i("div",{on:{click:t.toSelectAddress}},[i("div",{staticClass:"flex-row"},[i("div",{staticClass:"name theme_font_black"},[t._v(t._s(t.$store.state.mall2.selectAddress.receiverName))]),t._v(" "),i("div",{staticClass:"name theme_font_black"},[t._v(t._s(t.$store.state.mall2.selectAddress.mobile))]),t._v(" "),1==t.$store.state.mall2.selectAddress.isDefault?i("div",{staticClass:"act-item-full theme_standard_bg theme_font_white"},[t._v("默认\n              ")]):t._e()]),t._v(" "),i("div",{staticClass:"flex-row"},[i("div",{staticClass:"full theme_font_tint font-small"},[t._v(t._s(t.$store.state.mall2.selectAddress.addressFull)+"\n              ")]),t._v(" "),i("div",[i("i",{staticClass:"iconfont mall-gengduojiantou theme_font_tint icon-font"})])])]):t._e(),t._v(" "),t.$store.state.mall2.selectAddress.id>0||2!=t.deliveryType?t._e():i("div",{on:{click:t.toSelectAddress}},[i("div",{staticClass:"flex-row"},[t._v("请选择地址信息")])]),t._v(" "),t.$store.state.mall2.zitiAddress.id>0&&1==t.deliveryType?i("div",{on:{click:t.toSelectZitiAddress}},[i("div",{staticClass:"pickup-shop"},[i("div",{staticStyle:{flex:"1"}},[i("div",{staticClass:"flex-row"},[i("div",{staticClass:"name theme_font_black"},[t._v("自提店铺："+t._s(t.$store.state.mall2.zitiAddress.storeName)+"\n                  ")])]),t._v(" "),i("div",{staticClass:"flex-row"},[i("div",{staticClass:"full theme_font_tint font-small",staticStyle:{"line-height":"1.4"}},[t._v("\n                    "+t._s(t.$store.state.mall2.zitiAddress.addressFull)+" "+t._s(t.$store.state.mall2.zitiAddress.phone&&""!=t.$store.state.mall2.zitiAddress.phone?"("+t.$store.state.mall2.zitiAddress.phone+")":"")+"\n                  ")])])]),t._v(" "),i("div",[i("i",{staticClass:"iconfont mall-gengduojiantou theme_font_tint icon-font"})])])]):t._e(),t._v(" "),i("div",{staticClass:"colorfulline"},[i("img",{attrs:{src:"static/image/mall2/colorfulline.png"}})])]):t._e(),t._v(" "),"wish"==t.$route.query.entryType?i("div",{staticClass:"block-div wish-message-container"},[i("div",{staticClass:"top"},[i("p",{staticClass:"title"},[t._v("对TA说的话")]),t._v(" "),i("span",{staticClass:"random-btn",on:{click:function(e){return t.getWishMsg()}}},[t._v("随机换一句")])]),t._v(" "),i("div",{staticClass:"msg-input-c"},[i("van-field",{staticClass:"msg-input",attrs:{type:"textarea",placeholder:"请输入想说的话"},model:{value:t.wishData.payMsg,callback:function(e){t.$set(t.wishData,"payMsg",e)},expression:"wishData.payMsg"}})],1),t._v(" "),i("div",{staticClass:"nick-container"},[i("p",{staticClass:"nick-title"},[t._v("留言昵称")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.wishData.payNiceName,expression:"wishData.payNiceName"}],staticClass:"name",attrs:{type:"text",placeholder:"请输入昵称"},domProps:{value:t.wishData.payNiceName},on:{input:function(e){e.target.composing||t.$set(t.wishData,"payNiceName",e.target.value)}}})])]):t._e(),t._v(" "),"1"==t.occurData.needVirtualUserPhone?i("div",{staticClass:"block-div"},[i("div",{staticClass:"flex-row"},[i("div",{staticClass:"right-margin theme_font_common"},[t._v("接收短信的手机号")]),t._v(" "),i("div",{staticClass:"theme_font_common"},[t._v(t._s(t.$store.state.login.phone))])]),t._v(" "),i("div",{staticClass:"flex-row theme_font_tint"},[i("div",{staticClass:"font-small"},[t._v("购买成功后相关短信会自动发送到您手机上")])])]):t._e(),t._v(" "),i("div",{staticClass:"block-div"},[i("div",{staticClass:"flex-row",on:{click:t.payWayShow}},[i("div",{staticClass:"label-middle theme_font_common"},[t._v("支付方式")]),t._v(" "),i("div",{staticClass:"full"}),t._v(" "),i("div",{staticClass:"theme_font_common right-margin"},[t._v(t._s(t.payWayText))]),t._v(" "),i("div",[i("i",{staticClass:"iconfont mall-gengduo more-icon theme_font_tint"})])])]),t._v(" "),t._l(t.occurData.store,(function(e){return i("div",{staticClass:"block-div"},[t._v("\n          "+t._s(t.returnStoreProducts(e))+"\n          "),i("div",{staticClass:"flex-row"},[i("div",{staticClass:"name"},[t._v(t._s(e.storeName))])]),t._v(" "),1==e.storeProData.num?i("div",[t._l(e.activity,(function(e){return i("div",{},t._l(e.cart,(function(e){return i("div",{staticClass:"pro-row"},[i("div",{staticClass:"img-div"},[i("img",{attrs:{src:e.phPictureUrl}})]),t._v(" "),i("div",{staticClass:"info-div"},[i("div",{staticClass:"title theme_font_black"},[t._v(t._s(e.productName))]),t._v(" "),i("div",{staticClass:"title theme_font_black"},[i("span",[t._v(t._s(e.specs))])]),t._v(" "),i("div",{staticClass:"price"},[i("PriceOrder",{attrs:{productData:e}}),t._v(" "),"wish"==t.$route.query.entryType?i("van-stepper",{staticClass:"wish-prod-stepper",attrs:{max:t.$route.params.wishProdInfo.saleNumMax,min:t.$route.params.wishProdInfo.saleNumBegin,step:t.$route.params.wishProdInfo.saleNumStep,integer:""},model:{value:e.number,callback:function(a){t.$set(e,"number",a)},expression:"prodata.number"}}):i("span",{staticStyle:{float:"right"}},[t._v("x "+t._s(e.number))])],1)])])})),0)})),t._v(" "),e.noActivityCart.length>0?i("div",{},t._l(e.noActivityCart,(function(e){return i("div",{staticClass:"pro-row"},[i("div",{staticClass:"img-div"},[i("img",{attrs:{src:e.phPictureUrl}})]),t._v(" "),i("div",{staticClass:"info-div"},[i("div",{staticClass:"title theme_font_black"},[t._v(t._s(e.productName))]),t._v(" "),i("div",{staticClass:"title theme_font_black"},[i("span",[t._v(t._s(e.specs))])]),t._v(" "),i("div",{staticClass:"price"},[i("PriceOrder",{attrs:{productData:e}}),t._v(" "),"wish"==t.$route.query.entryType?i("van-stepper",{staticClass:"wish-prod-stepper",attrs:{max:t.$route.params.wishProdInfo.saleNumMax,min:t.$route.params.wishProdInfo.saleNumBegin,step:t.$route.params.wishProdInfo.saleNumStep,integer:""},model:{value:e.number,callback:function(a){t.$set(e,"number",a)},expression:"prodata.number"}}):i("span",{staticStyle:{float:"right"}},[t._v("x "+t._s(e.number))])],1)])])})),0):t._e()],2):t._e(),t._v(" "),e.storeProData.num>1?i("div",{on:{click:function(a){return t.showProsDetailEvent(e)}}},[i("div",{staticClass:"pros-row"},[i("div",{staticClass:"pros-msg"},[i("span",[t._v("共"+t._s(e.storeProData.proNum)+"件")]),t._v(" "),i("i",{staticClass:"iconfont mall-gengduo more-icon theme_font_tint"})]),t._v(" "),t._l(e.storeProData.proImgArr,(function(e,a){return a<3?i("div",{staticClass:"img-div"},[i("img",{attrs:{src:e}})]):t._e()}))],2)]):t._e(),t._v(" "),i("div",{staticClass:"flex-row"},[i("div",{staticClass:"label-middle theme_font_common"},[t._v("备注")]),t._v(" "),i("div",{staticClass:"full"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.remark,expression:"store.remark"}],staticClass:"row-input theme_font_common",attrs:{placeholder:"请留下您想说的话"},domProps:{value:e.remark},on:{input:function(a){a.target.composing||t.$set(e,"remark",a.target.value)}}})])])])})),t._v(" "),(!t.cardType||t.cardType&&551==t.cardType)&&"false"!=t.$store.state.globalConfig.invoice_shopping_enable&&1!=t.paramsData.orderCategory?i("div",{staticClass:"block-div"},[i("div",{staticClass:"flex-row"},[i("div",{staticClass:"title full theme_font_common"},[t._v("发票")]),t._v(" "),i("div",{staticClass:"swith",on:{click:t.useInvoiceEvent}},[t.useInvoice?i("img",{attrs:{src:"static/image/mall2/switch-on.png"}}):t._e(),t._v(" "),t.useInvoice?t._e():i("img",{attrs:{src:"static/image/mall2/switch-off.png"}})])]),t._v(" "),t.useInvoice?i("div",{staticClass:"flex-row",on:{click:t.changeInvoice}},[i("div",{staticClass:"label-middle theme_font_common"},[t._v("发票信息")]),t._v(" "),i("div",{staticClass:"full"}),t._v(" "),i("div",{staticClass:"theme_font_black right-margin",class:{theme_font_tint:""==t.invoiceInfo}},[t._v("\n              "+t._s(""!=t.invoiceInfo?t.invoiceInfo:"请编辑发票信息")+"\n            ")]),t._v(" "),i("div",[i("i",{staticClass:"iconfont mall-gengduo more-icon theme_font_tint"})])]):t._e()]):t._e(),t._v(" "),(!t.cardType||t.cardType&&551==t.cardType)&&1!=t.paramsData.orderCategory&&"wish"!==t.$route.query.entryType?i("div",{staticClass:"block-div"},[i("div",{staticClass:"flex-row",on:{click:t.couponEvent}},[i("div",{staticClass:"label-middle theme_font_common"},[t._v("优惠券")]),t._v(" "),i("div",{staticClass:"full"}),t._v(" "),t.lastRes.occur?i("div",{staticClass:"theme_font_black right-margin"},[t._v("优惠"+t._s(t.$util.toDecimal2(t.lastRes.occur[0].couponAmount))+"元\n            ")]):t._e(),t._v(" "),i("div",[i("i",{staticClass:"iconfont mall-gengduo more-icon theme_font_tint"})])]),t._v(" "),t._l(t.occurData.digitalList,(function(e){return"LimitWallet"!=e.acctType?i("div",[0!=e.deductionState?i("div",{staticClass:"flex-row"},[i("div",{staticClass:"label-middle theme_font_common"},[t._v(t._s(t.getDigitalDisplayName(e.acctType)))]),t._v(" "),i("div",{staticClass:"full"}),t._v(" "),e.userCanUseDigital>0?i("div",{staticClass:"right-margin"},[t._v("\n                共"+t._s(e.userBalanceDigital)+"，可用"+t._s(e.userCanUseDigital)+"，抵￥"+t._s(t.$util.toDecimal2(e.userCanUseDigitalAmount))+"元\n              ")]):t._e(),t._v(" "),e.userCanUseDigital<=0?i("div",{staticClass:"right-margin"},[t._v("共"+t._s(e.userBalanceDigital)+"，"+t._s(t.getCanNotUseStr(e.deductionState))+"，不能使用\n              ")]):t._e(),t._v(" "),i("div",{staticClass:"swith",on:{click:function(a){return t.useDigitalEvent(e)}}},[e.payDigital>e.fixedDigital?i("img",{attrs:{src:"static/image/mall2/switch-on.png"}}):t._e(),t._v(" "),e.payDigital<=e.fixedDigital?i("img",{attrs:{src:"static/image/mall2/switch-off.png"}}):t._e()])]):t._e()]):t._e()}))],2):t._e(),t._v(" "),0!=t.cardList.length&&1!=t.paramsData.orderCategory&&"true"==t.limitType?i("div",{staticClass:"block-div"},[i("div",{staticClass:"flex-row",on:{click:function(e){t.showYJChange=!0}}},[i("div",{staticClass:"label-middle theme_font_common"},[t._v("易捷卡")]),t._v(" "),"a"!=t.radio?i("div",{staticClass:"full theme_font_black right-margin",staticStyle:{"text-align":"right"}},[t.$route.params.cardName?i("p",[t._v(t._s(t.cardDetails.cardName?t.cardDetails.cardName:t.$route.params.cardName))]):i("p",[t._v("选择可用易捷卡")]),t._v(" "),t.$route.params.cardName?i("p",{staticClass:"theme_font_tint font-small",staticStyle:{"padding-top":"3px"}},[t._v("\n                余额"+t._s(t.$util.toDecimal2(t.cardAmount))+"元，抵扣"+t._s(t.$util.toDecimal2(t.userCanUseDigital))+"元")]):t._e()]):i("div",{staticClass:"full theme_font_black right-margin",staticStyle:{"text-align":"right"}},[t._v("\n              不使用易捷卡\n            ")]),t._v(" "),i("div",[i("i",{staticClass:"iconfont mall-gengduo more-icon theme_font_tint"})])])]):t._e(),t._v(" "),"552"==t.cardType&&1!=t.paramsData.orderCategory&&"true"==t.limitType?i("div",{staticClass:"block-div"},[i("div",{staticClass:"table-view yj-card"},[i("div",{staticClass:"table-view-cell"},[i("div",{staticClass:"table-view-cell-text"},[i("div",{staticClass:"left"},[t._v("易捷卡")]),t._v(" "),i("div",{staticClass:"right"},[t._v(t._s(t.$route.params.cardName))])])])])]):t._e(),t._v(" "),i("div",{staticClass:"block-div"},[i("div",{staticClass:"flex-row"},[i("div",{staticClass:"label-middle full theme_font_common"},[t._v("商品金额")]),t._v(" "),i("div",{staticClass:"theme_font_black"},[t._v("￥"+t._s(t.$util.toDecimal2(t.occurData.amount)))])]),t._v(" "),i("div",{staticClass:"flex-row"},[i("div",{staticClass:"label-middle full theme_font_common"},[t._v("立减")]),t._v(" "),i("div",{staticClass:"theme_font_red"},[t._v("-￥"+t._s(t.$util.toDecimal2(t.occurData.discountAmount)))])]),t._v(" "),i("div",{staticClass:"flex-row",on:{click:t.showFreightDetail}},[i("div",{staticClass:"label-middle full theme_font_common"},[t._v("\n              运费\n              "),i("i",{staticClass:"iconfont mall-info theme_font_gray",staticStyle:{"margin-left":"3px"}})]),t._v(" "),i("div",{staticClass:"theme_font_red"},[t._v("\n              +￥"+t._s(t.$util.toDecimal2(parseFloat(t.occurData.freightAmount)-parseFloat(t.occurData.freightDiscountAmount)))+"\n            ")])]),t._v(" "),1!=t.paramsData.orderCategory&&"wish"!=t.$route.query.entryType?i("div",{staticClass:"flex-row"},[i("div",{staticClass:"label-middle full theme_font_common"},[t._v("优惠券")]),t._v(" "),i("div",{staticClass:"theme_font_red"},[t._v("-￥"+t._s(t.$util.toDecimal2(t.occurData.couponAmount)))])]):t._e(),t._v(" "),"true"==t.limitType&&0!=t.cardList.length&&(t.cardDetails.cardName||t.$route.params.cardName)&&"a"!=t.radio?i("div",{staticClass:"flex-row"},[i("div",{staticClass:"label-middle full theme_font_common"},[t._v(t._s(t.cardDetails.cardName?t.cardDetails.cardName:t.$route.params.cardName)+"\n            ")]),t._v(" "),i("div",{staticClass:"theme_font_red"},[t._v("-￥"+t._s(t.$util.toDecimal2(t.userCanUseDigital)))])]):t._e(),t._v(" "),"true"==t.limitType&&"552"==t.cardType&&"a"!=t.radio?i("div",{staticClass:"flex-row"},[i("div",{staticClass:"label-middle full theme_font_common"},[t._v(t._s(t.$route.params.cardName))]),t._v(" "),i("div",{staticClass:"theme_font_red"},[t._v("-￥"+t._s(t.$util.toDecimal2(t.occurData.couponAmount)))])]):t._e(),t._v(" "),t._l(t.occurData.digitalList,(function(e){return e.payDigital>e.fixedDigital&&"LimitWallet"!=e.acctType?i("div",{staticClass:"flex-row"},[i("div",{staticClass:"label-middle full theme_font_common"},[t._v(t._s(t.getDigitalDisplayName(e.acctType)))]),t._v(" "),i("div",{staticClass:"theme_font_red"},[t._v("-￥"+t._s(t.$util.toDecimal2(e.userCanUseDigitalAmount)))])]):t._e()}))],2),t._v(" "),t.recommendDisabled&&(!t.cardType||t.cardType&&551==t.cardType)?i("div",{staticClass:"block-div"},[i("div",{staticClass:"flex-row"},[i("div",{staticClass:"passwords-input"},[i("div",{staticClass:"label-middle full theme_font_common"},[t._v("推荐人")]),t._v(" "),i("div",{staticClass:"passwords"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.referrer,expression:"referrer"}],attrs:{placeholder:"请输入推荐码",disabled:!t.canEditReferrer},domProps:{value:t.referrer},on:{input:function(e){e.target.composing||(t.referrer=e.target.value)}}})]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.canEditReferrer,expression:"canEditReferrer"}],staticClass:"show-passwords",on:{click:t.scanCodeFunc}},[i("img",{staticClass:"scancode",attrs:{src:"static/image/setting/icon-scan.png"}})])])])]):t._e()],2),t._v(" "),i("div",{staticClass:"bottom-btns"},[2==t.deliveryType&&1==t.occurData.needAddress?i("div",{staticClass:"tip theme_bg_yl theme_standard_font theme_light_bg"},[t._v(t._s(t.$store.state.mall2.selectAddress.addressFull)+"\n        ")]):t._e(),t._v(" "),i("div",{staticClass:"btn theme_standard_bg theme_font_white",on:{click:t.checkProductStock}},[t._v("提交订单")]),t._v(" "),i("div",{staticClass:"price"},[Object.keys(t.occurData).length?i("div",{staticClass:"rmb-div"},[i("span",{directives:[{name:"show",rawName:"v-show",value:t.$mallCommon.getOccurShowPrice(t.occurData),expression:"$mallCommon.getOccurShowPrice(occurData)"}],staticClass:"theme_font_red"},[t._v("￥")]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.$mallCommon.getOccurShowPrice(t.occurData),expression:"$mallCommon.getOccurShowPrice(occurData)"}],staticClass:"left-no-space price-big theme_font_red"},[t._v(t._s(t.getTotalPriceDuan(0)))]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.$mallCommon.getOccurShowPrice(t.occurData),expression:"$mallCommon.getOccurShowPrice(occurData)"}],staticClass:"theme_font_red"},[t._v("."+t._s(t.getTotalPriceDuan(1)))]),t._v(" "),t._l(t.occurData.digitalList,(function(e,a){return t.$mallCommon.getTotalUsePoints(e)>0?i("div",{staticClass:"digital-div"},[a!=t.$mallCommon.getFirstVartualIndex(t.occurData)||t.$mallCommon.getOccurShowPrice(t.occurData)?i("span",{staticClass:"price-big theme_font_red"},[t._v("+")]):t._e(),t._v(" "),i("span",{staticClass:"price-big theme_font_red"},[t._v(t._s(t.$mallCommon.getTotalUsePoints(e)))]),t._v(" "),i("span",{staticClass:"theme_font_red"},[t._v(t._s(t.$mallCommon.getTotalUnitStr(e.acctType)))])]):t._e()}))],2):t._e()])]),t._v(" "),i("van-popup",{staticClass:"pay-modal",attrs:{position:"bottom"},model:{value:t.showYJChange,callback:function(e){t.showYJChange=e},expression:"showYJChange"}},[i("div",{staticClass:"top"},[i("div",{staticClass:"close-img"},[i("div",{staticClass:"text"},[t._v("易捷卡")]),t._v(" "),i("div",{staticClass:"img"},[i("img",{staticClass:"close-btn",attrs:{src:a("+6ky"),alt:""},on:{click:function(e){t.showYJChange=!1}}})])])]),t._v(" "),i("van-radio-group",{model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[i("van-radio",{staticClass:"title-change",attrs:{"checked-color":"#f80f16",name:"a"},on:{click:t.changeYjCard}},[t._v("不使用易捷卡")]),t._v(" "),t._l(t.cardList,(function(e,a){return i("van-radio",{key:a,attrs:{"checked-color":"#f80f16",name:a},on:{click:function(a){return t.changeYjCard(e)}}},[i("div",{staticClass:"item"},[i("img",{staticClass:"pro-img",attrs:{src:e.cardFrontPicUrl,alt:""}}),t._v(" "),i("div",{staticClass:"card-content"},[i("p",{staticClass:"top"},[i("span",{staticClass:"card-name"},[t._v(t._s(e.cardName))]),t._v(" "),i("span",{staticClass:"card-type"},[t._v(t._s(e.cardTypeStr))])]),t._v(" "),i("p",{staticClass:"mid-price"},[i("span",{staticClass:"icon"},[t._v("余额：￥")]),t._v(t._s(e.balance))]),t._v(" "),i("div",{staticClass:"btm-content"},[i("span",{staticClass:"card-number"},[t._v("卡号："+t._s(e.cardNo))])])])])])}))],2),t._v(" "),i("div",{staticClass:"pay-confirm",on:{click:t.queryBtn}},[t._v("确定")])],1)],1)]):t._e(),t._v(" "),t.payWayPopShow?i("pop-view",{on:{closeEvent:t.popClose}},[i("div",{staticClass:"pop-body"},[i("div",{staticClass:"pop-title theme_font_common"},[t._v("请选择支付方式")]),t._v(" "),i("div",{staticClass:"items-div pop-scroll-div"},t._l(t.payWays,(function(e){return i("div",{staticClass:"item theme_font_common theme_bg_white_ef",class:{theme_light_bg:t.payWaySelected==e.tag,theme_standard_font_i:t.payWaySelected==e.tag,theme_standard_bdr_i:t.payWaySelected==e.tag},on:{click:function(a){return t.payWayEvent(e)}}},[t._v(t._s(e.text)+"\n        ")])})),0),t._v(" "),i("div",{staticClass:"bottom-btn theme_font_white theme_standard_bg bottom-space",on:{click:t.popSureEvent}},[t._v("确定\n      ")])])]):t._e(),t._v(" "),t.showProsDetail?i("pop-view",{on:{closeEvent:function(e){t.showProsDetail=!1}}},[i("div",{staticClass:"pop-body"},[i("div",{staticClass:"pop-title theme_font_common"},[t._v("商品明细")]),t._v(" "),i("div",{staticClass:"pop-scroll-div"},[t._l(t.currentStore.activity,(function(e){return i("div",{},t._l(e.cart,(function(e){return i("div",{staticClass:"pro-row"},[i("div",{staticClass:"img-div"},[i("img",{attrs:{src:e.phPictureUrl}})]),t._v(" "),i("div",{staticClass:"info-div"},[i("div",{staticClass:"title-min theme_font_black"},[t._v(t._s(e.productName))]),t._v(" "),i("div",{staticClass:"title-min theme_font_gray"},[i("span",{staticClass:"font-small"},[t._v(t._s(e.specs))])]),t._v(" "),i("div",{staticClass:"price"},[i("PriceOrder",{attrs:{productData:e}}),t._v(" "),i("span",{staticStyle:{float:"right"}},[t._v("x "+t._s(e.number))])],1)])])})),0)})),t._v(" "),t.currentStore.noActivityCart.length>0?i("div",{},t._l(t.currentStore.noActivityCart,(function(e){return i("div",{staticClass:"pro-row"},[i("div",{staticClass:"img-div"},[i("img",{attrs:{src:e.phPictureUrl}})]),t._v(" "),i("div",{staticClass:"info-div"},[i("div",{staticClass:"title-max double-line theme_font_black"},[t._v(t._s(e.productName))]),t._v(" "),i("div",{staticClass:"title-max double-line theme_font_gray"},[i("span",[t._v(t._s(e.specs))])]),t._v(" "),i("div",{staticClass:"price"},[i("PriceOrder",{attrs:{productData:e}}),t._v(" "),i("span",{staticStyle:{float:"right"}},[t._v("x "+t._s(e.number))])],1)])])})),0):t._e()],2)])]):t._e(),t._v(" "),i("mt-datetime-picker",{ref:"dateDom",attrs:{type:"date",startDate:new Date,endDate:t.getEndDate(),"year-format":"{value} 年","month-format":"{value} 月","date-format":"{value} 日"},model:{value:t.pickupTime,callback:function(e){t.pickupTime=e},expression:"pickupTime"}}),t._v(" "),t.showAgreement?i("Agreement",{attrs:{propsValue:9},on:{backEvent:function(e){t.showAgreement=!1}}}):t._e(),t._v(" "),t.showPointsRule?i("Agreement",{attrs:{propsValue:11},on:{backEvent:function(e){t.showPointsRule=!1}}}):t._e()],1)}),[],!1,null,"7fc96b62",null);e.default=p.exports},SKE7:function(t,e,a){},XXIG:function(t,e,a){"use strict";var i=a("XkAZ");a.n(i).a},XkAZ:function(t,e,a){},jfzV:function(t,e,a){"use strict";var i=a("SKE7");a.n(i).a}}]);