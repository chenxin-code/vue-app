(window.webpackJsonp=window.webpackJsonp||[]).push([[823],{"0Bdl":function(t,e,s){"use strict";var i=s("NYHG");s.n(i).a},A7wH:function(t,e,s){"use strict";s.r(e);var i={name:"list",components:{CellSwipe:s("dqDD").CellSwipe},data:function(){return{isEditing:!1,dataList:[],msgType:"",scrollPosition:0,mesView:!1,paramsData:null}},activated:function(){this.$refs.scrollContainer.scrollTop=this.scrollPosition},methods:{formatContent:function(t){return t.slice(0,t.indexOf("[BUTTON"))},selectItem:function(t,e){t.selected=!t.selected,this.dataList.splice(e,1,t)},setIsEditting:function(){this.isEditing=!this.isEditing},_deleteSelectedMsg:function(){for(var t=[],e=0;e<this.dataList.length;e++){var s=this.dataList[e];1==s.selected&&t.push({id:s.id,msgType:this.msgType})}t.length>0&&(this.paramsData={token:this.$store.state.login.token,msgUserModelList:t},this.mesView=!0)},_deleteAllMsg:function(){this.paramsData={token:this.$store.state.login.token,msgUserModelList:[{msgType:this.msgType}]},this.mesView=!0},_deleteMsgView:function(t){this.paramsData={token:this.$store.state.login.token,msgUserModelList:[{id:t.id,msgType:this.msgType}]},this.mesView=!0},_deleteMsg:function(){this._deleteRequest(this.paramsData)},_deleteRequest:function(t){var e=this;this.$Loading.open(),this.$http.post("/app/json/message/delAnyMsg",t).then((function(t){var s=t.data;e.$Loading.close(),0==s.status?(e.isEditing=!1,e.mesView=!1,e.getList()):e.$Toast(s.info)}),(function(t){e.$Loading.close(),e.$Toast("请求数据失败！")}))},toDetail:function(t){this.$router.push({name:"消息详情",params:t})},backEvent:function(){this.$router.go(-1)},getList:function(){var t=this;this.$Loading.open();var e={token:this.$store.state.login.token,msgType:this.msgType};this.$http.post("/app/json/message/getUnreadMsgModel",e).then((function(e){var s=e.data;t.$Loading.close(),0==s.status?t.dataList=s.data.msgModels:t.$Toast(s.info)}),(function(e){t.$Loading.close(),t.$Toast("请求数据失败！")}))}},beforeRouteLeave:function(t,e,s){"/usercenter/msgdetail"!=t.path&&this.$keepaliveHelper.deleteCache(this),s()},created:function(){var t=this;this.msgType=this.$route.query.msgType,this.getList(),this.$nextTick((function(){t.$refs.scrollContainer.addEventListener("scroll",(function(e){t.scrollPosition=t.$refs.scrollContainer.scrollTop}))}))}},n=(s("0Bdl"),s("KHd+")),a=Object(n.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"list"},[s("nav-top",{on:{backEvent:t.backEvent}},[t.dataList.length>0?s("div",{staticClass:"right-btn",staticStyle:{right:"0px",height:"44px",top:"0px","padding-right":"10px","font-size":"12px"},on:{click:t.setIsEditting}},[t._v("\n      "+t._s(t.isEditing?"完成":"编辑")+"\n    ")]):t._e()]),t._v(" "),s("nav-content",[s("div",{ref:"scrollContainer",staticClass:"scroll-div",class:{"show-btns":t.isEditing}},t._l(t.dataList,(function(e,i){return s("div",{key:i,on:{click:function(s){return t.toDetail(e)}}},[s("mt-cell-swipe",{attrs:{right:[{content:"删除",style:{padding:"20px 30px",background:"#F80F16",color:"white",display:"flex",alignItems:"center"},handler:function(){return t._deleteMsgView(e)}}]}},[s("div",{staticStyle:{width:"100%",display:"flex","text-align":"center"},attrs:{slot:"title"},slot:"title"},[t.isEditing?s("div",{staticClass:"left-select",on:{click:function(s){return s.stopPropagation(),t.selectItem(e,i)}}},[1==e.selected?s("i",{staticClass:"iconfont mall-xuanzhong theme_font_red"}):t._e(),t._v(" "),1!=e.selected?s("i",{staticClass:"iconfont mall-weixuanzhong theme_font_tint"}):t._e()]):t._e(),t._v(" "),s("div",{staticClass:"list-item"},[s("div",{staticClass:"line-div"},[s("p",{staticClass:"font-large"},[t._v(t._s(e.sketch))]),t._v(" "),s("p",{staticClass:"font-small theme_font_tint"},[t._v(t._s(e.appSendTime))])]),t._v(" "),s("div",{staticClass:"mrgt"},[s("p",{staticClass:"font-small theme_font_tint single-line"},[t._v(t._s(t.formatContent(e.content)))])])])])])],1)})),0),t._v(" "),t.isEditing?s("div",{staticClass:"bottom-btns"},[s("div",{staticClass:"btn",on:{click:t._deleteSelectedMsg}},[t._v("删除选中")]),t._v(" "),s("div",{staticClass:"btn",on:{click:t._deleteAllMsg}},[t._v("全部删除")])]):t._e()]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.mesView,expression:"mesView"}],staticClass:"card"},[s("van-popup",{staticClass:"popupCard",attrs:{"close-on-click-overlay":!1},model:{value:t.mesView,callback:function(e){t.mesView=e},expression:"mesView"}},[s("div",{staticClass:"popupCardText"},[t._v("\n        是否删除消息？\n      ")]),t._v(" "),s("div",{staticClass:"popupCardBtn"},[s("span",{on:{click:function(e){t.mesView=!1}}},[t._v("取消")]),t._v(" "),s("span",{on:{click:t._deleteMsg}},[t._v("删除")])])])],1)],1)}),[],!1,null,"da33a16c",null);e.default=a.exports},NYHG:function(t,e,s){}}]);