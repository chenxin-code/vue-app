(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8bd1b900"],{"476d":function(t,e,a){"use strict";var n="/app/json/micro_store_front_end/applyMicroStore",o="/app/json/micro_store_front_end/queryMicroStoreOpenState",i="/app/json/micro_store_front_end/queryMicroStoreOpenProcess",r="/app/json/micro_store_front_end/queryMicroStoreForProfit",s="/app/json/micro_store_front_end/getRewardTypeList",c="/app/json/micro_store_front_end/cashEarningsDetail",l="/app/json/micro_store_front_end/getMonthProfitList",u="/app/json/micro_store_front_end/getEmployeeInfoByUserId",p="/app/json/micro_store_front_end/queryMicroStoreForDecoration",f="/app/json/micro_store_front_end/updateMicroStoreInfoById",d="/app/json/micro_store_front_end/saveBankInfo";e["a"]={methods:{applyData:function(t){return this.$http.post(n,t)},stateData:function(t){return this.$http.post(o,t)},stateDatahn:function(t){return this.$http.post(i,t)},profitData:function(t){return this.$http.post(r,t)},profitDatahn:function(t){return this.$http.post(c,t)},monthData:function(t){return this.$http.post(l,t)},detailData:function(t){return this.$http.post(u,t)},modifyData:function(t){return this.$http.post(p,t)},getRewardData:function(t){return this.$http.post(s,t)},modifyafterData:function(t){return this.$http.post(f,t)},modifyBankData:function(t){return this.$http.post(d,t)}}}},a424:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"body"},[a("nav-top",{attrs:{title:"店铺装修"},on:{backEvent:function(e){return t.$router.go(-1)}}},[a("div",{staticClass:"shareBox",on:{click:t.previewData}},[t._v("预览")])]),a("nav-content",[a("van-cell-group",[a("div",{staticClass:"selectDiv",on:{click:t.changeName}},[a("van-field",{attrs:{label:"店铺名称",readonly:!0,placeholder:"店铺名称"},model:{value:t.mall.storeName,callback:function(e){t.$set(t.mall,"storeName",e)},expression:"mall.storeName"}}),t.disabled?t._e():a("span",{staticClass:"iconfont mall-gengduojiantou"})],1),a("div",{staticClass:"selectDiv",on:{click:t.changeProfile}},[a("van-field",{attrs:{readonly:!0,label:"店铺简介",placeholder:"店铺简介"},model:{value:t.mall.storeProfile,callback:function(e){t.$set(t.mall,"storeProfile",e)},expression:"mall.storeProfile"}}),t.disabled?t._e():a("span",{staticClass:"iconfont mall-gengduojiantou"})],1),1==t.$store.state.globalConfig.microshop_open?a("router-link",{staticClass:"link",attrs:{to:{path:"/micro_sho/bank",query:{card:t.mall.card,bankName:t.mall.bankName}}}},[a("div",{staticClass:"selectDiv"},[a("van-field",{attrs:{readonly:!0,label:"我的银行卡"},model:{value:t.mall.card,callback:function(e){t.$set(t.mall,"card",e)},expression:"mall.card"}}),a("span",{staticClass:"iconfont mall-gengduojiantou"})],1)]):t._e(),a("div",{staticClass:"selectDiv",on:{click:function(e){return t.openChangeImgPopup(1)}}},[a("van-field",{attrs:{type:"tel",label:"店铺头像",disabled:""}}),a("img",{staticClass:"img1",attrs:{src:t.mall.pictureUrl,alt:""}}),a("span",{staticClass:"iconfont mall-gengduojiantou"})],1),a("div",{staticClass:"selectDiv",on:{click:function(e){return t.openChangeImgPopup(2)}}},[a("van-field",{attrs:{label:"店铺背景",disabled:""}}),a("img",{staticClass:"img1",attrs:{src:t.mall.backgroundImgUrl,alt:""}}),a("span",{staticClass:"iconfont mall-gengduojiantou"})],1)],1),a("van-action-sheet",{attrs:{actions:t.actions},on:{select:t.onSelect},model:{value:t.showFaceBackImg,callback:function(e){t.showFaceBackImg=e},expression:"showFaceBackImg"}})],1)],1)},o=[],i=(a("e7e5"),a("d399")),r=a("5530"),s=(a("b0c0"),a("f0ba"),a("476d")),c=a("653a"),l=a("2f62"),u=a("d7b9"),p={name:"renovation",mixins:[s["a"]],data:function(){return{headUrl:"/static/image/microShop/head@2x.png",bacUrl:"/static/image/microShop/head@2x.png",disabled:!1,showFaceBackImg:!1,actions:[{name:"相册"},{name:"拍照"}],faceOrBack:"",frontOfId:"",backOfId:"",mall:{}}},computed:Object(r["a"])({},Object(l["c"])(["getPutaggregate"])),mounted:function(){1==this.$store.state.globalConfig.auto_create_store_info&&(this.disabled=!0),this.loadIndex()},methods:{loadIndex:function(){var t=this,e=this,a={token:this.$store.state.login.token};e.modifyData(a).then((function(a){var n=a.data.data||{};e.mall=n,e.mall.storeProfile||t.content()}))},content:function(){var t=this;this.$request.post("/app/json/news/getNewsList",{values:62}).then((function(e){if("success"===e.result){var a=e.data||[];t.mall.storeProfile=a[0].content}else t.$Toast(e.info)}))},changeProfile:function(){0==this.disabled&&this.$router.push({path:"/micro_sho/modifyintroduction"})},changeName:function(){0==this.disabled&&this.$router.push({path:"/micro_sho/modifyname"})},openChangeImgPopup:function(t){var e=this;this.faceOrBack=1==t?1:2,6==this.$store.state.webtype?u["a"].chooseImg().then((function(t){1==e.faceOrBack?(e.mall.pictureUrl=t.imgUrl,e.frontOfId=t.imgUrl):(e.mall.backgroundImgUrl=t.imgUrl,e.backOfId=t.imgUrl),e.commit()})):this.showFaceBackImg=!0},onSelect:function(t){this.showFaceBackImg=!1,"拍照"==t.name?this.getImg("2"):"相册"==t.name&&this.getImg("1")},getImg:function(t){var e=this;this.$bridgefunc.getPhoto(t,(function(t){e.updateImg(t);var a="data:image/jpg;base64,"+t;1==e.faceOrBack?e.mall.pictureUrl=a:e.mall.backgroundImgUrl=a}))},updateImg:function(t){var e=this,a={base64File:t,fileType:"jpg",fileName:"id-card-img",bucketName:"default_file"};this.$Loading.open("保存中..."),this.$http.post("/uploadFile",a).then((function(t){e.$Loading.close();var a=t.data;0==a.status?1==e.faceOrBack?(e.frontOfId=a.data,e.commit()):(e.backOfId=a.data,e.commit()):e.$Toast(a.info)}),(function(t){e.$Loading.close(),e.$Toast("上传图片失败")}))},commit:function(){var t=this,e=this,a={token:this.$store.state.login.token,id:e.getPutaggregate.id,storeName:"",pictureUrl:e.frontOfId,backgroundImgUrl:e.backOfId,storeProfile:"",card:""};e.modifyafterData(a).then((function(a){"success"===a.data.result?(t.getPutaggregate.pictureUrl=e.frontOfId,t.getPutaggregate.backgroundImgUrl=e.backOfId,c["a"].commit("putaggregate",t.getPutaggregate)):Object(i["a"])(a.data.info)}))},previewData:function(){var t=this;t.$router.push({name:"micro_sho/preview",params:{mall:t.mall}})}}},f=p,d=(a("d41e"),a("0c7c")),g=Object(d["a"])(f,n,o,!1,null,"61b071a9",null);e["default"]=g.exports},d41e:function(t,e,a){"use strict";a("e6c3")},d7b9:function(t,e,a){"use strict";a("e17f");var n=a("2241"),o=(a("e7e5"),a("d399")),i=a("d4ec"),r=a("bee2");a("d3b7"),a("c975"),a("ac1f"),a("466d"),a("1276"),a("a15b"),a("d81d"),a("0d03"),a("25f0"),a("fb6a"),a("e25e");function s(){var t=window.navigator.userAgent.toLowerCase();return"micromessenger"==t.match(/MicroMessenger/i)}var c=a("5530"),l=a("da71"),u=a("bc3a"),p=a.n(u),f=a("a026"),d=a("a78e"),g=a.n(d),m=a("4328"),h=a.n(m);f["default"].use(o["a"]),f["default"].use(n["a"]);var v=p.a.create({baseURL:l["a"].baseURL,timeout:1e4,responseType:"json",withCredentials:!1,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}});v.interceptors.request.use((function(t){o["a"].loading({mask:!0,duration:0});var e=g.a.get("usertoken");return"post"===t.method?t.data=h.a.stringify(Object(c["a"])(Object(c["a"])({},t.data),{},{token:e})):"get"===t.method&&(t.params=Object(c["a"])(Object(c["a"])({},t.params),{},{token:e})),t}),(function(t){return Promise.reject(t)})),v.interceptors.response.use((function(t){return o["a"].clear(),-1==t.data.status&&t.data.info.indexOf("用户信息为空")>-1&&n["a"].confirm({title:"提示",message:"用户信息失效, 请重新登录"}).then((function(){})),t}),(function(t){return o["a"].clear(),Promise.reject(t)}));var w=v,b=a("378f"),y=a("653a"),k=function(){function t(e){Object(i["a"])(this,t),this.jsApiList=e}return Object(r["a"])(t,[{key:"share",value:function(t,e,a,n){return s()?this._wxShare(t,e,a,n):this._appShare(t,e,a,n)}},{key:"chooseImage",value:function(t){return s()?this._wxChooseImage(t):this._appChooseImage()}},{key:"_wxChooseImage",value:function(t){var e=this;return new Promise((function(a,n){e._init(["chooseImage","uploadImage"]).then((function(){wx.chooseImage({count:t||1,sourceType:["camera"],sizeType:["original"],success:function(t){var e=t.localIds[0];wx.getLocalImgData({localId:e,success:function(t){var e=t.localData,n=e.substr(e.indexOf(",")+1);a({imagedata:[n]})}})}})}))}))}},{key:"_wxUploadImage",value:function(t){return new Promise((function(e,a){wx.uploadImage({localId:t,isShowProgressTips:1,success:function(t){e(t.serverId)}})}))}},{key:"_wxShare",value:function(t,e,a,n){var o=this;return new Promise((function(i,r){o._init(["onMenuShareTimeline","onMenuShareAppMessage","updateAppMessageShareData","updateTimelineShareData"]).then((function(){wx.onMenuShareTimeline({title:t,link:e,imgUrl:a,success:function(){i()}}),wx.onMenuShareAppMessage({title:t,desc:n,link:e,imgUrl:a,success:function(){i()}}),wx.updateAppMessageShareData({title:t,desc:n,link:e,imgUrl:a,success:function(){}}),wx.updateTimelineShareData({title:t,link:e,imgUrl:a,success:function(){}})}))}))}},{key:"_appShare",value:function(t,e,a,n){if("new"==y["a"].state.globalConfig.yht_protocol_type){var o={title:t,sharetext:n,imageurl:a,detailurl:e};b["a"].share(o)}else{var i={type:"share",para:{title:t,sharetext:n,imageurl:a,detailurl:e}};location.href=location.origin+"?appprotocol="+encodeURIComponent(JSON.stringify(i))}}},{key:"_appUploadImage",value:function(t){var e="appCallbackUploadImage",a={type:"webuploadimage",para:{callback:e,num:t||1}};return location.href=location.origin+"?appprotocol="+encodeURIComponent(JSON.stringify(a)),new Promise((function(t){window[e]=function(e){t(e)}}))}},{key:"_appChooseImage",value:function(){if("new"==y["a"].state.globalConfig.yht_protocol_type)return new Promise((function(t){b["a"].getPhoto(3,(function(e){var a=[];a.push(e),t({imagedata:a})}))}));var t="photoCallBack",e={type:"nativephoto",para:{type:"3"}};return location.href=location.origin+"?appprotocol="+encodeURIComponent(JSON.stringify(e)),new Promise((function(e){window[t]=function(t){e(t)}}))}},{key:"scanCode",value:function(){if("new"==y["a"].state.globalConfig.yht_protocol_type)return new Promise((function(t){b["a"].scanCode((function(e){t(e)}))}));var t="qrCallBack",e={type:"qrscan"};return location.href=location.origin+"?appprotocol="+encodeURIComponent(JSON.stringify(e)),new Promise((function(e){window[t]=function(t){e(t)}}))}},{key:"wxSign",value:function(t){if("new"==y["a"].state.globalConfig.yht_protocol_type)b["a"].wxFreePay(t);else{var e={type:"wxfreepay",para:{pre_entrustweb_id:t}};location.href=location.origin+"?appprotocol="+encodeURIComponent(JSON.stringify(e))}}},{key:"getLocation",value:function(){return new Promise((function(t){wx.getLocation({type:"wgs84",success:function(t){}})}))}},{key:"_init",value:function(t){var e=this;return new Promise((function(a,n){e._getConfig().then((function(e){wx.config({appId:e.appid,timestamp:e.timestamp,nonceStr:e.nonce,signature:e.signature,jsApiList:t}),wx.ready((function(){a()})),wx.error((function(t){n(t)}))}))["catch"]((function(t){n()}))}))}},{key:"_getConfig",value:function(){return new Promise((function(t,e){var a="",n=navigator.userAgent,o=!!n.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);a=o?window.initUrl:window.location.href.split("#")[0],w.post("/app/json/wx/getAccessToken",{url:encodeURIComponent(a)}).then((function(e){0===e.data.status&&t(Object.assign({},e.data.data,e.data.data.signature))}))["catch"]((function(t){e(t)}))}))}},{key:"openNewPage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("new"==y["a"].state.globalConfig.yht_protocol_type)b["a"].newPage({weburl:t,isnativetop:!0});else{var a={type:"newpage",para:{isnative:e,islogin:!0,isnativetop:!0,isopen:!0}};e?a.para.code=t:a.para.weburl=t,location.href=location.origin+"?appprotocol="+encodeURIComponent(JSON.stringify(a))}}},{key:"finishPage",value:function(){var t={type:"finish"};location.href=location.origin+"?appprotocol="+encodeURIComponent(JSON.stringify(t))}},{key:"openLogin",value:function(){var t={type:"login"};location.href=location.origin+"?appprotocol="+encodeURIComponent(JSON.stringify(t))}},{key:"chooseImg",value:function(){var t=this;return new Promise((function(e,a){t.chooseImage().then((function(t){if(t.imagedata&&t.imagedata.length){var a=t.imagedata[0];w.get("/app/json/app_youdi/getSunboxToken").then((function(t){var i=t.data.data;o["a"].loading({mask:!0,duration:0}),p.a.post("/uploadFile",h.a.stringify({base64File:a,fileType:"png",fileName:"1",token:i,bucketName:"default_file"})).then((function(t){var i=t.data.data,r={imgUrl:i,baseImgUrl:a};o["a"].clear(),i?e(r):n["a"].alert({title:"提示",message:"上传失败！"})}))}))}}))}))}}]),t}();e["a"]=new k},e6c3:function(t,e,a){}}]);