(window.webpackJsonp=window.webpackJsonp||[]).push([[705],{"2yfA":function(t,e,s){"use strict";s.r(e);var a=s("dqDD"),i={name:"addresslist",components:{Indicator:a.Indicator,Toast:a.Toast,CellSwipe:a.CellSwipe},data:function(){return{lists:[],scrollValue:0,reSetDefault:!1,pageType:"0",type:"",cannotUseList:[]}},methods:{backEvent:function(){this.$router.go(-1)},reSetDefaultAddress:function(t){this.reSetDefault=!1,this.$store.state.mall2.selectAddress=t,this._setDefaultAddress(t.id),this.$bridgefunc.vuexStorage()},_deleteAddress:function(t,e){var s=this;t.id==this.$store.state.mall2.selectAddress.id&&(this.reSetDefault=!0),this.$Loading.open();var a={id:t.id,token:this.$store.state.login.token};console.log(a),this.$http.post("/app/json/user_address/deleteUserAddress",a).then((function(t){s.$Loading.close();var e=t.data;console.log("删除地址:",e),0==e.status?s._getAddressList():s.$Toast(e.info)}),(function(t){s.$Loading.close(),console.log("删除地址",t),s.$Toast("删除地址失败")}))},editAddress:function(t){console.log(t),this.$router.push({path:"/mall2/addaddress",query:{addressItem:encodeURIComponent(JSON.stringify(t)),type:2,pageType:this.pageType}})},addAddressEvent:function(){if("citydelivery"==this.type){var t=sessionStorage.getItem("Address_City_Seleted");t=JSON.parse(t),this.$router.push({path:"/mall2/addaddress",query:{type:1,pageType:this.pageType,defaultCity:t.cityName,defaultProvince:t.provinceName}})}else this.$router.push({path:"/mall2/addaddress",query:{type:1,pageType:this.pageType}})},selectAddress:function(t,e){console.log(t),"0"==this.pageType&&(this.$store.state.mall2.selectAddress=t,this._setDefaultAddress(t.id),this.$bridgefunc.vuexStorage(),this.backEvent())},_setDefaultAddress:function(t){var e={token:this.$store.state.login.token,deliveryId:t};this.$http.post("/app/json/user_address/addDefaultAddress",e).then((function(t){}),(function(t){}))},_getAddressList:function(){var t=this;this.$Loading.open();var e={token:this.$store.state.login.token,addressType:"1"};console.log(e),this.$http.post("/app/json/user_address/loadUserAddressList",e).then((function(e){t.$Loading.close();var s=e.data;if(0==s.status){var a=s.data;if("citydelivery"==t.type){var i=sessionStorage.getItem("Address_City_Seleted");i=JSON.parse(i);for(var l=[],d=[],n=0;n<a.length;n++){var o=a[n];o.cityId==i.cityId?l.push(o):d.push(o)}l.length>0?1==t.reSetDefault&&t.reSetDefaultAddress(l[0]):(t.$store.state.mall2.selectAddress={id:""},t.$bridgefunc.vuexStorage()),t.lists=l,t.cannotUseList=d}else a.length>0?1==t.reSetDefault&&t.reSetDefaultAddress(a[0]):(t.$store.state.mall2.selectAddress.id="",t.$bridgefunc.vuexStorage()),t.lists=a}else t.$Toast(s.info)}),(function(e){t.$Loading.close(),console.log("获取地址列表",e),t.$Toast("获取数据失败")}))}},created:function(){this.pageType=this.$route.query.pageType?this.$route.query.pageType:"0",this.type=this.$route.query.type?this.$route.query.type:"",this._getAddressList()}},l=(s("DGqk"),s("KHd+")),d=Object(l.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"address-list"},[s("nav-top",{on:{backEvent:t.backEvent}}),t._v(" "),s("nav-content",[s("div",{ref:"addresslistscrl",staticClass:"scrolcontent"},[t._l(t.lists,(function(e,a){return s("div",{staticClass:"address-cells shadow-cell",on:{click:function(s){return t.selectAddress(e,a)}}},[s("mt-cell-swipe",{staticClass:"my-cell-swipe",attrs:{right:[{content:"删除",style:{padding:"20px 30px",background:"#F80F16",color:"white",display:"flex",alignItems:"center"},handler:function(){return t._deleteAddress(e,a)}}]}},[s("div",{staticStyle:{width:"100%",display:"flex","align-items":"center"},attrs:{slot:"title"},slot:"title"},[e.id==t.$store.state.mall2.selectAddress.id&&0==t.pageType?s("div",{staticClass:"left-select"},[s("i",{staticClass:"iconfont mall-xuanzhong theme_font_red"})]):t._e(),t._v(" "),s("div",{staticClass:"right-info"},[s("div",{staticClass:"name-phone"},[s("span",{staticClass:"realName theme_font_black left-con"},[t._v(t._s(e.receiverName))]),t._v(" "),s("span",{staticClass:"tel theme_font_black left-con"},[t._v(t._s(e.mobile))]),t._v(" "),1==e.isDefault?s("span",{staticClass:"default left-con theme_bg_red"},[t._v("默认")]):t._e()]),t._v(" "),s("div",{staticClass:"address-edit"},[s("p",{staticClass:"address theme_font_gray"},[t._v(t._s(e.addressFull))]),t._v(" "),s("div",{staticClass:"edit",on:{click:function(s){return s.stopPropagation(),t.editAddress(e)}}},[s("i",{staticClass:"iconfont mall-bianji theme_font_gray"})])])])])])],1)})),t._v(" "),t.cannotUseList.length>0?s("div",[s("div",{staticClass:"cannot-use-address"},[s("div",{staticClass:"line line_top"}),t._v(" "),s("div",{staticClass:"text"},[t._v("不可用地址")]),t._v(" "),s("div",{staticClass:"line line_top"})]),t._v(" "),t._l(t.cannotUseList,(function(e,a){return s("div",{staticClass:"address-cells shadow-cell"},[s("mt-cell-swipe",{staticClass:"my-cell-swipe",attrs:{right:[{content:"删除",style:{padding:"20px 30px",background:"#F80F16",color:"white",display:"flex",alignItems:"center"},handler:function(){return t._deleteAddress(e,a)}}]}},[s("div",{staticStyle:{width:"100%",display:"flex","align-items":"center"},attrs:{slot:"title"},slot:"title"},[e.id==t.$store.state.mall2.selectAddress.id&&0==t.pageType?s("div",{staticClass:"left-select"},[s("i",{staticClass:"iconfont mall-xuanzhong theme_font_red"})]):t._e(),t._v(" "),s("div",{staticClass:"right-info"},[s("div",{staticClass:"name-phone"},[s("span",{staticClass:"realName theme_font_gray left-con"},[t._v(t._s(e.receiverName))]),t._v(" "),s("span",{staticClass:"tel theme_font_gray left-con"},[t._v(t._s(e.mobile))]),t._v(" "),1==e.isDefault?s("span",{staticClass:"default left-con theme_bg_red"},[t._v("默认")]):t._e()]),t._v(" "),s("div",{staticClass:"address-edit"},[s("p",{staticClass:"address theme_font_gray"},[t._v(t._s(e.addressFull))]),t._v(" "),s("div",{staticClass:"edit",on:{click:function(s){return s.stopPropagation(),t.editAddress(e)}}},[s("i",{staticClass:"iconfont mall-bianji theme_font_gray"})])])])])])],1)}))],2):t._e()],2),t._v(" "),s("div",{staticClass:"bottom-btn theme_bg_red",on:{click:t.addAddressEvent}},[s("p",[t._v("新建收货地址")])])])],1)}),[],!1,null,"bc1facdc",null);e.default=d.exports},DGqk:function(t,e,s){"use strict";var a=s("YSJA");s.n(a).a},YSJA:function(t,e,s){}}]);