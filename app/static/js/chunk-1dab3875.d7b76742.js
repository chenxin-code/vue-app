(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1dab3875"],{"43fc":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav-top",{attrs:{title:"评价"},on:{backEvent:function(e){return t.$router.go(-1)}}}),a("nav-content",[a("div",{staticClass:"adress"},[a("div",{staticClass:"icon-con"},[a("img",{attrs:{src:"static/image/mall2/oil.png",alt:""}})]),a("div",{staticClass:"ad"},[t._v(t._s(t.form.ouName||t.$route.query.storeName)+"("+t._s(t.$route.query.standOuCode)+")")])]),t.$route.query.storeName?a("div",{staticClass:"order-info"},[a("div",{staticClass:"title"},[t._v("加油订单信息")]),a("div",{staticClass:"info-item"},[a("div",[t._v("交易流水：")]),a("div",[t._v(t._s(t.$route.query.refuelOrderId||t.details.refuelOrderId))])]),a("div",{staticClass:"info-item",on:{click:t.openTime}},[a("van-field",{attrs:{label:"加油时间",placeholder:"请选择加油时间","input-align":"right",readonly:1==t.$route.query.viewFlag,"right-icon":"arrow"},model:{value:t.form.createTime,callback:function(e){t.$set(t.form,"createTime",e)},expression:"form.createTime"}})],1),a("div",{staticClass:"info-item"},[a("van-field",{attrs:{label:"员工简码",placeholder:"请输入员工简码","input-align":"right",readonly:1==t.$route.query.viewFlag},model:{value:t.form.empNo,callback:function(e){t.$set(t.form,"empNo",e)},expression:"form.empNo"}})],1),a("div",{staticClass:"info-item"},[a("van-field",{attrs:{label:"加油金额(元)",placeholder:"请填写加油金额","input-align":"right",readonly:1==t.$route.query.viewFlag,required:!0},model:{value:t.form.refuelAmount,callback:function(e){t.$set(t.form,"refuelAmount",e)},expression:"form.refuelAmount"}})],1)]):a("div",{staticClass:"order-info"},[a("div",{staticClass:"title"},[t._v("加油订单信息")]),a("div",{staticClass:"info-item"},[a("div",[t._v("交易流水：")]),a("div",[t._v(t._s(t.$route.query.refuelOrderId||t.details.refuelOrderId||t.details.orderId))])]),a("div",{staticClass:"info-item"},[a("div",[t._v("加油时间：")]),a("div",[t._v(t._s(t.details.createTime))])]),a("div",{staticClass:"info-item"},[a("div",[t._v("加油金额(元)：")]),a("div",[t._v(t._s(t.details.refuelAmount))])])]),a("div",{staticClass:"order-info"},[a("evaluate-item",{attrs:{answerList:t.answerList,prize:t.questionPrize,view:t.view,form:t.form,evaluateType:t.details.evaluateType,randomId:t.randomId}})],1),a("van-popup",{style:{height:"50%"},attrs:{position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("van-datetime-picker",{attrs:{type:"datetime",title:"选择加油时间"},on:{confirm:t.confirm,cancel:function(e){t.show=!1}},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1)],1)],1)},s=[],r=(a("0d03"),a("d3b7"),a("25f0"),a("4160"),a("159b"),a("b0c0"),a("ac1f"),a("1276"),a("a9e3"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"title"},[t._v("请您提出意见，我们将持续改进与提升")]),t._l(t.answerList,(function(e,i){return a("div",{key:i,staticClass:"top"},[6===e.kindId?a("div",{staticClass:"singleList score"},[a("div",{staticClass:" score-con"},[a("label",{staticClass:"title-con"},[t._v(t._s(e.title))]),a("div",{staticClass:"evaluteBox"},[1===e.styleType?a("van-rate",{attrs:{color:"#ffd21e","void-icon":"star",readonly:1==t.view},on:{change:function(e){return t.evaluateData(i,e)}},model:{value:e.result,callback:function(a){t.$set(e,"result",a)},expression:"item.result"}}):t._e(),2===e.styleType?a("van-rate",{attrs:{color:"#25aff8",icon:"like","void-color":"#25aff8","void-icon":"like-o",readonly:1==t.view},on:{change:function(e){return t.evaluateData(i,e)}},model:{value:e.result,callback:function(a){t.$set(e,"result",a)},expression:"item.result"}}):t._e(),3===e.styleType?a("van-rate",{attrs:{color:"#25aff8",icon:"static/image/microShop/xiaoicon.png","void-color":"#25aff8","void-icon":"smile-o",readonly:1==t.view},on:{change:function(e){return t.evaluateData(i,e)}},model:{value:e.result,callback:function(a){t.$set(e,"result",a)},expression:"item.result"}}):t._e(),a("p",[t._v(t._s(e.evaluate))])],1)])]):t._e(),1===e.kindId?a("div",{staticClass:"singleList"},[a("div",{staticClass:"divObj"},[a("span",{staticClass:"wall-title"},[t._v(t._s(e.orderNo)+"、"+t._s(e.title))]),a("van-radio-group",{on:{change:t.changeResult},model:{value:e.result,callback:function(a){t.$set(e,"result",a)},expression:"item.result"}},t._l(e.options,(function(e,i){return a("van-radio",{key:i,attrs:{"checked-color":"#25aff8",name:t.optionsObj[i]}},[t._v(t._s(t.optionsObj[i])+" 、"+t._s(e.lable)+" ")])})),1)],1)]):t._e(),2===e.kindId?a("div",{staticClass:"singleList che-con multipleList"},[a("div",{staticClass:" "},[a("span",{staticClass:"wall-title"},[t._v(t._s(e.orderNo)+"、"+t._s(e.title))]),a("div",{staticClass:"checkItem-con"},t._l(e.options,(function(i,s){return a("van-button",{key:s,staticClass:"btn-con",class:i.flag?"select":"",attrs:{round:"",type:"default",size:"small"},on:{click:function(a){return t.selectO(e.options,e,s)}}},[t._v(t._s(i.lable))])})),1)])]):t._e(),5===e.kindId?a("div",{staticClass:"singleList"},[a("div",{staticClass:"divObj divObj1"},[e.limitMin&&!e.limitMax?a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.result,expression:"item.result"}],staticClass:"textType",staticStyle:{"min-height":"90px"},attrs:{disabled:1==t.view,placeholder:t.placeHolder?t.placeHolder:"对其他方面不满意，可描述问题帮加油站改善哦～"},domProps:{value:e.result},on:{input:function(a){a.target.composing||t.$set(e,"result",a.target.value)}}}):t._e(),e.limitMax&&!e.limitMin?a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.result,expression:"item.result"}],staticClass:"textType",staticStyle:{"min-height":"90px"},attrs:{disabled:1==t.view,placeholder:t.placeHolder?t.placeHolder:"对其他方面不满意，可描述问题帮加油站改善哦～"},domProps:{value:e.result},on:{input:function(a){a.target.composing||t.$set(e,"result",a.target.value)}}}):t._e(),e.limitMin&&e.limitMax?a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.result,expression:"item.result"}],staticClass:"textType",staticStyle:{"min-height":"90px"},attrs:{disabled:1==t.view,placeholder:t.placeHolder?t.placeHolder:"对其他方面不满意，可描述问题帮加油站改善哦～"},domProps:{value:e.result},on:{input:function(a){a.target.composing||t.$set(e,"result",a.target.value)}}}):t._e(),e.limitMin||e.limitMax?t._e():a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.result,expression:"item.result"}],staticClass:"textType",staticStyle:{"min-height":"90px"},attrs:{placeholder:t.placeHolder?t.placeHolder:"对其他方面不满意，可描述问题帮加油站改善哦～",disabled:1==t.view},domProps:{value:e.result},on:{input:function(a){a.target.composing||t.$set(e,"result",a.target.value)}}})])]):t._e(),7===e.kindId?a("div",{staticClass:"singleList text-con"},[a("div",{staticClass:"lin-con"}),a("div",{},[a("span",{staticClass:"wall-title"},[t._v(t._s(e.orderNo)+"、"+t._s(e.title))]),a("van-field",{staticStyle:{width:"100%",background:"white",border:"1px solid #ccc","border-radius":"8px"},attrs:{rows:"2",autosize:"",maxlength:e.limitMax||100,type:"textarea",placeholder:"亲，您对加油站的评价，是我们更好服务的动力哦！","show-word-limit":""},model:{value:e.result,callback:function(a){t.$set(e,"result",a)},expression:"item.result"}})],1)]):t._e(),4===e.kindId?a("div",{staticClass:"singleList"},[a("div",{staticClass:"divObj"},[a("span",{staticClass:"wall-title"},[t._v(t._s(e.orderNo)+"、"+t._s(e.title))]),a("div",{staticClass:"xiala",on:{click:function(a){return t.select1(e)}}},[a("span",[t._v(t._s(e.result||"请选择"))]),a("span",{staticClass:"icon iconfont mall-xiala"})]),a("van-action-sheet",{attrs:{id:"xialaView",actions:e.options},on:{select:function(a){return t.onSelect(a,e)}},model:{value:e.show,callback:function(a){t.$set(e,"show",a)},expression:"item.show"}})],1)]):t._e(),3===e.kindId?a("div",{staticClass:"singleList"},[a("div",{staticClass:"divObj"},[a("span",{staticClass:"wall-title"},[t._v(t._s(e.orderNo)+"、"+t._s(e.title))]),t._l(e.options,(function(i,s){return a("div",{key:s,staticClass:"pics"},[a("div",[a("span",[t._v(t._s(t.optionsObj[s])+"、")]),a("img",{attrs:{src:i.imgUrl,alt:""}})]),a("div",[a("van-radio-group",{model:{value:e.result,callback:function(a){t.$set(e,"result",a)},expression:"item.result"}},[a("van-radio",{attrs:{"checked-color":"#25aff8",name:t.optionsObj[s]}},[t._v(t._s(i.lable)+" ")])],1)],1)])}))],2)]):t._e()])})),1!=t.view&&t.answerList.length>0?a("div",{staticClass:"handler"},[a("van-button",{staticClass:"btn",attrs:{round:"",type:"info",color:"#F02C2D"},on:{click:t.commit}},[t._v("提交")]),t.hasPrize?a("div",[t.prize.length>0&&"20030"!=t.prize[0].prizeType?a("p",[t._v("* 完成评价后可获赠"+t._s(t.prize[0].prizeNum)+"张"+t._s(t.prize[0].prizeName)+t._s(t.prize.length>1?"等":""))]):t._e(),t.prize.length>0&&"20030"==t.prize[0].prizeType?a("p",[t._v("* 完成评价后可获赠"+t._s(t.prize[0].prizeName)+t._s(t.prize[0].prizeNum)+"次"+t._s(t.prize.length>1?"等":""))]):t._e()]):t._e()],1):t._e(),a("van-popup",{attrs:{"close-on-click-overlay":!1},model:{value:t.commitModel,callback:function(e){t.commitModel=e},expression:"commitModel"}},[a("div",{staticClass:"modal"},[a("p",{staticClass:"title-p"},[a("span",[t._v("成功提交问券")]),t.showFlag1?a("span",[t._v("恭喜您获得以下奖品")]):t._e()]),t.showFlag1?a("ul",t._l(t.mktAwardList,(function(e,i){return a("li",{key:i},[a("img",{attrs:{src:e.prizeImgUrl?e.prizeImgUrl:"static/image/microShop/icon52x.png",alt:""}}),a("span",[t._v(t._s(e.prizeName)+"("+t._s(e.prizeNum)+")")]),a("span",{on:{click:function(a){return t.seeView(e.prizeType,e.prizeCode)}}},[t._v("查看")])])})),0):t._e(),t.toEvaluatedNum?a("div",{staticClass:"order"},[a("div",{staticStyle:{"margin-top":"10px"}},[t._v("您在最近"+t._s(t.limitOrderDayNum)+"天内还有"+t._s(t.toEvaluatedNum)+"条待评价订单 ")])]):t._e()]),a("div",{staticClass:"btns"},[a("span",{staticClass:"theme_bg_red",on:{click:t.closeBtn}},[t._v(t._s(t.toEvaluatedNum?"继续评价":"确定"))])])])],2)}),o=[],n=(a("e7e5"),a("d399")),l=(a("c975"),a("4c53"),a("797f")),u={props:["answerList","prize","view","form","evaluateType","randomId"],name:"",mixins:[l["a"]],components:{},data:function(){return{commitModel:!1,showFlag1:!1,mktAwardList:[],hasPrize:null,toEvaluatedNum:null,limitOrderDayNum:null}},computed:{placeHolder:function(){var t=this,e=null;return this.answerList.length>0&&this.answerList.forEach((function(a,i){5==a.kindId&&(e=JSON.parse(t.answerList[i].options)[0].placeHolder)})),e}},methods:{seeView:function(t,e){var a="";if("20030"==t)this.$market.enterGamesFunc({gameTypeCode:e},!0);else if("20010"==t)a="/usercenter/rebatebonus";else if("20020"==t)a="/mall2/integralinfo";else if("20001"==t&&(a=this.$store.state.globalConfig.questionaire_prize_coupon_list||"/coupon_list",-1!=a.indexOf("uhuitong.com")))return void this.$market.enterNav({link:{type:"3",url:a,useOldProtocal:!0}});this.$router.push({path:a,query:{}})},evaluateData:function(t,e){var a=this.answerList[t];1==a.result?a.evaluate="非常差":2==a.result?a.evaluate="差":3==a.result?a.evaluate="一般":4==a.result?a.evaluate="满意":5==a.result&&(a.evaluate="非常满意")},closeBtn:function(){this.toEvaluatedNum>0?(this.commitModel=!0,this.$router.push({path:"/evaluatelist"})):this.commitModel=!1},commit:function(){this.$route.query.storeName&&""==this.form.refuelAmount?this.$Toast("请输入金额！"):this.sub()},sub:function(){var t=this,e=this,a=[];e.answerList.forEach((function(t){a.push({kindId:t.kindId,configId:t.configId,subjectId:t.id,kindName:t.kindName,options:t.options,title:t.title,styleType:t.styleType,orderNo:0==e.evaluateType?t.orderNo:e.randomId,result:t.result?t.result.toString():""})}));var i=!0;if(e.answerList.forEach((function(t){1==t.mustAnswer&&""==t.result&&(i=!1)})),i){var s=!0;if(e.answerList.forEach((function(t,a){5==t.kindId&&(t.limitMin&&!t.limitMax&&t.result.length<t.limitMin&&(e.tip="第"+(a+1)+"题简答题最少输入"+t.limitMin+"个字",s=!1),t.limitMax&&!t.limitMin&&t.result.length>t.limitMax&&(e.tip="第"+(a+1)+"题简答题最多输入"+t.limitMax+"个字",s=!1),t.limitMin&&t.limitMax&&(t.result.length>=t.limitMin&&t.result.length<=t.limitMax?s=!0:(e.tip="第"+(a+1)+"题简答题字数限制在"+t.limitMin+"至"+t.limitMax+"之间",s=!1)))})),s){e.$Loading.open();var r=Object.assign({resultJson:JSON.stringify(a),id:this.$route.query.id,orderId:this.$route.query.storeName?e.randomId:e.$route.query.orderId,refuelOrderId:e.$route.query.refuelOrderId,channel:e.$route.query.channel?e.$route.query.channel:"",channelName:e.$route.query.channelName?e.$route.query.channelName:""},this.form);e.commitData(r).then((function(a){if(e.$Loading.close(),"success"===a.data.result){Object(n["a"])("提交成功");var i={id:e.$route.query.id,orderId:0==e.evaluateType?e.$route.query.orderId:e.randomId};e.$Loading.open(),e.prizeData(i).then((function(a){e.$Loading.close(),"success"===a.data.result?(e.mktAwardList=a.data.data.mktAwardList||[],e.mktAwardList.length>0?t.showFlag1=!0:t.showFlag1=!1,t.getEvaluateOrder()):(e.commitModel=!1,e.$router.go(-1))}))}else Object(n["a"])(a.data.info)}))}else Object(n["a"])(e.tip)}else Object(n["a"])("您还有必答题尚未答完，请先答完必答题！")},getEvaluateOrder:function(t){var e=this;if(""!=this.$store.state.login.token){var a={token:this.$store.state.login.token},i="/app/json/questionaire/getLatestAppraise";this.$http.post(i,a).then((function(a){var i=a.data;0==i.status?(e.limitOrderDayNum=i.data.limitOrderDayNum,e.toEvaluatedNum=i.data.toEvaluatedNum,t||(e.toEvaluatedNum>0||1==e.showFlag1?e.commitModel=!0:e.commitModel=!1),e.hasPrize=i.data.hasPrize):e.$Toast("网络加载较慢，请稍后重试!")}),(function(t){}))}}},created:function(){this.getEvaluateOrder(!0)}},d=u,c=(a("5637"),a("0c7c")),m=Object(c["a"])(d,r,o,!1,null,"3c1ae41b",null),p=m.exports,v={name:"",mixins:[l["a"]],components:{evaluateItem:p},data:function(){return{form:{empNo:null,createTime:null,refuelAmount:null,ouName:null},randomId:null,questionPrize:{},answerList:[],value:null,show:!1,currentDate:new Date,minDate:new Date,details:{},view:0}},methods:{openTime:function(){1!=this.$route.query.viewFlag&&(this.show=!0)},confirm:function(t){this.show=!1,this.form.createTime=this.$util.getPreTime(t)},loadData:function(){var t=this;this.randomId=Math.random().toString(36).substr(2);var e=this,a={id:this.$route.query.id,orderId:this.$route.query.storeName?this.randomId:this.$route.query.orderId,refuelOrderId:this.$route.query.refuelOrderId};e.$http.post("/app/json/questionaire/appUserConfig",a).then((function(a){if("success"===a.data.result){t.getQuest(),t.details=a.data.data,document.title=a.data.data.title,t.form.createTime=a.data.data.createTime,t.form.empNo=a.data.data.empNo,t.form.refuelAmount=a.data.data.refuelAmount,t.form.ouName=a.data.data.ouName,t.questionPrize=JSON.parse(a.data.data.questionPrize);var i=a.data.data.subjectList;e.userId=a.data.data.userId;var s=a.data.data.questionShare?JSON.parse(a.data.data.questionShare):"";0==s.length?e.shareView=!1:e.shareView=!0,i.forEach((function(t){if(t.show=!1,1===t.kindId||2===t.kindId||3===t.kindId||4===t.kindId){var e=JSON.parse(t.options);e.forEach((function(t){t.name=t.lable})),t.options=e}2===t.kindId?t.result=[]:6===t.kindId?t.result=0:(t.result="",4===t.kindId&&(t.show=!1))})),i.forEach((function(t){t.evaluate="",t.tips=""})),e.answerList=JSON.parse(JSON.stringify(i)),e.answerList.forEach((function(t,a,i){2==t.kindId&&t.options.forEach((function(t,i,s){e.$set(e.answerList[a].options[i],"flag",!1)}))})),e.shareTitle=a.data.data.shareTitle,e.shareContent=a.data.data.shareContent,e.shareImgUrl=a.data.data.shareImgUrl}}))},getQuest:function(){var t=this,e={id:this.$route.query.id,orderId:this.$route.query.storeName?this.randomId:this.$route.query.orderId,refuelOrderId:this.$route.query.refuelOrderId};this.$http.post("/app/json/questionaire/startAnswer",e).then((function(e){t.$Loading.close(),"success"===e.data.result||t.loadDataDetail()}))},loadDataDetail:function(){var t=this,e=this,a={id:this.$route.query.id,orderId:this.$route.query.storeName?this.randomId:this.$route.query.orderId,refuelOrderId:this.$route.query.refuelOrderId};e.historydetailData(a).then((function(a){if("success"===a.data.result){t.view=1,t.details=a.data.data;var i=JSON.parse(a.data.data.resultJson);i.forEach((function(t){t.evaluate=""})),e.userId=a.data.data.userId;var s=a.data.data.questionShare?JSON.parse(a.data.data.questionShare):"";0==s.length?e.shareView=!1:e.shareView=!0,i.forEach((function(t,e){if(1===t.kindId||2===t.kindId||3===t.kindId||4===t.kindId){var a=JSON.parse(t.options)||[];a.forEach((function(t){t.name=t.lable})),t.options=a}2===t.kindId?t.result=t.result.split(","):6===t.kindId||8===t.kindId?(t.result=Number(t.result)||0,t.evaluate1={},t.evaluate1.explain=t.evaluate,t.evaluate1.reasonArr=JSON.parse(t.resultDes)):4===t.kindId&&(t.show=!1)})),e.answerList=i,e.shareTitle=a.data.data.shareTitle,e.shareContent=a.data.data.shareContent,e.shareImgUrl=a.data.data.shareImgUrl,t.form.time=a.data.data.createTime,t.form.empNo=a.data.data.empNo,t.form.money=a.data.data.refuelAmount,t.form.ouName=a.data.data.ouName,e.finishFlag=!0,e.$forceUpdate()}}))}},created:function(){this.view=this.$route.query.viewFlag,1==this.$route.query.viewFlag?this.loadDataDetail():this.loadData()}},f=v,h=(a("496c"),Object(c["a"])(f,i,s,!1,null,"46f804aa",null));e["default"]=h.exports},"45a8":function(t,e,a){},"496c":function(t,e,a){"use strict";a("bdfb")},"4c53":function(t,e,a){"use strict";var i=a("23e7"),s=a("857a"),r=a("af03");i({target:"String",proto:!0,forced:r("sub")},{sub:function(){return s(this,"sub","","")}})},5637:function(t,e,a){"use strict";a("45a8")},"797f":function(t,e,a){"use strict";var i="/app/json/questionaire/startAnswer",s="/app/json/questionaire/appUserConfig",r="/app/json/questionaire/submit",o="/app/json/questionaire/completeAct",n="/app/json/questionaire/findQuestionaireByuserId",l="/app/json/questionaire/historyQuestionaireList",u="/app/json/questionaire/questionaireDetail";e["a"]={methods:{participateData:function(t){return this.$http.post(i,t)},questionData:function(t){return this.$http.post(s,t)},commitData:function(t){return this.$http.post(r,t)},prizeData:function(t){return this.$http.post(o,t)},listData:function(t){return this.$http.post(n,t)},historyData:function(t){return this.$http.post(l,t)},historydetailData:function(t){return this.$http.post(u,t)}}}},bdfb:function(t,e,a){}}]);