(window.webpackJsonp=window.webpackJsonp||[]).push([[714],{"Clu/":function(e,t,s){"use strict";var r=s("Ucj0");s.n(r).a},"HC+A":function(e,t,s){"use strict";s.r(t);var r={name:"pay-check",components:{},data:function(){return{tradeNo:"",orderType:"",orderId:"",isScan:"",getResultTimes:0}},methods:{oilCheckPayResult:function(){var e=this;this.$Loading.open();var t="/app/json/refuel_center/queryPayState";this.isScan&&(t="/app/json/refuel_scan_code/queryPayState");var s={tradeNo:this.tradeNo};this.$http.post(t,s).then((function(t){e.$Loading.close();var s=t.data;if(0==s.status)if(1==s.data.state)e.oilResultHand(1);else if(2==s.data.state)e.oilResultHand(0);else if(0==s.data.state){if(e.getResultTimes++,e.getResultTimes>3)return;setTimeout((function(){e.oilCheckPayResult()}),500)}}),(function(t){e.$Loading.close()}))},oilResultHand:function(e){var t=this;if(this.$Loading.close(),"1"==e)this.$router.replace({path:this.isScan?"/firmScanDetail":"/firmDetail",query:{orderType:this.orderType,orderId:this.orderId,fromPage:1}});else{var s="/app/json/refuel_center/cancelOrder";this.isScan&&(s="/app/json/refuel_scan_code/cancelOrder");var r={orderType:this.orderType,orderId:this.orderId};this.$http.post(s,r).then((function(e){var s=e.data;0==s.status?(t.$Toast("支付已取消"),t.$router.go(-1)):t.$Toast(s.info)}))}},checkPayResult:function(){var e=this;this.$Loading.open();var t={tradeNo:this.tradeNo};this.$http.post("/app/json/app_shopping_order/queryPayState",t).then((function(t){e.$Loading.close();var s=t.data;if(0==s.status)if(1==s.data.state)e.enterSuccess();else{if(e.getResultTimes++,e.getResultTimes>3)return e.$Toast("暂未查询到您的支付信息！稍后请在订单中查看订单状态"),void e.$router.go(-1);setTimeout((function(){e.checkPayResult()}),500)}}),(function(t){e.$Loading.close()}))},toOrder:function(){1==this.$store.state.mall2.staticDeliverType?this.$router.replace({path:"/mall2/orderlist",query:{selectedIndex:"2",orderCategory:this.$route.query.orderCategory,vipUnitUserCode:this.$route.query.vipUnitUserCode}}):this.$router.replace({path:"/mall2/orderlist",query:{selectedIndex:"1",orderCategory:this.$route.query.orderCategory,vipUnitUserCode:this.$route.query.vipUnitUserCode}})},enterSuccess:function(){this.$router.replace({path:"/mall2/paysuccess",query:{selectedIndex:1,name:this.$route.query.name}})}},mounted:function(){var e=this;if(this.tradeNo=this.$route.query.tradeNo||"",this.orderType=this.$route.query.orderType||"",this.orderId=this.$route.query.orderId||"",this.isScan=this.$route.query.isScan||"",this.isZTApp=this.$route.query.isZTApp||"",this.$util.isZTAPP())this.$MessageBox.confirm("是否已经完成订单支付！","提示",{confirmButtonText:"支付完成",cancelButtonText:"放弃支付"}).then((function(t){e.getResultTimes=0,0==e.orderType.indexOf("100")?e.oilCheckPayResult():e.checkPayResult()})).catch((function(e){window.history.go(-2)}));else if(1==this.isZTApp)window.location.href="sinopecsales://"+window.location.host;else if("1"==this.$store.state.webtype)this.$bridgefunc.customGo(-1);else{var t=window.location.host;window.location.href=t+"://"+window.location.host}}},o=(s("Clu/"),s("KHd+")),i=Object(o.a)(r,(function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"pay-check"})}),[],!1,null,"4635dad3",null);t.default=i.exports},Ucj0:function(e,t,s){}}]);