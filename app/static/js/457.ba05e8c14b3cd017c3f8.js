(window.webpackJsonp=window.webpackJsonp||[]).push([[457],{ByGF:function(t,a,s){"use strict";var o=s("x7gE");s.n(o).a},LaXu:function(t,a,s){t.exports=s.p+"static/img/share-bg.c9e8080.png"},fs8S:function(t,a,s){"use strict";s.r(a);var o=s("2nGb"),i={data:function(){return{show:!1,page:0,rows:10,totalAmount:0,loading:!1,finished:!1,dataInfo:{},list:[]}},created:function(){this.onLoad(),this.getInfo()},methods:{goback:function(){this.$router.go(-1)},getCard:function(){var t=this;this.$Loading.open();var a={invited:1,referrerUserId:this.$route.query.userId,discountCardId:this.dataInfo.id};this.$http.post("/app/json/wx_discount_card/applyDiscountCard",a).then((function(a){t.$Loading.close(),console.log(a,"res");var s=a.data;0==s.status?s.data&&s.data.prepare_card_token?t.goForCard(s.data.prepare_card_token):t.$toast("未获取到先享卡token"):t.$toast(s.info)})).catch((function(a){console.error(a),t.$Loading.close()}))},getInfo:function(){var t=this;this.$http.post("/app/json/wx_discount_card/getShareableCard").then((function(a){var s=a.data;0==s.status?t.dataInfo=s.data||{}:t.$toast(s.info)}))},goForCard:function(t){wx.navigateToMiniProgram({appId:"wxcc2e4fbc5887661e",path:"/pages/get-card/get-card?prepare_card_token="+t})},shareCard:function(){var t={title:this.dataInfo.appGuideRemarks,imageurl:this.dataInfo.appSharedBGP};t.detailurl=this.$store.state.globalConfig.wxBaseUrl+o.a.shareUrl+this.$route.fullPath+"?userId="+this.$store.state.userInfo.userId,this.$bridgefunc.wechatShare(t)},onLoad:function(){var t=this;this.$Loading.open(),this.page++;var a={page:this.page,rows:this.rows,cardTemplateId:this.dataInfo.cardTemplateId};this.$http.post("/app/json/wx_discount_card/getUserInvite",a).then((function(a){var s=a.data;if(0==s.status){var o=s.data||[];t.list=t.list.concat(o),t.list.length>=s.totalRecords&&(t.finished=!0)}else t.finished=!0,t.$Toast(a.info?a.info:"获取列表失败");t.Loading=!1,t.$Loading.close()})).catch((function(a){t.$Loading.close()}))}},filters:{state:function(t){var a="";switch(t){case"ONGOING":a="约定进行中";break;case"CHECKING":a="到期核对中";break;case"FINISHED":a="已完成约定";break;case"UNFINISHED":a="未完成约定"}return a}},computed:{bgUrl:function(){return this.dataInfo.sharedBGP?{backgroundImage:"url("+this.dataInfo.sharedBGP+")"}:{backgroundImage:"url("+s("LaXu")+")"}}}},e=(s("ByGF"),s("KHd+")),n=Object(e.a)(i,(function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("div",[o("nav-top",{attrs:{title:"我的先享卡"},on:{backEvent:t.goback}}),t._v(" "),o("nav-content",[o("div",{staticClass:"content",style:t.bgUrl},[o("img",{staticClass:"tip",attrs:{src:s("iFBN"),alt:""}}),t._v(" "),o("h2",{on:{click:function(a){t.show=!0}}},[t._v("\n        邀请记录\n      ")]),t._v(" "),o("div",{staticClass:"footer"},[o("div",{staticClass:"btn",on:{click:t.getCard}}),t._v(" "),o("div",{staticClass:"btn",on:{click:t.shareCard}})])]),t._v(" "),o("van-popup",{staticClass:"popup",style:{height:"60%",background:"#FFEFDA"},attrs:{position:"bottom",closeable:"",round:""},model:{value:t.show,callback:function(a){t.show=a},expression:"show"}},[o("h2",[t._v("我的邀请记录")]),t._v(" "),o("div",{staticClass:"table"},[o("van-list",{staticClass:"search-list",attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(a){t.loading=a},expression:"loading"}},[o("div",{staticClass:"row title"},[o("div",{staticClass:"col col1"},[t._v("序号")]),t._v(" "),o("div",{staticClass:"col"},[t._v("用户手机号")]),t._v(" "),o("div",{staticClass:"col col2"},[t._v("领卡时间")]),t._v(" "),o("div",{staticClass:"col"},[t._v("履约状态")]),t._v(" "),o("div",{staticClass:"col"},[t._v("完成约定次数")])]),t._v(" "),t._l(t.list,(function(a,s){return o("div",{key:s,staticClass:"row t-content"},[o("div",{staticClass:"col col1"},[t._v(t._s(s+1))]),t._v(" "),o("div",{staticClass:"col"},[t._v(t._s(a.applyPhone))]),t._v(" "),o("div",{staticClass:"col col2"},[t._v(t._s(a.getTime))]),t._v(" "),o("div",{staticClass:"col"},[t._v(t._s(t._f("state")(a.state)))]),t._v(" "),o("div",{staticClass:"col"},[t._v(t._s(a.completeCnt||0)+"次")])])}))],2)],1)])],1)],1)}),[],!1,null,"2134e402",null);a.default=n.exports},iFBN:function(t,a,s){t.exports=s.p+"static/img/share-title.ad9c225.png"},x7gE:function(t,a,s){}}]);