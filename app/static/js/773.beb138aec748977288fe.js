(window.webpackJsonp=window.webpackJsonp||[]).push([[773],{BwLB:function(t,e,a){"use strict";var o=a("rb/7");a.n(o).a},WJkU:function(t,e,a){"use strict";a.r(e);var o=a("db0i"),n=a("L2JU"),s=a("KJ3S"),i=a("A8ay"),r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(t[o]=a[o])}return t},c={name:"btn-product",components:{},mixins:[i.a],data:function(){return{checked:!0,canEvent:!0}},props:["myIndex","usePorpData","propData"],computed:r({},Object(n.c)(["clientWidth"]),{pageData:function(){return 1==this.usePorpData?this.propData:this.$store.state.pageData},moduleData:function(){return this.pageData.moduleList[this.myIndex].data},getLabelText:function(){var t=this.moduleData.labelText;return this.moduleData.product&&null!=this.moduleData.product.activityPrice?t=t.replace("[price]",this.moduleData.product.activityPrice+""):t},getFloatUp:function(){var t="",e=this.moduleData.bgImgUrl;""!=e&&(t+="background: url('"+e+"') no-repeat center center / 100% 100%;");var a=this.moduleData.bgColor;""!=a&&(t+="background-color: "+a+";");var o=this.moduleData.floatUp;return o>0&&(t+="margin-top: -"+o+"%;"),this.moduleData.isFloat&&(-1==this.$store.state.webtype?t+="position: absolute;":t+="position: fixed;",t+="z-index: 20;left: 0;right: 0;bottom: 0;"),t},getSidesStyle:function(){var t="",e=this.moduleData.upMargin,a=this.moduleData.downMargin;e>0&&(t+="padding-top: "+e+"%;"),a>0&&(t+="padding-bottom: "+a+"%;");var o=this.moduleData.btnImage;return""!=o&&(t+="background: url('"+o+"') no-repeat center center / 100% 100%;"),t+"color: "+this.moduleData.labelColor+";"},getLeftBtnStyle:function(){var t="",e=this.moduleData.leftBtnWidth;return e&&(t+="width: "+e+"%;"),t}}),methods:{hotEvent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.actionBtnEvent(this.pageData.pgCode,this.moduleData.idCode+t)},leftBtnEvent:function(){this.$market.enterNav({link:this.moduleData.leftLink})},getProductDetail:function(t){var e=this;this.$Loading.open();var a=this.$market.apiBaseURL()+"/app/json/product/getAppProDetail",o={productType:t.productType,skuId:t.skuId,lng:this.$store.state.currentLocation.posx,lat:this.$store.state.currentLocation.posy,deliverType:"2"};this.$http.post(a,o).then((function(t){e.$Loading.close();var a=t.data;0==a.status?e.moduleData.product=a.data:e.$Toast(a.info)}),(function(t){e.$Loading.close(),e.$Toast("请求数据失败！")}))},buyEvent:function(){var t=this;if(-1!=this.$store.state.webtype)if(this.moduleData.showAgreement&&0==this.checked)this.$Toast("请先阅读并同意相关须知或政策");else if(this.canEvent){this.canEvent=!1,setTimeout((function(){t.canEvent=!0}),1e3);var e=this.moduleData.product;this.$Loading.open();var a={deliveryType:2,virtualUserPhone:this.$store.state.login.phone};a.carts=[{number:1,skuId:e.skuId,storeOuCode:e.storeOuCode,selfActivityId:e.activityId,checked:1,isGift:0}],this.$http.post("/app/json/app_shopping_order/submit",a).then((function(e){var a=e.data;if(0==a.status){var n=a.data||{};"4"==t.$store.state.webtype?t.$market.payEvent({payMode:305,payModeSub:305005},n.orderType,n.orderId,"/icbc/ryhysuccess").then((function(){})).catch((function(){t.$Toast("支付失败！")})):"3"==t.$store.state.webtype?o.a.payEvent({payMode:210,payModeSub:210005},n.orderType,n.orderId,"/icbc/ryhysuccess").then((function(t){})).catch((function(){t.$Toast("支付失败！")})):2==t.$store.state.webtype&&o.a.payEvent({payMode:210,payModeSub:210002},n.orderType,n.orderId,"/icbc/ryhysuccess").then((function(t){})).catch((function(){t.$Toast("支付失败！")}))}else t.$Toast(a.info);t.$Loading.close()}))}},toAgreement:function(){var t=this.moduleData.agreementValue;t&&this.$market.customPush({path:"/usercenter/agreement",query:{value:t}})}},created:function(){var t=this;-1!=this.$store.state.webtype&&this.moduleData.product&&this.getProductDetail(this.moduleData.product),s.a.$on("productBtnEvent",(function(){t.buyEvent()}))}},d=(a("BwLB"),a("KHd+")),u=Object(d.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"btn-product",style:t.getFloatUp},[a("div",{staticClass:"content-div"},[a("div",{staticClass:"left-btn",class:t.hotareaClass({idCode:t.moduleData.idCode+"leftBtnEvent"}),style:t.getLeftBtnStyle,on:{click:function(e){t.hotEvent("leftBtnEvent"),t.leftBtnEvent()}}},[a("img",{attrs:{src:t.moduleData.leftBtnImg}})]),t._v(" "),a("div",{staticClass:"btn-label",class:t.hotareaClass({idCode:t.moduleData.idCode+"buyEvent"}),style:t.getSidesStyle,on:{click:function(e){t.hotEvent("buyEvent"),t.buyEvent()}}},[a("span",[t._v(t._s(t.getLabelText))]),t._v(" "),a("span",{staticClass:"line-text"},[t._v(t._s(t.moduleData.lineText))])])]),t._v(" "),t.moduleData.showAgreement?a("div",{staticClass:"agreement"},[a("van-checkbox",{attrs:{"icon-size":"16px"},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}}),t._v(" "),a("div",{staticClass:"text",class:t.hotareaClass({idCode:t.moduleData.idCode+"toAgreement"}),on:{click:function(e){t.hotEvent("toAgreement"),t.toAgreement()}}},[t._v(t._s(t.moduleData.agreementText))])],1):t._e()])}),[],!1,null,"d8dced68",null);e.default=u.exports},"rb/7":function(t,e,a){}}]);