(window.webpackJsonp=window.webpackJsonp||[]).push([[620],{"9MBu":function(t,s){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD4AAAA+CAMAAABEH1h2AAAABGdBTUEAALGPC/xhBQAAAJZQTFRFIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVAAAAIxgVy1NN+gAAADF0Uk5TVsj90VPTO36mWsE9I2PPWHhRCVQy6wfYQR+2CkYZwLDqlyBIkhEwQHDQoOBQkBCAAMeQb5sAAAFmSURBVEjH7Zdnc4MwDEDddO+ZHVpIoGyw/v+fKwibGNvsux65y/tkEj1yEbKFCHVsEwBmoJJSJAU9pu1Q4iyhjhYdYOkQG4brYBNzjD4nMEaHQl8nEpasW3LEWtATKhHLeixHJJPSNyFjV6fveMRGo/s8m1GdHvEI/6xPVT+kGW4ffRUxDKm+St3gEau2otXq3Wv+X3UrPnLIv3wvV6L+FWS85av72BJ05YjSb1hM/Xe+CiqH1anqqQzWmlh1br7GND55GZ94IxZM6CjO+nA9rYc9uCiosC0+3eJF/wadqDvupHXxuEBeZP3B4yyKrN3hxZD+Xvxw8eAmolfaRH+9vcdRVnULzFp/Xf2jHfTXn4znwfqR6egfWJ2D9c4vJ3uX06RXXkqVBt2449r7+4R1ZRgx9hmJoM99xvXNL/LY67Aqd1xUHYXMMfqs6xio1y+7DqF6nRA2AjfoXl5Lt1wvB5owvLiif4X2x4oZnHbEAAAAAElFTkSuQmCC"},LfHr:function(t,s,e){"use strict";e.r(s);var a=e("L2JU"),i=e("0FX9"),o=e.n(i),r={name:"",mixins:[{methods:{queryGameAwardDist:function(t){return this.$http.post("/app/json/app_game/queryGameAwardDist",t)}}}],data:function(){return{showPickupCode:!1,loading:!1,hasMore:!0,page:0,curId:"",deliverType:"",fromType:"",prizeList:[],navMenu:[{name:"未领取",awardState:5},{name:"已领取",awardState:10}],curState:5,modelShow:!1,columns:[{text:"自提",deliverType:1},{text:"配送",deliverType:2}],qrCodeModelShow:!1,qrcodeStr:""}},mounted:function(){this.loadMore(),console.log(this.$route.query.type)},methods:{showPickupQrcode:function(t){this.qrcodeStr=t,this.showPickupCode=!0,this.$nextTick((function(){o.a.toCanvas(document.getElementById("pickupqrcode"),t+"",{width:160})}))},toHistory:function(){var t=this;this.$Loading.open();var s={redirectUrl:this.$store.state.globalConfig.kshop_rewardList_url};this.$http.post("/app/json/login/redirectToKShop",s).then((function(s){t.$Loading.close();var e=s.data;if(0==e.status){var a=e.data;t.$bridgefunc.customPush({path:a,isnativetop:"1"},!1)}else t.$Toast(e.info)}),(function(s){t.$Loading.close(),t.$Toast("请求数据失败！")}))},backEvent:function(){"subject"==this.$route.query.type?this.$router.push({path:"/questionlist"}):"serviceSubject"==this.$route.query.type?this.$router.push({path:"/service/questionlist"}):this.$router.go(-1)},nav:function(t){this.curState!==t&&(this.curState=t,this.page=0,this.loading=!1,this.hasMore=!0,this.prizeList=[],this.loadMore())},loadMore:function(){var t=this;this.$Loading.open(),this.page++,this.loading=!0;var s={awardState:this.curState,page:this.page,rows:12,token:this.$store.state.login.token};this.queryGameAwardDist(s).then((function(s){var e=s.data;"success"==e.result&&0==e.status&&(t.prizeList=t.prizeList.concat(e.data),t.prizeList.length<e.totalRecords?t.loading=!1:t.hasMore=!1),t.$Loading.close()}))},showQrcode:function(t){this.qrCodeModelShow=!0,console.log(t),this.$nextTick((function(){o.a.toCanvas(document.getElementById("qrcode"),t+"")}))},getAddress:function(t,s,e){this.curId=t,this.deliverType=s,this.fromType=e,1==s?this.$router.push("/mall2/mypickupaddress?pageType=5"):2==s?this.$router.push("/mall2/addresslist"):12==s&&(this.modelShow=!0)},modifyAddress:function(t){this.curId=t.id,this.deliverType=t.deliverType,this.fromType=t.fromType,this.$router.push("/mall2/addresslist")},submitAddress:function(t){var s=this;this.$Loading.open(),t.chooseDeliverType=this.deliverType;var e={addressInfo:JSON.stringify(t),id:this.curId},a="/app/json/app_game/updateRecAwardAddress";"3"==this.fromType&&(a="/app/json/live_broadcast/liveAwardAddress",e.addressModel=JSON.stringify(t)),this.$http.post(a,e).then((function(e){var a=e.data;"success"==a.result&&0==a.status?(s.prizeList.find((function(t){return t.id==s.curId})).addressInfo=JSON.stringify(t),s.$toast("设置成功")):s.$toast(a.info||"设置失败"),s.$Loading.close()}))},onConfirm:function(t){var s=t.deliverType;this.deliverType=s,1==s?this.$router.push("/mall2/mypickupaddress?pageType=5"):2==s&&this.$router.push("/mall2/addresslist")}},computed:(Object.assign||function(t){for(var s=1;s<arguments.length;s++){var e=arguments[s];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t})({},Object(a.c)(["getSelectAddress","getPickAddress"])),components:{},destroyed:function(){this.curId=""},watch:{getSelectAddress:function(t){this.curId&&2==this.deliverType&&this.submitAddress(t)},getPickAddress:function(t){this.curId&&1==this.deliverType&&(this.submitAddress(t),console.log(t))}}},n=(e("pnc6"),e("KHd+")),d=Object(n.a)(r,(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",[a("nav-top",{attrs:{title:"历史中奖纪录"},on:{backEvent:t.backEvent}},[t.$store.state.globalConfig.kshop_rewardList_url&&null!=t.$store.state.globalConfig.kshop_rewardList_url?a("div",{staticClass:"right-btn theme_font_gray",staticStyle:{right:"0px",height:"44px",top:"0px","padding-right":"10px","font-size":"12px"},on:{click:t.toHistory}},[t._v("历史记录\n    ")]):t._e()]),t._v(" "),a("nav-content",[a("div",{staticClass:"award-list-container"},[a("div",{staticClass:"nav-tab"},t._l(t.navMenu,(function(s,e){return a("div",{staticClass:"nav-tab-item",class:{active:t.curState===s.awardState},on:{click:function(e){return t.nav(s.awardState)}}},[a("span",{staticClass:"text"},[t._v(t._s(s.name))])])})),0),t._v(" "),a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],staticClass:"award-list-content",attrs:{"infinite-scroll-disabled":"loading","infinite-scroll-immediate-check":!0,"infinite-scroll-distance":"100"}},[t._l(t.prizeList,(function(s,i){return a("div",{staticClass:"table-view award-item"},[a("div",{staticClass:"table-view-cell"},[3==s.fromType?a("div",{staticClass:"pull-left"},[t._v(t._s(100==s.awardType?"抽奖活动":"领取活动"))]):a("div",{staticClass:"pull-left"},[t._v(t._s(s.gameTypeTitle))]),t._v(" "),a("div",{staticClass:"pull-right"},[t._v(t._s(s.createTime))])]),t._v(" "),3==s.fromType?a("div",{staticClass:"table-view-cell"},[a("div",{staticClass:"award-body clearfix"},[a("img",{staticClass:"award-img",attrs:{src:s.awardPic?s.awardPic:"static/image/live-stream/gift.png",alt:""}}),t._v(" "),a("div",{staticClass:"award-con"},[a("p",{staticClass:"award-name m-ellipsis"},[t._v(t._s(s.awardName)+"\n                  "),a("span",{staticClass:"status"},[t._v(t._s(s.awardStateStr))])]),t._v(" "),a("p",{staticClass:"award-num"},[t._v("数量："+t._s(s.awardNum))]),t._v(" "),s.deliverCheckcode&&5==t.curState?a("p",{staticClass:"award-address"},[s.addressInfo?a("span",[t._v("地址："+t._s(JSON.parse(s.addressInfo).addressFull))]):t._e(),t._v(" "),1==s.deliverType?a("span",{staticClass:"edit-btn",on:{click:function(e){return t.showPickupQrcode(s.deliverCheckcode)}}},[t._v("提货码")]):2==s.deliverType&&s.addressInfo?a("span",{staticClass:"edit-btn",on:{click:function(e){return t.modifyAddress(s)}}},[t._v("修改")]):a("span",{staticClass:"edit-btn",on:{click:function(e){return t.modifyAddress(s)}}},[t._v("设置收货地址")])]):t._e()])])]):a("div",{staticClass:"table-view-cell"},[a("div",{staticClass:"award-body clearfix"},[a("img",{staticClass:"award-img",attrs:{src:s.awardPic?s.awardPic:"static/image/live-stream/gift.png",alt:""}}),t._v(" "),a("div",{staticClass:"award-con"},[a("p",{staticClass:"award-name m-ellipsis"},[t._v(t._s(s.awardName)+"\n                  "),a("span",{staticClass:"status"},[t._v(t._s(s.awardStateStr))])]),t._v(" "),a("p",{staticClass:"award-num"},[t._v("数量："+t._s(s.awardNum))]),t._v(" "),a("p",{staticClass:"award-address"},[s.addressInfo?a("span",[t._v("地址："+t._s(JSON.parse(s.addressInfo).addressFull))]):t._e(),t._v(" "),10!=s.awardState?a("span",{staticClass:"edit-btn",on:{click:function(e){return t.getAddress(s.id,s.deliverType)}}},[t._v(t._s(s.addressInfo?"修改":"设置收货地址"))]):t._e()]),t._v(" "),s.addressInfo&&1==JSON.parse(s.addressInfo).chooseDeliverType?a("div",{staticClass:"qr-code",on:{click:function(e){return t.showQrcode(s.id)}}},[a("img",{staticClass:"img",attrs:{src:e("9MBu"),alt:""}})]):t._e()])])])])})),t._v(" "),a("div",{staticClass:"tip-data"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.hasMore,expression:"hasMore"}],staticClass:"has-data"},[t._v("\n            正在加载\n            "),a("mt-spinner",{staticClass:"icon",attrs:{size:22,type:"fading-circle"}})],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.hasMore,expression:"!hasMore"}],staticClass:"no-data"},[t._v("已经到底啦~")])])],2)])]),t._v(" "),a("van-popup",{attrs:{position:"bottom"},model:{value:t.modelShow,callback:function(s){t.modelShow=s},expression:"modelShow"}},[a("van-picker",{attrs:{"show-toolbar":"",title:"选择提货方式",columns:t.columns},on:{cancel:function(s){t.modelShow=!1},confirm:t.onConfirm}})],1),t._v(" "),a("van-popup",{model:{value:t.qrCodeModelShow,callback:function(s){t.qrCodeModelShow=s},expression:"qrCodeModelShow"}},[a("canvas",{ref:"qrcode",staticClass:"qrcode",attrs:{id:"qrcode"}})]),t._v(" "),a("van-popup",{staticClass:"pickup-pop",model:{value:t.showPickupCode,callback:function(s){t.showPickupCode=s},expression:"showPickupCode"}},[a("div",{staticClass:"pickup-div"},[a("div",{staticClass:"title"},[t._v("查看提货码")]),t._v(" "),a("div",{staticClass:"code-text"},[t._v("提货码："+t._s(t.qrcodeStr))]),t._v(" "),a("div",{staticClass:"qrcode-div"},[a("canvas",{attrs:{id:"pickupqrcode"}})]),t._v(" "),a("div",{staticClass:"tip"},[t._v("请到任一门店出示此二维码提货")]),t._v(" "),a("div",{staticClass:"btn",on:{click:function(s){t.showPickupCode=!1}}},[t._v("知道啦～")])])])],1)}),[],!1,null,"db5ab26c",null);s.default=d.exports},jTGK:function(t,s,e){},pnc6:function(t,s,e){"use strict";var a=e("jTGK");e.n(a).a}}]);