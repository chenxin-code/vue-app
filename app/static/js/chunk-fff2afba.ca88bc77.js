(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fff2afba"],{"257f":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"index"}},[a("nav-top",{attrs:{title:"加油卡绑定"},on:{backEvent:e.backEvent}}),a("nav-content",[a("div",{staticClass:"conter"},[a("p",{staticClass:"ma-top"}),a("div",{staticClass:"input"},[a("ul",{staticClass:"inputnumber"},[a("li",{staticClass:"cardnoTitle"},[e._v("加油卡号")]),a("li",{staticClass:"cardnoLi"},[e._v(e._s(e.noprefix))]),a("li",{staticClass:"cardnoInput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.number,expression:"number"}],attrs:{type:"number",placeholder:"请输入卡号后"+e.cardNumber+"位"},domProps:{value:e.number},on:{input:function(t){t.target.composing||(e.number=t.target.value)}}})])]),a("mt-field",{attrs:{label:"手机号码",placeholder:"请输入手机号",disabled:"",type:"tel"},model:{value:e.Member,callback:function(t){e.Member=t},expression:"Member"}}),a("mt-field",{attrs:{label:"手机验证码",attr:{maxlength:6},placeholder:"请输入短信验证码",type:"type"},model:{value:e.validate,callback:function(t){e.validate=t},expression:"validate"}},[a("input",{staticClass:"fl-right",style:{background:"#fff",fontSize:"12px",color:"获取验证码"===e.obtain?"#f02c2c":"#ccc"},attrs:{type:"button",value:e.obtain,disabled:e.disabled},on:{click:e.countdown}})]),e.$store.state.globalConfig.sunbox_binding_card_noreferee?e._e():a("mt-field",{attrs:{label:"推荐人",placeholder:"请输入推荐人（选填）"},on:{input:e.changeRfrCodeType},model:{value:e.referee,callback:function(t){e.referee=t},expression:"referee"}},[a("img",{attrs:{src:"static/image/fuelcard//btn_Sweep.png",width:"25",height:"25"},on:{click:e.sweep}})]),a("p",{staticClass:"btn",on:{click:e.renders}},[e._v("提交")])],1),e.cardPrompt?a("div",{staticClass:"card-prompt"},[a("h3",{staticClass:"title"},[e._v("温馨提示：")]),a("div",{staticClass:"content",domProps:{innerHTML:e._s(e.cardPrompt)}})]):e._e()])])],1)},r=[],i=(a("0d03"),a("c975"),a("4795"),a("4d63"),a("ac1f"),a("25f0"),a("5319"),a("76a0")),s={data:function(){return{cardNumber:19,number:"",phone:"",validate:"",referee:"",obtain:"获取验证码",disabled:!1,Member:"",prohibit:!1,noprefix:"",theScanCode:"",inway:"",lastPath:"",newList:"",cardPrompt:""}},mounted:function(){this.getphone(),this.recommenderHistory()},created:function(){this.showagreement(),this.inway=this.$route.query.inway?this.$route.query.inway:"",this.lastPath=this.$route.query.lastPath?this.$route.query.lastPath:"",this.rfrCodeType=1;var e=this.$store.state.mall2.behalf.referrerInvalidDate;if(e&&void 0!=e&&""!=e){var t=new Date(e).getTime(),a=(new Date).getTime();t>=a&&(this.referee=this.$store.state.mall2.behalf.referrer)}else this.referee=this.$store.state.mall2.behalf.referrer},methods:{showagreement:function(){var e=this;this.$request.post("/app/json/news/getNewsList",{values:24}).then((function(t){0==t.status&&(e.cardPrompt=t.data[0]?t.data[0].content:"")}))},backEvent:function(){this.$router.go(-1)},jiami:function(e){return e.substr(0,4)+"****"+e.substr(-4)},changeRfrCodeType:function(){this.rfrCodeType=1},sweep:function(){var e=this;this.$bridgefunc.scanCode((function(t){e.rfrCodeType=2;var a=t.code;a.indexOf("http")>-1&&(a=e.$util.getUrlParam(a,"qrCode")),e.theScanCode=a,e.referee=a}))},countdown:function(){var e=this,t=this,a=this,n=60;function r(){if(0==n)return t.disabled=!1,t.obtain="获取验证码",n=60,!1;t.disabled=!0,t.obtain="重新发送("+n+")",n--,setTimeout((function(){r()}),1e3)}var s=new RegExp("^[0-9]{".concat(this.cardNumber,"}$"));s.test(this.number)?this.$request.post("/app/json/card/checkCardHasBind",{cardno:this.noprefix+this.number}).then((function(t){if(0==t.status){e.$Loading.open();var n="/app/json/message/sendVerifyBindCardSms";e.$http.post(n,{phone:e.phone,cardno:e.noprefix+e.number}).then((function(e){a.$Loading.close(),"error"===e.data.result?Object(i["Toast"])(e.data.info):(Object(i["Toast"])("获取验证码成功"),r())}))}else e.$Toast(t.info)})):Object(i["Toast"])("请输入正确卡号")},renders:function(){var e=this;this.referee==this.theScanCode?this.rfrCodeType=2:this.rfrCodeType=1;var t=new RegExp("^[0-9]{".concat(this.cardNumber,"}$"));if(t.test(this.number))if(""!==this.validate){this.$Loading.open();var a=this,n="/app/json/card/bindCard";this.$http.post(n,{cardno:this.noprefix+this.number,smscode:this.validate,referrer:this.referee,bindway:3,rfrCodeType:this.rfrCodeType}).then((function(t){a.$Loading.close(),-1!==t.data.status?0===t.data.status&&("replace"==e.inway?e.$router.replace({path:e.lastPath}):e.$router.go(-1)):Object(i["Toast"])(t.data.info)}))}else Object(i["Toast"])("请输入正确短信验证码");else Object(i["Toast"])("请输入正确卡号")},getphone:function(){var e=this;this.$Loading.open();var t=this,a="/app/json/card/getcardnopre";this.$http.post(a,{}).then((function(a){t.$Loading.close(),e.phone=a.data.data.phone,e.noprefix=a.data.data.noprefix,e.cardNumber=1*(19-e.noprefix.length),e.Member=e.phone}))},getNewsList:function(){var e=this;this.$Loading.open();var t=this,a="/app/json/news/getNewsList";this.$http.post(a,{values:21}).then((function(a){t.$Loading.close(),e.newList=a.data.data[0]}))},recommenderHistory:function(){this.$Loading.open();var e=this,t="/app/json/card/getBindCardReferrer";this.$http.post(t,{}).then((function(t){e.$Loading.close(),t.data.data?(e.referee=t.data.data?t.data.data:"",e.prohibit=!0):e.prohibit=!1}))}}},o=s,c=(a("4bf2"),a("518b"),a("0c7c")),d=Object(c["a"])(o,n,r,!1,null,"0578ed54",null);t["default"]=d.exports},"4bf2":function(e,t,a){"use strict";a("eae0")},"518b":function(e,t,a){"use strict";a("b1cb")},b1cb:function(e,t,a){},eae0:function(e,t,a){}}]);