(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6f5ec1a2"],{"2da5":function(t,a,s){t.exports=s.p+"static/images/c9e80806bd4aec6931c1a0b2813b1a23.png"},"7aec":function(t,a,s){"use strict";s("d79a")},"7ecf":function(t,a,s){"use strict";s.r(a);var o=function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("div",[o("nav-top",{attrs:{title:"我的先享卡"},on:{backEvent:t.goback}}),o("nav-content",[o("div",{staticClass:"content",style:t.bgUrl},[o("img",{staticClass:"tip",attrs:{src:s("8850"),alt:""}}),o("h2",{on:{click:function(a){t.show=!0}}},[t._v(" 邀请记录 ")]),o("div",{staticClass:"footer"},[o("div",{staticClass:"btn",on:{click:t.getCard}}),o("div",{staticClass:"btn",on:{click:t.shareCard}})])]),o("van-popup",{staticClass:"popup",style:{height:"60%",background:"#FFEFDA"},attrs:{position:"bottom",closeable:"",round:""},model:{value:t.show,callback:function(a){t.show=a},expression:"show"}},[o("h2",[t._v("我的邀请记录")]),o("div",{staticClass:"table"},[o("van-list",{staticClass:"search-list",attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(a){t.loading=a},expression:"loading"}},[o("div",{staticClass:"row title"},[o("div",{staticClass:"col col1"},[t._v("序号")]),o("div",{staticClass:"col"},[t._v("用户手机号")]),o("div",{staticClass:"col col2"},[t._v("领卡时间")]),o("div",{staticClass:"col"},[t._v("履约状态")]),o("div",{staticClass:"col"},[t._v("完成约定次数")])]),t._l(t.list,(function(a,s){return o("div",{key:s,staticClass:"row t-content"},[o("div",{staticClass:"col col1"},[t._v(t._s(s+1))]),o("div",{staticClass:"col"},[t._v(t._s(a.applyPhone))]),o("div",{staticClass:"col col2"},[t._v(t._s(a.getTime))]),o("div",{staticClass:"col"},[t._v(t._s(t._f("state")(a.state)))]),o("div",{staticClass:"col"},[t._v(t._s(a.completeCnt||0)+"次")])])}))],2)],1)])],1)],1)},i=[],e=(s("99af"),s("da71")),n={data:function(){return{show:!1,page:0,rows:10,totalAmount:0,loading:!1,finished:!1,dataInfo:{},list:[]}},created:function(){this.onLoad(),this.getInfo()},methods:{goback:function(){this.$router.go(-1)},getCard:function(){var t=this;this.$Loading.open();var a={invited:1,referrerUserId:this.$route.query.userId,discountCardId:this.dataInfo.id};this.$http.post("/app/json/wx_discount_card/applyDiscountCard",a).then((function(a){t.$Loading.close();var s=a.data;0==s.status?s.data&&s.data.prepare_card_token?t.goForCard(s.data.prepare_card_token):t.$toast("未获取到先享卡token"):t.$toast(s.info)}))["catch"]((function(a){t.$Loading.close()}))},getInfo:function(){var t=this;this.$http.post("/app/json/wx_discount_card/getShareableCard").then((function(a){var s=a.data;0==s.status?t.dataInfo=s.data||{}:t.$toast(s.info)}))},goForCard:function(t){wx.navigateToMiniProgram({appId:"wxcc2e4fbc5887661e",path:"/pages/get-card/get-card?prepare_card_token=".concat(t)})},shareCard:function(){var t={title:this.dataInfo.appGuideRemarks,imageurl:this.dataInfo.appSharedBGP};t.detailurl=this.$store.state.globalConfig.wxBaseUrl+e["a"].shareUrl+this.$route.fullPath+"?userId="+this.$store.state.userInfo.userId,this.$bridgefunc.wechatShare(t)},onLoad:function(){var t=this;this.$Loading.open(),this.page++;var a={page:this.page,rows:this.rows,cardTemplateId:this.dataInfo.cardTemplateId};this.$http.post("/app/json/wx_discount_card/getUserInvite",a).then((function(a){var s=a.data;if(0==s.status){var o=s.data||[];t.list=t.list.concat(o),t.list.length>=s.totalRecords&&(t.finished=!0)}else t.finished=!0,t.$Toast(a.info?a.info:"获取列表失败");t.Loading=!1,t.$Loading.close()}))["catch"]((function(a){t.$Loading.close()}))}},filters:{state:function(t){var a="";switch(t){case"ONGOING":a="约定进行中";break;case"CHECKING":a="到期核对中";break;case"FINISHED":a="已完成约定";break;case"UNFINISHED":a="未完成约定";break}return a}},computed:{bgUrl:function(){var t={};return t=this.dataInfo.sharedBGP?{backgroundImage:"url(".concat(this.dataInfo.sharedBGP,")")}:{backgroundImage:"url(".concat(s("2da5"),")")},t}}},c=n,r=(s("7aec"),s("0c7c")),d=Object(r["a"])(c,o,i,!1,null,"17538e99",null);a["default"]=d.exports},8850:function(t,a,s){t.exports=s.p+"static/images/ad9c2251bcaca2eb49b8c2bdda5b88e3.png"},d79a:function(t,a,s){}}]);