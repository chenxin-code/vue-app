(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-55a997f1"],{"35fc":function(t,a,e){},"3de7":function(t,a,e){"use strict";e("4795"),e("d3b7");a["a"]={data:function(){return{getResultTimes:0,clearTimer:null,payTime:0}},mounted:function(){},methods:{checkPayResult:function(){var t=this;this.queryState().then((function(a){if(1==a)t.resultHand(1);else if(2==a)t.resultHand(0);else if(0==a){if(t.getResultTimes++,t.getResultTimes>20)return;t.clearTimer=setTimeout((function(){t.checkPayResult()}),1e3)}}))},queryState:function(){var t=this;return new Promise((function(a,e){var s="/app/json/refuel_center/queryPayState";t.isScan&&(s="/app/json/refuel_scan_code/queryPayState");var n={token:t.$store.state.login.token,tradeNo:t.payData.tradeNo};t.$Loading.open(),t.$http.post(s,n).then((function(s){t.$Loading.close();var n=s.data;0==n.status?a(n.data.state):e(),n.data.msg}))["catch"]((function(){t.$Loading.close()}))}))}},destroyed:function(){clearTimeout(this.clearTimer)}}},5463:function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"pay-mode"},[e("div",{staticClass:"title"},[t._v("支付方式")]),t._l(t.payWay,(function(a){return e("div",{staticClass:"pay-mode-item",on:{click:function(e){return t.payWaySelected(a)}}},["210009"!=a.payModeSub||"210009"==a.payModeSub&&3==t.$store.state.webtype?[e("div",{staticClass:"icon"},[e("img",{attrs:{src:a.icon}})]),e("div",{staticClass:"text"},[t._v(t._s(a.text))]),e("div",{staticClass:"selected"},[t.selectedPayWay.payModeSub!=a.payModeSub?e("i",{staticClass:"iconfont mall-weixuanzhong theme_font_tint"}):t._e(),t.selectedPayWay.payModeSub==a.payModeSub?e("i",{staticClass:"iconfont mall-xuanzhong theme_font_red"}):t._e()])]:t._e()],2)}))],2)},n=[],i=e("75bd"),o={name:"pay-mode",props:{supportCompany:Boolean},data:function(){return{payWay:[],selectedPayWay:{}}},mounted:function(){},methods:{init:function(t,a){var e=this;i["a"].getPayWays(t,a).then((function(t){e.payWay=t||[],e.supportCompany?e.selectedPayWay=[]:e.selectedPayWay=e.payWay[0],e.$emit("setPayWay",e.selectedPayWay,"init")}))},payWaySelected:function(t){t.payMode?(this.selectedPayWay=t,this.$emit("setPayWay",this.selectedPayWay)):this.$Toast("暂未开通！")}},components:{}},c=o,r=(e("9099"),e("0c7c")),l=Object(r["a"])(c,s,n,!1,null,"6197c526",null);a["a"]=l.exports},9099:function(t,a,e){"use strict";e("35fc")},"924b":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"order-list-container"},[e("nav-top",{on:{backEvent:function(a){return t.$router.go(-1)}}}),e("nav-content",[e("div",{staticClass:"order-list"},t._l(t.orderList,(function(a,s){return e("div",{key:s,staticClass:"order-item"},[e("div",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("油站")]),e("span",{staticClass:"content"},[t._v(t._s(a.ouName))])]),"scan"!=t.$route.query.enterPage?e("div",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("油枪")]),e("span",{staticClass:"content"},[t._v(t._s(a.refuelGunNo)+"号")])]):t._e(),e("div",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("油品")]),e("span",{staticClass:"content"},[t._v(t._s(a.refuelOilName))])]),e("div",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("加油时间")]),e("span",{staticClass:"content"},[t._v(t._s(a.refuelTakeDate))])]),"scan"!=t.$route.query.enterPage?e("div",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("加油升数")]),e("span",{staticClass:"content"},[t._v(t._s(a.refuelLiter)+"L")])]):t._e(),t.settleMobelAmount(a.thirdDiscountAmount,a.thirdDiscountAmount2)?e("div",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("移动优惠金额")]),e("span",{staticClass:"content"},[t._v("￥"+t._s(t.settleMobelAmount(a.thirdDiscountAmount,a.thirdDiscountAmount2)))])]):t._e(),e("div",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("金额")]),e("span",{staticClass:"theme_font_red"},[t._v("￥"+t._s(a.payAmount.toFixed(2)))])]),e("div",{staticClass:"btn-group"},[e("div",{staticClass:"btns"},[e("div",{staticClass:"btn",on:{click:function(e){return t.cancelOrderHandler(a)}}},[t._v("取消订单")]),e("div",{staticClass:"btn pay-btn",on:{click:function(e){return t.payOrder(a)}}},[t._v("继续支付")])])])])})),0),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.orderList.length,expression:"!orderList.length"}],staticClass:"no-data"},[t._v("暂无订单~")])]),t.showModal?e("div",{staticClass:"confirm-pay-modal"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-title"},[t._v("确认支付？")]),e("div",{staticClass:"content"},[t.payData.payMode?e("div",{staticClass:"item"},[e("span",[t._v("支付方式")]),e("span",[t._v(t._s(t.payTypeStr(t.payData.payMode)))])]):e("div",{staticClass:"item"},[e("pay-mode",{ref:"payModeRef",staticStyle:{width:"100%","margin-top":"0"},on:{setPayWay:t.setPayWays}})],1),e("div",{staticClass:"item"},[e("span",[t._v("加油时间")]),e("span",[t._v(t._s(t.payData.createTime))])]),e("div",{staticClass:"item"},[e("span",[t._v("加油升数")]),e("span",[t._v(t._s(t.payData.refuelLiter)+"L")])]),t.settleMobelAmount(t.payData.thirdDiscountAmount,t.payData.thirdDiscountAmount2)?e("div",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("移动优惠金额")]),e("span",{staticClass:"content"},[t._v("￥"+t._s(t.settleMobelAmount(t.payData.thirdDiscountAmount,t.payData.thirdDiscountAmount2)))])]):t._e(),e("div",{staticClass:"item"},[e("span",[t._v("金额")]),e("span",{staticClass:"theme_font_red"},[t._v("￥"+t._s(t.payData.totalAmount.toFixed(2)))])])]),e("div",{staticClass:"btns"},[e("p",{staticClass:"btn cancel-btn",on:{click:function(a){t.showModal=!1}}},[t._v("否")]),e("p",{staticClass:"btn",on:{click:function(a){return t.payBill(t.payData)}}},[t._v("是")])])])]):t._e()],1)},n=[],i=e("5530"),o=(e("fb6a"),e("0d03"),e("ac1f"),e("5319"),e("5b7e"),e("6461")),c=e("75bd"),r=e("2f62"),l=e("5463"),d=e("3de7"),u={mixins:[d["a"]],data:function(){return{showModal:!1,payData:{},selectedPayWay:null}},created:function(){this.queryOrder()},computed:Object(i["a"])({isScan:function(){return"scan"==this.$route.query.enterPage}},Object(r["c"])({orderList:"oilPayOrderList"})),methods:{setPayWays:function(t){this.selectedPayWay=Object.assign({},t)},settleMobelAmount:function(t,a){var e=t||0,s=a||0;return e+s},payTypeStr:function(t){return c["a"].getPayWayStr(t)},cancelOrderHandler:function(t){var a=this;this.$dialog.confirm({message:"确定取消当前订单吗？"}).then((function(){a.cancelOrder(t)}))},cancelOrder:function(t){var a=this,e={token:this.$store.state.login.token,orderType:t.orderType,orderId:t.id},s="/app/json/refuel_center/cancelOrder";this.isScan&&(s="/app/json/refuel_scan_code/cancelOrder"),this.$http.post(s,e).then((function(t){var e=t.data;0==e.status?(a.$Toast("支付已取消"),a.queryOrder()):a.$Toast(e.info)}))},payOrder:function(t){var a=this;this.payData=t,this.showModal=!0,this.payData.payMode||this.$nextTick((function(){a.$refs.payModeRef.init(t.orderType.slice(0,t.orderType.length-3),t.storeOuCode)}))},queryOrder:function(){var t=this,a="/app/json/refuel_center/queryOrder";this.isScan&&(a="/app/json/refuel_scan_code/queryOrder"),this.$request.post(a,{state:1}).then((function(a){0===a.status?(t.$store.state.oilPayOrderList=a.data.orderList,0===a.data.orderList.length&&t.$router.go(-1)):t.$Toast("订单请求失败！")}))},payBill:function(t){var a=this,e=this.isScan?"refuelScanPayEvent":"refuelPayEvent",s=Object.assign({},t);t.payMode||(s=Object.assign({},s,this.selectedPayWay)),this.hasToPay=!0,this.payTime=(new Date).getTime(),c["a"][e](s,t.orderType,t.id).then((function(){a.resultHand("1",t)}))["catch"]((function(){a.resultHand("0",t)}))},resultHand:function(t,a){this.$Loading.close(),o["a"].addLog("支付结果",t?"成功":"失败"),"1"==t?this.$router.replace({path:this.isScan?"/firmScanDetail":"/firmDetail",query:{orderType:this.payData.orderType,orderId:this.payData.id,fromPage:1}}):this.cancelOrder(a)},formatTime:function(t){return this.$util.formatDate(new Date(t),"yyyy-MM-dd hh:mm:ss")}},components:{PayMode:l["a"]}},y=u,p=(e("a9c0"),e("0c7c")),f=Object(p["a"])(y,s,n,!1,null,"9eb9c59c",null);a["default"]=f.exports},a9c0:function(t,a,e){"use strict";e("d587")},d587:function(t,a,e){}}]);