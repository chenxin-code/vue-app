(window.webpackJsonp=window.webpackJsonp||[]).push([[780],{h9T4:function(t,s,e){"use strict";var a=e("zyl+");e.n(a).a},u8O5:function(t,s,e){"use strict";e.r(s);var a=e("p46w"),i=e.n(a),o=e("KJ3S"),n={name:"esh-qqjy",components:{},mixins:[e("A8ay").a],data:function(){return{jyCouponList:[]}},props:["myIndex","usePorpData","propData"],computed:{pageData:function(){return 1==this.usePorpData?this.propData:this.$store.state.pageData},moduleData:function(){return this.pageData.moduleList[this.myIndex].data},moduleType:function(){return 2==this.moduleData.styleType?"yjq":"jyq"}},methods:{hotEvent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.actionBtnEvent(this.pageData.pgCode,this.moduleData.idCode+t)},submitOrder:function(t){var s=this,e={},a=[{skuId:t.skuId,storeOuCode:t.storeOuCode,number:1,checked:1,isGift:0}],o="jyq"==this.moduleType?"/app/json/fee_life_order/submit":"/app/json/app_shopping_order/submit";e.deliveryType="2",e.virtualUserPhone=this.$store.state.userInfo.phone,e.orderScene=this.$util.orderScene(),e.carts=a,this.$Loading.open(),this.$http.post(o,e).then((function(t){s.$Loading.close();var e=t.data,a=e.data||{};if(0==e.status){var o;o=3==s.$store.state.webtype?{payMode:210,payModeSub:210005}:2==s.$store.state.webtype?{payMode:210,payModeSub:210002}:{payMode:305,payModeSub:305005},s.$market.payEvent(o,a.orderType,a.orderId).then((function(){i.a.set("icbc_tradeNo",a.tradeNo)})).catch((function(){s.$Toast("支付失败！")}))}else s.$Toast(e.info)}),(function(t){s.$Loading.close(),s.$Toast("请求数据失败！")}))},resultHand:function(t,s){this.$Loading.close(),"1"==t?this.$router.replace({path:"/icbc/success",query:{orderType:s.orderType,orderId:s.id,fromPage:1}}):this.$Toast("支付失败！")},buyCouponEvent:function(t){-1!=this.$store.state.webtype&&this.submitOrder(t)},couponDetailEvent:function(t){this.$market.customPush({path:"/icbc/coupondetail",query:{couponData:JSON.stringify(t)}})},getJYCouponList:function(){var t=this,s=this.$market.apiBaseURL()+"/app/json/product/getAppProSearchList",e={productType:"jyq"==this.moduleType?"513":"5",page:1,rows:20};if(this.moduleData.rows){for(var a=[],i=0;i<this.moduleData.rows.length;i++){var o=this.moduleData.rows[i];""!=o.skuId&&a.push(o.skuId)}a.length>0&&(e.skuIds=a)}e.area={provinceId:this.$store.state.indexData.provinceId,cityId:this.$store.state.indexData.cityId},this.$Loading.open(),this.$http.post(s,e).then((function(s){t.$Loading.close();var e=s.data;0===e.status?t.jyCouponList=e.data.list:t.$Toast(e.info)}),(function(s){t.$Loading.close(),t.$Toast("系统运行过程中遇到问题，请稍候再试")}))},getCouponStyle:function(){var t={};return this.moduleData.bgImgUrl&&(t.backgroundImage="url("+this.moduleData.bgImgUrl+")"),t}},created:function(){var t=this;this.getJYCouponList(),o.a.$on("refreshESHQQJY",(function(s){s==t.moduleData.idCode&&t.getJYCouponList()}))}},u=(e("h9T4"),e("KHd+")),c=Object(u.a)(n,(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"esh-qqjy"},["jyq"==t.moduleType&&t.jyCouponList.length>0?e("div",{staticClass:"jyq-div"},t._l(t.jyCouponList,(function(s,a){return e("div",{key:a,staticClass:"coupon",class:t.hotareaClass({idCode:t.moduleData.idCode+s.id}),on:{click:function(e){t.hotEvent(s.id),t.couponDetailEvent(s)}}},[e("div",{staticClass:"mianer"},[e("p",{staticClass:"big"},[t._v("加油券")]),t._v(" "),s.stockNum?e("p",{staticClass:"number"},[t._v("剩余"+t._s(s.stockNum>=100?"99+":s.stockNum)+"张")]):e("p",{staticClass:"number"},[t._v("剩余99+张")])]),t._v(" "),e("div",{staticClass:"cou-info"},[e("div",{staticClass:"cou-title double-line"},[t._v(t._s(s.showTitle))]),t._v(" "),e("div",{staticClass:"cou-time"},[t._v("有效期：180天")])]),t._v(" "),e("div",{staticClass:"right"},[e("div",{staticClass:"price"},[t._v("¥"+t._s(s.activityPrice))]),t._v(" "),e("div",{staticClass:"text"},[t._v("¥"+t._s(s.salePrice))]),t._v(" "),e("div",{staticClass:"btn",on:{click:function(e){return e.stopPropagation(),t.buyCouponEvent(s)}}},[t._v("立即购买")])])])})),0):t.jyCouponList.length>0?e("div",{staticClass:"yjq-container"},[e("div",{staticClass:"list"},t._l(t.jyCouponList,(function(s){return e("div",{staticClass:"coupon",style:t.getCouponStyle()},[e("div",{staticClass:"mianer"}),t._v(" "),e("div",{staticClass:"cou-info"},[e("div",{staticClass:"cou-title double-line"},[t._v(t._s(s.showTitle))]),t._v(" "),e("div",{staticClass:"cou-time"},[t._v("有效期至：90天")])]),t._v(" "),e("div",{staticClass:"right"},[e("div",{staticClass:"cou-discount"},[t._v("￥"+t._s(s.activityPrice))]),t._v(" "),e("div",{staticClass:"cou-original"},[t._v("￥"+t._s(s.salePrice))]),t._v(" "),e("div",{staticClass:"btn",on:{click:function(e){return e.stopPropagation(),t.buyCouponEvent(s)}}},[t._v("立即购买")])])])})),0)]):t._e()])}),[],!1,null,"beaaad1c",null);s.default=c.exports},"zyl+":function(t,s,e){}}]);