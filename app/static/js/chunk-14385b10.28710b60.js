(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-14385b10"],{"084c":function(t,e,i){"use strict";var a="/app/json/user_invoice_assistant/queryUserInvoiceHeadList",s="/app/json/user_invoice_assistant/queryInvoicedList",n="/app/json/user_invoice_assistant/queryInvoiceDetails",o="/app/json/user_invoice_assistant/addOrUpdateUserInvoiceHead",r="/app/json/user_invoice_assistant/deleteUserInvoiceHead",l="/app/json/user_invoice_assistant/setDefaultUserInvoiceHead",c="/app/json/user_invoice_assistant/searchInvoiceList",p="/app/json/user_invoice_assistant/queryUserInvoiceHeadDetails",u="/app/json/user_invoice_assistant/addInvoicing",d="/app/json/user_invoice_assistant/getResultFromQrcode",v="/app/json/user_invoice_assistant/queryDefaultTittle",h="/app/json/user_invoice_assistant/unInvoicingList",f="/app/json/user_invoice_assistant/queryUserInvoiceHeadDetails",b="/app/json/user_invoice_assistant/queryInvoicedList",_="/app/json/user_invoice_assistant/queryInvoiceDetails",j="/app/json/user_invoice_assistant/invoiceModifyMailbox",m="/app/json/user_invoice_assistant/orderInvoicingInMall",O="/app/json/user_invoice_assistant/gasCardInvoice",D="/app/json/refuel_center/queryOrder",y="/app/json/app_shopping_order/queryOrder",g="/app/json/user_invoice_assistant/queryCashIn",$="/app/json/user_invoice_assistant/sinopecWalletInvoiceList",k="/app/json/user_invoice_assistant/queryUserRefuelingCardInfoList",C="/app/json/user_invoice_assistant/queryConvenienceStoreOrder",T="/app/json/user_invoice_assistant/invoiceContentDetailsList",w="/app/json/user_invoice_assistant/invoiceContentDetails",I="/app/json/user_invoice_assistant/detailsOfInvoiceList",x="/app/json/app_shopping_order/detail",P="/app/json/user_invoice_assistant/convenienceStoredetail",q="/app/json/refuel_center/detail",L="/app/json/user_invoice_assistant/detailsOfInvoiceInfo",B="/app/json/card/getUserCardList",A="/app/json/news/getNewsList",E="/app/json/user_invoice_assistant/invoiceRushRed",N="/app/json/user_invoice_assistant/cashInInvoicing",S="/app/json/user_invoice_assistant/importUserInvoiceHead";e["a"]={methods:{exportinvoiceData:function(t){return this.$http.post(S,t)},golddetailData:function(t){return this.$http.post(L,t)},invoicetipData:function(t){return this.$http.post(A,t)},refundData:function(t){return this.$http.post(E,t)},cardMoData:function(t){return this.$http.post(B,t)},mingxiData:function(t){return this.$http.post(I,t)},malldetailData:function(t){return this.$http.post(x,t)},shopdetailData:function(t){return this.$http.post(P,t)},oildetailData:function(t){return this.$http.post(q,t)},hisdetailData:function(t){return this.$http.post(w,t)},hisData:function(t){return this.$http.post(T,t)},mallData:function(t){return this.$http.post(y,t)},storeData:function(t){return this.$http.post(C,t)},appData:function(t){return this.$http.post(D,t)},goldData:function(t){return this.$http.post(g,t)},walletData:function(t){return this.$http.post($,t)},cardData:function(t){return this.$http.post(k,t)},commitselfinvoiceData:function(t){return this.$http.post(m,t)},commitselfcardinvoiceData:function(t){return this.$http.post(O,t)},commitselfgoldinvoiceData:function(t){return this.$http.post(N,t)},emailData:function(t){return this.$http.post(j,t)},histroydetailData:function(t){return this.$http.post(_,t)},histroyData:function(t){return this.$http.post(b,t)},riseData:function(t){return this.$http.post(a,t)},openedData:function(t){return this.$http.post(s,t)},commitData:function(t){return this.$http.post(o,t)},delData:function(t){return this.$http.post(r,t)},morenData:function(t){return this.$http.post(l,t)},detailData:function(t){return this.$http.post(n,t)},souData:function(t){return this.$http.post(c,t)},soudetailData:function(t){return this.$http.post(p,t)},tijiaoData:function(t){return this.$http.post(u,t)},saoData:function(t){return this.$http.post(d,t)},morentitleData:function(t){return this.$http.post(v,t)},daikaiData:function(t){return this.$http.post(h,t)},chakanData:function(t){return this.$http.post(f,t)}}}},"4ba5":function(t,e,i){"use strict";i("cf6c")},"6fa8":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"body"},[i("nav-top",{attrs:{title:"开具发票"},on:{backEvent:function(e){return t.$router.go(-1)}}}),i("nav-content",[t.showPage?i("div",[i("div",{on:{click:t.close}},[i("div",{staticClass:"publicInvoice publicInvoice1"},[i("van-cell-group",[i("van-field",{attrs:{type:"tel",label:"订单号",disabled:""},model:{value:t.orderId,callback:function(e){t.orderId=e},expression:"orderId"}}),i("van-field",{attrs:{label:"金额",disabled:""},model:{value:t.amount,callback:function(e){t.amount=e},expression:"amount"}}),i("div",{staticClass:"publicInvoiceDiv"},[i("van-field",{staticClass:"nei",attrs:{label:"发票内容",disabled:""},model:{value:t.detail,callback:function(e){t.detail=e},expression:"detail"}}),i("div",{staticClass:"mingxi",on:{click:t.goDetail}},[i("span",[t._v("明细")]),i("span",{staticClass:"img iconfont mall-gengduojiantou"})])],1)],1)],1),i("div",{staticClass:"publicInvoice"},[4==t.typeObj.titleType?i("van-cell-group",{staticStyle:{position:"relative"}},[i("van-field",{staticClass:"paragraph",attrs:{label:"发票抬头",placeholder:"请输入发票抬头"},on:{input:t.monitor},model:{value:t.detailObj1.title,callback:function(e){t.$set(t.detailObj1,"title",e)},expression:"detailObj1.title"}}),i("div",{class:{divPut:1==t.dropDown,nothing:0==t.dropDown}},[i("div",{staticClass:"divPut1"}),i("div",{staticClass:"divPut2"},[i("ul",t._l(t.isText,(function(e,a){return t.dropDown?i("li",{on:{click:function(i){return t.detailData(e)}}},[t._v(t._s(e.title))]):t._e()})),0)])])],1):t._e(),5==t.typeObj.titleType?i("van-cell-group",{staticStyle:{position:"relative"}},[i("van-field",{staticClass:"paragraph",attrs:{label:"发票抬头",placeholder:"请输入发票抬头"},on:{input:t.monitor},model:{value:t.detailObj2.title,callback:function(e){t.$set(t.detailObj2,"title",e)},expression:"detailObj2.title"}}),i("div",{class:{divPut:1==t.dropDown,nothing:0==t.dropDown}},[i("div",{staticClass:"divPut1"}),i("div",{staticClass:"divPut2"},[i("ul",t._l(t.isText,(function(e,a){return t.dropDown?i("li",{on:{click:function(i){return t.detailData(e)}}},[t._v(t._s(e.title))]):t._e()})),0)])])],1):t._e(),i("van-radio-group",{model:{value:t.typeObj.titleType,callback:function(e){t.$set(t.typeObj,"titleType",e)},expression:"typeObj.titleType"}},[i("div",[t._v("抬头类型")]),i("van-radio",{attrs:{name:4,"checked-color":"#f44"}},[t._v("个人/非企业单位")]),i("van-radio",{attrs:{name:5,"checked-color":"#f44"}},[t._v("企业")])],1),i("div",[4==t.typeObj.titleType?i("div",[i("van-cell-group",[i("van-field",{attrs:{type:"tel",label:"电话号码",placeholder:"输入手机号"},model:{value:t.detailObj1.userPhone,callback:function(e){t.$set(t.detailObj1,"userPhone",e)},expression:"detailObj1.userPhone"}}),i("van-field",{attrs:{label:"电子邮箱",placeholder:"输入电子邮箱"},model:{value:t.detailObj1.userEmail,callback:function(e){t.$set(t.detailObj1,"userEmail",e)},expression:"detailObj1.userEmail"}})],1)],1):t._e(),5==t.typeObj.titleType?i("div",[i("van-cell-group",[i("van-field",{attrs:{label:"税号",placeholder:"请输入税号"},model:{value:t.detailObj2.orgTaxNo,callback:function(e){t.$set(t.detailObj2,"orgTaxNo",e)},expression:"detailObj2.orgTaxNo"}}),i("van-field",{attrs:{label:"电话号码",placeholder:"输入手机号"},model:{value:t.detailObj2.userPhone,callback:function(e){t.$set(t.detailObj2,"userPhone",e)},expression:"detailObj2.userPhone"}}),i("van-field",{attrs:{label:"电子邮箱",placeholder:"输入电子邮箱"},model:{value:t.detailObj2.userEmail,callback:function(e){t.$set(t.detailObj2,"userEmail",e)},expression:"detailObj2.userEmail"}}),i("van-field",{attrs:{label:"单位地址",placeholder:"选填"},model:{value:t.detailObj2.companyAddress,callback:function(e){t.$set(t.detailObj2,"companyAddress",e)},expression:"detailObj2.companyAddress"}}),i("van-field",{attrs:{label:"开户银行",placeholder:"选填"},model:{value:t.detailObj2.openingBank,callback:function(e){t.$set(t.detailObj2,"openingBank",e)},expression:"detailObj2.openingBank"}}),i("van-field",{attrs:{label:"银行账号",placeholder:"选填"},model:{value:t.detailObj2.bankAccount,callback:function(e){t.$set(t.detailObj2,"bankAccount",e)},expression:"detailObj2.bankAccount"}})],1)],1):t._e()])],1),1==t.showPaperticketButton?i("div",{staticClass:"open-paper-tickets",on:{click:t.openPaperTickets}},[i("span",[t._v("我要开纸票")])]):t._e(),i("div",{staticClass:"answer theme_bg_red",class:{active:t.isOpenTicket},on:{click:t.commit}},[t._v("申请开票")])])]):t._e(),i("van-popup",{staticClass:"detail-modal",model:{value:t.detailData1,callback:function(e){t.detailData1=e},expression:"detailData1"}},[i("div",{staticClass:"detail-modal-content"},[i("div",{staticClass:"div1"},[i("span",[t._v("订单号")]),i("span",[t._v(t._s(t.orderId))])]),i("div",{staticClass:"div1"},[i("span",[t._v("油站")]),i("span",[t._v(t._s(t.storeOuName))])]),i("div",{staticClass:"div1"},[i("span",[t._v("开票金额")]),i("span",[t._v(t._s(t.invoiceDetail.nrecAmount))])]),i("div",{staticClass:"div1"},[i("span",[t._v("商品明细")]),i("span",[t._v(t._s(t.invoiceDetail.skuName))])]),i("div",{staticClass:"div1"},[i("span",[t._v("商品单价")]),i("span",[t._v(t._s(t.invoiceDetail.price))])]),i("div",{staticClass:"div1"},[i("span",[t._v("订单金额")]),i("span",[t._v(t._s(t.invoiceDetail.payAmount))])]),i("div",{staticClass:"div1"},[i("span",[t._v("支付明细")]),i("span",[t._v(t._s(t.invoiceDetail.payModeName))])]),i("div",{staticClass:"closeBtn",on:{click:t.closeDetail}},[i("i",{staticClass:"iconfont mall-guanbi"})])])])],1)],1)},s=[],n=(i("e7e5"),i("d399")),o=(i("0d03"),i("4795"),i("fb6a"),i("084c")),r=(i("17cc"),{name:"invoicing",mixins:[o["a"]],data:function(){return{radio:"5",checked:!0,amount:"",orderId:"",detail:"",companyAddress:"",userEmail:"",orgTaxNo:"",title:"",openingBank:"",userPhone:"",bankAccount:"",showPage:!0,typeObj:{titleType:5},detailData1:!1,people:!1,paramsData:{},open:"",ouCode:"",orderType:"",dropDown:!1,isText:[],idDetail:"",detailObj1:{titleType:4},detailObj2:{titleType:5},vals:"",qrCode:"",stationOuCode:"",storeOuName:"",invoiceDetail:{},list:{},isShow:"",showPaperticketButton:-1,isOpenTicket:!1}},created:function(){var t=this;t.qrCode=t.$route.query.StationInvoice},mounted:function(){this.sweepDetail(),this.defaultTitle()},methods:{openPaperTickets:function(){var t=this;this.$request.post("/app/json/user_invoice_assistant/unLockInvoiceMark",{storeBranchOrgOuCode:this.list.stationOuCode,shoppingOrderId:this.list.orderId,storeStandCode:this.list.ouCode,refuelRecordId:this.list.orderId}).then((function(e){0==e.status?t.$Toast(e.info?e.info:"开票成功"):t.$Toast(e.info?e.info:"获取我的拼团失败")}))},showPaperticketsBtn:function(t){var e=this;this.$request.post("/app/json/user_invoice_assistant/querShowPaperticketButton",{storeOuCode:t.order.storeOuCode}).then((function(t){0==t.status?1==t.data&&1==e.isShow?e.showPaperticketButton=1:e.showPaperticketButton=-1:e.$Toast(t.info)}))},dateCompare:function(t,e){var i=new Date(e),a=new Date(i.getTime()+18e5);return t.valueOf()>a.valueOf()?-1:t.valueOf()<a.valueOf()?1:void 0},close:function(){this.dropDown=!1},closeDetail:function(){this.detailData1=!1},goDetail:function(){this.detailData1=!0},detailData:function(t){var e=this;4==t.titleType?e.detailObj1=t:5==t.titleType&&(e.detailObj2=t)},monitor:function(t){var e=this;t&&this.throttle((function(){var i={token:e.$store.state.login.token,title:t};e.souData(i).then((function(t){t.data.data.length>0?(e.isText=t.data.data,e.dropDown=!0):e.dropDown=!1}))}),500)()},throttle:function(t,e){var i=this;return function(){for(var a=arguments.length,s=new Array(a),n=0;n<a;n++)s[n]=arguments[n];i.timer&&clearTimeout(i.timer),i.timer=setTimeout((function(){t.apply(i,s)}),e)}},commit:function(){var t=this;if(0==this.isOpenTicket){var e=this,i={};if(4==e.typeObj.titleType?(e.detailObj1.titleType=4,Object.assign(i,e.detailObj1)):5==e.typeObj.titleType&&(e.detailObj2.titleType=5,Object.assign(i,e.detailObj2)),!i.title)return void Object(n["a"])({message:"请输入发票抬头",duration:2e3});if(!i.userEmail&&!i.userPhone)return void Object(n["a"])({message:"请输入邮箱或者手机号",duration:2e3});if(i.userPhone&&!/^1(3|4|5|7|8|9)\d{9}$/.test(i.userPhone))return void Object(n["a"])({message:"请输入正确的手机号",duration:2e3});var a=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;if(i.userEmail&&!a.test(i.userEmail))return void Object(n["a"])({message:"请输入正确的邮箱",duration:2e3});if(5==i.titleType&&!i.orgTaxNo)return void Object(n["a"])({message:"请输入税号",duration:2e3});this.$Loading.open(),e.tijiaoData({token:this.$store.state.login.token,userInvoiceHeadModel:i,stationInvoiceQrcodeModel:e.list}).then((function(e){t.$Loading.close(),"success"===e.data.result?(t.isOpenTicket=!0,n["a"].success("开票成功")):Object(n["a"])(e.data.info)}))}else n["a"].success("已开票")},sweepDetail:function(){var t=this,e=this,i={token:this.$store.state.login.token,qrcode:e.qrCode};e.saoData(i).then((function(i){var a=i.data.data||{};if(e.state=a.state,0===a.state){if(e.list=a,e.orderId=a.stationOrder.orderId,e.amount=a.stationOrder.nrecAmount,e.storeOuCode=a.stationOrder.storeOuCode,e.orderType=a.orderType,e.ouCode=a.ouCode,e.stationOuCode=a.stationOuCode,e.storeOuName=a.stationOrder.storeOuName,1==t.$store.state.globalConfig.papertickets){var s=a.order.cashRefuelingRecordModelList[0].transactionTime,n=s.slice(0,4)+"-"+s.slice(4,6)+"-"+s.slice(6,8)+" "+s.slice(8,10)+":"+s.slice(10,12)+":"+s.slice(12,14);t.isShow=t.dateCompare(new Date,n),t.showPaperticketsBtn(a)}a.stationOrder&&(t.invoiceDetail=t.$assign({},a.stationOrder.itemList[0],a.stationOrder.payList[0]))}else(1===a.state||2===a.state)&&e.$router.push({name:"invalid",params:{state:e.state}})}))},defaultTitle:function(){var t=this,e={token:this.$store.state.login.token};t.morentitleData(e).then((function(e){var i=e.data.data||{};i.titleType?t.typeObj.titleType=e.data.data.titleType:t.typeObj.titleType=5,4==t.typeObj.titleType?t.detailObj1=i:5==t.typeObj.titleType&&(t.detailObj2=i)}))}}}),l=r,c=(i("4ba5"),i("0c7c")),p=Object(c["a"])(l,a,s,!1,null,"be896b8c",null);e["default"]=p.exports},cf6c:function(t,e,i){}}]);