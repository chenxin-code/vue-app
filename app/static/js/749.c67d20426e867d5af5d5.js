(window.webpackJsonp=window.webpackJsonp||[]).push([[749],{TaML:function(t,e,s){"use strict";var o=s("d453");s.n(o).a},YcId:function(t,e,s){"use strict";s.r(e);var o={name:"",data:function(){return{wxShopCartList:[],lastPath:""}},mounted:function(){this.code=this.$route.query.code,this.storeOuCode=this.$route.query.storeOuCode;var t=localStorage.getItem("historyPros");this.wxShopCartList=t?JSON.parse(t):[],this.getProDetail()},created:function(){this.lastPath=this.$route.query.lastPath?this.$route.query.lastPath:""},methods:{deleteEvent:function(t){var e=this;this.$dialog.confirm({message:"确定删除此商品吗？",confirmButtonColor:"#F80F16"}).then((function(){for(var s=0;s<e.wxShopCartList.length;s++)if(e.wxShopCartList[s].skuId==t.skuId){e.wxShopCartList.splice(s,1);break}window.localStorage.setItem("historyPros",JSON.stringify(e.wxShopCartList))}))},numChange:function(t){for(var e=0;e<this.wxShopCartList.length;e++){var s=this.wxShopCartList[e];if(s.skuId==t.skuId){s.number=t.number;break}}this.setHistoryPros()},getProDetail:function(){var t=this,e={token:this.$store.state.login.token,barcode:this.code,pickupStoreOuCode:this.storeOuCode};this.$Loading.open(),this.$http.post("/app/json/product/getAppProDetail",e).then((function(e){t.$Loading.close();var s=e.data;if(0==s.status){var o=s.data||{},i=t.$mallCommon.priceFromItem(o);o.dpedData=i;for(var r=o.skuId,a=!1,n=0;n<t.wxShopCartList.length;n++){var c=t.wxShopCartList[n];if(c.skuId==r){a=!0,c.number+=1;break}}a||(o.number=1,t.wxShopCartList.push(o)),t.setHistoryPros()}else t.$Toast(s.info)}),(function(e){t.$Loading.close(),t.$Toast("请求数据失败！")}))},shopping:function(){var t=this;this.$bridgefunc.scanCode((function(e){1==t.$store.state.webtype?t.code=e.code:t.code=e.code.split(",")[1],t.getProDetail()}))},shoppingCart:function(){this.$router.push({path:"/mall2/scanbuyplaceorder",query:{storeoucode:this.$route.query.storeOuCode,pickupId:this.$route.query.pickupId}})},back:function(){this.$router.back()},setHistoryPros:function(){var t=this,e=[];window.localStorage.setItem("historyPros",JSON.stringify(this.wxShopCartList)),this.wxShopCartList.forEach((function(s){e.push({skuId:s.skuId,number:s.number,checked:1,storeOuCode:t.storeOuCode})})),window.localStorage.setItem("historyPros",JSON.stringify(e))}},beforeRouteLeave:function(t,e,s){t.path==this.lastPath&&(window.localStorage.removeItem("historyPros"),this.$keepaliveHelper.deleteCache(this)),s()},activated:function(){var t=localStorage.getItem("historyPros");this.wxShopCartList=t?JSON.parse(t):[]},components:{PriceOrder:s("WQzh").a}},i=(s("TaML"),s("KHd+")),r=Object(i.a)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("nav-top",{on:{backEvent:function(e){return t.back()}}}),t._v(" "),s("nav-content",[t.wxShopCartList.length?s("ul",{staticClass:"pro-list"},t._l(t.wxShopCartList,(function(e,o){return s("li",{key:o,staticClass:"pro-item"},[s("div",{staticClass:"pro-item-content"},[s("img",{staticClass:"pro-img",attrs:{src:e.phMainUrl,alt:""}}),t._v(" "),s("div",{staticClass:"pro-info"},[s("div",{staticClass:"pro-name single-line",domProps:{innerHTML:t._s(e.showTitle)}}),t._v(" "),s("div",{staticClass:"pro-price-wrapper"},[s("div",{staticClass:"pro-price"},[s("PriceOrder",{attrs:{scanProduct:e}})],1),t._v(" "),s("div",{staticClass:"input-number"},[s("van-stepper",{attrs:{min:e.saleNumBegin,max:e.saleNumMax,step:e.saleNumStep,integer:""},on:{change:function(s){return t.numChange(e)}},model:{value:e.number,callback:function(s){t.$set(e,"number",s)},expression:"item.number"}})],1)]),t._v(" "),s("div",{staticClass:"delete-btn",attrs:{slot:"right"},on:{click:function(s){return t.deleteEvent(e)}},slot:"right"},[s("van-icon",{staticClass:"icon",attrs:{name:"delete"}})],1)])])])})),0):t._e(),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0==t.wxShopCartList.length,expression:"wxShopCartList.length == 0"}],staticClass:"no-data"},[t._v("购物车竟然是空的，请选购商品吧")]),t._v(" "),s("div",{staticClass:"btn-group"},[s("div",{staticClass:"btn left-btn",on:{click:t.shopping}},[t._v("继续购物")]),t._v(" "),s("div",{staticClass:"btn right-btn",on:{click:t.shoppingCart}},[t._v("前往购物车")])])])],1)}),[],!1,null,"1799a6f5",null);e.default=r.exports},d453:function(t,e,s){}}]);