(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dc866248"],{"02c7":function(t,e,a){"use strict";a("59d0")},"45c9":function(t,e,a){"use strict";a("c07d")},"59d0":function(t,e,a){},a770:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"index"}},[a("mt-header",{attrs:{title:"加油卡绑定"}},[a("mt-button",{attrs:{slot:"left",icon:"back"},on:{click:t.backEvent},slot:"left"})],1),a("div",{staticClass:"conter"},[a("p",{staticClass:"ma-top"}),a("div",{staticClass:"input"},[a("ul",{staticClass:"inputnumber"},[a("li",{staticClass:"cardnoTitle"},[t._v("加油卡号")]),a("li",{staticClass:"cardnoLi"},[t._v(t._s(t.noprefix))]),a("li",{staticClass:"cardnoInput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.number,expression:"number"}],attrs:{type:"number",placeholder:"请输入卡号后11位"},domProps:{value:t.number},on:{input:function(e){e.target.composing||(t.number=e.target.value)}}})])]),a("mt-field",{attrs:{label:"手机号码",placeholder:"请输入手机号",disabled:"",type:"tel"},model:{value:t.Member,callback:function(e){t.Member=e},expression:"Member"}}),a("mt-field",{attrs:{label:"手机验证码",attr:{maxlength:6},placeholder:"请输入短信验证码",type:"type"},model:{value:t.validate,callback:function(e){t.validate=e},expression:"validate"}},[a("input",{staticClass:"fl-right",style:{background:"#fff",fontSize:"12px",color:"获取验证码"===t.obtain?"#f02c2c":"#ccc"},attrs:{type:"button",value:t.obtain,disabled:t.disabled},on:{click:t.countdown}})]),a("mt-field",{attrs:{label:"推荐人",placeholder:"请输入推荐人（选填）"},on:{input:t.changeRfrCodeType},model:{value:t.referee,callback:function(e){t.referee=e},expression:"referee"}},[a("img",{attrs:{src:"static/image/fuelcard//btn_Sweep.png",width:"25",height:"25"},on:{click:t.sweep}})]),a("p",{staticClass:"btn",on:{click:t.renders}},[t._v("提交")]),a("p",{staticClass:"bind-unit-card",on:{click:t.gobindUnitCard}},[t._v("单位加油卡绑定>")])],1),t.cardPrompt?a("div",{staticClass:"card-prompt"},[a("h3",{staticClass:"title"},[t._v("温馨提示：")]),a("div",{staticClass:"content",domProps:{innerHTML:t._s(t.cardPrompt)}})]):t._e()])],1)},i=[],s=(a("0d03"),a("4795"),a("76a0")),o={data:function(){return{number:"",phone:"",validate:"",referee:"",obtain:"获取验证码",disabled:!1,Member:"",prohibit:!1,noprefix:"",theScanCode:"",inway:"",lastPath:"",newList:"",cardPrompt:""}},mounted:function(){this.getphone(),this.recommenderHistory()},created:function(){this.showagreement(),this.inway=this.$route.query.inway?this.$route.query.inway:"",this.lastPath=this.$route.query.lastPath?this.$route.query.lastPath:"",this.rfrCodeType=1;var t=this.$store.state.mall2.behalf.referrerInvalidDate;if(t&&void 0!=t&&""!=t){var e=new Date(t).getTime(),a=(new Date).getTime();e>=a&&(this.referee=this.$store.state.mall2.behalf.referrer)}else this.referee=this.$store.state.mall2.behalf.referrer},methods:{gobindUnitCard:function(){this.$router.push({path:"/bindUnitCard"})},showagreement:function(){var t=this;this.$request.post("/app/json/news/getNewsList",{values:24}).then((function(e){0==e.status&&(t.cardPrompt=e.data[0]?e.data[0].content:"")}))},backEvent:function(){this.$router.go(-1)},jiami:function(t){return t.substr(0,4)+"****"+t.substr(-4)},changeRfrCodeType:function(){this.rfrCodeType=1},sweep:function(){var t=this;this.$bridgefunc.scanCode((function(e){t.rfrCodeType=2,t.theScanCode=e.code,t.referee=e.code}))},countdown:function(){var t=this,e=this,a=this,n=60;function i(){if(0==n)return e.disabled=!1,e.obtain="获取验证码",n=60,!1;e.disabled=!0,e.obtain="重新发送("+n+")",n--,setTimeout((function(){i()}),1e3)}var o=/^[0-9]{11}$/;o.test(this.number)?this.$request.post("/app/json/card/checkCardHasBind",{cardno:this.noprefix+this.number}).then((function(e){if(0==e.status){t.$Loading.open();var n="/app/json/message/sendVerifyBindCardSms";t.$http.post(n,{token:a.$store.state.login.token,phone:t.phone,cardno:t.noprefix+t.number}).then((function(t){a.$Loading.close(),"error"===t.data.result?Object(s["Toast"])(t.data.info):(Object(s["Toast"])("获取验证码成功"),i())}))}else t.$Toast(e.info)})):Object(s["Toast"])("请输入正确卡号")},renders:function(){var t=this;this.referee==this.theScanCode?this.rfrCodeType=2:this.rfrCodeType=1;var e=/^[0-9]{11}$/;if(e.test(this.number))if(""!==this.validate){this.$Loading.open();var a=this,n="/app/json/card/bindCard";this.$http.post(n,{token:a.$store.state.login.token,cardno:this.noprefix+this.number,smscode:this.validate,referrer:this.referee,bindway:3,rfrCodeType:this.rfrCodeType}).then((function(e){a.$Loading.close(),-1!==e.data.status?0===e.data.status&&t.$router.go(-1):Object(s["Toast"])(e.data.info)}))}else Object(s["Toast"])("请输入正确短信验证码");else Object(s["Toast"])("请输入正确卡号")},getphone:function(){var t=this;this.$Loading.open();var e=this,a="/app/json/card/getcardnopre";this.$http.post(a,{token:e.$store.state.login.token}).then((function(a){e.$Loading.close(),t.phone=a.data.data.phone,t.noprefix=a.data.data.noprefix,t.Member=t.phone}))},getNewsList:function(){var t=this;this.$Loading.open();var e=this,a="/app/json/news/getNewsList";this.$http.post(a,{token:e.$store.state.login.token,values:21}).then((function(a){e.$Loading.close(),t.newList=a.data.data[0]}))},recommenderHistory:function(){this.$Loading.open();var t=this,e="/app/json/card/getBindCardReferrer";this.$http.post(e,{token:t.$store.state.login.token}).then((function(e){t.$Loading.close(),e.data.data?(t.referee=e.data.data?e.data.data:"",t.prohibit=!0):t.prohibit=!1}))}}},r=o,c=(a("45c9"),a("02c7"),a("0c7c")),d=Object(c["a"])(r,n,i,!1,null,"19194d42",null);e["default"]=d.exports},c07d:function(t,e,a){}}]);