(window.webpackJsonp=window.webpackJsonp||[]).push([[485],{"+Urn":function(t,e,s){t.exports=s.p+"static/img/p1.24b66ca.png"},"/sXR":function(t,e,s){},KRXD:function(t,e,s){t.exports=s.p+"static/img/bg.4cc4f6e.png"},t5JH:function(t,e,s){"use strict";s.r(e),s("4X9F");var a=s("IkEG"),i=s("ygAv"),o=(s("p46w"),{data:function(){return{tabList:[{text:"套餐说明",type:1},{text:"我的邀约",type:2}],active:!0,dropmenuShow:!1,oilRecordList:[],cut:"",myHomeInfo:"",newsList:"",oilOpen:!1,complete:!1,oilState:"",isOverdue:!1,alreadyDue:!1,isUpgrade:!0,oilId:"",state:"",showOpen:!1,myInviteList:[],rebate:[],ruleDesc:"",renewalInfo:"",bgImgList:""}},mounted:function(){this.queryMyHomeInfo(),this.showagreement(),this.getNewsList(),this.getAcctInfoList()},methods:{getNewsList:function(){var t=this;this.$request.post("/app/json/news/getNewsList",{values:47}).then((function(e){0==e.status?t.bgImgList=e.data[0]?e.data[0].content:"":t.$Toast(e.info?e.info:"获取获取内容中心失败")}))},cancelClickBtn:function(){this.dropmenuShow=!1,this.tabList.forEach((function(t){t.showClick=!1}))},queryMyHomeInfo:function(){var t=this;this.$request.post("/app/json/app_package_refuel/queryMyHomeInfo",{}).then((function(e){if(0===e.status){t.myHomeInfo=e.data;var s="";t.myHomeInfo?(t.state=t.dealState(t.myHomeInfo.orderModel.state,t.myHomeInfo.orderModel.startDate,t.myHomeInfo.orderModel.endDate),1==t.myHomeInfo.orderModel.packageType?s=t.myHomeInfo.orderDetailModelList[0].packageRefuelOrderId:(console.log("userId"),t.myHomeInfo.orderDetailModelList.forEach((function(t){"INVITER"==t.joinType&&(s=t.packageRefuelOrderId,console.log(s))}))),t.ruleDesc=JSON.parse(t.myHomeInfo.orderModel.ruleDesc)||{},t.dealRebate(t.ruleDesc.sumRebate,t.myHomeInfo.orderModel.sumOilLiter||0),console.log("ruleDesc"),console.log(t.ruleDesc),t.queryPackageRefuelOrderRecord(s),t.isOverdue=t.overdueDeal(),t.isOverdue&&t.queryRenewalInfo(),"签约中"==t.state||"未开始"==t.state?(t.showOpen=!0,t.complete=!0):("已结束"==t.state||"已结算"==t.state||"已取消"==t.state||"待签约"==t.state&&2==t.myHomeInfo.orderModel.packageType)&&(t.showOpen=!1,t.complete=!0)):t.queryMyInviteList()}else t.$Toast(e.info?e.info:"获取列表失败")}))},queryMyInviteList:function(){var t=this;this.$request.post("/app/json/app_package_refuel/queryMyInviteList",{}).then((function(e){if(0===e.status)if(t.cut=e.data.length,t.myInviteList=e.data,t.myInviteList.length){var s=[],a="",i=[];if(t.myInviteList.forEach((function(e){"待签约"==(a=t.dealState(e.state,e.startDate,e.endDate))&&i.push(e),s.push(a)})),s.every(t.sourceState))for(var o=0;o<i.length;o++)console.log(t.timeJudge(i[o].startDate.split(" ")[0])),-1!=t.timeJudge(i[o].startDate.split(" ")[0])?t.$router.push({path:"/invitation-details",query:{id:i[o].packageRefuelOrderId,joinType:i[o].joinType}}):(t.showOpen=!1,t.complete=!0);else t.showOpen=!1,t.complete=!0}else t.showOpen=!1,t.complete=!0;else t.$Toast(e.info?e.info:"获取列表失败")}))},queryRenewalInfo:function(){var t=this;this.$request.post("/app/json/app_package_refuel/queryRenewalInfo",{}).then((function(e){0===e.status?(t.renewalInfo=e.data,t.renewalInfo&&t.renewalInfo.orderModel.id!=t.myHomeInfo.orderModel.id&&(t.isOverdue=!1,t.alreadyDue=!0)):t.$Toast(e.info?e.info:"获取续签信息失败")}))},timeJudge:function(t){var e=i.a.getMyDate(new Date),s=new Date(t),a=new Date(s.getTime()+2592e5);return i.a.dateCompare(e,i.a.getPreTime(a.getTime()).split(" ")[0])},sourceState:function(t){return"待签约"==t},dealDiffData:function(t){var e=this,s="";return 1==this.myHomeInfo.orderModel.packageType||3==this.myHomeInfo.orderModel.packageType?1==t?this.myHomeInfo.orderDetailModelList[0].sumOilLiter||"0":2==t?this.myHomeInfo.orderDetailModelList[0].sumRebate||"0":this.myHomeInfo.orderDetailModelList[0].sumAmount||"0.00":(this.myHomeInfo.orderDetailModelList.forEach((function(a){console.log(e.$store.state.mall2.behalf.userId),a.userId==e.$store.state.mall2.behalf.userId&&(s=1==t?a.sumOilLiter?a.sumOilLiter:"0":2==t?a.sumRebate||"0":a.sumAmount||"0.00")})),s)},getAcctInfoList:function(){var t=this;this.$request.post("/app/json/app_youdi/getAcctInfoList",{}).then((function(e){0===e.status?(t.oilState=e.data||[],console.log(t.oilState),(t.oilState.length&&0===t.oilState.state||!t.oilState.length)&&(t.oilOpen=!0)):t.$Toast(e.info?e.info:"获取油滴账户信息失败")}))},queryPackageRefuelOrderRecord:function(t){var e=this;this.oilId=t,this.$request.post("/app/json/app_package_refuel/queryPackageRefuelOrderRecord",{packageRefuelOrderId:t}).then((function(t){0===t.status?e.oilRecordList=t.data:e.$Toast(t.info?t.info:"获取列表失败")}))},dealState:function(t,e,s){var a=i.a.getMyDate(new Date);if("WAIT_SIGN_UP"==t)return"待签约";if("SIGNED_UP"==t){var o=i.a.dateCompare(a,e.split(" ")[0]),n=i.a.dateCompare(a,s.split(" ")[0]);return 1==o?"未开始":0!=o&&-1!=o||1!=n&&0!=n?"已结束":"签约中"}return"SETTLED"==t?"已结算":"CANCELED"==t?"已取消":void 0},overdueDeal:function(){var t=i.a.getMyDate(new Date),e=this.myHomeInfo.orderModel.endDate.split(" ")[0],s=i.a.getAfterWeek(e).split(" ")[0];return i.a.isDateBetween(t,s,e)},dealRebate:function(t,e){for(var s=[].concat(t).sort((function(t,e){return t.oilLiter-e.oilLiter})),a=[],i=0;i<s.length-1;i++){var o=s[i],n=s[i+1];if(o.oilLiter<=e&&e<n.oilLiter){a.push(o),a.push(n);break}if(i===s.length-2&&e>=n.oilLiter){a.push(n);break}}this.rebate=a},overdue:function(){this.$router.push({path:"/package-change",query:{overdueDate:this.myHomeInfo.orderModel.endDate}})},showagreement:function(){var t=this;this.$request.post("/app/json/news/getNewsList",{values:35}).then((function(e){0==e.status?t.newsList=e.data[0]?e.data[0].content:"":t.$Toast(e.info?e.info:"获取获取内容中心失败")}))},openOil:function(){window.location.href="/app-vue/oildrop"},dealTime:function(t,e){return t.split(" ")[0]+"~"+e.split(" ")[0]},linkTo:function(t){1==t.type?this.$router.push({path:"/instructions"}):2==t.type?this.$router.push({path:"/my-invitation"}):this.$router.push({path:"/history-invitation"})},openInfo:function(){this.$router.push({path:"/instructions"})},changeBtn:function(){this.oilState.length?0==this.oilState.state?this.$Toast("您还未开通油滴套餐，请前往开通吧!"):2==this.oilState.state?this.$Toast("您的油滴账号已被冻结，无法开通套餐!"):4==this.oilState.state?this.$Toast("您的油滴账号已被锁定，无法开通套餐!"):this.$router.push({path:"/package-change"}):this.$Toast("您还未开通油滴套餐，请前往开通吧!")},openRecord:function(){this.$router.push({path:"/oil-record",query:{id:this.oilId,packageType:this.myHomeInfo.orderModel.packageType}})},exitPackage:function(){var t=this;a.a.confirm({title:"提示",message:"退出套餐后再次加入，返利比例将会按最低返利档次重新计算，是否确认退出？",confirmButtonText:"不了，我再想想",cancelButtonText:"确定我要退出"}).then((function(){console.log("不会退出套餐")})).catch((function(){t.$request.post("/app/json/app_package_refuel/quitPackageOrder",{id:t.myHomeInfo.orderModel.id}).then((function(e){0==e.status?(t.$Toast("退出套餐成功"),t.queryMyHomeInfo()):t.$Toast(e.info?e.info:"退出套餐失败")}))}))},dealNum:function(t,e){return((100*t-100*e)/100).toFixed(2)}},components:{}}),n=(s("x0zz"),s("KHd+")),l=Object(n.a)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.complete?a("div",{staticClass:"oil-package",on:{click:t.cancelClickBtn}},[a("nav-top",{attrs:{title:"油滴套餐"},on:{backEvent:function(e){return t.$router.go(-1)}}},[0!=t.cut?a("div",{staticClass:"tips icon-tips"},[t._v(t._s(t.cut))]):t._e(),t._v(" "),a("i",{staticClass:"iconfont mall-gengduo",on:{click:function(e){e.stopPropagation(),t.dropmenuShow=!t.dropmenuShow}}})]),t._v(" "),t.showOpen?a("nav-content",{staticClass:"oil-package-container open"},[a("div",{staticClass:"content"},[t.isOverdue?a("div",{staticClass:"title-tips"},[a("div",{staticClass:"text"},[t._v("您的套餐即将过期")]),t._v(" "),a("div",{staticClass:"btn",on:{click:t.overdue}},[t._v("点此续签")])]):t._e(),t._v(" "),t.alreadyDue?a("div",{staticClass:"already"},[a("div",{staticClass:"top"},[a("span",{staticClass:"over-due-tips"},[t._v("已续签")]),t._v(" "),a("span",{staticClass:"text"},[t._v(t._s(t.renewalInfo.orderModel.packageRefuelName+"("+t.renewalInfo.orderModel.duration+"天)"))])]),t._v(" "),a("div",{staticClass:"bottom"},[t._v("生效日期："+t._s(""+t.renewalInfo.orderModel.startDate))])]):t._e(),t._v(" "),a("div",{staticClass:"title-info"},[a("div",{staticClass:"info"},[a("div",{staticClass:"title-name"},[a("div",{staticClass:"left"},[t._v(t._s(t.myHomeInfo.orderModel.packageRefuelName)+"  "+t._s(t.myHomeInfo.orderModel.duration)+"天")]),t._v(" "),a("div",{staticClass:"right"},[t._v(t._s(t.state))])]),t._v(" "),a("div",{staticClass:"text"},[t._v("套餐开始时间："+t._s(t.myHomeInfo.orderModel.startDate))]),t._v(" "),a("div",{staticClass:"text"},[t._v("套餐结束时间："+t._s(t.myHomeInfo.orderModel.endDate))]),t._v(" "),1==t.ruleDesc.rebateType?a("div",[t.rebate.length>1?a("div",{staticClass:"special"},[t._v("\n              您当前再加"+t._s(t.dealNum(t.rebate[1].oilLiter,this.myHomeInfo.orderModel.sumOilLiter||0))+"升油即可升级返利档次。\n            ")]):t._e()]):a("div",[t.rebate.length&&3==t.myHomeInfo.orderModel.packageType?a("div",{staticClass:"special"},[t._v("\n              您当前加油单笔即时返利为"+t._s(t.rebate[0].rebate)+"%"),1!=t.rebate.length?a("span",[t._v(",再加"+t._s(t.dealNum(t.rebate[1].oilLiter,this.myHomeInfo.orderModel.sumOilLiter||0))+"升，即可升级实时返利比例至"+t._s(t.rebate[1].rebate)+"%。")]):t._e()]):t._e(),t._v(" "),t.rebate.length&&3!=t.myHomeInfo.orderModel.packageType?a("div",{staticClass:"special"},[t._v("\n              您当前加油单笔即时返利为"+t._s(t.ruleDesc.baseRebate)+"%,套餐到期后的补返比例为"+t._s(t.rebate[0].rebate)+"%"),1!=t.rebate.length?a("span",[t._v(",再加"+t._s(t.dealNum(t.rebate[1].oilLiter,this.myHomeInfo.orderModel.sumOilLiter||0))+"升，即可升级累计补返比例至"+t._s(t.rebate[1].rebate)+"%。")]):t._e()]):t._e()])])]),t._v(" "),2==t.myHomeInfo.orderModel.packageType?a("div",{staticClass:"statistical"},[a("div",{staticClass:"title"},[t._v("套餐加油统计")]),t._v(" "),a("ul",{staticClass:"list"},[a("li",{staticClass:"item"},[a("div",{staticClass:"oil-info"},[a("div",{staticClass:"name"},[t._v("加油升数")]),t._v(" "),a("div",{staticClass:"num"},[t._v(t._s(t.myHomeInfo.orderModel.sumOilLiter||"0"))])]),t._v(" "),a("div",{staticClass:"oil-info middle"},[a("div",{staticClass:"name"},[t._v("实时返利金额")]),t._v(" "),a("div",{staticClass:"num"},[t._v(t._s(t.myHomeInfo.orderModel.rebate||"0"))])]),t._v(" "),a("div",{staticClass:"oil-info"},[a("div",{staticClass:"name"},[t._v("加油金额")]),t._v(" "),a("div",{staticClass:"num"},[t._v(t._s(t.myHomeInfo.orderModel.sumAmount||"0.00"))])])])])]):t._e(),t._v(" "),a("div",{staticClass:"statistical"},[a("div",{staticClass:"title"},[t._v("个人加油统计")]),t._v(" "),a("ul",{staticClass:"list"},[a("li",{staticClass:"item"},[a("div",{staticClass:"oil-info"},[a("div",{staticClass:"name"},[t._v("加油升数")]),t._v(" "),a("div",{staticClass:"num"},[t._v(t._s(t.dealDiffData(1)))])]),t._v(" "),a("div",{staticClass:"oil-info middle"},[a("div",{staticClass:"name"},[t._v("实时返利金额")]),t._v(" "),a("div",{staticClass:"num"},[t._v(t._s(t.dealDiffData(2)))])]),t._v(" "),a("div",{staticClass:"oil-info"},[a("div",{staticClass:"name"},[t._v("加油金额")]),t._v(" "),a("div",{staticClass:"num"},[t._v(t._s(t.dealDiffData(3)))])])])])]),t._v(" "),2==t.myHomeInfo.orderModel.packageType?a("div",{staticClass:"title"},[t._v("个人加油明细")]):1==t.myHomeInfo.orderModel.packageType?a("div",{staticClass:"title"},[t._v("加油明细")]):a("div",{staticClass:"title"},[t._v("返利明细")])]),t._v(" "),a("ul",{staticClass:"details-list"},[t._l(t.oilRecordList,(function(e,s){return s<5?a("li",{key:s,staticClass:"details-item"},[a("div",{staticClass:"info"},[a("div",{staticClass:"name"},[t._v("订单号")]),t._v(" "),a("div",{staticClass:"details-text"},[t._v(t._s(e.orderNo))])]),t._v(" "),a("div",{staticClass:"info"},[a("div",{staticClass:"name"},[t._v("加油时间")]),t._v(" "),a("div",{staticClass:"details-text"},[t._v(t._s(e.tradeTime))])]),t._v(" "),a("div",{staticClass:"info"},[a("div",{staticClass:"name"},[t._v("加油升数")]),t._v(" "),a("div",{staticClass:"details-text"},[t._v(t._s(e.oilLiter||"0"))])]),t._v(" "),a("div",{staticClass:"info"},[a("div",{staticClass:"name"},[t._v("加油金额")]),t._v(" "),a("div",{staticClass:"details-text"},[t._v(t._s(e.amount||"0.00"))])]),t._v(" "),a("div",{staticClass:"info"},[a("div",{staticClass:"name"},[t._v("实时返利金额")]),t._v(" "),a("div",{staticClass:"details-text"},[t._v(t._s(e.rebate||"0"))])])]):t._e()})),t._v(" "),0==t.oilRecordList.length?a("div",{staticClass:"no-data"},[a("div",{staticClass:"img"},[a("img",{attrs:{src:s("+Urn"),alt:""}})]),t._v(" "),a("div",{staticClass:"text"},[t._v("暂无数据")])]):t._e(),t._v(" "),a("div",{staticClass:"more-btn"},[t.oilRecordList.length>5?a("div",{staticClass:"seeMore",on:{click:t.openRecord}},[t._v("查看更多加油记录")]):t._e(),t._v(" "),t.oilRecordList.length>5&&(3==t.myHomeInfo.orderModel.packageType||1==t.myHomeInfo.orderModel.packageType||2==t.myHomeInfo.orderModel.packageType)?a("div",[t._v(" | ")]):t._e(),t._v(" "),3==t.myHomeInfo.orderModel.packageType||1==t.myHomeInfo.orderModel.packageType||2==t.myHomeInfo.orderModel.packageType?a("div",{staticClass:"icon-right",on:{click:t.exitPackage}},[t._v("退出套餐")]):t._e()])],2),t._v(" "),a("div",{staticClass:"tab"},t._l(t.tabList,(function(e,s){return a("div",{key:s,staticClass:"item"},[a("div",{staticClass:"text",on:{click:function(s){return t.linkTo(e)}}},[t._v(t._s(e.text.substr(0,2))),a("br"),t._v(t._s(e.text.substr(2,2)))])])})),0)]):a("nav-content",{staticClass:"oil-package-container "},[a("div",{staticClass:"no-open"},[t.bgImgList?a("div",{staticClass:"bg-img",domProps:{innerHTML:t._s(t.bgImgList)}}):a("div",{staticClass:"bg-img"},[a("img",{attrs:{src:s("KRXD"),alt:""}})]),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"main-info"},[t.oilOpen?a("div",{staticClass:"oil-open-tips",on:{click:t.openOil}},[t._v("开通套餐需要开通油滴账户，点击"),a("span",{staticClass:"oil-text"},[t._v("开通油滴")]),t._v("前往开通\n          ")]):t._e(),t._v(" "),a("div",{staticClass:"news",domProps:{innerHTML:t._s(t.newsList)},on:{click:t.openInfo}})]),t._v(" "),a("div",{staticClass:"open-btn",on:{click:t.changeBtn}},[a("div",{staticClass:"left"}),t._v(" "),a("div",{staticClass:"center"},[t._v("申请开通")]),t._v(" "),a("div",{staticClass:"right"})])]),t._v(" "),a("div",{staticClass:"tab"},t._l(t.tabList,(function(e,s){return 0==s?a("div",{key:s,staticClass:"item"},[a("div",{staticClass:"text",on:{click:function(s){return t.linkTo(e)}}},[t._v(t._s(e.text.substr(0,2))),a("br"),t._v(t._s(e.text.substr(2,2))+"\n          ")])]):t._e()})),0)])])],1):t._e()}),[],!1,null,"3c2f1be4",null);e.default=l.exports},x0zz:function(t,e,s){"use strict";var a=s("/sXR");s.n(a).a}}]);