(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c85e5b00"],{"0d67":function(t,e,a){},a898:function(t,e,a){"use strict";a("0d67")},e94b:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ad-page"},[a("nav-top",{attrs:{title:"优惠码"},on:{backEvent:function(e){return t.$router.go(-1)}}}),a("nav-content",[a("div",{staticClass:"code"},[a("div",{staticClass:"top"},[a("span",[t._v(t._s(t.detailInfo.title)+" "+t._s(t.detailInfo.oilNo))])]),a("div",{staticClass:"top"},[a("span",[t._v("优惠码：")]),a("span",[t._v(t._s(t.code))])]),a("canvas",{attrs:{id:"barcode"}}),a("div",{staticClass:"number"},[t._v(t._s(t.number))]),a("canvas",{attrs:{id:"qrcode"}})])])],1)},n=[],i=(a("e17f"),a("2241")),s=(a("4795"),a("a9e3"),a("62c5")),c=a.n(s),r=a("d055"),u=a.n(r),d={name:"ad-page",components:{},data:function(){return{code:"",item:"",number:"",flag:!0,timeer:"",timeer2:"",timeVouc:"",detailInfo:{}}},methods:{getStatus:function(){var t=this,e="/platform/json/coupon/getHjyusedcoustate",a={},o=this;this.$http.post(e,a).then((function(e){0==e.data.status&&("0"==e.data.data?(t.getDetail(),t.timeer2=setInterval((function(){t.getDetail()}),6e4)):(clearInterval(t.timeer2),o.$Bridgefunc.customGo(-2)))}))},getDetail:function(){var t=this,e="/platform/json/coupon/getHjyCoupons";this.$Loading.open();var a=this;this.$http.post(e,this.item).then((function(e){if(t.$Loading.close(),0===e.data.status){var o=e.data.data;o&&(t.code=o.couNo,t.getCode(o.voucher))}else 1001==e.data.errorCode?i["a"].alert({title:"",message:e.data.info}).then((function(){a.$Bridgefunc.customGo(-1)})):a.$Toast({message:e.data.info,position:"bottom",duration:1e3})}))["catch"]((function(e){t.$Loading.close(),t.$Toast({message:"请求失败",position:"bottom",duration:2e3})}))},getCode:function(t){var e=this,a="/platform/json/coupon/getHjycheckcode",o={"hjyCouponReqModel.voucher":t,isJsonData:!0};this.checkVouchers(t),this.timeVouc=setInterval((function(){e.checkVouchers(t)}),1e3),this.$http.post(a,o).then((function(t){0===t.data.status&&e.$nextTick((function(){e.createBar(t.data.data)}))}))},createBar:function(t){this.number=t;var e=document.getElementById("barcode");c()(e,t,{displayValue:!1,fontSize:16});var a=document.getElementById("qrcode");u.a.toCanvas(a,t,(function(t){}))},checkVouchers:function(t){var e=this,a="/platform/json/coupon/gethjyCouponState",o={token:this.$store.state.login.token||"",voucher:t,isJsonData:!0};this.$http.post(a,o).then((function(a){var o=a.data;0===o.status?0===Number(o.data)||(e.detailInfo.currentTime=o.currentTime,clearInterval(e.timeer2),clearInterval(e.timeVouc),e.$bridgefunc.customPush({path:"/hkpayDetail",query:{getGame:1===Number(o.data),voucher:encodeURIComponent(JSON.stringify(t)),detailInfo:encodeURIComponent(JSON.stringify(e.detailInfo))}})):e.$Toast(a.data.info)}))["catch"]((function(t){e.$Toast("请求失败")}))}},created:function(){this.getStatus(),this.item=JSON.parse(decodeURIComponent(this.$route.query.item)),this.detailInfo=JSON.parse(decodeURIComponent(this.$route.query.detailInfo))},destroyed:function(){clearInterval(this.timeer2),clearInterval(this.timeVouc)}},l=d,h=(a("a898"),a("0c7c")),f=Object(h["a"])(l,o,n,!1,null,"10338fb9",null);e["default"]=f.exports}}]);