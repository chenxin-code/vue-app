(window.webpackJsonp=window.webpackJsonp||[]).push([[162],{"4PfF":function(t,e,i){"use strict";var n=i("7HVa");i.n(n).a},"7HVa":function(t,e,i){},CHo7:function(t,e,i){},F9re:function(t,e,i){},cnNK:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAABTUlEQVRIS73Uvy5FQRDH8e+v0SoRCYlKo9GJF7ghCpVKxSNolZ5ColPphAKJCCFqjdpTiJCMTLI32dzYe87+ObY/+zkzv9kRjY+ZzQALkj6mXa2WrpmtA1fAPHAs6SR1fzM4oPfAbMBeJW0MCv+BGrAn6WIwOIHuSzofLONS1H+oOOMatBiuRYvgFmg23ArNghPooaSzkiXUa7hao70qNrM14CnaSL4ciisdd2dqxQF9i1rZBO2s2Mwcis9BaaaTc9BV8SS8KemlZJhy4VXgPfroE9iS9FCLd061ma0Aj8BiwL6AUS3eCTtmZsvAc0u8FzwE3htujWfBEe6ZL0WZ70i6yxm4bDjgPmj+rMb4N7CdgxfBLfBiOMK97f7k/PSuvAoO+Fxoe4zvSrqelnk1nMB/Qua3KbwJnMBvJI0GhyP8FPAdfyTp8l/gnHf8C8iaph82lunDAAAAAElFTkSuQmCC"},eL3i:function(t,e,i){"use strict";var n=i("CHo7");i.n(n).a},k5RN:function(t,e,i){"use strict";var n=i("F9re");i.n(n).a},n6X0:function(t,e,i){"use strict";i.r(e);var n=i("dqDD"),s=i("tfLl"),a={name:"",props:["pageData"],components:{},data:function(){return{paySlected:0}},methods:{testFunc:function(){console.log("testFunc")},payModeSlected:function(t){this.paySlected=t},bottomClick:function(t){"0"==t?this.dismiss():(console.log("test",this.pageData.payModes[this.paySlected]),this.$emit("heightSlect",this.pageData.payModes[this.paySlected]))},dismiss:function(){this.$emit("dismiss")}},created:function(){console.log("data",this.pageData)}},o=(i("eL3i"),i("KHd+")),c=Object(o.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"bottom",on:{scroll:function(t){t.stopPropagation()},click:t.dismiss}},[i("div",{staticClass:"content"},[t.pageData.payModes?i("div",{staticClass:"content-item"},[i("div",{staticClass:"item-title"},[t._v("支付方式：")]),t._v(" "),i("div",{staticClass:"item-detail"},t._l(t.pageData.payModes,(function(e,n){return i("span",{key:n,class:n===t.paySlected?"slected-span":"span",on:{click:function(e){return e.stopPropagation(),t.payModeSlected(n)}}},[t._v(t._s(e.channelInfo))])})),0)]):t._e(),t._v(" "),i("div",{staticClass:"content-bottom"},[i("span",{staticClass:"left-span",on:{click:function(e){return t.bottomClick("0")}}},[t._v("取消")]),t._v(" "),i("span",{staticClass:"right-span",on:{click:function(e){return t.bottomClick("1")}}},[t._v("确定")])])])])}),[],!1,null,"46d67730",null).exports,r={name:"mine-card-record",components:{PullTo:PullTo,Toast:n.Toast,Navigation:s.a,hightSlectedPage:c},data:function(){return{topHeight:0,tag:0,paySlected:0,slectedData:{},finishedOrder:[],unFinishedOrder:null,hightSlected:!1,pageNum:"1",pageSize:"10",finishOptionDefault:{queryType:"0",channelType:"",pageNum:"1",pageSize:"10",startDate:"",endDate:""},finishQueryOption:{}}},methods:{lookInvoice:function(t){Object(n.Toast)({message:"请到电子发票>我的发票查看",position:"bottom",duration:2e3})},getMore:function(t){this.pageNum=(parseInt(this.pageNum)+1).toString(),this.finishQueryOption.pageNum=this.pageNum;var e=this;this.queryFinishOrder().then((function(i){i.forEach((function(t){e.finishedOrder.push(t)})),t("done")})).catch((function(){t("fail")}))},refresh:function(t){this.pageNum=1,this.finishQueryOption.pageNum=this.pageNum;var e=this;this.queryFinishOrder().then((function(i){e.finishedOrder=i,t("done")})).catch((function(){t("fail")}))},rightClick:function(){console.log("data1",this.slectedData),this.hightSlected=!0},backEvent:function(){this.$bridgefunc.customGo(-1)},queryPayModeList:function(){var t=this;this.$http.post("/app/json/refuel/getRefuelChannels",{token:this.$store.state.login.token}).then((function(e){var i=e.data;0==i.status?t.slectedData.payModes=i.data:Object(n.Toast)({message:i.info?i.info:"",position:"bottom",duration:2e3})}),(function(e){t.$Loading.close(),Object(n.Toast)({message:"",position:"bottom",duration:2e3})}))},queryUnFinishOrder:function(){var t={token:this.$store.state.login.token},e=this;this.$http.post("/app/json/refuel/queryRefuelRecords",t).then((function(t){e.$Loading.close();var i=t.data;0==i.status?e.unFinishedOrder=i.data:Object(n.Toast)({message:i.info?i.info:"",position:"bottom",duration:2e3})}),(function(t){e.$Loading.close(),Object(n.Toast)({message:"",position:"bottom",duration:2e3})}))},queryFinishOrder:function(){var t=this,e=this;return new Promise((function(i,s){e.$Loading.open();var a={token:e.$store.state.login.token,queryType:e.finishQueryOption.queryType,channelType:e.finishQueryOption.channelType,pageNum:e.finishQueryOption.pageNum,pageSize:e.finishQueryOption.pageSize,startDate:e.finishQueryOption.startDate,endDate:e.finishQueryOption.endDate};t.$http.post("/app/json/refuel/queryFinishedRecord",a).then((function(t){e.$Loading.close();var a=t.data;0==a.status?i(a.data):(Object(n.Toast)({message:a.info?a.info:"消费记录查询失败",position:"bottom",duration:2e3}),s())}),(function(t){e.$Loading.close(),Object(n.Toast)({message:"消费记录查询失败",position:"bottom",duration:2e3}),s()}))}))},payModeSlected:function(t){this.paySlected=t},slectOrder:function(t){},openInvoice:function(t){var e={type:"00",record:this.finishedOrder[t]},i=this;this.$bridgefunc.vuexStorage((function(){i.$bridgefunc.customPush({path:"/selectinvoice",isnativetop:"1",query:{fPContentMessage:encodeURIComponent(JSON.stringify(e))}})}))},checkFp:function(t){return"110"==t.channel||"908"==t.channel?t.invoiceNo.length>0?"02":"01":"907"==t.channel&&"1"==t.remark.split("-")[1]?t.invoiceNo.length>0?"02":"01":"00"},hightDismiss:function(){this.hightSlected=!1},heightSlect:function(t){this.hightSlected=!1,this.finishQueryOption=this.finishOptionDefault,this.finishQueryOption.channelType=t.channelCode,this.finishQueryOption.queryType="1";var e=this;this.queryFinishOrder().then((function(t){e.finishedOrder=t}))}},mounted:function(){var t=this;this.$bridgefunc.registePageShow((function(){t.queryFinishOrder().then((function(e){t.finishedOrder=e}))}))},created:function(){this.topHeight=this.$store.state.barHeight+this.$market.getNavHeight();var t=this;this.finishQueryOption=this.finishOptionDefault,this.queryFinishOrder().then((function(e){t.finishedOrder=e})),this.queryPayModeList(),this.queryUnFinishOrder()},computed:{}},h=(i("4PfF"),Object(o.a)(r,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"oil-order_background"},[i("Navigation",{attrs:{title:"加油记录",hasBack:"1",rightText:"筛选"},on:{backEvent:t.backEvent,rightClick:t.rightClick}}),t._v(" "),i("div",{staticClass:"content_div",style:{marginTop:t.topHeight+"px"}},[t._m(0),t._v(" "),t.unFinishedOrder?i("div",{staticClass:"content-item unFinished"},[i("ul",{staticClass:"ul"},t._l(t.unFinishedOrder,(function(e,n){return i("li",{key:n,staticClass:"li"},[i("div",{staticClass:"li-item"},[i("span",{staticClass:"item-left"},[i("span",[t._v("订单号：")]),t._v(" "),i("span",[t._v(t._s(e.orderNo))])]),t._v(" "),i("span",{staticClass:"item-right item-top"},[t._v("￥"+t._s(e.payAmount))])]),t._v(" "),i("div",{staticClass:"li-item"},[i("span",{staticClass:"item-left"},[t._v(t._s(e.createTime))]),t._v(" "),i("span",{staticClass:"item-right item-bottom"},[t._v("开具发票")])])])})),0)]):t._e(),t._v(" "),i("div",{staticClass:"content-item finished"},[i("pull-to",{staticClass:"pullTo",attrs:{"bottom-load-method":t.getMore,"top-load-method":t.refresh}},[i("ul",{staticClass:"ul"},t._l(t.finishedOrder,(function(e,n){return i("li",{key:n,staticClass:"li",on:{click:function(e){return t.slectOrder(n)}}},[i("div",{staticClass:"li-item"},[i("span",{staticClass:"item-left"},[i("span",[t._v("订单号：")]),t._v(" "),i("span",[t._v(t._s(e.orderNo))])]),t._v(" "),i("span",{staticClass:"item-right item-top"},[t._v("￥"+t._s(e.payAmount))])]),t._v(" "),i("div",{staticClass:"li-item"},[i("span",{staticClass:"item-left"},[t._v(t._s(e.createTime))]),t._v(" "),"00"==t.checkFp(e)?i("span",{staticClass:"item-right item-bottom notHelp"},[t._v("不支持")]):t._e(),t._v(" "),"01"==t.checkFp(e)?i("span",{staticClass:"item-right item-bottom",on:{click:function(e){return t.openInvoice(n)}}},[t._v("开具发票")]):t._e(),t._v(" "),"02"==t.checkFp(e)?i("span",{staticClass:"item-right item-bottom openSuccess",on:{click:function(i){return t.lookInvoice(e)}}},[t._v("已开发票")]):t._e()])])})),0)])],1),t._v(" "),t.hightSlected&&t.slectedData?i("hight-slected-page",{style:{top:t.topHeight+"px"},attrs:{pageData:t.slectedData},on:{dismiss:t.hightDismiss,heightSlect:t.heightSlect}}):t._e()],1)],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"content-item top"},[e("span",{staticClass:"title"},[this._v("全部订单")]),this._v(" "),e("img",{staticClass:"img",attrs:{src:"static/image/refuel/calendar.png"}})])}],!1,null,"afbb7b8c",null));e.default=h.exports},tfLl:function(t,e,i){"use strict";var n=(i("k5RN"),i("KHd+")),s=Object(n.a)({name:"",props:["title","hasBack"],data:function(){return{}},methods:{backEvent:function(){this.$emit("backEvent","")},getTotalHeight:function(){return"height:"+(this.$store.state.barHeight+this.$market.getNavHeight())+"px;"}},created:function(){}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"navigation",style:t.getTotalHeight()},[n("div",{staticClass:"navigation-content",style:{top:this.$store.state.barHeight+"px"}},["1"==t.hasBack?n("div",{staticClass:"back-div",on:{click:function(e){return t.backEvent()}}},[n("img",{staticClass:"back-img",attrs:{src:i("cnNK")}})]):t._e(),t._v(" "),n("div",{staticClass:"page-title"},[t._v(t._s(t.title))])])])}),[],!1,null,"2a7ccb57",null);e.a=s.exports}}]);