(window.webpackJsonp=window.webpackJsonp||[]).push([[969],{BcbB:function(t,i,e){"use strict";var s=e("rstr");e.n(s).a},rstr:function(t,i,e){},yUXF:function(t,i,e){"use strict";e.r(i);var s=e("ygAv"),a={data:function(){return{oilNum:"",currentIndex:-1,currentIndexPay:-1,payType:["待支付","已完成","已取消"],oilList:[],refuelTankOilNoList:[],oil:"",payTypeList:["商品付款"],tabActive:0,time:"本月",showTime:!1,currentYear:(new Date).getFullYear(),currentMonth:(new Date).getMonth()+1,currentDate:new Date,orderList:[],page:0,skuNames:"",hasMore:!0,loading:!1,phone:"14031312323",dateFrom:"",state:[],showScreening:!1}},mounted:function(){this.dateFrom=s.a.getDealMonthFrom(this.currentYear,this.currentMonth),this.getPayBill(),this.getDictByAlias(),this.getDictByAliasGoods()},methods:{getDictByAliasGoods:function(){var t=this;this.$Loading.open();var i={token:this.$store.state.login.token,alias:"shoppingScanCodeProductPayType"};this.$http.post("/app/json/app_dict/getDictByAlias",i).then((function(i){var e=i.data;t.$Loading.close(),0==e.status?t.payTypeList=e.data:t.$Toast(e.info),t.complete=!0}))},getDictByAlias:function(){var t=this;this.$Loading.open();var i={token:this.$store.state.login.token,alias:"MatertialCode"};this.$http.post("/app/json/app_dict/getDictByAlias",i).then((function(i){var e=i.data;t.$Loading.close(),0==e.status?t.oilList=e.data||[]:t.$Toast(e.info),t.complete=!0}))},resetBtn:function(){this.currentIndex=-1,this.currentIndexPay=-1,this.state=[],this.oil="",this.showScreening=!1,this.getPayBill()},confirmBtn:function(){this.orderList=[],this.oilNum=0,this.getPayBill(),this.showScreening=!1},tabChange:function(t,i){this.currentIndex=t,this.skuNames=i.dictKey,console.log(this.oil)},tabChangePay:function(t,i){this.currentIndexPay=t,this.state=0==t?1:1==t?3:[7,8]},changeTab:function(t,i){this.skuNames="",this.state="",this.orderList=[],this.oilNum=0,this.getPayBill()},confirmDate:function(t){this.currentYear=new Date(this.currentDate).getFullYear(),this.currentMonth=new Date(this.currentDate).getMonth()+1,this.dateFrom=s.a.getDealMonthFrom(this.currentYear,this.currentMonth),this.showTime=!1,this.orderList=[],this.getPayBill()},formatter:function(t,i){return"year"===t?i+"年":"month"===t?i+"月":i},getPayBill:function(){var t=this;this.page++,this.loading=!0,this.$Loading.open(),this.oil&&this.refuelTankOilNoList.push(this.oil);var i="/app/json/app_employee/queryRefuelOrder";1==this.tabActive&&(i="/app/json/app_employee/queryShoppingScanOrder");var e={token:this.$store.state.login.token,refuelTakeDate:this.dateFrom.start+"TO"+this.dateFrom.end,rows:12,skuNames:this.skuNames,page:this.page,state:this.state};this.$http.post(i,e).then((function(i){var e=i.data;if(0==e.status){var s=e.data.orderList||[];if(t.orderList=t.orderList.concat(s),t.page<e.data.page.totalPages?t.loading=!1:t.hasMore=!1,t.orderList.length){var a=0;t.orderList.forEach((function(t){a+=Number(t.payAmount)})),t.oilNum=a}}else t.$Toast(e.info);t.$Loading.close()}))},toDetail:function(t,i){this.$router.push({path:"/offline_payment/oil_record_details",query:{detail:JSON.stringify(t),source:this.tabActive}})},formatState:function(t){var i="";return 1==t?i="待支付":3==t?i="已支付":7!=t&&8!=t||(i="已取消"),i}},components:{}},n=(e("BcbB"),e("KHd+")),o=Object(n.a)(a,(function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"offline-payment-record"},[e("nav-top",{attrs:{title:"离线支付记录"},on:{backEvent:function(i){return t.$router.go(-1)}}}),t._v(" "),e("nav-content",{staticClass:"offline-payment-record-content"},[e("div",{staticClass:"content"},[e("van-tabs",{staticClass:"tabs",on:{change:t.changeTab},model:{value:t.tabActive,callback:function(i){t.tabActive=i},expression:"tabActive"}},[e("van-tab",{attrs:{title:"加油交易记录"}}),t._v(" "),e("van-tab",{attrs:{title:"非油交易记录"}})],1),t._v(" "),e("div",{staticClass:"screening"},[e("div",{staticClass:"top"},[e("div",{staticClass:"filter-btn",on:{click:function(i){t.showTime=!0}}},[e("div",{staticClass:"time"},[t._v(t._s(t.currentYear)+"年"+t._s(t.currentMonth)+"月")]),t._v(" "),e("i",{staticClass:"icon iconfont mall-arrow-down",class:{active:t.showTime}})]),t._v(" "),e("div",{staticClass:"filter-btn",on:{click:function(i){t.showScreening=!0}}},[e("div",{staticClass:"time"},[t._v("筛选")]),t._v(" "),e("i",{staticClass:"icon iconfont mall-arrow-down",class:{active:t.showTime}})])]),t._v(" "),e("div",{staticClass:"bottom"},[e("span",{staticClass:"title"},[t._v(t._s("0"==t.tabActive?"加油总金额":"非油交易总金额"))]),t._v(" "),e("span",{staticClass:"num"},[t._v("￥"+t._s(t.oilNum?t.oilNum.toFixed(2):"0.00"))])])])],1),t._v(" "),e("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.getPayBill,expression:"getPayBill"}],staticClass:"order-list",attrs:{"infinite-scroll-disabled":"loading","infinite-scroll-immediate-check":!0,"infinite-scroll-distance":"20"}},[t._l(t.orderList,(function(i,s){return e("div",{key:s,staticClass:"order-item",on:{click:function(e){return t.repayDetail(i)}}},[e("div",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v(t._s(i.submitTime))]),t._v(" "),e("span",{staticClass:"con"},[t._v(t._s(t.formatState(i.state)))])]),t._v(" "),e("div",{staticClass:"item special"},[e("span",{staticClass:"label"},[t._v(t._s(i.refuelCashierName))])]),t._v(" "),e("div",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v(t._s(t.$market.dealPhone(t.phone)))]),t._v(" "),""!==i.payAmount||void 0!==i.payAmount?e("span",{staticClass:"con theme_font_red money-special"},[t._v("￥23")]):t._e()]),t._v(" "),e("div",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v(t._s(i.refuelOilName))])]),t._v(" "),e("div",{staticClass:"item pay-btn special"},[e("div",[e("div",{staticClass:"con wait-pay again",on:{click:function(e){return e.stopPropagation(),t.toDetail(i)}}},[t._v("查看详情")])])])])})),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.hasMore,expression:"!hasMore"}],staticClass:"no-data theme_font_tint"},[t._v("没有更多数据了~")])],2),t._v(" "),e("van-popup",{attrs:{position:"bottom"},model:{value:t.showTime,callback:function(i){t.showTime=i},expression:"showTime"}},[e("van-datetime-picker",{attrs:{type:"year-month",formatter:t.formatter},on:{confirm:t.confirmDate,cancel:function(i){t.showTime=!1}},model:{value:t.currentDate,callback:function(i){t.currentDate=i},expression:"currentDate"}})],1),t._v(" "),e("van-popup",{attrs:{position:"bottom"},model:{value:t.showScreening,callback:function(i){t.showScreening=i},expression:"showScreening"}},[e("div",{staticClass:"screen-content"},[e("div",{staticClass:"content"},[t._e(),t._v(" "),1==t.tabActive?e("div",{staticClass:"screen"},[e("div",{staticClass:"title"},[t._v("商品付款类型")]),t._v(" "),e("ul",{staticClass:"oil-list"},t._l(t.payTypeList,(function(i,s){return 0==s?e("li",{staticClass:"oil-item"},[e("div",{staticClass:"oil",class:{active:t.currentIndex===s},on:{click:function(e){return t.tabChange(s,i)}}},[t._v(t._s(i.dictValue)+"\n                ")])]):t._e()})),0)]):t._e(),t._v(" "),e("div",{staticClass:"screen"},[e("div",{staticClass:"title"},[t._v("支付状态")]),t._v(" "),e("ul",{staticClass:"oil-list special"},t._l(t.payType,(function(i,s){return e("li",{staticClass:"oil-item"},[e("div",{staticClass:"oil",class:{active:t.currentIndexPay===s},on:{click:function(e){return t.tabChangePay(s,i)}}},[t._v("\n                  "+t._s(i)+"\n                ")])])})),0)])]),t._v(" "),e("div",{staticClass:"btn-group"},[e("div",{staticClass:"btn-item",on:{click:t.resetBtn}},[t._v("重置")]),t._v(" "),e("div",{staticClass:"btn-item",on:{click:t.confirmBtn}},[t._v("确定")])])])])],1)],1)}),[],!1,null,"489357c3",null);i.default=o.exports}}]);