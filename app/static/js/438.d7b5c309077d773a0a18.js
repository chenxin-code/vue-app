(window.webpackJsonp=window.webpackJsonp||[]).push([[438],{"CG+W":function(t,e,o){"use strict";var n,r=o("0FX9"),i=(n=o.n(r).a.toCanvas,function(){var t=Array.prototype.slice.call(arguments);return new Promise((function(e,o){t.push((function(t,n){t?o(t):e(n)})),n.apply(null,t)}))}),a=function(t,e){var o=document.createElement("canvas");return i(o,t,e).then((function(){return o.width}))},s=function(t){return t.length>36?"M":t.length>16?"Q":"H"},c=function(t){var e=t.canvas,o=(t.content,t.logo);if(o){var n=e.width,r=o.logoSize,i=void 0===r?.15:r,a=o.borderColor,s=o.bgColor,c=void 0===s?a||"#ffffff":s,u=o.borderSize,l=void 0===u?.05:u,f=o.crossOrigin,v=o.borderRadius,g=void 0===v?8:v,m=o.logoRadius,h=void 0===m?0:m,y="string"==typeof o?o:o.src,C=n*i,p=n*(1-i)/2,b=n*(i+l),q=n*(1-i-l)/2,w=e.getContext("2d");d(w)(q,q,b,b,g),w.fillStyle=c,w.fill();var I=new Image;return(f||h)&&I.setAttribute("crossOrigin",f||"anonymous"),I.src=y,new Promise((function(t,e){I.onload=function(){h?function(t){var e=document.createElement("canvas");e.width=p+C,e.height=p+C,e.getContext("2d").drawImage(t,p,p,C,C),d(w)(p,p,C,C,h),w.fillStyle=w.createPattern(e,"no-repeat"),w.fill()}(I):function(t){w.drawImage(t,p,p,C,C)}(I),t()}}))}},d=function(t){return function(e,o,n,r,i){var a=Math.min(n,r);return i>a/2&&(i=a/2),t.beginPath(),t.moveTo(e+i,o),t.arcTo(e+n,o,e+n,o+r,i),t.arcTo(e+n,o+r,e,o+r,i),t.arcTo(e,o+r,e,o,i),t.arcTo(e,o,e+n,o,i),t.closePath(),t}},u=function(t){return function(t){var e=t.canvas,o=t.content,n=t.width,r=void 0===n?0:n,c=t.nodeQrCodeOptions,d=void 0===c?{}:c;return d.errorCorrectionLevel=d.errorCorrectionLevel||s(o),a(o,d).then((function(t){return d.scale=0===r?void 0:r/t*4,i(e,o,d)}))}(t).then((function(){return t})).then(c)},l={toCanvas:u,toImage:function(t){var e=document.createElement("canvas");return t.canvas=e,t.logo&&("string"==typeof t.logo&&(t.logo={src:t.logo}),t.logo.crossOrigin="Anonymous"),u(t).then((function(){var o=t.image,n=void 0===o?new Image:o,r=t.downloadName,i=void 0===r?"qr-code":r,a=t.download;n.src=e.toDataURL(),(!0===a||"function"==typeof a)&&(a=!0===a?function(t){return t()}:a)((function(){!function(t,e){var o=t.src,n=document.createElement("a");n.download=e,n.href=o,document.body.appendChild(n),n.click(),document.body.removeChild(n)}(n,i)}))}))}};e.a=l},Ctyn:function(t,e,o){"use strict";var n=o("ZToj");e.a=function(t){var e=void 0;return"海南省"==n.a.state.globalConfig.province&&(e="hainan"),e?"static/enterpriseImg/"+e+"/"+t:null}},H0xM:function(t,e,o){},Uy9X:function(t,e,o){"use strict";o.r(e);var n=o("CG+W"),r=o("YsXA"),i=o.n(r),a=o("Ctyn"),s=o("2nGb"),c={data:function(){return{myTimeout:null,myInfo:{}}},mounted:function(){this.getMycode()},methods:{refreshBtn:function(){this.getMycode()},getMycode:function(){var t=this;this.$Loading.open();var e={token:this.$store.state.login.token};this.$http.post("/app/json/user/queryQrCodeInfo",e).then((function(e){t.$Loading.close();var o=e.data;0==o.status?(t.myInfo=o.data,t.$nextTick((function(){t.$route.query.isToRegiste||t.$route.query.isPreRegiste?t.toCanvas():t.myInfo.qrCodeWithAppDownload?t.createQRCode(t.myInfo.qrCodeWithAppDownload):t.toCanvas(),t.myTimeout&&(clearTimeout(t.myTimeout),t.myTimeout=null),t.myTimeout=setTimeout((function(){t.getMycode()}),18e4)}))):t.$Toast(o.info)}),(function(e){t.$Loading.close(),console.log("获取我的电子券",e)}))},toCanvas:function(){if("2"!=this.$store.state.globalConfig.user_qrCode_type){var t=document.getElementById("barcode");i()(t,this.myInfo.qrCode,{displayValue:!1})}if("1"!=this.$store.state.globalConfig.user_qrCode_type){var e=document.getElementById("qrcode");e.getContext("2d").clearRect(0,0,e.width,e.height);var o=""+this.$store.state.globalConfig.wxBaseUrl+s.a.shareUrl+"/usercenter/downloadshare",n=this.myInfo.qrCode;this.$route.query.isToRegiste&&(o=""+this.$store.state.globalConfig.wxBaseUrl+s.a.shareUrl+"/usercenter/loginbindqrcode",n=this.myInfo.qrCode),this.$route.query.isPreRegiste&&(o=""+this.$store.state.globalConfig.wxBaseUrl+s.a.shareUrl+"/usercenter/preregistration",n=this.myInfo.userNo),this.getShort(o,n)}},createQRCode:function(t){if("2"!=this.$store.state.globalConfig.user_qrCode_type){var e=document.getElementById("barcode");i()(e,this.myInfo.qrCode,{displayValue:!1})}if("1"!=this.$store.state.globalConfig.user_qrCode_type){var o={canvas:document.getElementById("qrcode"),content:t,width:140,nodeQrCodeOptions:{margin:0}},r=Object(a.a)("qr-logo.png");r&&(o.logo={src:r}),n.a.toCanvas(o)}}},destroyed:function(){this.myTimeout&&(clearTimeout(this.myTimeout),this.myTimeout=null)},components:{}},d=(o("hz8Q"),o("KHd+")),u=Object(d.a)(c,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"handle-oil-qrcode"},[o("nav-top",{attrs:{title:"提油卡办理"},on:{backEvent:function(e){return t.$router.go(-1)}}}),t._v(" "),o("nav-content",{staticClass:"handle-oil-qrcode-container"},[o("div",{staticClass:"qr-div"},[o("div",{staticClass:"barcode"},[o("canvas",{attrs:{id:"barcode"}})]),t._v(" "),o("div",{staticClass:"qrcode-text"},[t._v(t._s(t.myInfo.qrCode))]),t._v(" "),o("div",{staticClass:"codeimg-content"},[o("div",{ref:"qrcode",staticClass:"qrcode"},[o("canvas",{attrs:{id:"qrcode"}})]),t._v(" "),o("div",{staticClass:"icon",on:{click:t.refreshBtn}},[o("i",{staticClass:"iconfont mall-shuaxin"})]),t._v(" "),o("div",{staticClass:"tips"},[t._v("备注：当前二维码有效期为5分钟，到期自动失效。")])])])])],1)}),[],!1,null,"68421cb8",null);e.default=u.exports},hz8Q:function(t,e,o){"use strict";var n=o("H0xM");o.n(n).a}}]);