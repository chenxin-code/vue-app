(window.webpackJsonp=window.webpackJsonp||[]).push([[301],{"+hDQ":function(t,e,s){t.exports=s.p+"static/img/tt.8460c2c.jpg"},"2wRi":function(t,e,s){t.exports=s.p+"static/img/top-bg.9972178.png"},T2zA:function(t,e,s){"use strict";var a=s("kNEb");s.n(a).a},ThbV:function(t,e,s){"use strict";var a=s("oixD");s.n(a).a},"YYU/":function(t,e,s){"use strict";s.r(e);var a=s("WQzh"),i={name:"sbx-adder",components:{},props:{value:{default:1},max:{type:Number,default:999},disabled:{type:Boolean,default:!1}},model:{prop:"value",event:"change"},methods:{changeNumber:function(t){this.$emit("change",t)},fetchChange:function(t){this.$emit("on-change",t)},testNumber:function(t){this.disabled||((t=Number((t+"").replace(/[^\d]/g,"")))<1&&(t=1),t>this.max&&(t=this.max),this.changeNumber(t),this.fetchChange(t))}}},n=(s("ThbV"),s("KHd+")),o={name:"yj-coupon",components:{SbxAdder:Object(n.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"sbx-adder",class:{disabled:t.disabled}},[s("div",{staticClass:"btn-add",on:{click:function(e){return t.testNumber(t.value+1)}}},[s("van-icon",{attrs:{name:"plus"}})],1),t._v(" "),s("div",{staticClass:"num"},[s("input",{ref:"inp",attrs:{disabled:t.disabled,type:"text"},domProps:{value:t.value},on:{input:function(e){return t.changeNumber(e.target.value)},blur:function(e){return t.testNumber(e.target.value)}}})]),t._v(" "),s("div",{staticClass:"btn-minus",on:{click:function(e){return t.testNumber(t.value-1)}}},[s("i",{staticClass:"icon iconfont mall-jianhao"})])])}),[],!1,null,"3768dde7",null).exports,PriceOrder:a.a},data:function(){return{selectedNum:1,couponIdx:0,couponList:[],spuModels:[],chooseCouponList:[],occurData:{}}},computed:{detailData:function(){return this.couponList[this.couponIdx]},detailSpuModels:function(){return this.spuModels[this.couponIdx]},mobileDetail:function(){return this.detailSpuModels?this.detailSpuModels.mobileDetail:""}},methods:{getTabOrders:function(){var t,e=(t=regeneratorRuntime.mark((function t(e){var s,a,i,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.$Loading.open(),s={token:this.$store.state.login.token,productType:"515"},t.next=4,this.$http.post("/app/json/product_recharge/getRechargeProList",s);case 4:a=t.sent,0==(i=a.data).status?(i.data.list.forEach((function(t){t.salePrice+="a";var e=n.$mallCommon.priceFromItem(t);t.dpedData=e})),this.couponList=i.data.list,this.spuModels=i.data.spuModels,i.data.list.length&&this._reSettleCart()):this.$Toast(i.info),this.$Loading.close();case 8:case"end":return t.stop()}}),t,this)})),function(){var e=t.apply(this,arguments);return new Promise((function(t,s){return function a(i,n){try{var o=e[i](n),c=o.value}catch(t){return void s(t)}if(!o.done)return Promise.resolve(c).then((function(t){a("next",t)}),(function(t){a("throw",t)}));t(c)}("next")}))});return function(t){return e.apply(this,arguments)}}(),selectCoupon:function(t){this.couponIdx=t,this._reSettleCart()},_reSettleCart:function(){var t=this;this.$Loading.open();var e={deliveryType:2};e.carts=[{number:this.selectedNum,skuId:this.detailData.skuId,storeOuCode:this.detailData.storeOuCode,selfActivityId:this.detailData.activityId,checked:1}],e.couNo=["-1"],this.$http.post("/app/json/fee_life_order/settle",e).then((function(e){t.$Loading.close();var s=e.data;0==s.status?t.occurData=s.data.occur[0]:t.$Toast(s.info)}),(function(e){Loading.close(),t.$Toast("请求数据失败！")}))},submit:function(){var t=this;this.$Loading.open();var e={deliveryType:2};e.carts=[{number:this.selectedNum,skuId:this.detailData.skuId,storeOuCode:this.detailData.storeOuCode,selfActivityId:this.detailData.activityId,checked:1}],this.$http.post("/app/json/fee_life_order/submit",e).then((function(e){var s=e.data;0==s.status?t.$Toast("兑换成功"):t.$Toast(s.info),t.$Loading.close()}))}},created:function(){this.getTabOrders()}},c=(s("T2zA"),Object(n.a)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"yj-coupon"},[a("nav-top",{attrs:{bgImg:s("2wRi")},on:{backEvent:function(e){return t.$router.go(-1)}}}),t._v(" "),a("nav-content",[a("div",{staticClass:"coupon-box"},[a("div",{staticClass:"coupon-container"},[a("ul",{staticClass:"coupon-group"},t._l(t.couponList,(function(e,s){return a("li",{staticClass:"coupon-list",on:{click:function(e){return t.selectCoupon(s)}}},[a("div",{staticClass:"row-top"},[a("div",{staticClass:"price"},[a("span",{staticClass:"icon"},[t._v("￥")]),t._v(" "),a("span",{staticClass:"num"},[t._v(t._s(e.skuFeatures[0]?e.skuFeatures[0].featureValue:""))])]),t._v(" "),e.skuFeatures[1]&&e.skuFeatures[1].featureValue?a("div",{staticClass:"text"},[a("div",[t._v(t._s(e.skuFeatures[1]?e.skuFeatures[1].featureValue:0))])]):t._e()]),t._v(" "),a("div",{staticClass:"row-bottom"},[a("div",{staticClass:"text"},[t._v(t._s(e.spuName))]),t._v(" "),a("div",{staticClass:"price-box"},[a("PriceOrder",{attrs:{listitem:e}}),t._v(" "),a("div",{staticClass:"select-icon"},[a("i",{staticClass:"icon iconfont",class:s==t.couponIdx?"mall-xuanzhong":"mall-weixuanzhong"})])],1)])])})),0)]),t._v(" "),a("div",{staticClass:"flex-div"},[a("div",{staticClass:"label"},[t._v("购买数量")]),t._v(" "),a("div",{staticClass:"content"},[a("SbxAdder",{attrs:{disabled:""},on:{"on-change":t._reSettleCart},model:{value:t.selectedNum,callback:function(e){t.selectedNum=e},expression:"selectedNum"}})],1)])]),t._v(" "),a("div",{staticClass:"price-info"},[a("div",{staticClass:"flex-div"},[a("div",{staticClass:"label"},[t._v("商品金额")]),t._v(" "),a("div",{staticClass:"content"},[t._v("￥"+t._s(t.occurData.amount))])]),t._v(" "),a("div",{staticClass:"flex-div"},[a("div",{staticClass:"label"},[t._v("选择优惠券")]),t._v(" "),a("div",{staticClass:"content"},[t.chooseCouponList.length?a("van-icon",{staticStyle:{"font-weight":"bold"},attrs:{name:"ellipsis",size:"25"}}):a("span",{staticClass:"empty"},[t._v("暂无优惠券")])],1)]),t._v(" "),a("div",{staticClass:"flex-div"},[a("div",{staticClass:"label"},[t._v("应付金额")]),t._v(" "),a("div",{staticClass:"content red"},[t._v("￥"+t._s(t.occurData.payAmount))])])]),t._v(" "),t.mobileDetail?a("div",{staticClass:"terms"},[a("div",{staticClass:"terms-title"},[t._v("使用说明")]),t._v(" "),a("div",{staticClass:"terms-content",domProps:{innerHTML:t._s(t.mobileDetail)}})]):t._e(),t._v(" "),a("div",{staticClass:"terms"},[a("div",{staticClass:"terms-title"},[t._v("使用方式")]),t._v(" "),a("div",{staticClass:"terms-content"},[a("img",{attrs:{src:s("+hDQ"),alt:""}})])]),t._v(" "),a("div",{staticClass:"buy-now",on:{click:t.submit}},[t._v("立即购买")])])],1)}),[],!1,null,"f525e3a0",null));e.default=c.exports},kNEb:function(t,e,s){},oixD:function(t,e,s){}}]);