(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33591d3f","chunk-7baddb58"],{"0ac9":function(e,t,a){"use strict";a("baed")},"1d33":function(e,t,a){"use strict";a("a6be")},"3b97":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("nav-top",{attrs:{title:"团购认证"},on:{backEvent:function(t){return e.$router.go(-1)}}}),a("nav-content",[e.messageView?a("div",[2==e.params.state?a("van-notice-bar",{attrs:{scrollable:!1,wrapable:""}},[e._v(" 企业审核认证中，请耐心等待审核结果...... ")]):e._e(),a("div",{staticClass:"gray"}),a("div",{staticClass:"table-view"},[a("div",{staticClass:"table-view-cell"},[a("div",{staticClass:"table-view-cell-text"},[a("div",{staticClass:"left"},[a("span",[e._v("姓名")])]),a("div",{staticClass:"center"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.params.realName,expression:"params.realName",modifiers:{trim:!0}}],attrs:{readonly:e.disabled,placeholder:"请输入姓名",type:"text"},domProps:{value:e.params.realName},on:{input:function(t){t.target.composing||e.$set(e.params,"realName",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])])]),a("div",{staticClass:"table-view-cell"},[a("div",{staticClass:"table-view-cell-text"},[a("div",{staticClass:"left"},[a("span",[e._v("手机号")])]),a("div",{staticClass:"center"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.params.userName,expression:"params.userName",modifiers:{trim:!0}}],attrs:{readonly:e.disabled,placeholder:"请输入手机号",type:"text"},domProps:{value:e.params.userName},on:{input:function(t){t.target.composing||e.$set(e.params,"userName",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])])]),a("div",{staticClass:"table-view-cell"},[a("div",{staticClass:"table-view-cell-text"},[a("div",{staticClass:"left"},[a("span",[e._v("企业名称")])]),a("div",{staticClass:"center"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.params.enterpriseName,expression:"params.enterpriseName"}],attrs:{readonly:e.disabled,placeholder:"请输入企业名称",type:"text"},domProps:{value:e.params.enterpriseName},on:{input:function(t){t.target.composing||e.$set(e.params,"enterpriseName",t.target.value)}}})])])]),a("div",{staticClass:"table-view-cell"},[a("div",{staticClass:"table-view-cell-text"},[a("div",{staticClass:"left"},[a("span",[e._v("工商税号")])]),a("div",{staticClass:"center"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.params.taxNumber,expression:"params.taxNumber"}],attrs:{readonly:e.disabled,placeholder:"请输入税号",type:"text"},domProps:{value:e.params.taxNumber},on:{input:function(t){t.target.composing||e.$set(e.params,"taxNumber",t.target.value)}}})])])]),a("div",{staticClass:"table-view-cell"},[a("div",{staticClass:"table-view-cell-text"},[a("div",{staticClass:"left"},[a("span",[e._v("所属地市")])]),a("div",{staticClass:"item-right",on:{click:e.selectRegion}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],staticClass:"editText",attrs:{readonly:e.disabled,placeholder:"选择区域",type:"text"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}})]),e.showSelect?a("RegionSelect",{ref:"regionselect",attrs:{initData:e.initData},on:{closeEvent:e.regionCloseEvent,selectedItemsEvent:e.selectedItemsEvent}}):e._e()],1)]),a("div",{staticClass:"table-view-cell"},[a("div",{staticClass:"table-view-cell-text"},[a("div",{staticClass:"left"},[a("span",[e._v("公司详细地址")])]),a("div",{staticClass:"center"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.params.detailAddress,expression:"params.detailAddress"}],attrs:{readonly:e.disabled,placeholder:"请输入公司详细地址",type:"text"},domProps:{value:e.params.detailAddress},on:{input:function(t){t.target.composing||e.$set(e.params,"detailAddress",t.target.value)}}})])])]),a("div",{staticClass:"table-view-cell"},[a("div",{staticClass:"table-view-cell-text"},[a("div",{staticClass:"left"},[a("span",[e._v("开户银行")])]),a("div",{staticClass:"center"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.params.bankName,expression:"params.bankName"}],attrs:{readonly:e.disabled,placeholder:"请输入开户银行",type:"text"},domProps:{value:e.params.bankName},on:{input:function(t){t.target.composing||e.$set(e.params,"bankName",t.target.value)}}})])])]),a("div",{staticClass:"table-view-cell"},[a("div",{staticClass:"table-view-cell-text"},[a("div",{staticClass:"left"},[a("span",[e._v("银行卡号")])]),a("div",{staticClass:"center"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.params.bankNumber,expression:"params.bankNumber"}],attrs:{readonly:e.disabled,placeholder:"请输入银行卡号",type:"text"},domProps:{value:e.params.bankNumber},on:{input:function(t){t.target.composing||e.$set(e.params,"bankNumber",t.target.value)}}})])])]),a("div",{staticClass:"certificates"},[a("p",[e._v("上传营业执照")]),a("div",{staticClass:"certificatesItem"},[a("div",{on:{click:function(t){return e.openChangeImgPopup(1)}}},[a("div",{staticClass:"imgBox"},[a("img",{staticClass:"backgroundImg",attrs:{src:e.params.businessLicense||"static/image/vocational-certification/gh@2x.png",alt:""}}),0==e.disabled?a("img",{staticClass:"tipsImg",attrs:{alt:"",src:"static/image/vocational-certification/icon1@2x.png"}}):e._e()]),a("div",{staticClass:"text"},[a("div",{staticClass:"textBox"},[a("span",[e._v("上传营业执照")])])])]),1==e.params.state?a("p",{staticClass:"unbound",on:{click:e.unboundData}},[e._v("解绑企业")]):e._e()])])]),e.disabled?e._e():a("div",{staticClass:"answer theme_bg_red",on:{click:e.popupCardBtn}},[e._v("提交认证")])],1):e._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:e.notCertified,expression:"notCertified"}],staticClass:"div"},[a("div",{staticClass:"authenticationFailed"},[a("img",{staticClass:"img",attrs:{alt:"",src:"static/image/microShop/picture.png"}}),a("p",{staticClass:"p2 p"},[e._v("检测到您还未进行实名认证，请先前往实名认证吧")])]),a("div",{staticClass:"answer theme_bg_red",on:{click:e.deCertification}},[e._v("前往个人认证")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:3==e.params.state,expression:"params.state == 3"}],staticClass:"div"},[a("div",{staticClass:"authenticationFailed"},[a("img",{attrs:{alt:"",src:"static/image/microShop/renzheng.png"}}),a("p",{staticClass:"p1"},[e._v("很遗憾！企业认证未通过...")]),a("p",{staticClass:"p2"},[e._v("原因："+e._s(e.params.examineRemark))])]),a("div",{staticClass:"grayBtn"},[a("p",{staticClass:"theme_bg_red p1",on:{click:e.returnAuthentication}},[e._v("重新提交认证")]),a("p",{staticClass:"theme_bg_red p2",on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")])])]),a("van-action-sheet",{attrs:{actions:e.actions},on:{select:e.onSelect},model:{value:e.showFaceBackImg,callback:function(t){e.showFaceBackImg=t},expression:"showFaceBackImg"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.popupCard,expression:"popupCard"}],staticClass:"card"},[a("van-popup",{staticClass:"popupCard",attrs:{"close-on-click-overlay":!1},model:{value:e.popupCard,callback:function(t){e.popupCard=t},expression:"popupCard"}},[a("div",{staticClass:"popupCardText"},[a("div",{staticClass:"phoneView"},[a("span",{staticClass:"span1"},[e._v("手机号")]),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.params.userName,expression:"params.userName",modifiers:{trim:!0}}],attrs:{placeholder:"请输入手机号",type:"text"},domProps:{value:e.params.userName},on:{input:function(t){t.target.composing||e.$set(e.params,"userName",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),a("CountButton",{ref:"countBtn",staticClass:"send-btn",attrs:{phone:e.params.userName},on:{getSmsEvent:e.getCode}})],1),a("div",{staticClass:"phoneView"},[a("span",{staticClass:"span1"},[e._v("验证码")]),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.params.smsVerifyCode,expression:"params.smsVerifyCode",modifiers:{trim:!0}}],attrs:{placeholder:"请输入验证码",type:"text"},domProps:{value:e.params.smsVerifyCode},on:{input:function(t){t.target.composing||e.$set(e.params,"smsVerifyCode",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])]),a("div",{staticClass:"popupCardBtn"},[a("span",{on:{click:function(t){e.popupCard=!1}}},[e._v("取消")]),a("span",{on:{click:e.commit}},[e._v("确认提交")])])])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.unboundView,expression:"unboundView"}],staticClass:"card"},[a("van-popup",{staticClass:"popupCard",attrs:{"close-on-click-overlay":!1},model:{value:e.unboundView,callback:function(t){e.unboundView=t},expression:"unboundView"}},[a("div",{staticClass:"popupCardText"},[a("div",{staticClass:"phoneView"},[a("span",{staticClass:"span1"},[e._v("手机号")]),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.params.userName,expression:"params.userName",modifiers:{trim:!0}}],attrs:{placeholder:"请输入手机号",type:"text"},domProps:{value:e.params.userName},on:{input:function(t){t.target.composing||e.$set(e.params,"userName",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),a("CountButton",{ref:"countBtn",staticClass:"send-btn",attrs:{phone:e.params.userName},on:{getSmsEvent:e.getCode}})],1),a("div",{staticClass:"phoneView"},[a("span",{staticClass:"span1"},[e._v("验证码")]),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.params.smsVerifyCode,expression:"params.smsVerifyCode",modifiers:{trim:!0}}],attrs:{placeholder:"请输入验证码",type:"text"},domProps:{value:e.params.smsVerifyCode},on:{input:function(t){t.target.composing||e.$set(e.params,"smsVerifyCode",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])]),a("div",{staticClass:"popupCardBtn"},[a("span",{on:{click:function(t){e.unboundView=!1}}},[e._v("取消")]),a("span",{on:{click:e.unboundBtns}},[e._v("确认解绑")])])])],1)],1)},i=[],n=(a("b0c0"),a("d3b7"),a("3ca3"),a("ddb0"),a("8431")),o=a("d7b9"),r=a("b90b"),c={name:"index",data:function(){return{backUUID:"",notCertified:!1,messageView:!0,phone:"",name:"",disabled:!0,initData:{title:"请选择地区"},frontOfId:"",actions:[{name:"相册"},{name:"拍照"}],region:[],selectedItems:[],showSelect:!1,popupCard:!1,unboundView:!1,showFaceBackImg:!1,certificateObj:{},params:{id:"",realName:"",userName:"",enterpriseName:"",taxNumber:"",provinceId:"",provinceName:"",cityId:"",city:"",province:"",cityName:"",detailAddress:"",bankNumber:"",businessLicense:"",bankName:"",smsVerifyCode:""}}},mounted:function(){this.isAuth(),this.backUUID=this.$util.randomString()},watch:{unboundView:function(){this.unboundView||this.$bridgefunc.delandriodback(this.backUUID)},popupCard:function(){this.popupCard||this.$bridgefunc.delandriodback(this.backUUID)}},methods:{getCode:function(e,t){var a=this;this.$refs.countBtn.startTime(),this.$Loading.open();var s="/app/json/login/sendSms",i={smsType:"1020",token:this.$store.state.login.token,phone:this.params.userName,imgVerifyCode:e,uuid:t};this.$http.post(s,i).then((function(e){a.$Loading.close();var t=e.data;0==t.status?a.$Toast("获取验证码成功"):(a.$refs.countBtn.resetClock(),a.$Toast(t.info?t.info:"获取短信验证码失败"))}),(function(e){a.$Loading.close(),a.$refs.countBtn.resetClock(),a.$Toast("系统运行过程中遇到问题，请稍候再试")}))},openChangeImgPopup:function(e){var t=this;0==this.disabled&&(1==this.$store.state.webtype?o["a"].chooseImg().then((function(e){t.params.businessLicense=e.imgUrl,t.params.businessLicense=e.imgUrl})):this.showFaceBackImg=!0)},onSelect:function(e){this.showFaceBackImg=!1,"拍照"==e.name?this.getImg("2"):"相册"==e.name&&this.getImg("1")},returnAuthentication:function(){this.messageView=!0},getImg:function(e){var t=this;this.$bridgefunc.getPhoto(e,(function(e){t.updateImg(e);var a="data:image/jpg;base64,"+e;t.params.businessLicense=a}))},updateImg:function(e){var t=this,a={base64File:e,fileType:"jpg",fileName:"id-card-img",bucketName:"app_img"};this.$Loading.open("保存中..."),this.$http.post("/uploadFile",a).then((function(e){t.$Loading.close();var a=e.data;0==a.status?t.params.businessLicense=a.data:t.$Toast(a.info)}),(function(e){t.$Loading.close(),t.$Toast("上传图片失败")}))},addFunction:function(e){var t=this;this.$bridgefunc.andriodaddback(this.backUUID,(function(){e?t.popupCard=!1:unboundView=!1}))},popupCardBtn:function(){this.popupCard=!0,this.addFunction(1)},deCertification:function(){this.$bridgefunc.customPush({path:window.location.origin+"/app-vue/oildrop/certification",isnativetop:"0",superback:1,isVuePage:"0"})},selectRegion:function(){0==this.disabled&&(this.showSelect=!0,this.getRegionData(0))},getRegionData:function(e){var t=this;this.$Loading.open();var a="/app/json/area/loadAreaList",s={token:this.$store.state.login.token,parentId:e};this.$http.post(a,s).then((function(e){t.$Loading.close();var a=e.data;if(0==a.status){var s=a.data;s.length>0?t.$nextTick((function(){this.$refs.regionselect.pushCustomOptions(s)})):(t.showSelect=!1,t.region=t.selectedItems,t.getRegionText())}else t.$Toast(a.info)}),(function(e){t.$Loading.close(),t.$Toast("获取数据失败")}))},regionCloseEvent:function(){this.showSelect=!1},selectedItemsEvent:function(e){var t=e.item;this.selectedItems=e.selecteds;var a={};if(this.selectedItems.length>0){for(var s=0;s<4;s++){var i={id:"",name:""};this.selectedItems.length>s&&(i=this.selectedItems[s]),0==s?(this.params.provinceId=i.id,this.params.provinceName=i.name):1==s?(this.params.cityId=i.id,this.params.cityName=i.name):2==s?(a.countryId=i.id,a.countryName=i.name):3==s&&(a.townId=i.id,a.townName=i.name)}this.$emit("info",a)}if(4==this.selectedItems.length)return this.showSelect=!1,this.region=this.selectedItems,void this.getRegionText();this.getRegionData(t.id)},getRegionText:function(){for(var e="",t=0;t<this.region.length;t++)e+=this.region[t].name;this.name=e,this.$refs.regionselect.reset(null)},unboundData:function(){this.unboundView=!0,this.addFunction(0)},unboundBtns:function(){var e=this,t={token:this.$store.state.login.token,id:this.params.id,smsVerifyCode:this.params.smsVerifyCode,userName:this.params.userName};this.$request.post("/app/json/user_auth/authEnterpriseUntie",t).then((function(t){"success"==t.result?(e.unboundView=!1,e.detail(),e.$toast("解绑成功")):e.$Toast(t.info)}))},isAuth:function(){var e=this,t=this;t.$http.post("/app/json/user_auth/getUserCertificate",{cateType:1}).then((function(a){var s=a.data.data;if(0==a.data.status){for(var i in s.page="",s)if(s[i])return void e.detail();t.notCertified=!0}}))},detail:function(){var e=this;this.$request.post("/app/json/user_auth/authEnterpriseDetail",{token:this.$store.state.login.token}).then((function(t){"success"==t.result?(e.params=t.data||{},e.name=e.params.provinceName&&e.params.cityName?e.params.provinceName+e.params.cityName:"",e.params.state?1==e.params.state?(e.disabled=!0,e.messageView=!0):3==e.params.state?(e.name="",e.disabled=!1,e.messageView=!1,e.params={id:"",realName:"",userName:"",enterpriseName:"",taxNumber:"",provinceId:"",provinceName:"",cityId:"",city:"",province:"",cityName:"",detailAddress:"",bankNumber:"",businessLicense:"",bankName:"",smsVerifyCode:""}):2==e.params.state&&(e.disabled=!0,e.messageView=!0):(e.disabled=!1,e.messageView=!0)):e.$Toast(t.info)}))},commit:function(){var e=this;this.params.token=this.$store.state.login.token,this.$request.post("/app/json/user_auth/checkParam",this.params).then((function(t){"success"==t.result?e.$request.post("/app/json/user_auth/authEnterprise",e.params).then((function(t){"success"==t.result?(e.popupCard=!1,e.detail(),e.$toast("提交认证成功")):e.$Toast(t.info)})):e.$Toast(t.info)}))}},components:{RegionSelect:n["default"],CountButton:r["a"],photograph:function(){return a.e("chunk-3a6f1b65").then(a.bind(null,"59f2b"))}}},l=c,u=(a("0ac9"),a("0c7c")),p=Object(u["a"])(l,s,i,!1,null,"161aaca0",null);t["default"]=p.exports},8431:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"region-select"},[a("div",{staticClass:"other-div",on:{click:e.close}}),a("transition",{attrs:{name:"pop_transiton"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.popShow,expression:"popShow"}],staticClass:"select-content"},[a("div",{staticClass:"close-btn",on:{click:e.close}},[a("img",{attrs:{src:"static/image/mall/close.png"}})]),a("div",{staticClass:"font-medium-l-x title"},[e._v(e._s(e.initData.title?e.initData.title:"请选择区域"))]),a("div",{staticClass:"selected-item font-medium"},[e._l(e.selectedItems,(function(t,s){return a("div",{staticClass:"item-div",on:{click:function(t){return e.reSelect(s)}}},[a("div",{staticClass:"item-text"},[e._v(e._s(t.name))])])})),e.cusOptions.length>0?a("div",{staticClass:"item-div"},[a("div",{staticClass:"item-text item-selected theme_font_red"},[e._v("请选择")])]):e._e()],2),a("div",{staticClass:"options-div"},e._l(e.cusOptions,(function(t,s){return a("div",{staticClass:"option",on:{click:function(a){return e.selectOption(t,s)}}},[e._v(e._s(t.name))])})),0)])])],1)},i=[],n=(a("4795"),a("a434"),a("b0c0"),{name:"",props:{initData:{type:Object,default:{}}},data:function(){return{popShow:!1,selectedIndexs:[],selectedItems:[],dataCache:[],cusOptions:[],cusIndex:0,initAreas:[],myTimeout:null}},methods:{close:function(){var e=this;this.popShow=!1,this.myTimeout&&(clearTimeout(this.myTimeout),this.myTimeout=null),this.myTimeout=setTimeout((function(){e.$emit("closeEvent","")}),240)},reSelect:function(e){if(1!=this.initData.canNotReselect){var t=this.selectedItems.length-e;this.selectedItems.splice(e,t),this.selectedIndexs.splice(e,t);var a=this.dataCache[e];this.dataCache.splice(e+1,t),this.cusOptions=a}},selectOption:function(e,t){this.cusIndex=t,this.selectedItems.push(e),this.selectedIndexs.push(t),this.cusOptions=[];var a={item:e,selecteds:this.selectedItems};this.$emit("selectedItemsEvent",a)},pushCustomOptions:function(e){if(0==this.selectedIndexs.length&&(this.selectedIndexs=[],this.selectedItems=[],this.dataCache=[],this.cusIndex=0),this.dataCache.push(e),this.cusOptions=e,this.initAreas&&this.initAreas.length>0){for(var t=this.initAreas.shift(),a=!1,s=0;s<e.length;s++){var i=e[s];if(this.$util.areaEqual(t,i.name)){a=!0,this.selectOption(i,s);break}}0==a&&(this.initAreas=[])}},reset:function(e){this.selectedIndexs=[],this.selectedItems=[],this.cusIndex=0,e?(this.dataCache=[],this.dataCache.push(e),this.cusOptions=e):(this.cusOptions=this.dataCache[0],this.dataCache=[],this.dataCache.push(this.cusOptions))}},created:function(){try{this.initAreas=JSON.parse(JSON.stringify(this.initData.initAreas))}catch(e){this.initAreas=[]}},mounted:function(){this.popShow=!0}}),o=n,r=(a("1d33"),a("0c7c")),c=Object(r["a"])(o,s,i,!1,null,"6251ae42",null);t["default"]=c.exports},a6be:function(e,t,a){},baed:function(e,t,a){},d7b9:function(e,t,a){"use strict";a("e17f");var s=a("2241"),i=(a("e7e5"),a("d399")),n=a("d4ec"),o=a("bee2");a("d3b7"),a("c975"),a("ac1f"),a("466d"),a("1276"),a("a15b"),a("d81d"),a("0d03"),a("25f0"),a("fb6a"),a("e25e");function r(){var e=window.navigator.userAgent.toLowerCase();return"micromessenger"==e.match(/MicroMessenger/i)}var c=a("5530"),l=a("da71"),u=a("bc3a"),p=a.n(u),d=a("a026"),m=a("a78e"),h=a.n(m),v=a("4328"),f=a.n(v);d["default"].use(i["a"]),d["default"].use(s["a"]);var g=p.a.create({baseURL:l["a"].baseURL,timeout:1e4,responseType:"json",withCredentials:!1,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}});g.interceptors.request.use((function(e){i["a"].loading({mask:!0,duration:0});var t=h.a.get("usertoken");return"post"===e.method?e.data=f.a.stringify(Object(c["a"])(Object(c["a"])({},e.data),{},{token:t})):"get"===e.method&&(e.params=Object(c["a"])(Object(c["a"])({},e.params),{},{token:t})),e}),(function(e){return Promise.reject(e)})),g.interceptors.response.use((function(e){return i["a"].clear(),-1==e.data.status&&e.data.info.indexOf("用户信息为空")>-1&&s["a"].confirm({title:"提示",message:"用户信息失效, 请重新登录"}).then((function(){})),e}),(function(e){return i["a"].clear(),Promise.reject(e)}));var C=g,b=a("378f"),w=a("653a"),y=function(){function e(t){Object(n["a"])(this,e),this.jsApiList=t}return Object(o["a"])(e,[{key:"share",value:function(e,t,a,s){return r()?this._wxShare(e,t,a,s):this._appShare(e,t,a,s)}},{key:"chooseImage",value:function(e){return r()?this._wxChooseImage(e):this._appChooseImage()}},{key:"_wxChooseImage",value:function(e){var t=this;return new Promise((function(a,s){t._init(["chooseImage","uploadImage"]).then((function(){wx.chooseImage({count:e||1,sourceType:["camera"],sizeType:["original"],success:function(e){var t=e.localIds[0];wx.getLocalImgData({localId:t,success:function(e){var t=e.localData,s=t.substr(t.indexOf(",")+1);a({imagedata:[s]})}})}})}))}))}},{key:"_wxUploadImage",value:function(e){return new Promise((function(t,a){wx.uploadImage({localId:e,isShowProgressTips:1,success:function(e){t(e.serverId)}})}))}},{key:"_wxShare",value:function(e,t,a,s){var i=this;return new Promise((function(n,o){i._init(["onMenuShareTimeline","onMenuShareAppMessage","updateAppMessageShareData","updateTimelineShareData"]).then((function(){wx.onMenuShareTimeline({title:e,link:t,imgUrl:a,success:function(){n()}}),wx.onMenuShareAppMessage({title:e,desc:s,link:t,imgUrl:a,success:function(){n()}}),wx.updateAppMessageShareData({title:e,desc:s,link:t,imgUrl:a,success:function(){}}),wx.updateTimelineShareData({title:e,link:t,imgUrl:a,success:function(){}})}))}))}},{key:"_appShare",value:function(e,t,a,s){if("new"==w["a"].state.globalConfig.yht_protocol_type){var i={title:e,sharetext:s,imageurl:a,detailurl:t};b["a"].share(i)}else{var n={type:"share",para:{title:e,sharetext:s,imageurl:a,detailurl:t}};location.href=location.origin+"?appprotocol="+encodeURIComponent(JSON.stringify(n))}}},{key:"_appUploadImage",value:function(e){var t="appCallbackUploadImage",a={type:"webuploadimage",para:{callback:t,num:e||1}};return location.href=location.origin+"?appprotocol="+encodeURIComponent(JSON.stringify(a)),new Promise((function(e){window[t]=function(t){e(t)}}))}},{key:"_appChooseImage",value:function(){if("new"==w["a"].state.globalConfig.yht_protocol_type)return new Promise((function(e){b["a"].getPhoto(3,(function(t){var a=[];a.push(t),e({imagedata:a})}))}));var e="photoCallBack",t={type:"nativephoto",para:{type:"3"}};return location.href=location.origin+"?appprotocol="+encodeURIComponent(JSON.stringify(t)),new Promise((function(t){window[e]=function(e){t(e)}}))}},{key:"scanCode",value:function(){if("new"==w["a"].state.globalConfig.yht_protocol_type)return new Promise((function(e){b["a"].scanCode((function(t){e(t)}))}));var e="qrCallBack",t={type:"qrscan"};return location.href=location.origin+"?appprotocol="+encodeURIComponent(JSON.stringify(t)),new Promise((function(t){window[e]=function(e){t(e)}}))}},{key:"wxSign",value:function(e){if("new"==w["a"].state.globalConfig.yht_protocol_type)b["a"].wxFreePay(e);else{var t={type:"wxfreepay",para:{pre_entrustweb_id:e}};location.href=location.origin+"?appprotocol="+encodeURIComponent(JSON.stringify(t))}}},{key:"getLocation",value:function(){return new Promise((function(e){wx.getLocation({type:"wgs84",success:function(e){}})}))}},{key:"_init",value:function(e){var t=this;return new Promise((function(a,s){t._getConfig().then((function(t){wx.config({appId:t.appid,timestamp:t.timestamp,nonceStr:t.nonce,signature:t.signature,jsApiList:e}),wx.ready((function(){a()})),wx.error((function(e){s(e)}))}))["catch"]((function(e){s()}))}))}},{key:"_getConfig",value:function(){return new Promise((function(e,t){var a="",s=navigator.userAgent,i=!!s.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);a=i?window.initUrl:window.location.href.split("#")[0],C.post("/app/json/wx/getAccessToken",{url:encodeURIComponent(a)}).then((function(t){0===t.data.status&&e(Object.assign({},t.data.data,t.data.data.signature))}))["catch"]((function(e){t(e)}))}))}},{key:"openNewPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("new"==w["a"].state.globalConfig.yht_protocol_type)b["a"].newPage({weburl:e,isnativetop:!0});else{var a={type:"newpage",para:{isnative:t,islogin:!0,isnativetop:!0,isopen:!0}};t?a.para.code=e:a.para.weburl=e,location.href=location.origin+"?appprotocol="+encodeURIComponent(JSON.stringify(a))}}},{key:"finishPage",value:function(){var e={type:"finish"};location.href=location.origin+"?appprotocol="+encodeURIComponent(JSON.stringify(e))}},{key:"openLogin",value:function(){var e={type:"login"};location.href=location.origin+"?appprotocol="+encodeURIComponent(JSON.stringify(e))}},{key:"chooseImg",value:function(){var e=this;return new Promise((function(t,a){e.chooseImage().then((function(e){if(e.imagedata&&e.imagedata.length){var a=e.imagedata[0];C.get("/app/json/app_youdi/getSunboxToken").then((function(e){var n=e.data.data;i["a"].loading({mask:!0,duration:0}),p.a.post("/uploadFile",f.a.stringify({base64File:a,fileType:"png",fileName:"1",token:n,bucketName:"default_file"})).then((function(e){var n=e.data.data,o={imgUrl:n,baseImgUrl:a};i["a"].clear(),n?t(o):s["a"].alert({title:"提示",message:"上传失败！"})}))}))}}))}))}}]),e}();t["a"]=new y}}]);