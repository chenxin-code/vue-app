(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-98ad39fe"],{"01b4":function(t,i,e){"use strict";e("e1f2")},"0315":function(t,i,e){},"81d5":function(t,i,e){"use strict";var s=e("7b0b"),n=e("23cb"),a=e("50c4");t.exports=function(t){var i=s(this),e=a(i.length),r=arguments.length,o=n(r>1?arguments[1]:void 0,e),c=r>2?arguments[2]:void 0,h=void 0===c?e:n(c,e);while(h>o)i[o++]=t;return i}},b01c:function(t,i,e){"use strict";e.r(i);var s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"setgesture"},[e("nav-top",{attrs:{title:1==t.type?"设置手势密码":"修改手势密码"},on:{backEvent:t.backEvent}}),e("nav-content",[e("div",{staticClass:"g-top"},[e("div",{staticClass:"g-select"},t._l(9,(function(i){return e("div",{staticClass:"g-dot  ",class:t.isExist(i)?"theme_bg_red":"theme_bg_white_ef"})})),0),e("div",{staticClass:"text"},[e("div",{staticClass:"title"},[t._v(" "+t._s(1==t.type?"设置手势密码":"修改手势密码")),e("br")]),e("div",{staticClass:"g-tip",class:t.isWrong?"theme_font_red":"theme_font_gray"},[t._v(" "+t._s(t.gTipStr)+" ")])])]),e("div",{staticClass:"canvas"},[e("gcanvas",{ref:"gcanvas",on:{getGesture:t.getGesture}})],1),e("p",{staticClass:"bt-tip theme_font_gray"},[t._v(" 设置手势密码, 防止他人未经授权查看 ")])])],1)},n=[],a=e("1da1"),r=(e("96cf"),e("c975"),e("0d03"),e("c1b2")),o=e("19e7"),c={name:"setgesture",components:{gcanvas:r["a"]},data:function(){return{isWrong:!1,step:1,firstPoints:[],secondPoints:[],type:"",digitalPWD:"",gTipStr:""}},mounted:function(){this.type=this.$route.query.type,this.digitalPWD=this.$route.query.digitalPWD||""},methods:{backEvent:function(){this.$router.go(-1)},isExist:function(t){var i=this.firstPoints.indexOf(t);return i>-1},getGesture:function(t){1==this.step?t.length<4?(this.gTipStr="至少连接4个点，请重新绘制",this.isWrong=!0,this.$refs.gcanvas.reset()):(this.gTipStr="请再次绘制",this.isWrong=!1,this.firstPoints=this.getIndexArr(t),this.step=2,this.$refs.gcanvas.reset()):(this.secondPoints=this.getIndexArr(t),this.isEqual()?1==this.type?this.openSpecialPwd(12):this.modifyUserSpecialPayPwd(12,this.digitalPWD):(this.gTipStr="两次绘制不同，请重新绘制",this.isWrong=!0,this.$refs.gcanvas.reset()))},openSpecialPwd:function(t){var i=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var s,n,a,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i.$Loading.open("请求中"),e.next=3,i.$bridgefunc.getArgsWithPromise();case 3:s=e.sent,n="/app/json/user/setUserSpecialPayPwd",a=i.$store.state.login.token,r=(new Date).valueOf(),o={token:a,payPwdMode:t,userPayPwd:r,deviceId:s.deviceId},i.$http.post(n,o).then((function(t){i.$Loading.close();var e=t.data;0==e.status?(i.$store.state.pwdStates.gestureNumbers=i.secondPoints,i.$store.state.pwdStates.gesturePwd=e.data,i.$Toast({message:e.info?e.info:"手势设置成功！",position:"bottom",duration:2e3}),i.$bridgefunc.vuexStorage((function(){i.$router.go(-1)}))):i.$Toast({message:e.info?e.info:"手势设置失败！",position:"bottom",duration:2e3})}),(function(t){i.$Loading.close(),i.$Toast({message:"手势设置失败！",position:"bottom",duration:2e3})}));case 9:case"end":return e.stop()}}),e)})))()},modifyUserSpecialPayPwd:function(t,i){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function s(){var n,a,r,c,h;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return e.$Loading.open("请求中"),s.next=3,e.$bridgefunc.getArgsWithPromise();case 3:n=s.sent,a="/app/json/user/modifyUserSpecialPayPwd",r=e.$store.state.login.token,c=(new Date).valueOf(),h={token:r,payPwdMode:t,userPayPwd:c,deviceId:n.deviceId,originalPwd:Object(o["a"])(i)},e.$http.post(a,h).then((function(t){e.$Loading.close();var i=t.data;0==i.status?(e.$store.state.pwdStates.gestureNumbers=e.secondPoints,e.$store.state.pwdStates.gesturePwd=i.data,e.$Toast(1==e.type?"手势设置成功":"手势修改成功"),e.$bridgefunc.vuexStorage((function(){e.$router.go(-1)}))):e.$Toast(1==e.type?"手势设置失败":"手势修改失败")}),(function(t){e.$Loading.close(),e.$Toast({message:"手势设置失败！",position:"bottom",duration:2e3})}));case 9:case"end":return s.stop()}}),s)})))()},isEqual:function(){for(var t="",i="",e=0;e<this.firstPoints.length;e++)t+=this.firstPoints[e];for(e=0;e<this.secondPoints.length;e++)i+=this.secondPoints[e];return t===i},getIndexArr:function(t){for(var i=[],e=0;e<t.length;e++){var s=t[e].index;i.push(s)}return i}},created:function(){}},h=c,d=(e("01b4"),e("0c7c")),l=Object(d["a"])(h,s,n,!1,null,"22229edc",null);i["default"]=l.exports},b93f:function(t,i,e){"use strict";e("0315")},c1b2:function(t,i,e){"use strict";var s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"gcanvas"},[e("canvas",{ref:"canvas",staticClass:"canvas"})])},n=[],a=(e("a434"),e("cb29"),{name:"gcanvas",components:{},data:function(){return{ctx:"",devicePixelRatio:0,r:"",lastPoint:[],arr:[],restPoint:[],drawStyle:"red"}},methods:{init:function(){this.initDom(),this.lastPoint=[],this.touchFlag=!1,this.ctx=this.$refs.canvas.getContext("2d"),this.createCircle(),this.bindEvent()},reset:function(){this.createCircle()},bindEvent:function(){var t=this,i=this.$refs.canvas;i.addEventListener("touchstart",(function(i){i.preventDefault();for(var e=t.getPosition(i),s=0;s<t.arr.length;s++)if(Math.abs(e.x-t.arr[s].x)<t.r&&Math.abs(e.y-t.arr[s].y)<t.r){t.touchFlag=!0,t.lastPoint.push(t.arr[s]),t.drawPoint(this.drawStyle),t.restPoint.splice(s,1);break}}),!1),i.addEventListener("touchmove",(function(i){t.touchFlag&&t.update(t.getPosition(i))}),!1),i.addEventListener("touchend",(function(i){t.touchFlag&&(t.touchFlag=!1,t.update(void 0,!0),t.storePass(t.lastPoint))}),!1)},initDom:function(){this.devicePixelRatio=window.devicePixelRatio||1;var t=this.$refs.canvas,i=window.innerWidth,e=window.innerWidth;t.style.width=i+"px",t.style.height=e+"px",t.height=e*this.devicePixelRatio,t.width=i*this.devicePixelRatio},createCircle:function(){var t=3,i=0;this.r=this.ctx.canvas.width/(2+4*t),this.lastPoint=[],this.arr=[],this.restPoint=[];for(var e=this.r,s=0;s<t;s++)for(var n=0;n<t;n++){i++;var a={x:4*n*e+3*e,y:4*s*e+3*e,index:i};this.arr.push(a),this.restPoint.push(a)}this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);for(s=0;s<this.arr.length;s++)this.drawCle(this.arr[s].x,this.arr[s].y)},drawCle:function(t,i){this.ctx.fillStyle="#DDDDDD",this.ctx.beginPath(),this.ctx.arc(t,i,this.r,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},drawPoint:function(t){for(var i=0;i<this.lastPoint.length;i++)this.ctx.fillStyle=t,this.ctx.beginPath(),this.ctx.arc(this.lastPoint[i].x,this.lastPoint[i].y,this.r/2.5,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},drawStatusPoint:function(t){for(var i=0;i<this.lastPoint.length;i++)this.ctx.strokeStyle=t,this.ctx.beginPath(),this.ctx.arc(this.lastPoint[i].x,this.lastPoint[i].y,this.r,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.stroke()},drawLine:function(t,i,e){this.ctx.beginPath(),this.ctx.strokeStyle=t,this.ctx.lineWidth=3,this.ctx.moveTo(this.lastPoint[0].x,this.lastPoint[0].y);for(var s=1;s<this.lastPoint.length;s++)this.ctx.lineTo(this.lastPoint[s].x,this.lastPoint[s].y);this.ctx.lineTo(i.x,i.y),this.ctx.stroke(),this.ctx.closePath()},getPosition:function(t){var i=t.currentTarget.getBoundingClientRect(),e={x:(t.touches[0].clientX-i.left)*this.devicePixelRatio,y:(t.touches[0].clientY-i.top)*this.devicePixelRatio};return e},update:function(t,i){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);for(var e=0;e<this.arr.length;e++)this.drawCle(this.arr[e].x,this.arr[e].y);if(this.drawPoint(this.drawStyle),this.drawStatusPoint(this.drawStyle),i)this.lastPoint.length&&this.drawLine(this.drawStyle,this.lastPoint[this.lastPoint.length-1],this.lastPoint);else{this.drawLine(this.drawStyle,t,this.lastPoint);for(e=0;e<this.restPoint.length;e++)if(Math.abs(t.x-this.restPoint[e].x)<this.r&&Math.abs(t.y-this.restPoint[e].y)<this.r){this.lastPoint.push(this.restPoint[e]),this.drawPoint(this.drawStyle),this.restPoint.splice(e,1);break}}},storePass:function(t){this.$emit("getGesture",t)}},mounted:function(){this.init()},created:function(){}}),r=a,o=(e("b93f"),e("0c7c")),c=Object(o["a"])(r,s,n,!1,null,"361e8269",null);i["a"]=c.exports},cb29:function(t,i,e){var s=e("23e7"),n=e("81d5"),a=e("44d2");s({target:"Array",proto:!0},{fill:n}),a("fill")},e1f2:function(t,i,e){}}]);