(window.webpackJsonp=window.webpackJsonp||[]).push([[887],{"Sp+b":function(t,e,s){"use strict";s.r(e);var a=s("17lL"),i=s("ygAv"),o=s("2nGb"),n={data:function(){return{tabList:[{text:"套餐说明",type:1},{text:"我的邀约",type:2},{text:"历史签约",type:3}],dropmenuShow:!1,ind:0,date:"",showDate:"",columns:[],columnsPeople:["2人","3人"],show:!1,showPeople:!1,showWxTips:!1,radio:1,showShare:!1,type:1,allPackage:{},desc:"",shareDetails:{},details:[],packageRefuel:"",peopleNum:"",name:"",rfrCode:"",shareId:""}},mounted:function(){this.showDate=i.a.getMyDate(new Date),console.log(i.a.getMyDate(new Date)),this.type=this.$route.query.type,this.id=this.$route.query.id,this.queryPackageRefuelTypeList()},methods:{share:function(){console.log(this.shareDetails),console.log(""+location.origin+o.a.shareUrl+"/redirect?shareId="+this.shareId),a.a.share(this.shareDetails.name,""+location.origin+o.a.shareUrl+"/redirect?shareId="+this.shareId,this.shareDetails.pic,"好友邀请您一起来开通加油家庭套餐啦，加油返利更省钱")},queryPackageRefuelTypeList:function(){var t=this;this.$request.post("/app/json/app_package_refuel/queryPackageRefuelTypeList",{}).then((function(e){0===e.status?(t.allPackage=e.data,t.dealData()):t.$Toast(e.info?e.info:"获取列表失败")}))},cancelClickBtn:function(){this.dropmenuShow=!1,this.tabList.forEach((function(t){t.showClick=!1}))},signPackageRefuel:function(){var t=this,e=this.$route.query.overdueDate;this.date=e?i.a.getNextMinutesValOne(e):i.a.getNextMinutes(),console.log(this.date),this.$request.post("/app/json/app_package_refuel/signPackageRefuel",{packageRefuelId:this.packageRefuel.id,startDate:this.date,rfrCode:this.rfrCode,rfrCodeType:"1",id:"",inviteeIds:""}).then((function(s){0===s.status?t.$router.push({path:"/success",query:{overdueDate:e}}):t.$Toast(s.info?s.info:"开通失败")}))},inviteSignPackageRefuel:function(){var t=this,e=this.$route.query.overdueDate;this.date=e?i.a.getNextMinutesValOne(e):i.a.getNextMinutes(),console.log(this.date),this.$request.post("/app/json/app_package_refuel/inviteSignPackageRefuel",{packageRefuelId:this.packageRefuel.id,startDate:this.date,rfrCode:this.rfrCode,rfrCodeType:"1",signUpNum:this.peopleNum}).then((function(e){0===e.status?(t.shareId=e.data.id,console.log(t.shareId),2==t.$store.state.webtype&&(t.showWxTips=!0),t.share()):t.$Toast(e.info?e.info:"邀请失败")}))},shareBtn:function(){this.inviteSignPackageRefuel()},dealData:function(){var t=this;console.log(this.allPackage),this.allPackage.forEach((function(e){t.columns.push({text:e.name,id:e.id}),console.log(t.$route.query.id),t.id==e.id&&(console.log("我是item"),console.log(e),t.shareDetails=e,t.columnsPeople=t.shareDetails.canSignUpNum.split(","),t.details=t.shareDetails.packageRefuelList,t.packageRefuel=t.details[0],t.name=t.shareDetails.name,t.desc=t.packageRefuel.desc,t.peopleNum=t.columnsPeople[0],console.log(t.packageRefuel))}))},linkTo:function(t){1==t.type?this.$router.push({path:"/instructions"}):2==t.type?this.$router.push({path:"/my-invitation"}):this.$router.push({path:"/history-invitation"})},changeType:function(t,e){console.log(t),this.desc=t.desc,this.ind=e,this.packageRefuel=t},onConfirm:function(t){this.show=!1,this.type=t.type,this.id=t.id,this.columns=[],this.ind=0,this.dealData()},onConfirmPeople:function(t){this.peopleNum=t,this.showPeople=!1},openBtn:function(){2==this.type?this.showShare=!0:this.signPackageRefuel()}},components:{}},l=(s("gw5Y"),s("KHd+")),c=Object(l.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"open-allPackage",on:{click:t.cancelClickBtn}},[a("nav-top",{attrs:{title:"开通套餐"},on:{backEvent:function(e){return t.$router.go(-1)}}},[a("i",{staticClass:"iconfont mall-gengduo",on:{click:function(e){e.stopPropagation(),t.dropmenuShow=!t.dropmenuShow}}})]),t._v(" "),a("nav-content",{staticClass:"open-allPackage-container"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.dropmenuShow,expression:"dropmenuShow"}],staticClass:"dropmenu",on:{click:function(t){t.stopPropagation()}}},t._l(t.tabList,(function(e,s){return a("div",{key:s,staticClass:"dropmenu-item",on:{click:function(s){return t.linkTo(e)}}},[t._v(t._s(e.text))])})),0),t._v(" "),a("div",{staticClass:"info"},[a("div",{staticClass:"main"},[a("div",{staticClass:"card special"},[a("div",{staticClass:"left"},[t._v("套餐类型")]),t._v(" "),a("div",{staticClass:"right",on:{click:function(e){t.show=!0}}},[t._v(t._s(t.name)+" "),a("van-icon",{attrs:{size:"18px",name:"ellipsis"}})],1)]),t._v(" "),a("div",{staticClass:"card change date"},[a("div",{staticClass:"left"},[t._v("套餐选择")]),t._v(" "),a("ul",{staticClass:"type-list"},t._l(t.details,(function(e,s){return a("li",{key:s,staticClass:"type-item",class:{active:t.ind==s},on:{click:function(a){return t.changeType(e,s)}}},[a("div",{staticClass:"text"},[t._v(t._s(e.duration)+"天")])])})),0)]),t._v(" "),1==t.type||3==t.type?a("div",{staticClass:"card"},[a("div",{staticClass:"left"},[t._v("开通日期")]),t._v(" "),a("div",{staticClass:"right"},[t._v(t._s(t.showDate))])]):a("div",{staticClass:"table-view people",on:{click:function(e){t.showPeople=!0}}},[a("div",{staticClass:"table-view-cell"},[a("div",{staticClass:"table-view-cell-text"},[t._v("选择套餐人数")]),t._v(" "),a("div",{staticClass:"table-view-cell-arrow"},[t._v(t._s(t.peopleNum))])])]),t._v(" "),a("div",{staticClass:"card special code"},[a("div",{staticClass:"left"},[t._v("邀请码")]),t._v(" "),a("div",{staticClass:"right"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.rfrCode,expression:"rfrCode"}],staticClass:"inp",attrs:{type:"text",placeholder:"非必填"},domProps:{value:t.rfrCode},on:{input:function(e){e.target.composing||(t.rfrCode=e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"card change"},[a("div",{staticClass:"left"},[t._v("套餐优惠规则")]),t._v(" "),a("div",{staticClass:"content",domProps:{innerHTML:t._s(t.desc)}})])]),t._v(" "),a("div",{staticClass:"btn",on:{click:t.openBtn}},[t._v(t._s(1==t.type||3==t.type?"一键开通":"邀请开通"))]),t._v(" "),a("div",{staticClass:"wx-show"},[a("van-popup",{model:{value:t.showWxTips,callback:function(e){t.showWxTips=e},expression:"showWxTips"}},[a("div",{staticClass:"jt"},[a("img",{attrs:{src:s("vkBj"),alt:""}})]),t._v(" "),a("div",{staticClass:"wx-tips-show"},[a("div",{staticClass:"wx-tips-content"},[a("div",{staticClass:"text1"},[t._v("1.点击右上角")]),t._v(" "),a("div",{staticClass:"text2"},[t._v("\n                2.点击\n                "),a("span",{staticClass:"img"},[a("img",{attrs:{src:s("FJcm"),alt:""}})]),t._v("\n                发送给朋友\n              ")])])])])],1),t._v(" "),a("van-popup",{attrs:{position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("van-picker",{attrs:{"show-toolbar":"",title:"套餐类型选择",columns:t.columns},on:{cancel:function(e){t.show=!1},confirm:t.onConfirm}})],1),t._v(" "),a("van-popup",{attrs:{position:"bottom"},model:{value:t.showPeople,callback:function(e){t.showPeople=e},expression:"showPeople"}},[a("van-picker",{attrs:{"show-toolbar":"",title:"开通人数选择",columns:t.columnsPeople},on:{cancel:function(e){t.showPeople=!1},confirm:t.onConfirmPeople}})],1),t._v(" "),a("van-popup",{attrs:{position:"bottom"},model:{value:t.showShare,callback:function(e){t.showShare=e},expression:"showShare"}},[a("div",{staticClass:"share-content"},[a("div",{staticClass:"title"},[t._v("邀请好友一同开通家庭套餐")]),t._v(" "),a("div",{staticClass:"share-main",on:{click:t.shareBtn}},[a("div",{staticClass:"img"},[a("img",{attrs:{src:s("aO4Z"),alt:""}})]),t._v(" "),a("div",{staticClass:"text"},[t._v("微信好友")])]),t._v(" "),a("div",{staticClass:"btn",on:{click:function(e){t.showShare=!1}}},[t._v("取消")])])])],1),t._v(" "),a("div",{staticClass:"tab"},t._l(t.tabList,(function(e,s){return a("div",{key:s,staticClass:"item"},[a("div",{staticClass:"text",on:{click:function(s){return t.linkTo(e)}}},[t._v(t._s(e.text.substr(0,2))),a("br"),t._v(t._s(e.text.substr(2,2)))])])})),0)])],1)}),[],!1,null,"5e95920a",null);e.default=c.exports},gw5Y:function(t,e,s){"use strict";var a=s("hbZR");s.n(a).a},hbZR:function(t,e,s){}}]);