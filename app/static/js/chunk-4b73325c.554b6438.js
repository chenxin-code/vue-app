(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4b73325c"],{"06b0":function(t,e,a){},"42cf":function(t,e,a){"use strict";a("06b0")},"8b2f":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.complete?a("div",{staticClass:"my-ebay"},[a("nav-top",{staticClass:"theme_bg_orange_i theme_font_white_i",attrs:{title:t.title,bgImg:1},on:{backEvent:function(e){return t.$router.go(-1)}}}),a("nav-content",{staticClass:"my-ebay-container"},[a("div",{staticClass:"top"},[a("div",{staticClass:"help-tips"},[a("span",{staticClass:"text",on:{click:t.openHelp}},[t._v("帮助说明")])]),a("div",{staticClass:"title"},[t._v("当前拥有")]),a("div",{staticClass:"ebay-num"},[a("span",{staticClass:"num"},[t._v(t._s(t.balanceUnit))]),t._v(t._s(t.title)+" ")])]),a("div",{staticClass:"my-ebay-info"},[a("div",{staticClass:"qr-div"},[a("div",{staticClass:"barcode",on:{click:t.barcodeBtn}},[a("canvas",{attrs:{id:"barcode"}})]),a("div",{staticClass:"codeimg-content"},[a("div",{ref:"qrcode",staticClass:"qrcode",attrs:{id:"qrcode"}})])])]),a("div",{staticClass:"choseOil",on:{click:t.pushHistory}},[t._v("查看历史记录")]),a("van-popup",{model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("div",{staticClass:"popup-show",on:{click:function(e){t.show=!1}}},[a("div",{staticClass:"barcode"},[a("canvas",{attrs:{id:"enlargeBarcode"}})])])])],1)],1):t._e()},n=[],s=a("5530"),o=(a("d81d"),a("4795"),a("d044")),c=a.n(o),r=a("62c5"),d=a.n(r),p=a("2f62"),u=a("efff"),l=a("19e7"),h=a("3f12"),y={data:function(){return{myInfo:{},show:!1,digitalPWD:"",statusObj:{totalAddUnit:0,expireBalanceUnit:0,totalConsumeUnit:0},cardList:[],dict:"",title:"",complete:!1,balanceUnit:""}},mounted:function(){this.getlist(),this.openVerify()},activated:function(){1==this.isPwdSet.status&&(this.payQrcodePay(this.isPwdSet.pwd,this.myInfo.qrcode),u["a"].close())},methods:{openVerify:function(){var t=this;"1"==this.$store.state.globalConfig.qrcodePayVerify?h["a"].open({type:"qrcodePay_verify",sureFunc:this.imgSureFunc,vertifyCancelEvent:function(){t.$router.go(-1)},paras:{phone:this.$store.state.login.phone,token:this.$store.state.login.token}}):this.imgSureFunc(null,null)},imgSureFunc:function(t,e){this.makePayQrcode(t,e)},getlist:function(){var t=this;this.$Loading.open();var e={token:this.$store.state.login.token,alias:"rewards_group"};this.$http.post("/app/json/app_dict/getDictByAlias",e).then((function(e){var a=e.data;if(t.$Loading.close(),0==a.status){t.cardList=a.data;var i=t.cardList||[];i.map((function(e){1==e.dictKey&&(t.getAccountBaseInfo(e.dictKey),t.dict=e,t.title=e.dictValue)}))}else t.$Toast(a.info);t.complete=!0}))},getAccountBaseInfo:function(t){var e=this,a={token:this.$store.state.login.token,acctType:8,groupValue:t};this.$http.post("/app/json/acct/getAccountBaseInfo",a).then((function(t){var a=t.data||{};0==a.status?(e.balanceUnit=a.data.balanceUnit,e.$set(e.dict,"details",a.data)):e.$Toast(a.info?a.info:"获取失败")}))},barcodeBtn:function(){var t=this;this.show=!0,this.$nextTick((function(e){var a=document.getElementById("barcode"),i=document.getElementById("enlargeBarcode");d()(a,t.myInfo.qrcode,{displayValue:!1,width:2,height:130}),d()(i,t.myInfo.qrcode,{displayValue:!1,width:2,height:130})}))},makePayQrcode:function(t,e){var a=this;this.$Loading.open();var i="/app/json/app_pay/makePayQrcode",n={token:this.$store.state.login.token,payMode:121,groupValue:1,distOuCode:1,imgVerifyCode:t,uuid:e};this.$http.post(i,n).then((function(t){a.$Loading.close();var e=t.data;0==e.status?(a.myInfo=e.data,a.$nextTick((function(){a.toCanvas(),clearInterval(a.queryPayStateTimer),a.queryPayStateTimer=setInterval((function(){a.payQrcodeCheck(a.myInfo.qrcode)}),2e3)}))):(a.$Toast(e.info),"1"==a.$store.state.globalConfig.qrcodePayVerify&&a.openVerify())}),(function(t){a.$Loading.close()}))},payQrcodeCheck:function(t){var e=this;this.digitalPWD="",this.$request.post("/app/json/app_pay/payQrcodeCheck",{payMode:121,qrcode:t,hideLoading:!0}).then((function(a){if(0===a.status&&(e.payDetais=a.data,e.payDetais.payUnit))if(clearInterval(e.queryPayStateTimer),e.payDetais.needPayPwd){if("1"==e.payDetais.payPwdState)return void e.$Toast("支付密码已锁定，请稍后再试！");u["a"].open({initData:{payPwdState:e.payDetais.payPwdState},toSettingPwd:function(){e.$router.push({path:"/usercenter/nosetpwd",query:{isSet:e.payDetais.payPwdState,source:"rebate"}}),u["a"].close()},inputFinished:function(a){e.digitalPWD=a,e.payQrcodePay(e.digitalPWD,t),u["a"].close()}})}else e.payQrcodePay(e.digitalPWD,t)}))},payQrcodePay:function(t,e){var a=this,i="";t&&(i=Object(l["a"])(t)),this.$request.post("/app/json/app_pay/payQrcodePay",{payMode:121,qrcode:e,PayPwd:i}).then((function(t){0===t.status?a.$router.push({path:"/usercenter/pay-results",query:{payInfo:JSON.stringify(a.payDetais)}}):a.$Toast(t.info)}))},toCanvas:function(){var t=document.getElementById("barcode");d()(t,this.myInfo.qrcode,{displayValue:!1});var e=document.getElementById("qrcode");e.innerHTML="";new c.a("qrcode",{width:200,height:200,text:this.myInfo.qrcode});var a=document.getElementById("qrcode").getElementsByTagName("img"),i=a[0];i.style.width="100%",i.style.height="100%"},pushHistory:function(){this.$keepaliveHelper.deleteCache(this),this.$router.push({path:"/oil-point-history"})},openHelp:function(){this.$router.push({path:"/help-instructions"})}},destroyed:function(){clearInterval(this.queryPayStateTimer)},computed:Object(s["a"])({},Object(p["c"])(["isPwdSet"])),components:{QRCode:c.a}},f=y,v=(a("42cf"),a("0c7c")),g=Object(v["a"])(f,i,n,!1,null,"0d478f1a",null);e["default"]=g.exports}}]);