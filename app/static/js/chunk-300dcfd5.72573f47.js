(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-300dcfd5"],{"0bc1":function(t,e,a){"use strict";a("5ea3")},"50f9":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"my-qrcode"},[a("nav-top",{attrs:{title:t.details.dictValue},on:{backEvent:t.backEvent}}),a("nav-content",{staticClass:"my-qrcode-container"},[t.complete?a("div",{staticClass:"code-content"},[a("div",{staticClass:"balance qr-div"},[a("p",[t._v("账户红包余额")]),a("span",{staticClass:"number"},[t._v(t._s(t.details.details.balanceUnit||"0"))])]),a("div",{staticClass:"qr-div"},[a("div",{staticClass:"barcode",on:{click:t.barcodeBtn}},[a("canvas",{attrs:{id:"barcode"}})]),a("div",{staticClass:"codeimg-content"},[a("div",{ref:"qrcode",staticClass:"qrcode",attrs:{id:"qrcode"}})])]),a("div",{staticClass:"choseOil",on:{click:t.pushHistory}},[t._v("查看历史记录")]),a("van-popup",{model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("div",{staticClass:"popup-show",on:{click:function(e){t.show=!1}}},[a("div",{staticClass:"barcode"},[a("canvas",{attrs:{id:"enlargeBarcode"}})])])])],1):t._e()])],1)},s=[],o=a("5530"),n=(a("4795"),a("d044")),c=a.n(n),d=a("62c5"),r=a.n(d),u=(a("da71"),a("efff")),l=a("19e7"),p=a("2f62"),y={name:"my-qrcode",components:{QRCode:c.a},data:function(){return{show:!1,myInfo:{},statusObj:{totalAddUnit:0,expireBalanceUnit:0,totalConsumeUnit:0},details:{details:{}},queryPayStateTimer:null,digitalPWD:"",payDetais:"",complete:!1}},mounted:function(){this.details=JSON.parse(this.$route.query.details),this.makePayQrcode()},activated:function(){1==this.isPwdSet.status&&(this.payQrcodePay(this.isPwdSet.pwd,this.myInfo.qrcode),u["a"].close())},methods:{backEvent:function(){this.$keepaliveHelper.deleteCache(this),this.$router.go(-1)},barcodeBtn:function(){var t=this;this.show=!0,this.$nextTick((function(e){var a=document.getElementById("barcode"),i=document.getElementById("enlargeBarcode");r()(a,t.myInfo.qrcode,{displayValue:!1,width:2,height:130}),r()(i,t.myInfo.qrcode,{displayValue:!1,width:2,height:130})}))},makePayQrcode:function(){var t=this;this.$Loading.open();var e="/app/json/app_pay/makePayQrcode",a={token:this.$store.state.login.token,payMode:121,groupValue:this.details.dictKey,distOuCode:1,imgVerifyCode:this.$route.query.verifyCode||"",uuid:this.$route.query.uuid||""};this.$http.post(e,a).then((function(e){t.$Loading.close();var a=e.data;0==a.status?(t.complete=!0,t.myInfo=a.data,t.$nextTick((function(){t.toCanvas(),clearInterval(t.queryPayStateTimer),t.queryPayStateTimer=setInterval((function(){t.payQrcodeCheck(t.myInfo.qrcode)}),2e3)}))):("1"==t.$store.state.globalConfig.qrcodePayVerify&&t.$router.go(-1),t.$Toast(a.info))}),(function(e){t.$Loading.close()}))},payQrcodeCheck:function(t){var e=this;this.digitalPWD="";var a="/app/json/app_pay/payQrcodeCheck",i={token:this.$store.state.login.token,payMode:121,qrcode:t};this.$http.post(a,i).then((function(a){var i=a.data;if(0==i.status&&(e.payDetais=i.data,e.payDetais.payUnit))if(clearInterval(e.queryPayStateTimer),e.payDetais.needPayPwd){if("1"==e.payDetais.payPwdState)return void e.$Toast("支付密码已锁定，请稍后再试！");u["a"].open({initData:{payPwdState:e.payDetais.payPwdState},toSettingPwd:function(){e.$router.push({path:"/usercenter/nosetpwd",query:{isSet:e.payDetais.payPwdState,source:"rebate"}}),u["a"].close()},inputFinished:function(a){e.digitalPWD=a,e.payQrcodePay(e.digitalPWD,t),u["a"].close()}})}else e.payQrcodePay(e.digitalPWD,t)}),(function(t){}))},payQrcodePay:function(t,e){var a=this,i="";t&&(i=Object(l["a"])(t)),this.$request.post("/app/json/app_pay/payQrcodePay",{payMode:121,qrcode:e,PayPwd:i}).then((function(t){0===t.status?a.$router.push({path:"/usercenter/pay-results",query:{payInfo:JSON.stringify(a.payDetais)}}):a.$Toast(t.info)}))},toCanvas:function(){var t=document.getElementById("barcode");r()(t,this.myInfo.qrcode,{displayValue:!1});var e=document.getElementById("qrcode");e.innerHTML="";new c.a("qrcode",{width:200,height:200,text:this.myInfo.qrcode});var a=document.getElementById("qrcode").getElementsByTagName("img"),i=a[0];i.style.width="100%",i.style.height="100%"},pushHistory:function(){this.$keepaliveHelper.deleteCache(this),this.$router.push({path:"/usercenter/rebatebonuslist",query:Object(o["a"])({title:this.details.dictValue,dictKey:this.details.dictKey},this.statusObj)})}},destroyed:function(){clearInterval(this.queryPayStateTimer)},computed:Object(o["a"])({},Object(p["c"])(["isPwdSet"]))},h=y,f=(a("0bc1"),a("0c7c")),v=Object(f["a"])(h,i,s,!1,null,"2a38a670",null);e["default"]=v.exports},"5ea3":function(t,e,a){}}]);