(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-662eb152"],{"7c61":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAFMN540AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHqADAAQAAAABAAAAHgAAAADKQTcFAAAEBElEQVRIDa1WPWgUQRSeNwkE9eJdo4U/JBaCQvYUtFFQUtiKkBhLG3tBFI0IEgXxB0Wws7Cw9Q9EsFUQsVHQO5tgYYKaxuaSuxgE3fF9b+/tzs7d3kVxi50373/evJ8xpv0tRtVZgIRfI6p+Ns6NArZC4U3lY12ICcdY5EBNv8ZY9MLNzFggiDdCJUuXnHMrg8AODQ5s+/nr92fAwqYbKFazD9nsUXD4HxgsDCgRCKhTJtiz5Z07DgEBo0BAfeoz0XcxAYZGtGvauPiqMDOhXK9tBJx+S9XqAdbQbFSrNxXZ/dRMLR+dHEgPbIi+spNbVAqrnFUQzvxm9+Z9zyUyCbcbSSIUv0z2nqQfOiUWOmTJXMvO6t1Tebi0lt68WUmJUNWIoinjzANV27HyiSr12lbFJ2b7CSm3t8olIrI5a9AueUXzyovD+iECXi44jt1zZZKVAw0CYM0IXLrmlc9rjaW7PgJwYsmOJ9kSvww9Uf72mau42s2KXM2KiMv1cwS3IFFWI4T7gycdVwVhlNjikyc3yJnDXFmbGPXWWrq4vlZ7FSoP7rmP+2SOVer1h6pE3IY1iXC/c3MCcSKlSZQEzEs91dpzbXtgpT49ThS0t01AFBrRXIpvp3BWiW2KZlKWFDRf+Vgb5Rb3xa9UDuLBrFLbwiqUKGkLjlXnfEGwcmZe7hAGQRWIRQgaNwJ88O3tKoxeseb9+7mV3btHhwbteCAkWyJa6CKcuaoeaBx8JY7MM8savvvI0FVVwBV0xucrT0ycJbdv35rFZuuHT+gLE31DPVgkOJK9r4DHAEFs5czr6/Xzq1XgV1+uMHCEpdbyPFfTBs9QApI9X6l/yHmYEw4FJB6t1kkydLqrwlCA97gAZ9ytcql0ByHpwiKoDsOozubjx1diZ6aLhP4Gj1AOT05eoJmZ2JfLGV6Koqv/y6BvBDAcwJ0qXgwnIV3+9Le9V5WseuW0LJfWbZesRGiRFEVG0ZJ05KBMi40k4176ebc2BkFurpKAbJPkyRG708UKQYFSO6694ecvPBm0sfSiFWi1dMtioBSQPbQbQTtoSCfD0K1xY0qmNWAwgpa0DHXIEw9A2ETDbjK+FNB6bLMTggndMR+BHqIZqYUO8jbb94L0DrMThhHonQM53TyueV7nUOGGZxvC2j2k3a+AVXwJ1fh72JRy4jF9jl9guZaWMvJA5Zf4fefMiXDEpTwKsJPMe495jzPvNkXnVjLT/Ka4LoZB6PvYzEn/48Z7yKSTES8bmQBEj/5RbbEYGdHtv57SE4dSEgFDt4saS8jfsecuxbV+yjfm8xQa9pnc1NRAc3Z2P3f5IyZ2e3gCbWo/JjGNFhhe4Gb8jsP3dHhi4nU4EHxdCv8BmRABAvEq9xAAAAAASUVORK5CYII="},"950e":function(t,e,s){},beeb:function(t,e,s){"use strict";s("950e")},ecd4:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.complete?i("div",{staticClass:"open-package",on:{click:t.cancelClickBtn}},[i("nav-top",{attrs:{title:"邀约详情"},on:{backEvent:function(e){return t.$router.go(-1)}}},[t.$route.query.shareId?i("i",{staticClass:"iconfont mall-gengduo",on:{click:function(e){e.stopPropagation(),t.dropmenuShow=!t.dropmenuShow}}}):t._e()]),i("nav-content",{staticClass:"open-package-container"},[i("div",{staticClass:"tab"},t._l(t.tabList,(function(e,s){return i("div",{key:s,staticClass:"item"},[i("div",{staticClass:"text",on:{click:function(s){return t.linkTo(e)}}},[t._v(t._s(e.text.substr(0,2))),i("br"),t._v(t._s(e.text.substr(2,2)))])])})),0),t.$route.query.shareId||"INVITEE"==t.joinType?i("div",[i("div",{directives:[{name:"show",rawName:"v-show",value:t.success&&!t.openSelf&&!t.openSuccess&&!t.openOthers,expression:"success && !openSelf && !openSuccess && !openOthers"}],staticClass:"title-tips"},[t._v(t._s(t.details.phone)+"邀请您一同开通家庭套餐")]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.openSuccess,expression:"openSuccess"}],staticClass:"title-tips aggress"},[t._v("申请成功！等待好友确认开通后即可享受套餐优惠")]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.openOthers,expression:"openOthers"}],staticClass:"title-tips aggress"},[t._v("开通失败，好友已和他人成功开通家庭套餐")]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.openSelf,expression:"openSelf"}],staticClass:"title-tips aggress",on:{click:t.goHome}},[t._v("开通成功！好友已和你成功开通家庭套餐点击"),i("span",{staticClass:"look"},[t._v("查看")]),t._v("更多开通信息")])]):t._e(),t.$route.query.id?i("div",["SIGNED_UP"==t.details.state?i("div",{staticClass:"title-tips aggress"},[t._v("邀约成功：已开通套餐")]):t._e(),"WAIT_SIGN_UP"==t.details.state&&1!=t.type&&t.details.signUpNum>t.details.joinNum?i("div",{staticClass:"title-tips aggress"},[t._v("邀约失败：受邀成员不足 ")]):t._e(),"WAIT_SIGN_UP"==t.details.state&&1!=t.type&&t.details.signUpNum<t.details.joinNum?i("div",{staticClass:"title-tips aggress"},[t._v("邀约失败：邀请人未确认开通套餐 ")]):t._e()]):t._e(),i("div",{staticClass:"info"},[i("div",{staticClass:"main"},[i("div",{staticClass:"card special"},[i("div",{staticClass:"left"},[t._v("套餐类型")]),i("div",{staticClass:"right"},[t._v(t._s(t.details.packageRefuelName))])]),i("div",{staticClass:"card change top"},[i("div",{staticClass:"left"},[t._v("套餐选择")]),i("ul",{staticClass:"type-list"},[i("li",{staticClass:"type-item"},[t._v(t._s(t.details.duration)+"天")])])]),i("div",{staticClass:"card people-num"},[i("div",{staticClass:"left"},[t._v("套餐人数")]),i("div",{staticClass:"right"},[t._v(t._s(t.details.signUpNum)+"人")])]),t.$route.query.shareId||"INVITEE"==t.joinType?t._e():i("div",{staticClass:"card change people"},[i("div",{staticClass:"left"},[t._v(" 家庭成员  "),t.details.signUpNum<t.orderDetailModelList.length?i("span",{staticClass:"tips"},[t._v("受邀成员过多，请踢除部分成员")]):t._e(),t.details.signUpNum>t.orderDetailModelList.length?i("span",{staticClass:"tips"},[t._v("成员不足，去邀请更多好友试试吧")]):t._e()]),i("ul",{staticClass:"invitation-list"},t._l(t.orderDetailModelList,(function(e,a){return i("li",{key:a,staticClass:"invitation-item"},[i("div",{staticClass:"oil-left"},[i("div",{staticClass:"name"},[t._v("油滴账号")]),i("div",{staticClass:"num"},[t._v(t._s(e.phone))])]),"INVITER"==e.joinType?i("div",{staticClass:"oil-right"},[t._v("邀请人")]):i("div",{staticClass:"oil-right",on:{click:function(s){return t.deleteBtn(e)}}},[i("img",{attrs:{src:s("7c61"),alt:""}})])])})),0),t.details.signUpNum>t.orderDetailModelList.length?i("div",{staticClass:"share-btn",on:{click:function(e){t.showShare=!0}}},[i("div",{staticClass:"text"},[t._v("再次分享")])]):t._e()]),i("div",{staticClass:"card change"},[i("div",{staticClass:"left"},[t._v("套餐优惠规则")]),i("div",{staticClass:"content",domProps:{innerHTML:t._s(t.details.packageRefuelDesc)}})])]),t.btnShow?i("div",{staticClass:"btn",class:{active:!t.$route.query.shareId&&t.details.signUpNum!=t.orderDetailModelList.length},on:{click:t.openBtn}},[t._v(t._s(t.$route.query.shareId||"INVITEE"==t.joinType?"申请加入":"确认开通")+" ")]):t._e(),i("van-popup",{attrs:{position:"bottom"},model:{value:t.showShare,callback:function(e){t.showShare=e},expression:"showShare"}},[i("div",{staticClass:"share-content"},[i("div",{staticClass:"title"},[t._v("邀请好友一同开通家庭套餐")]),i("div",{staticClass:"share-main",on:{click:t.shareBtn}},[i("div",{staticClass:"img"},[i("img",{attrs:{src:s("68ee"),alt:""}})]),i("div",{staticClass:"text"},[t._v("微信好友")])]),i("div",{staticClass:"btn",on:{click:function(e){t.showShare=!1}}},[t._v("取消")])])])],1),i("div",{staticClass:"wx-show"},[i("van-popup",{model:{value:t.showWxTips,callback:function(e){t.showWxTips=e},expression:"showWxTips"}},[i("div",{staticClass:"jt"},[i("img",{attrs:{src:s("be40"),alt:""}})]),i("div",{staticClass:"wx-tips-show"},[i("div",{staticClass:"wx-tips-content"},[i("div",{staticClass:"text1"},[t._v("1.点击右上角")]),i("div",{staticClass:"text2"},[t._v(" 2.点击 "),i("span",{staticClass:"img"},[i("img",{attrs:{src:s("14972"),alt:""}})]),t._v(" 发送给朋友 ")])])])])],1),t.$route.query.shareId?i("div",[i("div",{staticClass:"no-cancel"},[i("van-dialog",{attrs:{confirmButtonText:"取消"},on:{confirm:function(e){t.show=!1}},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("div",{staticClass:"tips"},[t._v("邀请链接已失效")])])],1),i("div",{staticClass:"have-cancel"},[i("van-dialog",{attrs:{confirmButtonText:"前往开通","show-cancel-button":""},on:{cancel:function(e){t.showNoOil=!1},confirm:t.openOil},model:{value:t.showNoOil,callback:function(e){t.showNoOil=e},expression:"showNoOil"}},[i("div",{staticClass:"tips"},[t._v("您还不是油滴账户，无法开通套餐")])])],1),i("div",{staticClass:"no-cancel"},[i("van-dialog",{attrs:{confirmButtonText:"取消"},on:{confirm:function(e){t.showOilState=!1}},model:{value:t.showOilState,callback:function(e){t.showOilState=e},expression:"showOilState"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.oilStateOpen,expression:"oilStateOpen"}],staticClass:"tips"},[t._v("您的油滴账号已被冻结,"),i("br"),t._v("无法开通套餐")]),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.oilStateOpen,expression:"!oilStateOpen"}],staticClass:"tips"},[t._v("您的油滴账号已被锁定,"),i("br"),t._v("无法开通套餐")])])],1),i("div",{staticClass:"no-cancel"},[i("van-dialog",{attrs:{confirmButtonText:"取消"},on:{confirm:function(e){t.showOpen=!1}},model:{value:t.showOpen,callback:function(e){t.showOpen=e},expression:"showOpen"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"open"}],staticClass:"tips"},[t._v("您已开通加油套餐,"),i("br"),t._v("无法接受好友邀约")]),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.open,expression:"!open"}],staticClass:"tips"},[t._v("您已接受其他邀约,"),i("br"),t._v("申请失败")])])],1)]):t._e(),i("div",{staticClass:"have-cancel"},[i("van-dialog",{attrs:{confirmButtonText:"确认剔除","show-cancel-button":""},on:{cancel:function(e){t.showDeletePeople=!1},confirm:t.confirmDelete},model:{value:t.showDeletePeople,callback:function(e){t.showDeletePeople=e},expression:"showDeletePeople"}},[i("div",{staticClass:"tips"},[t._v("确认剔除成员："+t._s(t.deletePeople.phone)+"？")])])],1)])],1):t._e()},a=[],o=(s("0d03"),s("99af"),s("4160"),s("159b"),s("ac1f"),s("1276"),s("a15b"),s("d7b9")),n=s("ca00"),l=s("da71"),c={data:function(){return{tabList:[{text:"套餐说明",type:1},{text:"我的邀约",type:2},{text:"历史签约",type:3}],complete:!1,showOilState:!1,show:!1,oilStateOpen:!0,open:!0,showNoOil:!1,showOpen:!1,dropmenuShow:!1,showDeletePeople:!1,date:"",showShare:!1,peopleList:[1,2,3,4],noOpen:!1,details:"",success:!1,btnShow:!0,openSelf:!1,openOthers:!1,openSuccess:!1,showWxTips:!1,orderDetailModelList:[],deletePeople:"",joinType:"",oilState:""}},mounted:function(){var t=this.$route.query.token;t&&"undefined"!==t&&"null"!==t&&(this.$store.state.login.token=t,this.$bridgefunc.vuexStorage()),this.date=n["a"].getMyDate(new Date),this.$route.query.shareId&&this.acceptInvite(),this.$route.query.id&&(this.joinType=this.$route.query.joinType||"",this.queryPackageOrderInfo())},methods:{share:function(){o["a"].share(this.details.packageRefuelName,"".concat(location.origin).concat(l["a"].shareUrl,"/redirect?shareId=").concat(this.details.id),this.details.pic,"好友邀请您一起来开通加油家庭套餐啦，加油返利更省钱")},cancelClickBtn:function(){this.dropmenuShow=!1,this.tabList.forEach((function(t){t.showClick=!1}))},goHome:function(){this.$router.push({path:"/oil-package"})},queryPackageOrderInfo:function(){var t=this;this.$request.post("/app/json/app_package_refuel/queryPackageOrderInfo",{id:this.$route.query.id}).then((function(e){0===e.status?(t.orderDetailModelList=e.data.orderDetailModelList,t.details=e.data.orderModel,2==t.$store.state.webtype&&t.share(),"INVITEE"==t.joinType&&1==t.orderDetailModelList.length&&"AGREED"==t.orderDetailModelList[0].joinState&&(t.openSuccess=!0,t.btnShow=!1),t.dealState(t.details.state,t.details.startDate),t.complete=!0):t.$Toast(e.info?e.info:"获取详情失败")}))},getAcctInfoList:function(){var t=this;this.$request.post("/app/json/app_youdi/getAcctInfoList",{}).then((function(e){0===e.status?(t.oilState=e.data||[],t.oilState.length?0==t.oilState.state?t.showNoOil=!0:2==t.oilState.state?(t.showOilState=!0,t.oilStateOpen=!0):4==t.oilState.state?(t.showOilState=!0,t.oilStateOpen=!1):t.agreeInvite():t.showNoOil=!0):t.$Toast(e.info?e.info:"获取油滴账户信息失败")}))},dealState:function(t,e,s){"WAIT_SIGN_UP"==t&&(this.type=this.timeJudge(e.split(" ")[0]))},timeJudge:function(t){var e=n["a"].getMyDate(new Date),s=new Date(t),i=new Date(s.getTime()+2592e5);return n["a"].dateCompare(e,n["a"].getPreTime(i.getTime()).split(" ")[0])},acceptInvite:function(){var t=this;this.$request.post("/app/json/app_package_refuel/acceptInvite",{id:this.$route.query.shareId}).then((function(e){if(0===e.status){t.details=e.data;var s=t.timeJudge(t.details.startDate.split(" ")[0]);if(-1==s)return t.show=!0,t.success=!0,void(t.btnShow=!1);"SIGNED_UP"==t.details.state?(t.btnShow=!1,t.details.signedOrderDetail?t.details.signedOrderDetail.packageRefuelOrderId==t.details.id?"INVITER"!=t.details.signedOrderDetail.joinType&&(t.openSelf=!0):(t.showOpen=!0,"SIGNED_UP"==t.details.signedOrderDetail.state?t.open=!0:t.open=!1):t.openOthers=!0):"WAIT_SIGN_UP"==t.details.state&&(t.details.signedOrderDetail?(t.btnShow=!1,t.details.signedOrderDetail.packageRefuelOrderId==t.details.id?t.openSuccess=!0:(t.showOpen=!0,"SIGNED_UP"==t.details.signedOrderDetail.state?t.open=!0:t.open=!1)):t.success=!0),t.complete=!0}else t.$Toast(e.info?e.info:"获取信息失败")}))},shareBtn:function(){2==this.$store.state.webtype?this.showWxTips=!0:this.share()},linkTo:function(t){1==t.type?this.$router.push({path:"/instructions"}):2==t.type?this.$router.push({path:"/my-invitation"}):this.$router.push({path:"/history-invitation"})},openBtn:function(){this.$route.query.shareId?this.getAcctInfoList():this.details.signUpNum==this.orderDetailModelList.length&&this.signPackageRefuel()},signPackageRefuel:function(){var t=this,e="";e=this.$route.query.startDate?this.$route.query.startDate:n["a"].getNextMinutes();var s=[];this.orderDetailModelList.forEach((function(t){s.push(t.id)})),this.$request.post("/app/json/app_package_refuel/signPackageRefuel",{packageRefuelId:this.details.packageRefuelId,startDate:e,id:this.$route.query.id,inviteeIds:s.join(",")}).then((function(e){0===e.status?(t.$Toast("开通成功"),t.$router.go(-1)):t.$Toast(e.info?e.info:"获取列表失败")}))},agreeInvite:function(){var t=this;this.$request.post("/app/json/app_package_refuel/agreeInvite",{id:this.$route.query.shareId}).then((function(e){0===e.status?(t.btnShow=!1,t.openSuccess=!0):t.$Toast(e.info?e.info:"获取信息失败")}))},openOil:function(){window.location.href="/app-vue/oildrop"},confirmDelete:function(){var t=this;this.$request.post("/app/json/app_package_refuel/removeInvitee",{id:this.$route.query.id,inviteeIds:this.deletePeople.id}).then((function(e){0===e.status?(t.$Toast("删除成功"),t.queryPackageOrderInfo()):t.$Toast(e.info?e.info:"获取信息失败")}))},deleteBtn:function(t){this.deletePeople=t,this.showDeletePeople=!0}},components:{}},r=c,d=(s("beeb"),s("0c7c")),p=Object(d["a"])(r,i,a,!1,null,"0d22e644",null);e["default"]=p.exports}}]);