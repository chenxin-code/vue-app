(window.webpackJsonp=window.webpackJsonp||[]).push([[124],{"/TVe":function(e,t,s){"use strict";var i=s("SpzE");s.n(i).a},Fa9I:function(e,t,s){"use strict";var i=s("HDVs");s.n(i).a},GKa6:function(e,t,s){},H7Ms:function(e,t,s){"use strict";var i=s("RGQu");s.n(i).a},HDVs:function(e,t,s){},RGQu:function(e,t,s){},SpzE:function(e,t,s){},bfkV:function(e,t,s){"use strict";var i={name:"empty",props:{description:{type:String,default:"暂无订单"}},data:function(){return{imgUrl:s("x2n3")}}},a=(s("Fa9I"),s("KHd+")),o=Object(a.a)(i,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"empty"},[t("van-empty",{staticClass:"custom-image",attrs:{image:this.imgUrl,description:this.description}})],1)}),[],!1,null,"1227a0e7",null);t.a=o.exports},vsNf:function(e,t,s){"use strict";var i=s("GKa6");s.n(i).a},x2n3:function(e,t,s){e.exports=s.p+"static/img/noOrder.6272a9f.png"},zPPR:function(e,t,s){"use strict";s.r(t),s("5+UC");var i,a=s("05lO"),o=(s("rB5s"),s("VD6T")),n=(s("Ya7C"),s("0xSJ")),r=(s("CdMl"),s("LW2U")),l=s("7tbW"),c=s.n(l),h=s("3tWz"),u=s.n(h),p=s("ZiUS"),v=s.n(p),m={props:["leftTitle","rightTitle"],data:function(){return{adapterTop:"0.426667rem"}},created:function(){var e=window.screen.height/window.screen.width,t=window.screen.height==window.screen.availHeight?1.8:1.65;this.adapterTop=e<t?"1.173333rem":"0.426667rem"},methods:{goBack:function(){this.$emit("backEvent")},navToPage:function(){this.$emit("navToPage")}}},d=(s("H7Ms"),s("KHd+")),f=Object(d.a)(m,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"nav-top",style:{"padding-top":e.adapterTop}},[s("div",{on:{click:e.goBack}},[s("i",{staticClass:"icon"}),e._v(" "),s("span",{staticClass:"left-title"},[e._v(e._s(e.leftTitle))])]),e._v(" "),e.rightTitle?s("span",{staticClass:"right-title",on:{click:e.navToPage}},[e._v(e._s(e.rightTitle))]):e._e()])}),[],!1,null,"52e44c84",null).exports,g={props:["checkData","mergeAmount","total","resultList"],data:function(){return{isChecked:!1,isShow:!1,amount:{integer:"0",decimal:"00"},isX:!1}},created:function(){/iphone/gi.test(navigator.userAgent)&&812==screen.height&&375==screen.width?(console.log("是iphonex"),this.isX=!0):(console.log("不是iphonex"),this.isX=!1)},methods:{checkEvent:function(e){var t=Array.from(this.checkData);console.log("paydiv",t),console.log("resultList",this.resultList),0!=t.length&&(this.resultList.checked=this.isChecked,this.resultList.checkAll=!0,this.$emit("checkEvent",this.resultList))},mergePay:function(){this.$emit("mergePay")}},watch:{mergeAmount:function(e,t){var s=this.$util.toDecimal2(e).toString().split(".");this.amount.integer=s[0],this.amount.decimal=s[1]}}},y=(s("/TVe"),Object(d.a)(g,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"pay-content"},[s("div",{staticClass:"pay-div"},[s("div",[s("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"pay-box"},[s("van-checkbox",{attrs:{"checked-color":"#f80f16","icon-size":"18px"},on:{click:function(t){return e.checkEvent(t)}},model:{value:e.isChecked,callback:function(t){e.isChecked=t},expression:"isChecked"}}),e._v(" "),s("div",{staticClass:"text"},[s("p",{staticClass:"p1"},[e._v("全选")]),e._v(" "),s("div",{staticClass:"checkAll"},[s("div",{staticClass:"all"},[e._v("\n              合计"),s("span",[e._v("￥"),s("span",[e._v(e._s(e.amount.integer))]),e._v("."),s("span",{staticClass:"decimal"},[e._v(e._s(e.amount.decimal))])])])])])],1)]),e._v(" "),s("div",{staticClass:"pay"},[s("div",{staticClass:"btn",on:{click:e.mergePay}},[s("div",{staticClass:"text"},[e._v("去结算")]),e._v(" "),s("div",{staticClass:"total"},[e._v("("+e._s(e.total)+")")])])])]),e._v(" "),e.isX?s("div",{staticClass:"adapter-iphoneX"}):e._e()])}),[],!1,null,"743f209e",null).exports),k=s("bfkV"),w=s("KK7d"),b=s("aMtl"),C=s("kB5k"),_=s("wd/R"),T=s.n(_);function P(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var N={data:function(){return{offsetTop:"0rem",billValue:0,typeOption:[{text:"待支付",value:0},{text:"已完成",value:1}],isLoading:!1,isFinishBill:!1,isMonthPay:!1,checkData:new Set,mergeAmount:0,payTotal:0,currentPage:0,results:[],showEmpty:!1,loading:!1,finished:!1,pageTimes:"",showFinishText:!1,billNosList:[],isPaying:!1,isShowNumLoading:!0,isShowPayDiv:!1,totalPayableAmount:0,checkPcs:!1,errorMsg:"",showErrorMsg:!1}},components:(i={navTop:f,payDiv:y,Empty:k.a},P(i,r.a.name,r.a),P(i,n.a.name,n.a),P(i,o.a.name,o.a),i),beforeRouteEnter:function(e,t,s){"/billCenter/detail"===t.path?e.meta.keepAlive=!0:e.meta.keepAlive=!1,s()},created:function(){"1"==this.$route.query.billDetailType?(this.isFinishBill=!0,this.billValue=1):(this.isFinishBill=!1,this.billValue=0,this.isShowPayDiv=!0),this.getBillDetail()},activated:function(){},methods:{toast:function(){a.a.loading({duration:0,type:"loading",message:"加载中...",forbidClick:!0})},getBillDetail:function(){var e=this;this.showEmpty=!1,this.loading=!0,this.isFinishBill&&(this.showFinishText=!1,this.finished=!1,this.currentPage++);var t,s={airDefenseNo:this.$route.query.airDefenseNo,memberId:this.$store.state.userInfo.phone?this.$store.state.userInfo.phone:"",status:this.isFinishBill?90:10,type:2,pageNo:this.isFinishBill?this.currentPage:1,pageTimes:this.isFinishBill&&this.pageTimes?this.pageTimes:""};t="development"==this.$store.state.environment?"http://m-center-uat.linli.timesgroup.cn/times/charge-bff/order-center/api-c/v1/getList":"https://m-center-prod-linli.timesgroup.cn/times/charge-bff/order-center/api-c/v1/getList",this.$http.get(t,{params:s}).then((function(t){var s=t.data.data;if(200===t.data.code){if(e.isFinishBill)if(e.isShowPayDiv=!1,e.totalPayableAmount="0.00",s.finish.length&&s.finish[0].records.length)if(1===e.currentPage)e.results=s.finish[0],e.pageTimes=e.results.pageTimes;else{var i=e.pageTimes?v()(e.pageTimes,",").length:0;if(i&&i===e.currentPage||1===i)e.finished=!0,e.showFinishText=!0;else{var o=s.finish[0].records,n=e.results.records.concat(o);e.results.records=n,e.finished=!1}}else e.results=[];else s.notpay.length&&s.notpay[0].records.length?(e.results=s.notpay[0],e.totalPayableAmount=e.results.totalPayableAmount,e.finished=!0,e.showFinishText=!0,e.isShowPayDiv=!0):(e.results=[],e.isShowPayDiv=!1);console.log("this.results",e.results),e.loading=!1,e.isLoading=!1,0===e.results.length?(e.showEmpty=!0,e.finished=!0,e.showFinishText=!1):e.isMonthPay="1"==e.results.managementFeeCycle,e.isShowNumLoading=!1}else e.results=[],Object(a.a)({duration:500,message:t.data.message});e.$forceUpdate()}))},checkShop:function(e,t,s){e.shopCheck?this.shopTrue(e):this.shopFalse(e)},checkSingle:function(e,t){t.checked?this.checkTrue(e,t):this.checkFalse(e,t)},checkTrue:function(e,t){if(console.log("checkTrue item",e),console.log("checkTrue itemIn",t),this.isMonthPay){this.checkData.add(t),e.checked=!0,this.$refs.payDiv.isShow=!0,this.payTotal=this.checkData.size;var s=Array.from(this.checkData);e.shopCheck||null==e.shopCheck||s.length===e.quarterList.length&&(e.shopCheck=!0);var i=s.reduce((function(e,t){return Object(C.BigNumber)(e).plus(t.monthPayableAmount)}),0);this.mergeAmount=i,this.$refs.billItem.length===s.length&&(this.$refs.payDiv.isChecked=!0)}else{this.checkData.add(e),this.$refs.payDiv.isShow=!0,this.payTotal=this.checkData.size;var a=Array.from(this.checkData);console.log("mergeList checkTrue",a);var o=a.reduce((function(e,t){return Object(C.BigNumber)(e).plus(t.monthPayableAmount)}),0);this.mergeAmount=o,this.$refs.billItem.length===a.length&&(this.$refs.payDiv.isChecked=!0)}this.$forceUpdate()},checkFalse:function(e,t){console.log("checkFalse item",e),console.log("checkFalse itemIn",t),this.isMonthPay?(this.checkData.delete(t),t.checked=!1):(console.log("checkFalse checkData",e),this.checkData.delete(t)),e.shopCheck=!1,this.payTotal=this.checkData.size;var s=Array.from(this.checkData);console.log("mergeList checkFalse",s);var i=s.reduce((function(e,t){return Object(C.BigNumber)(e).plus(t.monthPayableAmount)}),0);this.mergeAmount=i,this.$refs.payDiv.isChecked=!1,0===this.payTotal&&(this.$refs.payDiv.isShow=!1),this.$forceUpdate()},shopTrue:function(e){var t=this;e.quarterList.forEach((function(e,s){t.checkTrue(e,s)}))},shopFalse:function(e){var t=this;e.quarterList.forEach((function(s){t.checkFalse(e,s)}))},checkPayDiv:function(e){var t=this;e.checked?(this.isMonthPay?(this.$refs.checkShop&&this.$refs.checkShop.filter((function(e,t){e.checked=!0})),this.$refs.checkboxGroup&&this.$refs.checkboxGroup.filter((function(e,t){e.checked=!0}))):e.forEach((function(e){e.shopCheck=!0,e.quarterList.forEach((function(e,s){t.checkTrue(e,s)}))})),this.billNosList=this.results.billNos,this.mergeAmount=this.results.totalPayableAmount,console.log("this.mergeAmount",this.mergeAmount)):(this.isMonthPay?(this.$refs.checkShop&&this.$refs.checkShop.filter((function(e,t){e.checked=!1})),this.$refs.checkboxGroup&&this.$refs.checkboxGroup.filter((function(e,t){e.checked=!1}))):e.forEach((function(e){e.shopCheck=!1,e.quarterList.forEach((function(e,s){t.checkFalse(e,s)}))})),this.billNosList=[],this.checkData=new Set,this.$refs.payDiv.isShow=!1,this.mergeAmount=0,this.payTotal=0)},backEvent:function(){this.$router.go(-1)},navToPage:function(){w.a.openTargetRouter({type:"microapp",uri:"com.times.microapp.AppcInvoice",path:"/",hideNavbar:!0})},onRefresh:function(){this.$refs.payDiv.isShow=!1,this.checkData=new Set,this.mergeAmount=0,this.payTotal=0,this.results=[],this.showFinishText=!1,this.loading=!0,this.finished=!1,this.isShowNumLoading=!0,this.currentPage=0,this.isShowPayDiv=!1,this.pageTimes="",this.getBillDetail()},onChangeBillType:function(e){this.$refs.payDiv.isShow=!1,this.isFinishBill=!!e,this.isMonthPay=!1,this.checkData=new Set,this.mergeAmount=0,this.payTotal=0,this.results=[],this.showFinishText=!1,this.loading=!0,this.finished=!1,this.isShowNumLoading=!0,this.currentPage=0,this.isShowPayDiv=!1,this.checkPcs=!1,this.getBillDetail()},mergePay:function(){var e=this;this.toast();var t=Array.from(this.checkData),s=t.filter((function(e){return e.monthList}));console.log("payData",s);var i=[];s.forEach((function(e,t){e.billNos.forEach((function(e){i.push(e)}))}));var o=u()(i,",");if(0==t.length)a.a.clear(),this.$toast("请选择账单");else{var n=[];s.forEach((function(e,t){e.billNos.forEach((function(e){n.push(e.toString())}))}));var r,l=[];r="development"==this.$store.state.environment?"http://times-pcs.linli580.com.cn:8888/pcs/bill-center/check-bill":"https://times-pms.linli580.com/pcs/bill-center/check-bill";var h={list:n};this.$http.post(r,JSON.stringify(h)).then((function(t){if("0000"==t.data.code){for(var i=t.data.data,n=0;n<i.length;n++)1!=i[n].status&&2!=i[n].status||l.push(i[n].status);if(console.log("详情页checkStatus",l),c()(l).includes(2))a.a.clear(),e.showErrorMsg=!0,e.errorMsg="尊敬的邻里邦用户，该账单不存在，请重新刷新页面，获取最新账单。";else if(c()(l).includes(1))a.a.clear(),e.showErrorMsg=!0,e.errorMsg="尊敬的邻里邦用户，该账单信息已经更新，请重新刷新页面，获取最新账单。";else{var r=[];s.forEach((function(e,t){r.push(e.isPay)})),console.log("是否支付中账单",r),r.includes(1)?(a.a.clear(),e.showErrorMsg=!0,e.errorMsg="尊敬的邻里邦用户，由于上次账单支付异常中断，为确保您的账户安全，请稍等10分钟后重新支付，感谢您的理解。"):(console.log("提交账单中心参数",{businessCstNo:e.$store.state.userInfo.phone,platMerCstNo:s[0].platMerCstNo,tradeMerCstNo:s[0].tradeMerCstNo,billNo:o,appScheme:"x-engine",payType:!1}),b.a.YJBillPayment({businessCstNo:e.$store.state.userInfo.phone,platMerCstNo:s[0].platMerCstNo,tradeMerCstNo:s[0].tradeMerCstNo,billNo:o,appScheme:"x-engine",payType:!1,__ret__:function(t){console.log("---------------开始支付提交记录---------------------"),console.log(t),"1"==t.billRetStatus?e.$router.push({path:"/order/2?orderPage=false"}):(a.a.clear(),e.showErrorMsg=!0,e.errorMsg=t.billRetStatusMessage?t.billRetStatusMessage:"支付失败")}}))}}}))}},goToDetail:function(e,t){if(console.log("goToDetail",e),t){var s=T()(e.payTime).format("YYYY-MM-DD"),i="/advancePaymentDetails?type=1&amount="+e.realAmount+"&objectName="+this.results.spaceFullName+"&customerName="+e.proprietorName+"&tollDate="+s+"\n        &payWay="+e.payType+"&tradeMerCstno="+e.tradeMerCstNo+"&platMerCstno="+e.platMerCstNo+"&projectName="+e.showInfo+"&navTitleName=账单详情";w.a.openTargetRouter({type:"microapp",uri:"com.times.microapp.AppcPrepay",path:i,hideNavbar:!1})}else this.$router.push({path:"/billCenter/detail",query:{buildings:this.results.spaceFullName,businessCreateTime:e.businessCreateTime,houseNo:e.houseNo,showInfo:e.showInfo,showInfoExt:e.showInfoExt,proprietorName:e.proprietorName,payableAmount:e.payableAmount,realAmount:e.realAmount,platMerCstNo:e.platMerCstNo,tradeMerCstNo:e.tradeMerCstNo,airDefenseNo:e.airDefenseNo,status:e.status,recStartTime:e.businessParams.recStartTime,recEndTime:e.businessParams.recEndTime,chargeYear:e.businessParams.chargeYear}})},closeTanC:function(){this.showErrorMsg=!1}}},D=(s("vsNf"),Object(d.a)(N,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"bill-detail"},[s("van-sticky",{attrs:{"offset-top":e.offsetTop}},[s("nav-top",{attrs:{leftTitle:"账单明细",rightTitle:"发票查询"},on:{backEvent:e.backEvent,navToPage:e.navToPage}})],1),e._v(" "),s("div",{staticClass:"warpper"},[s("div",{staticClass:"summary"},[s("div",{staticClass:"house-title"},[e._v(e._s(this.$route.query.houseName))]),e._v(" "),s("div",{staticClass:"pay-total"},[s("div",{staticClass:"text"},[e._v("待缴纳总金额：")]),e._v(" "),e.isShowNumLoading?e._e():s("div",{staticClass:"money"},[s("span",{staticClass:"currency-symbol"},[e._v("￥")]),e._v(e._s(e.totalPayableAmount)+"\n        ")]),e._v(" "),e.isShowNumLoading?s("div",{staticClass:"money"},[s("van-loading",{attrs:{size:"20"}})],1):e._e()])]),e._v(" "),s("div",{staticClass:"bill-list"},[s("div",{staticClass:"title"},[e._m(0),e._v(" "),s("div",{staticClass:"operation"},[s("van-dropdown-menu",{attrs:{overlay:!1}},[s("van-dropdown-item",{attrs:{options:e.typeOption},on:{change:e.onChangeBillType},model:{value:e.billValue,callback:function(t){e.billValue=t},expression:"billValue"}})],1)],1)]),e._v(" "),s("div",{staticClass:"content",class:e.showEmpty?"empty":""},[s("van-pull-refresh",{on:{refresh:e.onRefresh},model:{value:e.isLoading,callback:function(t){e.isLoading=t},expression:"isLoading"}},[s("van-list",{staticStyle:{height:"100%",width:"100%","overflow-y":"auto"},attrs:{finished:e.finished,"finished-text":e.showFinishText?"--没有更多了--":"","immediate-check":!1,offset:10},on:{load:e.getBillDetail},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[e._l(e.results.records,(function(t,i){return s("div",{key:i,staticClass:"list"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isFinishBill,expression:"!isFinishBill"}]},[s("van-checkbox",{directives:[{name:"show",rawName:"v-show",value:!e.isMonthPay,expression:"!isMonthPay"}],ref:"checkShop",refInFor:!0,attrs:{name:i,"checked-color":"#ee0a24"},on:{click:function(s){return e.checkShop(t,i,e.isMonthPay)}},model:{value:t.shopCheck,callback:function(s){e.$set(t,"shopCheck",s)},expression:"item.shopCheck"}},[e._v(e._s(t.quarterTitle))]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isMonthPay,expression:"isMonthPay"}],staticClass:"title-hd"},[e._v("\n                  "+e._s(t.quarterTitle)+"\n                ")])],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isFinishBill,expression:"isFinishBill"}],staticClass:"title-hd"},[e._v("\n                "+e._s(t.quarterTitle)+"\n              ")]),e._v(" "),e._l(t.quarterList,(function(i,a){return s("div",{key:a,ref:"billItem",refInFor:!0,staticClass:"item"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isFinishBill,expression:"!isFinishBill"}],staticClass:"check-operation"},[s("van-checkbox",{directives:[{name:"show",rawName:"v-show",value:e.isMonthPay,expression:"isMonthPay"}],ref:"checkboxGroup",refInFor:!0,attrs:{"checked-color":"#ee0a24"},on:{change:function(s){return e.checkSingle(t,i,a)}},model:{value:i.checked,callback:function(t){e.$set(i,"checked",t)},expression:"detail.checked"}})],1),e._v(" "),s("div",{staticClass:"item-box",class:{"finish-item":e.isFinishBill}},[s("div",{staticClass:"detail-title"},[s("div",{staticClass:"month-text"},[s("span",{staticClass:"num"},[e._v(e._s(i.month))]),e._v(" "),s("span",[e._v(e._s(i.monthTitle))])]),e._v(" "),s("div",{staticClass:"status"},[s("span",{directives:[{name:"show",rawName:"v-show",value:!e.isFinishBill,expression:"!isFinishBill"}],staticClass:"pay-status",class:1==i.isPay?"paying":"need"},[e._v(e._s(1==i.isPay?"支付中":"待支付"))]),e._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:e.isFinishBill,expression:"isFinishBill"}],staticClass:"pay-status finish"},[e._v("已完成")]),e._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:!e.isFinishBill,expression:"!isFinishBill"}],staticClass:"pay-money"},[e._v("￥"+e._s(i.monthPayableAmount))])])]),e._v(" "),e._l(i.monthList,(function(t,i){return s("div",{key:i,staticClass:"detail-item",on:{click:function(s){return e.goToDetail(t,e.isFinishBill)}}},[s("span",{staticClass:"detail-name"},[e._v(e._s(t.showInfo)),s("i")]),e._v(" "),s("span",{staticClass:"detail-money"},[e._v("￥"+e._s(t.payableAmount))])])}))],2)])}))],2)})),e._v(" "),s("Empty",{directives:[{name:"show",rawName:"v-show",value:e.showEmpty,expression:"showEmpty"}],attrs:{description:e.isFinishBill?"暂无账单":"恭喜您，账单已经全部缴清啦!"}})],2)],1)],1)])]),e._v(" "),s("pay-div",{directives:[{name:"show",rawName:"v-show",value:e.isShowPayDiv,expression:"isShowPayDiv"}],ref:"payDiv",attrs:{checkData:e.checkData,mergeAmount:e.mergeAmount,total:e.payTotal,resultList:e.results.records},on:{checkEvent:e.checkPayDiv,mergePay:e.mergePay}}),e._v(" "),e.showErrorMsg?s("div",{staticClass:"tanc-box"},[s("div",{staticClass:"content"},[s("div",{staticClass:"bg-box"}),e._v(" "),s("div",{staticClass:"message-box"},[e._v(e._s(e.errorMsg))]),e._v(" "),s("div",{staticClass:"btn-box",on:{click:e.closeTanC}},[e._v("确认")])]),e._v(" "),s("div",{staticClass:"close-btn",on:{click:e.closeTanC}})]):e._e()],1)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"text"},[t("i",{staticClass:"icon"}),this._v(" "),t("span",[this._v("您的专属账单")])])}],!1,null,"6f9d6d46",null));t.default=D.exports}}]);