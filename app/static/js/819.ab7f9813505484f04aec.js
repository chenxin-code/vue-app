(window.webpackJsonp=window.webpackJsonp||[]).push([[819],{"7D/8":function(e,t,s){"use strict";s.r(t);var o=s("uQt8"),i=s("Gedb"),n=s("W34l"),r={name:"login-binding",components:{CountButton:o.a},data:function(){return{phone:"",passwords:"",isShowPwd:!1,regChannel:"",authcode:"",firstLevel:!1,msgCode:"",bindType:"",referrer:"",scanCode:"",canEditReferrer:!0}},watch:{msgCode:function(e){this.msgCode=this.$util.checkVerifyCodeLenght(this.msgCode)}},methods:{changeBindType:function(){1==this.bindType?this.bindType=4:4==this.bindType&&(this.bindType=1)},scanCodeFunc:function(){var e=this;this.$bridgefunc.scanCode((function(t){e.scanCode=t.code,e.referrer=t.code}))},backEvent:function(){this.$router.go(-1)},checkOutFun:function(){if(""!=this.phone)if(/^1\d{10}$/.test(this.phone)){if(4==this.bindType){if(""==this.msgCode)return void this.$Toast("验证码不能为空")}else if(""==this.passwords)return void this.$Toast("密码不能为空");this.registerFun()}else this.$Toast("手机号格式不对!");else this.$Toast("手机号不能为空!")},getMsgCode:function(e,t){var s=this;if(""!=this.phone){this.$refs.countBtn.startTime(),this.$Loading.open();var o={phone:this.phone,smsType:"1020",imgVerifyCode:e,uuid:t,category:"oilsale"};this.$http.post("/app/json/login/sendSms",o).then((function(e){s.$Loading.close(),console.log(e.data);var t=e.data;0==t.status?s.$Toast("获取短信验证码成功"):(s.$Toast(t.info?t.info:"获取短信验证码失败"),s.$refs.countBtn.resetClock())}),(function(e){s.$Loading.close(),s.$Toast("系统运行过程中遇到问题，请稍候再试"),s.$refs.countBtn.resetClock()}))}else this.$Toast("手机号不能为空!")},registerFun:function(){var e=this,t={phone:this.phone,thirdUserId:this.thirdUserId,regChannel:this.regChannel};this.referrer&&this.referrer.length&&(t.rfrCode=this.referrer),this.referrer==this.scanCode?t.rfrCodeType=2:t.rfrCodeType=1,4==this.bindType?(t.smsVerifyCode=this.msgCode,t.userPwd=Object(i.a)(this.phone)):1==this.bindType&&(t.userPwd=Object(i.a)(this.passwords)),t.bindType=this.bindType,2==this.$store.state.webtype?(this.$Loading.open(),n.a.getWechatSignature((function(s){s?n.a.wxGetLocation((function(s){e.$store.state.currentLocation.posx=s?s.longitude:"",e.$store.state.currentLocation.posy=s?s.latitude:"",e.$mallCommon.addressAnalysis((function(s){e.$Loading.close(),t.province=e.$store.state.mall2.selectAddress.provinceName,t.provinceCode=e.$store.state.mall2.selectAddress.provinceId,t.city=e.$store.state.mall2.selectAddress.cityName,t.cityCode=e.$store.state.mall2.selectAddress.cityId,t.longitude=e.$store.state.currentLocation.posx,t.latitude=e.$store.state.currentLocation.posy,e.apiEvent(t)}),s)})):e.apiEvent(t)}))):(t.province=this.$store.state.mall2.selectAddress.provinceName,t.provinceCode=this.$store.state.mall2.selectAddress.provinceId,t.city=this.$store.state.mall2.selectAddress.cityName,t.cityCode=this.$store.state.mall2.selectAddress.cityId,t.longitude=this.$store.state.currentLocation.posx,t.latitude=this.$store.state.currentLocation.posy,this.apiEvent(t))},apiEvent:function(e){var t=this;this.$Loading.open(),this.$http.post("/app/json/login/bindThirdUser",e).then((function(e){t.$Loading.close(),console.log(e.data);var s=e.data;0==s.status?(t.$Toast("绑定成功"),t.firstLevel?t.$userCenter.retsetToIndex(s.data,1):t.$userCenter.retsetToIndex(s.data,2)):2002==s.errorCode?t.$Toast(s.info?s.info:"手机号已存在用户已注册"):t.$Toast(s.info?s.info:"注册失败")}),(function(e){t.$Loading.close(),t.$Toast("系统运行过程中遇到问题，请稍候再试")}))}},mounted:function(){this.referrer=sessionStorage.getItem("USER_NO")||"",this.referrer&&(this.canEditReferrer=!1)},created:function(){this.regChannel=this.$route.query.regChannel,this.thirdUserId=this.$route.query.thirdUserId,this.authcode=this.$route.query.code,this.firstLevel=this.$route.query.firstLevel,this.bindType=this.$route.query.bindType?this.$route.query.bindType:1}},a=(s("fs/3"),s("KHd+")),d=Object(a.a)(r,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"login-binding  login2"},[s("nav-top",{on:{backEvent:e.backEvent}}),e._v(" "),s("nav-content",[s("div",{staticClass:"register"},[s("div",{staticClass:"text-input"},[s("div",{staticClass:"cell-phone"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.phone,expression:"phone"}],attrs:{placeholder:"请输入手机号",type:"number"},domProps:{value:e.phone},on:{input:function(t){t.target.composing||(e.phone=t.target.value)}}})])]),e._v(" "),1==e.bindType?s("div",{staticClass:"passwords-input"},[s("div",{staticClass:"passwords"},["checkbox"==(e.isShowPwd?"text":"password")?s("input",{directives:[{name:"model",rawName:"v-model",value:e.passwords,expression:"passwords"}],attrs:{placeholder:"请输入密码",type:"checkbox"},domProps:{checked:Array.isArray(e.passwords)?e._i(e.passwords,null)>-1:e.passwords},on:{change:function(t){var s=e.passwords,o=t.target,i=!!o.checked;if(Array.isArray(s)){var n=e._i(s,null);o.checked?n<0&&(e.passwords=s.concat([null])):n>-1&&(e.passwords=s.slice(0,n).concat(s.slice(n+1)))}else e.passwords=i}}}):"radio"==(e.isShowPwd?"text":"password")?s("input",{directives:[{name:"model",rawName:"v-model",value:e.passwords,expression:"passwords"}],attrs:{placeholder:"请输入密码",type:"radio"},domProps:{checked:e._q(e.passwords,null)},on:{change:function(t){e.passwords=null}}}):s("input",{directives:[{name:"model",rawName:"v-model",value:e.passwords,expression:"passwords"}],attrs:{placeholder:"请输入密码",type:e.isShowPwd?"text":"password"},domProps:{value:e.passwords},on:{input:function(t){t.target.composing||(e.passwords=t.target.value)}}})]),e._v(" "),s("div",{staticClass:"show-passwords",on:{click:function(t){e.isShowPwd=!e.isShowPwd}}},[s("img",{staticClass:"see-icon",attrs:{src:e.isShowPwd?"static/image/login2/see-icon.png":"static/image/login2/icon-eye.png"}})])]):e._e(),e._v(" "),4==e.bindType?s("div",{staticClass:"passwords-input"},[s("div",{staticClass:"passwords"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.msgCode,expression:"msgCode"}],attrs:{placeholder:"请输入验证码"},domProps:{value:e.msgCode},on:{input:function(t){t.target.composing||(e.msgCode=t.target.value)}}})]),e._v(" "),s("div",{staticClass:"forget-btn"},[s("count-button",{ref:"countBtn",staticClass:"theme_standard_font_i",attrs:{phone:e.phone},on:{getSmsEvent:e.getMsgCode}})],1)]):e._e(),e._v(" "),2==e.$store.state.webtype&&"0"!=e.$store.state.globalConfig.user_register_referrer_input?s("div",{staticClass:"passwords-input"},[s("div",{staticClass:"passwords"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.referrer,expression:"referrer"}],attrs:{placeholder:"请输入推荐码",disabled:!e.canEditReferrer},domProps:{value:e.referrer},on:{input:function(t){t.target.composing||(e.referrer=t.target.value)}}})]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.canEditReferrer,expression:"canEditReferrer"}],staticClass:"show-passwords",on:{click:e.scanCodeFunc}},[s("img",{staticClass:"see-icon",attrs:{src:"static/image/setting/icon-scan.png"}})])]):e._e(),e._v(" "),s("div",{staticClass:"common-btn theme_standard_bg theme_font_white bind-btn",on:{click:e.checkOutFun}},[e._v("绑定")]),e._v(" "),2!=e.$store.state.webtype?s("div",{staticClass:"login-way"},[s("div",{staticClass:"btn-extend",on:{click:e.changeBindType}},[e._v(e._s(1==e.bindType?"短信验证绑定":"密码验证绑定"))])]):e._e()])])],1)}),[],!1,null,"58ba210e",null);t.default=d.exports},"fs/3":function(e,t,s){"use strict";var o=s("l2U9");s.n(o).a},l2U9:function(e,t,s){}}]);