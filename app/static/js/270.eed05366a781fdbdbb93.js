(window.webpackJsonp=window.webpackJsonp||[]).push([[270,713,1005],{"15TJ":function(t,e,s){},"28rc":function(t,e,s){"use strict";s.r(e);var a=s("xZc2"),i=s("Vqiz"),r=s("csf6"),o=s("mbR2"),n=s("mCA+"),l={name:"cart",components:{CartList:i.a,AdPage:o.a},props:{hasBack:{type:Boolean,default:!0},commonShow:{type:Boolean,default:!1}},data:function(){return{topArr:[],deliverType:null,listZitiId:null,cartAddress:null,isEditing:!1,peisongNum:0,zitiNum:0,dataIsLoad:!1,firstZiti:!0,orderCategory:"",vipUnitUserCode:void 0,lastPath:"",cartNum:0,showBackBtn:!0}},methods:{toPresaleCart:function(){this.$router.push({path:"/mall2/presalecart"})},backEvent:function(){this.$router.go(-1),this.$keepaliveHelper.deleteCache(this)},setEdit:function(){this.isEditing=!this.isEditing},getAddressName:function(){var t=null;return 2==this.deliverType?t="":1==this.deliverType&&(t=""),t},chooseAddress:function(t){if(2==t)this.$router.push({path:"/mall2/addresslist"});else{if("cnooc"==this.$store.state.globalConfig.app_home_special_flag)return;this.$router.push({path:"/mall2/mypickupaddress"})}},deliverTypeEvent:function(t){2==t.type?(this.saveItemSel(t),this.getData()):1==t.type&&(1!=this.firstZiti||null!=this.$store.state.mall2.zitiAddress.id&&""!=this.$store.state.mall2.zitiAddress.id?(this.saveItemSel(t),this.getData()):this.chooseAddress(t.type),this.firstZiti=!1)},saveItemSel:function(t){t.hasShow=!0,this.deliverType=t.type,this.$store.state.mall2.staticDeliverType=this.deliverType,this.$bridgefunc.vuexStorage()},pageShow:function(){this.deliverType=this.$store.state.mall2.staticDeliverType,this.getData()},getData:function(){var t=this;if(1==this.deliverType)r.a.checkIsInitialLoad((function(e){if(e)t.getData();else{var s=t.getCartRef(t.deliverType);t.$nextTick((function(){if(t.$refs[s]){var e=t.$refs[s];console.log("this.$store.state.mall2.zitiAddress",t.$store.state.mall2.zitiAddress),console.log("this.$route.query.pickupAddress",t.$route.query.pickupAddress),e[0].getDataList(),sessionStorage.removeItem("RHY_Pickup_Address")}}))}}));else{var e=this.getCartRef(this.deliverType);this.$nextTick((function(){t.$refs[e]&&(t.$refs[e][0].getDataList(),sessionStorage.removeItem("RHY_Pickup_Address"))}))}},getCartRef:function(t){return"cart"+t},getItemByType:function(t){for(var e=0;e<this.topArr.length;e++){var s=this.topArr[e];if(s.type==t)return s}return null},_getCartCount:function(t){var e=this,s={token:this.$store.state.login.token,deliveryType:t,orderCategory:this.orderCategory,vipUnitUserCode:this.vipUnitUserCode};this.$http.post("/app/json/app_cart/getCartCount",s).then((function(s){var a=s.data;0==a.status&&(e.goodsCount=a.data,1==t?e.zitiNum=a.data:e.peisongNum=a.data)}),(function(t){}))}},activated:function(){if(2==this.$store.state.globalConfig.presaleType&&(this.cartNum=n.a.getCartNum()),("/common"!=this.$route.path||this.commonShow)&&1==this.dataIsLoad){this.deliverType=this.$store.state.mall2.staticDeliverType;var t=this.getItemByType(this.deliverType);this.deliverTypeEvent(t)}},beforeRouteLeave:function(t,e,s){t.path!=this.lastPath&&"/"!=this.lastPath&&""!=this.lastPath||this.$keepaliveHelper.deleteCache(this),s()},mounted:function(){var t=this;this.deliverType=this.$store.state.mall2.staticDeliverType;var e=this.getItemByType(this.deliverType);this.deliverTypeEvent(e),setTimeout((function(){t.dataIsLoad=!0}),500),1==this.deliverType?(this.zitiNum=this.$store.state.mall2.cartNum,"cnooc"==this.$store.state.globalConfig.app_home_special_flag?""!=this.$store.state.mall2.zitiAddress.mchOuCode&&this._getCartCount(2):this._getCartCount(2)):(this.peisongNum=this.$store.state.mall2.cartNum,"cnooc"==this.$store.state.globalConfig.app_home_special_flag?""!=this.$store.state.mall2.zitiAddress.id&&this._getCartCount(2):this._getCartCount(1))},created:function(){var t=this;if(this.lastPath=this.$route.query.lastPath?this.$route.query.lastPath:"",this.topArr=a.a.getTopArr(),this.$route.query.pickupId)this.$mallCommon.getSysStoreById(this.$route.query.pickupId,(function(e){t.$store.state.mall2.zitiAddress=e,sessionStorage.setItem("RHY_Pickup_Address",t.$route.query.pickupId),t.$userCenter._setDefaultPickupAddress(e.id)}));else if(this.$route.query.pickupAddress){var e=JSON.parse(this.$route.query.pickupAddress);this.$store.state.mall2.zitiAddress=e,sessionStorage.setItem("RHY_Pickup_Address",this.$route.query.pickupAddress),this.$userCenter._setDefaultPickupAddress(e.id)}this.listZitiId=this.$route.query.pickupId,this.cartAddress=this.$store.state.mall2.selectAddress,this.orderCategory=this.$route.query.orderCategory,this.vipUnitUserCode=this.$route.query.vipUnitUserCode,console.log("this.$store.state.webtype",this.$store.state.webtype),2!=this.$store.state.webtype&&3!=this.$store.state.webtype||"/common"!=this.$route.path?this.showBackBtn=!0:this.showBackBtn=!1},watch:{"$store.state.mall2.cartNum":function(t,e){0==t&&(this.isEditing=!1),1==this.deliverType?this.zitiNum=t:this.peisongNum=t}},computed:{goodsCount:{get:function(){return this.$store.state.mall2.cartNum},set:function(){}}}},u=(s("qfH3"),s("KHd+")),c=Object(u.a)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"cart"},[s("nav-top",{attrs:{noTitle:!0,noBack:!t.hasBack,showBackBtn:t.showBackBtn},on:{backEvent:t.backEvent}},[s("div",{staticClass:"cart-top"},[s("div",{staticClass:"cart-title"},[s("span",{staticClass:"title theme_font_black"},[t._v("购物车("+t._s(t.goodsCount)+")")])]),t._v(" "),t.goodsCount>0?s("p",{staticClass:"cart-edit theme_font_gray",on:{click:t.setEdit}},[t._v("\n        "+t._s(t.isEditing?"完成":"编辑")+"\n      ")]):t._e()])]),t._v(" "),s("nav-content",[s("div",{staticClass:"list-content",class:{notop:"1"==t.$store.state.globalConfig.delivertype_default||"2"==t.$store.state.globalConfig.delivertype_default}},t._l(t.topArr,(function(e,a){return e.hasShow?s("CartList",{directives:[{name:"show",rawName:"v-show",value:t.deliverType==e.type,expression:"deliverType == item.type"}],key:a,ref:t.getCartRef(e.type),refInFor:!0,attrs:{deliverType:e.type,isEditing:t.isEditing,orderCategory:t.orderCategory,vipUnitUserCode:t.vipUnitUserCode},on:{updateEdit:t.setEdit}}):t._e()})),1)]),t._v(" "),s("AdPage",{attrs:{pageAdKeywords:"AD_Key_Cart"}})],1)}),[],!1,null,"f8c7ec4c",null);e.default=c.exports},AXlJ:function(t,e,s){},chc6:function(t,e,s){"use strict";var a=s("2nGb"),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var s=0;s<e.length;s++){var a=e[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,s,a){return s&&t(e.prototype,s),a&&t(e,a),e}}(),o=document.getElementsByTagName("head")[0],n=function(){function t(e,s){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.url=e||"",this.funcName=s;var i=document.createElement("script");e+=(~e.indexOf("?")?"&":"?")+"callback="+s,i.src=e,i.type="text/javascript",this.myTimer=setTimeout((function(){a.callCallback({status:1,info:"网络加载较慢！"}),a.clearup()}),1e4),window[s]=function(t){a.callCallback({status:0,data:t,info:""}),a.clearup()},i.onerror=function(){a.callCallback({status:1,info:"网络加载较慢！"}),a.clearup()},this.scriptNode=i,o.appendChild(this.scriptNode)}return r(t,[{key:"then",value:function(t){this.callbackFunc=t}},{key:"callCallback",value:function(t){var e=this;setTimeout((function(){e.callbackFunc(t)}),0)}},{key:"clearup",value:function(){this.myTimer&&clearTimeout(this.myTimer),this.myTimer=null,this.scriptNode.src="",o.removeChild(this.scriptNode)}}]),t}(),l={request:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!t)throw new Error("url 不能为空");return 0!=t.indexOf("http")&&(t=a.a.baseURL+t),s.forEach((function(e){if("object"===(void 0===e?"undefined":i(e)))for(var s in e)t+=~t.indexOf("?")?"&":"?",t+=s+"="+e[s]})),new n(t,e)},cancelAll:function(){}};e.a=l},g2bL:function(t,e,s){"use strict";var a=s("AXlJ");s.n(a).a},mbR2:function(t,e,s){"use strict";var a=s("chc6"),i={name:"adpage",components:{ImageAd:function(){return s.e(772).then(s.bind(null,"BAEh"))}},props:["pageAdKeywords","pgCode"],data:function(){return{pageData:null,show:!1}},computed:{showAdpage:function(){var t=this.show&&null!=this.pageData&&this.pageData.adData&&""!=this.pageData.adData;return t&&null==this.pageData.adData.rows.find((function(t){return 0!=t.canSee}))&&(t=!1),t}},methods:{adPageIsShow:function(t){var e=window.localStorage.getItem(this.pageAdKeywords+t);e?(new Date).getTime()>e&&(this.show=!0):this.show=!0},adPageHide:function(){this.show=!1},getMyPageData:function(){var t=this,e="vuePageData_",s=[];s.push({appType:1}),s.push({accessType:2}),this.pgCode&&""!=this.pgCode?(e+=this.pgCode,s.push({pgCode:this.pgCode})):(s.push({pageAdKeywords:this.pageAdKeywords}),e+=this.$util.md5String(this.pageAdKeywords)),a.a.request("/appcontent/js/app_vue_page/vuePageData.js",e,s).then((function(e){if(0==e.status){var s=e.data.pageData;if(!s.pageDataJson)return;t.pageData=JSON.parse(s.pageDataJson);var a=e.data.id||"",i=t.pageData.adData;if(t.adPageIsShow(a),i&&t.show)if("1"==i.showFrequency){var r=new Date;r=r.setDate(r.getDate()+1),r=new Date(r).setHours(2,0,0,0);var o=new Date(r).getTime();window.localStorage.setItem(t.pageAdKeywords+a,o)}else if("2"==i.showFrequency){var n=new Date;n=n.setDate(n.getDate()+999);var l=new Date(n).getTime();window.localStorage.setItem(t.pageAdKeywords+a,l)}else if("3"==i.showFrequency){var u=(new Date).getTime()+36e3;window.localStorage.setItem(t.pageAdKeywords+a,u)}else if("4"==i.showFrequency){var c=(new Date).getTime()+0;window.localStorage.setItem(t.pageAdKeywords+a,c)}else{var d=(new Date).getTime()+36e5;window.localStorage.setItem(t.pageAdKeywords+a,d)}}}))}},created:function(){this.getMyPageData()}},r=(s("g2bL"),s("KHd+")),o=Object(r.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.showAdpage?s("div",{staticClass:"adpage",on:{click:function(e){return e.stopPropagation(),t.adPageHide(e)}}},[s("div",[s("ImageAd",{attrs:{usePorpData:!0,propData:t.pageData},on:{closeEvent:t.adPageHide}})],1)]):t._e()}),[],!1,null,"52850f74",null);e.a=o.exports},qfH3:function(t,e,s){"use strict";var a=s("15TJ");s.n(a).a}}]);