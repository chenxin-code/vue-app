(window.webpackJsonp=window.webpackJsonp||[]).push([[276],{"/AsD":function(t,e,a){},"8MwQ":function(t,e,a){"use strict";a.r(e);var s=a("VxuK"),n=a.n(s),i=a("Z6Mb"),r=a("ZToj"),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c={name:"calendar",mixins:[i.a],data:function(){return{title:"",initPage:!1,showRecord:!1,tableMonth:-1,calendar:[],stationList:[],sideFiltrateModalShow:!1,price:"0",loading:!1,allMoney:0,finished:!1,danjia:"",grayDate:!0,obj:{},page:0,station:{stationCode:"",stationName:""},stationModel:"",signInData:{},searchName:"",areaShowName:"附近",winPrize:[],searchType:"",cityId:"",channel:"",weeks:["一","二","三","四","五","六","日"],itemId:"",lastPath:"",today:"",calendarDay:"",priceA:"",priceB:"",priceC:"",datePrice:[],shareInfo:{isShare:0},nums:0}},created:function(){this.lastPath=this.$route.query.lastPath},beforeRouteLeave:function(t,e,a){t.path==this.lastPath&&this.$keepaliveHelper.deleteCache(this),a()},mounted:function(){this.nowDate=new Date,this.tableYear=this.nowDate.getFullYear(),this.tableMonth=this.nowDate.getMonth(),this.itemId=this.$route.query.itemId,this.messageData(),this.today=this.getNowFormatDate(),console.log(this.today)},computed:{monthFormat:function(){return["一","二","三","四","五","六","七","八","九","十","十一","十二"][this.tableMonth]},numberOfDaysTotal:function(){var t=0;return this.signInData&&this.signInData.gameSigninRecordModelList&&this.signInData.gameSigninRecordModelList.length>0&&(t=this.signInData.gameSigninRecordModelList[this.signInData.gameSigninRecordModelList.length-1].daysTotal),t}},methods:{messageData:function(){var t=this,e=this;e.page=e.page+1;var a={token:this.$store.state.login.token,itemId:e.$route.query.itemId,pageThis:e.page,pageSize:10,keyWord:""};this.$Loading.open(),e.ticketListData(a).then((function(a){if(t.$Loading.close(),a.data.result)if(e.obj=a.data.data[0]||{},0==Object.keys(a.data.data[0].datePrices).length)t.getCalendar(),e.calendar.forEach((function(t,s){t.redData=!1;var n=new Date(t.date),i=n.getFullYear()+""+(n.getMonth()+1)+n.getDate();Number(i)==Number(e.today.replace(/-/g,""))?(console.log("同一天"),t.price=a.data.data[0].original_price,t.priceA=a.data.data[0].nett_price,t.priceB=a.data.data[0].back_cash,t.priceC=a.data.data[0].market_price):(console.log("bu同一天"),t.price=a.data.data[0].sku_suggest_price,t.priceA=a.data.data[0].sku_user_price,t.priceB=a.data.data[0].sku_back_cash,t.priceC=a.data.data[0].sku_suggest_price),t.price>0?t.selectData=!0:t.selectData=!1}));else{console.log(666),console.log(o(a.data.data[0].datePrices)),console.log(a.data.data[0].datePrices);var s=[],n=a.data.data[0].datePrices;for(var i in n)s.push(Object.assign({},n[i],{date:i}));e.datePrice=s,e.getCalendar(),e.selectCalendar()}}))},selectCalendar:function(){var t=this;0!=t.datePrice.length&&t.calendar.forEach((function(e){t.datePrice.forEach((function(a){a.date===t.$util.formatDate(e.date,"yyyy-MM-dd")&&(e.selectData=!0)}))}))},getNowFormatDate:function(){var t=new Date,e=t.getFullYear(),a=t.getMonth()+1,s=t.getDate();return a>=1&&a<=9&&(a="0"+a),s>=0&&s<=9&&(s="0"+s),e+"-"+a+"-"+s},getCalendar:function(){var t=this,e=[],a=new n.a.Generator({onlyDays:!0,weekStart:1,lang:"zh"}),s=this._clearHours(new Date),i=a(this.tableYear,this.tableMonth);console.log(i),i.cells.forEach((function(a,n){if("prevMonth"===a.type||"monthDay"===a.type||"nextMonth"===a.type){var i=a.date&&t._clearHours(a.date);a.type=i===s?"today":a.type,0==Object.keys(t.obj.datePrices).length||t.datePrice.forEach((function(e){t._clearHours(e.date)===i&&(a.obj=e,console.log(a.obj))})),a.redData=!1,a.selectData=!1,e.push(a)}})),this.calendar=e},signHandler:function(t,e){if(console.log(t),0==Object.keys(this.obj.datePrices).length){var a=(s=new Date(t.date)).getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate();console.log(a),this.calendar.forEach((function(t){t.redData=!1})),this.calendar[e].redData=!0,console.log(this.calendar),this.grayDate=!1,this.nums=1,this.calendarDay=a,this.price=t.price,console.log(this.price),this.priceA=t.market_price,this.priceC=t.suggest_price,this.allMoney=(Number(this.price)*this.nums).toFixed(2)}else if(1==this.calendar[e].selectData){var s;a=(s=new Date(t.date)).getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate(),console.log(a),this.calendar.forEach((function(t){t.redData=!1})),this.calendar[e].redData=!0,this.grayDate=!1,this.nums=1,this.calendarDay=a,this.price=t.obj.price,console.log(this.price),this.priceA=t.obj.market_price,this.priceC=t.obj.suggest_price,this.allMoney=(Number(this.price)*this.nums).toFixed(2)}else this.$Toast("当前日期不可购买")},signIn:function(){this.signHandler({date:new Date})},_clearHours:function(t){var e=new Date(t);return e.setHours(0,0,0,0),e.getTime()},toOrder:function(){1==this.grayDate?this.$Toast("请先选择日期"):(r.a.commit("putpeople",[]),this.$router.push({path:"/carefree_trave/writingOrder",query:{itemId:this.$route.query.itemId,nums:this.nums,allMoney:this.allMoney,price:this.price,priceA:this.priceA,priceB:this.priceB,priceC:this.priceC}}))},less:function(){1==this.grayDate?this.$Toast("请先选择日期"):(this.nums>0?(this.nums--,this.allMoney=(this.allMoney-this.price).toFixed(2)):(this.nums=0,this.allMoney=0),0==this.nums&&(this.grayDate=!0))},inputs:function(t){console.log(t),0==t.srcElement.value&&(this.grayDate=!0)},add:function(){1==this.grayDate?this.$Toast("请先选择日期"):(console.log(333,this.price),this.nums++,this.allMoney=(Number(this.price)*this.nums).toFixed(2))},prevMonth:function(){this.tableMonth--,this.tableMonth<0&&(this.tableMonth=11,this.tableYear--),this.nowDate=new Date,this.nowDate.setMonth(this.tableMonth),this.nowDate.setFullYear(this.tableYear),this.getCalendar(),this.messageData(),this.selectCalendar()},nextMonth:function(){this.tableMonth++,this.tableMonth>11&&(this.tableMonth=0,this.tableYear++),this.nowDate.setMonth(this.tableMonth),this.nowDate.setFullYear(this.tableYear),this.getCalendar(),this.messageData(),this.selectCalendar()}}},l=(a("JRy3"),a("KHd+")),h=Object(l.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sign-in-container"},[a("nav-top",{attrs:{title:"日期选择"},on:{backEvent:function(e){return t.$router.go(-1)}}}),t._v(" "),a("nav-content",[a("div",{staticClass:"calendar-container"},[a("div",{staticClass:"calendar-wrapper"},[a("div",{staticClass:"calendar-content"},[a("div",{staticClass:"line"}),t._v(" "),a("div",{staticClass:"month-choose-wrapper"},[a("div",{staticClass:"btn left-btn",on:{click:t.prevMonth}}),t._v(" "),a("div",{staticClass:"month"},[t._v(t._s(t.monthFormat)+"月")]),t._v(" "),a("div",{staticClass:"btn right-btn",on:{click:t.nextMonth}})]),t._v(" "),a("ul",{staticClass:"calendar-list"},[t._l(7,(function(e,s){return a("li",{key:s,staticClass:"calendar-item other"},[a("span",{staticClass:"text"},[t._v(t._s(t.weeks[s]))])])})),t._v(" "),t._l(t.calendar,(function(e,s){return a("li",{key:s+10,staticClass:"calendar-item",class:{colour:1==e.selectData,red:1==e.redData},on:{click:function(a){return t.signHandler(e,s)}}},[a("span",{staticClass:"text"},[t._v(t._s(e.desc))]),t._v(" "),e.obj?[e.obj.price?a("span",{staticClass:"money",class:{colour:1==e.selectData,red:1==e.redData}},[t._v("￥"+t._s(e.obj.suggest_price))]):t._e(),t._v(" "),a("span",{staticStyle:{display:"none"}},[t._v(t._s(e.obj.price))]),t._v(" "),a("span",{staticStyle:{display:"none"}},[t._v(t._s(e.obj.price))])]:[e.price&&e.price>0?a("span",{staticClass:"money",class:{colour:1==e.selectData,red:1==e.redData}},[t._v("￥"+t._s(e.price))]):t._e()]],2)}))],2)])])]),t._v(" "),a("div",{staticClass:"box"},[a("p",[t._v("可用时间")]),t._v(" "),a("p",[t._v(t._s(t.obj.startTime)+"~"+t._s(t.obj.expireTime))]),t._v(" "),a("span",[t._v("（限"+t._s(t.obj.week)+"可用）")])]),t._v(" "),a("div",{staticClass:"box box1"},[a("div",[a("p",[t._v("购票数量")]),t._v(" "),a("span",[t._v("￥"+t._s(t.price)+"元")])]),t._v(" "),a("div",{staticClass:"div divs"},[a("div",{staticClass:"num"},[a("span",{class:{gray:1==t.grayDate},on:{click:t.less}},[t._v("-")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.nums,expression:"nums"}],attrs:{type:"number",disabled:t.grayDate},domProps:{value:t.nums},on:{input:[function(e){e.target.composing||(t.nums=e.target.value)},t.inputs]}}),a("span",{class:{gray:1==t.grayDate},on:{click:t.add}},[t._v("+")])])])])]),t._v(" "),a("div",{staticClass:"box div4"},[a("p",[t._v("总额："),a("span",{staticClass:"span1"},[t._v("￥"+t._s(t.allMoney))])]),t._v(" "),a("span",{staticClass:"span2",class:{gray:1==t.grayDate},on:{click:t.toOrder}},[t._v("下一步")])])],1)}),[],!1,null,"6ea586a4",null);e.default=h.exports},JRy3:function(t,e,a){"use strict";var s=a("/AsD");a.n(s).a},MmhS:function(t,e){var a=864e5;function s(t,e){return new Date(t,e+1,0).getDate()}function n(t,e,a){return 0===e&&a>50?t-1:11===e&&a<10?t+1:t}function i(t,e,s,n){e>11&&(e=0,t++);var i=new Date(t,e,s);n&&i.setDate(i.getDate()+4-(i.getDay()||7));var r=n?i.getFullYear():t,o=new Date(r,0,1),c=1+Math.round((i-o)/a);n||(c+=o.getDay());var l=Math.ceil(c/7);if(!n){var h=new Date(t,e,s),d=new Date(t+1,0,1),u=d.getDay();h.getTime()>=d.getTime()-a*u&&(l=1)}return l}t.exports=function(t){return function(t,e,a){for(var r,o,c,l=this.lang||"en",h=this.onlyDays,d=void 0===this.weekStart?1:this.weekStart,u=1===d,p=[],g=d-(new Date(t,e,1).getDay()||(u?7:0)),m=i(t,e,1,u),y=s(t,e),v=s(t,e-1),f=n(t,e,m),D={month:e,year:t,daysInMonth:y},b=0;b<7;b++){c=g;for(var _=0;_<8;_++){b>0&&_>0&&g++,g>y||g<1?(o=g>y?g-y:v+g,r=g>y?e+1:e-1):(o=g,r=e);var M=c!==g&&b>0,w={desc:M?o:m,week:m,type:0===_?"weekLabel":0===b?"dayLabel":g<1?"prevMonth":g>y?"nextMonth":"monthDay",format:u?"ISO 8601":"US",date:!!M&&new Date(Date.UTC(t,r,o)),year:f,index:p.length};a&&("function"==typeof a?w=a.call(D,w,l):a.forEach((function(t){w=t.call(D,w,l)}))),h&&M?p.push(w):h||p.push(w)}b>0&&(m=i(t,r,o+1,u)),f=n(t,e,m)}return D.cells=p,D}.bind(t)}},VxuK:function(t,e,a){t.exports={Generator:a("MmhS"),addLabels:a("Z8gK")}},XJak:function(t,e){t.exports={weekPlaceholder:"",columnNames:{en:{0:"w",1:"monday",2:"tuesday",3:"wednesday",4:"thursday",5:"friday",6:"saturday",7:"sunday"},sv:{0:"v",1:"måndag",2:"tisdag",3:"onsdag",4:"torsdag",5:"fredag",6:"lördag",7:"söndag"},pt:{0:"s",1:"segunda",2:"terça",3:"quarta",4:"quinta",5:"sexta",6:"sábado",7:"domingo"}},monthNames:{en:["January","February","March","April","May","June","July","August","September","October","November","December"],sv:["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],pt:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"]},classes:{dayLabel:"day-of-week",weekLabel:"week-number",prevMonth:"inactive",nextMonth:"inactive",monthDay:"day-in-month"}}},Z6Mb:function(t,e,a){"use strict";e.a={methods:{ticketListData:function(t){return this.$http.post("/app/json/app_travel/queryTicketList",t)},orderData:function(t){return this.$http.post("/app/json/app_travel/queryTicketList",t)},orderdetailData:function(t){return this.$http.post("/app/json/app_travel/detail",t)},orderdetail1Data:function(t){return this.$http.post("/app/json/app_shopping_order/detail",t)},placeorderData:function(t){return this.$http.post("/app/json/app_travel/placeAnOrder",t)},cancelorderData:function(t){return this.$http.post("/app/json/app_travel/cancelOrder",t)},payorderData:function(t){return this.$http.post("/app/json/app_travel/placingOrder",t)},afterData:function(t){return this.$http.post("/app/json/app_travel/queryAfterSaleList",t)},afterdetailData:function(t){return this.$http.post("/app/json/app_travel/queryAfterSaleList",t)},afterapplyData:function(t){return this.$http.post("/app/json/app_travel/submitAfterSale",t)}}}},Z8gK:function(t,e,a){var s=a("XJak");function n(t,e){var a=[s.classes[t.type]];return t.class?t.class=("string"==typeof t.class?[t.class]:t.class).concat(a):t.class=a,t.type.indexOf("Label")>0&&(0==t.index&&s.weekPlaceholder?t.desc=s.weekPlaceholder:t.index<8?t.desc=s.columnNames[e][t.index]:t.index%8==0&&(t.desc=t.week)),t.date&&(t.monthName=s.monthNames[e][t.date.getMonth()]),this.monthName||(this.monthName=s.monthNames[e][this.month]),this.labels||(this.labels={monthNames:s.monthNames[e],columnNames:s.columnNames[e],classes:s.classes}),t}n.setLabels=function(t){!function t(e,a){for(var s in e)a[s]?null==(n=e[s])||n.constructor!==Array&&n.constructor!==Object||t(e[s],a[s]):a[s]=e[s];var n}(t,s)},t.exports=n}}]);