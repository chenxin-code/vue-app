(window.webpackJsonp=window.webpackJsonp||[]).push([[617],{JsoE:function(t,e,a){"use strict";var i=a("uw1k");a.n(i).a},Pw99:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABLUlEQVRYR+2WvRGDMAyF5ca02SQZgWyQjEDFTFSMQDYIIySbpMUNOXP4Lufzj55cOAWUnK33+VmSpajypyrr0wHwvw4Mw3DTWs9d131K8mQcx5Mxpu37/hGKE3TAihPRREQvrfVVCrGLP4noQkT3EEQQwG5clmVWSp2lEL/i67q+m6ZpQweJ5kAJBFfcXkkyCSUQiHgWwC5AIFBxFgAXQiLOBshBSMUhgBiE/W+M2Uotle2xXgJ3Qj8n9sAicdgBdwoPgiQnd7FgB9xVONv3QOKOCQP4CbfZWNAxIYBQtluAkrbNBkiVGtKs/GpgAXDqXAqRBeCIR6qDlZjZxwhtMqgTyecYFZc4ER1IpOIoRHIkK+lwgbeDP5LZzVWH0pIpGN2bLUM0ILr+AKjuwBeoBoQwAQ33qQAAAABJRU5ErkJggg=="},Rh9f:function(t,e,a){"use strict";a.r(e);var i=a("db0i"),n={name:"index",components:{},data:function(){return{paymentMethod:"",payInfo:[],payWay:[],hasToPay:!1,hasToPays:"",payMode:"",myTimer:null,timeValue:0,timeString:"",prepayId:"",orderNo:"",clinetId:"",integer:"",decimal:"",redirectUrl:"",hiddenInterface:!1}},methods:{backEvent:function(){window.history.go(-1)},payWaySelected:function(t){this.hasToPays!=t.payModeSub&&(this.hasToPays=t.payModeSub,this.payMode=t.payMode),t.payModeSub&&(this.paymentMethod=t.text)},payEvent:function(){var t=this;if(""!=this.hasToPays){var e=" ",a=" ";""!=this.payInfo.payModeSub?(e=this.payInfo.payModeSub,a=this.payInfo.payMode):(this.setPayWays(),e=this.hasToPays,a=this.payMode),this.$Loading.open();var n={clinetId:this.payInfo.clinetId,orderNo:this.payInfo.orderNo,payMode:a,payModeSub:e};this.$http.post("/app/json/app_pay/externalPay",n).then((function(e){t.hasToPay=!0,t.$Loading.close(),i.a.doPay(t.payWay[0],e.data.data.payInfo).then((function(){if(t.redirectUrl)if(t.redirectUrl.indexOf("?")>"-1"){var e=t.redirectUrl+"&result=success";window.location.replace(e)}else{var a=t.redirectUrl+"?result=success";window.location.replace(a)}else window.history.go(-1)})).catch((function(){t.$Toast("支付失败，请重新支付！")}))}),(function(e){t.hasToPay=!1,t.$Loading.close()}))}else this.$Toast("请选择支付方式！")},setPayWays:function(){var t,e=this;return(t=regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.getPayWays(e.payInfo.orderType,e.payInfo.occurOuCode);case 2:e.payWay=t.sent,e.payWay.length>0&&(e.selectedPayWay=e.payWay[0]),e.hasToPays=e.payWay[0].payModeSub,e.payMode=e.payWay[0].payMode,e.paymentMethod=e.payWay[0].text;case 7:case"end":return t.stop()}}),t,e)})),function(){var e=t.apply(this,arguments);return new Promise((function(t,a){return function i(n,s){try{var o=e[n](s),r=o.value}catch(t){return void a(t)}if(!o.done)return Promise.resolve(r).then((function(t){i("next",t)}),(function(t){i("throw",t)}));t(r)}("next")}))})()},checkPayResult:function(){var t=this;this.$Loading.open();var e={prepayId:this.prepayId,orderNo:this.orderNo,clinetId:this.clinetId};this.$http.post("/app/json/app_pay/queryExternalPayInfo",e).then((function(e){if(t.$Loading.close(),t.payInfo=e.data.data,"0"!=e.data.status)t.applyOrder();else{t.hiddenInterface=!0,t.payInfo=e.data.data;var a=t.payInfo.payAmount;a=a.toString().split("."),t.integer=a[0],t.decimal=a[1],t.setPayWays()}}),(function(e){t.$Loading.close()}))},applyOrder:function(){var t=this;this.$MessageBox.confirm("订单已提交，请勿重新提交订单！","提示",{showCancelButton:!1,closeOnClickModal:!1}).then((function(e){t.backEvent()})).catch((function(t){}))},timerCreated:function(){var t=this;this.myTimer||(this.timeValue=1800,this.myTimer=setInterval((function(){t.timeValue>0&&t.timeValue<=1800?(t.timeValue--,t.timeValueString()):(clearInterval(t.myTimer),t.myTimer=null)}),1e3))},timeValueString:function(){var t,e=this.timeValue,a="00",i="00";e>3600&&(a=parseInt(e/3600),e%=3600),e>60&&(i=parseInt(e/60),e%=60),t=e,this.timeString=a+":"+i+":"+t}},created:function(){this.prepayId=this.$route.query.prepayid,this.orderNo=this.$route.query.orderno,this.clinetId=this.$route.query.clientid,this.redirectUrl=this.$route.query.redirectUrl?this.$route.query.redirectUrl:"",this.timerCreated(),this.checkPayResult()},mounted:function(){var t=this;this.$bridgefunc.enterForegroundCallBack((function(){t.hasToPay&&(t.hasToPay=!1,t.checkPayResult())}))},activated:function(){}},s=(a("JsoE"),a("KHd+")),o=Object(s.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"index mall2"},[i("div",{staticClass:"return",on:{click:t.backEvent}},[i("img",{attrs:{src:a("Pw99"),alt:""}})]),t._v(" "),t.hiddenInterface?i("div",[i("div",{staticClass:"title-first"},[i("div",{staticClass:"content"},[i("div",{staticClass:"content-div"},[i("span",{staticClass:"symbol"},[t._v("￥")]),t._v(" "),i("span",[t._v(t._s(t.integer)+"."),i("span",{staticClass:"decimal"},[t._v(t._s(t.decimal))])])]),t._v(" "),i("div",{staticStyle:{"margin-top":"10px",color:"#888888"}},[i("span",[t._v("支付剩余时间:")]),t._v(" "),i("span",[t._v(t._s(t.timeString))])])]),t._v(" "),i("div",{staticClass:"flex-row block-div"},[i("div",{staticClass:"tradingNumber"},[t._v("交易号:"+t._s(t.payInfo.orderNo))])])]),t._v(" "),i("div",{staticClass:"transaction"},[t._m(0),t._v(" "),t._l(t.payWay,(function(e){return i("div",{staticClass:"flex-row flex-now",on:{click:function(a){return t.payWaySelected(e)}}},[i("div",{staticClass:"icon-div"},[i("img",{attrs:{src:e.icon}})]),t._v(" "),i("div",{staticClass:"full"},[t._v(t._s(e.text))]),t._v(" "),i("div",{staticClass:"selected-mark"},[t.hasToPays!=e.payModeSub?i("i",{staticClass:"iconfont mall-weixuanzhong theme_font_tint"}):t._e(),t._v(" "),t.hasToPays==e.payModeSub?i("i",{staticClass:"iconfont mall-xuanzhong theme_font_red"}):t._e()])])}))],2),t._v(" "),i("div",{staticClass:"bottom-btn theme_font_white theme_standard_bg",on:{click:t.payEvent}},[t._v("\n      "+t._s(t.paymentMethod)+"支付￥"+t._s(t.payInfo.payAmount)+"元\n    ")])]):t._e()])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"flex-row"},[e("div",{staticClass:"title"},[this._v("支付方式")])])}],!1,null,"4ca93292",null);e.default=o.exports},uw1k:function(t,e,a){}}]);