(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-706d0ad5"],{"0315":function(t,i,s){},"03a7":function(t,i,s){"use strict";s.r(i);var e=function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"setgesture"},[s("nav-top",{on:{backEvent:t.backEvent}}),s("nav-content",[s("div",{staticClass:"g-top"},[s("div",{staticClass:"g-select"},t._l(9,(function(i){return s("div",{staticClass:"g-dot  ",class:t.isExist(i)?"theme_bg_red":"theme_bg_white_ef"})})),0),s("div",{staticClass:"g-tip",class:t.isWrong?"theme_font_red":"theme_font_gray"},[t._v(" "+t._s(t.gTipStr)+" ")])]),s("div",{staticClass:"canvas"},[s("gcanvas",{ref:"gcanvas",on:{getGesture:t.getGesture}})],1),s("p",{staticClass:"bt-tip theme_font_gray"},[t._v(" 设置手势密码, 防止他人未经授权查看 ")])])],1)},n=[],a=s("1da1"),r=(s("96cf"),s("c975"),s("0d03"),s("c1b2")),o={name:"setgesture",components:{gcanvas:r["a"]},data:function(){return{gTipStr:"设置手势密码",isWrong:!1,step:1,firstPoints:[],secondPoints:[]}},methods:{backEvent:function(){this.$router.go(-1)},isExist:function(t){var i=this.firstPoints.indexOf(t);return i>-1},getGesture:function(t){1==this.step?t.length<4?(this.gTipStr="至少连接4个点，请重新绘制",this.isWrong=!0,this.$refs.gcanvas.reset()):(this.gTipStr="请再次绘制",this.isWrong=!1,this.firstPoints=this.getIndexArr(t),this.step=2,this.$refs.gcanvas.reset()):(this.secondPoints=this.getIndexArr(t),this.isEqual()?this.openSpecialPwd(2):(this.gTipStr="两次绘制不同，请重新绘制",this.isWrong=!0,this.firstPoints=[],this.step=1,this.$refs.gcanvas.reset()))},openSpecialPwd:function(t){var i=this;return Object(a["a"])(regeneratorRuntime.mark((function s(){var e,n,a,r,o;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return i.$Loading.open("请求中"),s.next=3,i.$bridgefunc.getArgsWithPromise();case 3:e=s.sent,n="/app/json/user/openSpecialPwd",a=i.$store.state.login.token,r=(new Date).valueOf(),o={token:a,userPwdMode:t,pwdCode:r,deviceId:e.deviceId?e.deviceId:"123",deviceName:e.deviceName?e.deviceName:"test",deviceModel:e.model?e.model:"phone",authType:"1"},i.$http.post(n,o).then((function(t){i.$Loading.close();var s=t.data;0==s.status?(i.$store.state.login.gestureNumbers=i.secondPoints,i.$store.state.login.gesturePwd=s.data,i.$Toast({message:s.info?s.info:"手势设置成功！",position:"bottom",duration:2e3}),i.$bridgefunc.vuexStorage((function(){i.$router.go(-1)}))):i.$Toast({message:s.info?s.info:"手势设置失败！",position:"bottom",duration:2e3})}),(function(t){i.$Loading.close(),i.$Toast({message:"手势设置失败！",position:"bottom",duration:2e3})}));case 9:case"end":return s.stop()}}),s)})))()},isEqual:function(){for(var t="",i="",s=0;s<this.firstPoints.length;s++)t+=this.firstPoints[s];for(s=0;s<this.secondPoints.length;s++)i+=this.secondPoints[s];return t===i},getIndexArr:function(t){for(var i=[],s=0;s<t.length;s++){var e=t[s].index;i.push(e)}return i}},created:function(){}},h=o,c=(s("8a37a"),s("0c7c")),l=Object(c["a"])(h,e,n,!1,null,"1c91fa02",null);i["default"]=l.exports},"81d5":function(t,i,s){"use strict";var e=s("7b0b"),n=s("23cb"),a=s("50c4");t.exports=function(t){var i=e(this),s=a(i.length),r=arguments.length,o=n(r>1?arguments[1]:void 0,s),h=r>2?arguments[2]:void 0,c=void 0===h?s:n(h,s);while(c>o)i[o++]=t;return i}},"8a37a":function(t,i,s){"use strict";s("ee5e")},b93f:function(t,i,s){"use strict";s("0315")},c1b2:function(t,i,s){"use strict";var e=function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"gcanvas"},[s("canvas",{ref:"canvas",staticClass:"canvas"})])},n=[],a=(s("a434"),s("cb29"),{name:"gcanvas",components:{},data:function(){return{ctx:"",devicePixelRatio:0,r:"",lastPoint:[],arr:[],restPoint:[],drawStyle:"red"}},methods:{init:function(){this.initDom(),this.lastPoint=[],this.touchFlag=!1,this.ctx=this.$refs.canvas.getContext("2d"),this.createCircle(),this.bindEvent()},reset:function(){this.createCircle()},bindEvent:function(){var t=this,i=this.$refs.canvas;i.addEventListener("touchstart",(function(i){i.preventDefault();for(var s=t.getPosition(i),e=0;e<t.arr.length;e++)if(Math.abs(s.x-t.arr[e].x)<t.r&&Math.abs(s.y-t.arr[e].y)<t.r){t.touchFlag=!0,t.lastPoint.push(t.arr[e]),t.drawPoint(this.drawStyle),t.restPoint.splice(e,1);break}}),!1),i.addEventListener("touchmove",(function(i){t.touchFlag&&t.update(t.getPosition(i))}),!1),i.addEventListener("touchend",(function(i){t.touchFlag&&(t.touchFlag=!1,t.update(void 0,!0),t.storePass(t.lastPoint))}),!1)},initDom:function(){this.devicePixelRatio=window.devicePixelRatio||1;var t=this.$refs.canvas,i=window.innerWidth,s=window.innerWidth;t.style.width=i+"px",t.style.height=s+"px",t.height=s*this.devicePixelRatio,t.width=i*this.devicePixelRatio},createCircle:function(){var t=3,i=0;this.r=this.ctx.canvas.width/(2+4*t),this.lastPoint=[],this.arr=[],this.restPoint=[];for(var s=this.r,e=0;e<t;e++)for(var n=0;n<t;n++){i++;var a={x:4*n*s+3*s,y:4*e*s+3*s,index:i};this.arr.push(a),this.restPoint.push(a)}this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);for(e=0;e<this.arr.length;e++)this.drawCle(this.arr[e].x,this.arr[e].y)},drawCle:function(t,i){this.ctx.fillStyle="#DDDDDD",this.ctx.beginPath(),this.ctx.arc(t,i,this.r,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},drawPoint:function(t){for(var i=0;i<this.lastPoint.length;i++)this.ctx.fillStyle=t,this.ctx.beginPath(),this.ctx.arc(this.lastPoint[i].x,this.lastPoint[i].y,this.r/2.5,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},drawStatusPoint:function(t){for(var i=0;i<this.lastPoint.length;i++)this.ctx.strokeStyle=t,this.ctx.beginPath(),this.ctx.arc(this.lastPoint[i].x,this.lastPoint[i].y,this.r,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.stroke()},drawLine:function(t,i,s){this.ctx.beginPath(),this.ctx.strokeStyle=t,this.ctx.lineWidth=3,this.ctx.moveTo(this.lastPoint[0].x,this.lastPoint[0].y);for(var e=1;e<this.lastPoint.length;e++)this.ctx.lineTo(this.lastPoint[e].x,this.lastPoint[e].y);this.ctx.lineTo(i.x,i.y),this.ctx.stroke(),this.ctx.closePath()},getPosition:function(t){var i=t.currentTarget.getBoundingClientRect(),s={x:(t.touches[0].clientX-i.left)*this.devicePixelRatio,y:(t.touches[0].clientY-i.top)*this.devicePixelRatio};return s},update:function(t,i){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);for(var s=0;s<this.arr.length;s++)this.drawCle(this.arr[s].x,this.arr[s].y);if(this.drawPoint(this.drawStyle),this.drawStatusPoint(this.drawStyle),i)this.lastPoint.length&&this.drawLine(this.drawStyle,this.lastPoint[this.lastPoint.length-1],this.lastPoint);else{this.drawLine(this.drawStyle,t,this.lastPoint);for(s=0;s<this.restPoint.length;s++)if(Math.abs(t.x-this.restPoint[s].x)<this.r&&Math.abs(t.y-this.restPoint[s].y)<this.r){this.lastPoint.push(this.restPoint[s]),this.drawPoint(this.drawStyle),this.restPoint.splice(s,1);break}}},storePass:function(t){this.$emit("getGesture",t)}},mounted:function(){this.init()},created:function(){}}),r=a,o=(s("b93f"),s("0c7c")),h=Object(o["a"])(r,e,n,!1,null,"361e8269",null);i["a"]=h.exports},cb29:function(t,i,s){var e=s("23e7"),n=s("81d5"),a=s("44d2");e({target:"Array",proto:!0},{fill:n}),a("fill")},ee5e:function(t,i,s){}}]);