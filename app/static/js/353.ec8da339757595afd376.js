(window.webpackJsonp=window.webpackJsonp||[]).push([[353],{"02sM":function(t,o,n){},Mzcy:function(t,o,n){"use strict";var s=n("Nceb");n.n(s).a},Nceb:function(t,o,n){},Zw9j:function(t,o,n){"use strict";var s=n("02sM");n.n(s).a},oF0E:function(t,o){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAgCAYAAAAMq2gFAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyppVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTMyIDc5LjE1OTI4NCwgMjAxNi8wNC8xOS0xMzoxMzo0MCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUuNSAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpBOTQ4MjU0QzQzQkQxMUU5OTkwQkREQTMzRTQ4NjdGRiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpBOTQ4MjU0RDQzQkQxMUU5OTkwQkREQTMzRTQ4NjdGRiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkE5NDgyNTRBNDNCRDExRTk5OTBCRERBMzNFNDg2N0ZGIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkE5NDgyNTRCNDNCRDExRTk5OTBCRERBMzNFNDg2N0ZGIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+TrBRdQAAAx9JREFUeNq0Vl9Ik1EUP5uzbZgyUlNR/EOhJkYPgQ9FRj4IEVNkRSa+GBFlZEYmUa2gfJhWiAxDsgWClOBEEh/24ItGGGJSbQZFYqaFNqtZps5t3zr3zsi5797vU9eBc+6fc87vx/fdc/+ogCemKSUIvoMgeIvB592PbSZqDM4Bjn9i/z3qc+w/xbYfmgoFFpRCdPberAKTyzD5BoIScAIMtKXqCx4H+kjqu4XtY2jW+9dCKkNIGl1JaPtQ21EzQb5kruT0wZnuJD5R03wu2iHUAti4FFCM05254kTmxVS0NtQU2LykUKxTT1KDie57VGg7UZMhfJJMMU+2R6z+orOoeVKZGpUCsuPUkB2vwb5SDhnBrAxUXYtfjZXyESsnkVZTcCXRCsuIAbidrwPDrmhKRmTJK0CX/TsYbeMw7pz/V42hFTqN43RCdBwnOgLOUKIDySroORoPOo34F7gWvVBkscOzD7MsIjIuJdl61ncnRCmh28AmIaLTqqC7IhcSorfwfqFeyVubmrxoiNVKr0VsVCTUHErnrhVByWB5DVla2SVm2LOd584gRCqWNy0mQjZR2jYNz01rdJnl9Qh+2UQeHzd2mRBNsrwj0x7ZRCNTv3juSUI0zPJa3vyWTWR58ZnnHiZEvSxvm2MB+j+5JUn6x1zQNvSFF9JLiLpQv4l5cfNDsdUJtrEFJoLt3Q8oxg3rZa8nwe5SrByql3H3NrCOINIW7dRAaU4U5MSrMcEPb2cWoePVV+hxOENi15wMtfCo/M5fokh0vsTJ3SwiGTesWKwd5/YikSew7SsjSXmVkbMyjNfEEsVEkuCL77zWgbYqjERV8PCEQ/wqv7C1lVRqGEgs8OBYK/9xAnAOdXATJIMrGBKvoIs6snFKUCc2QDJBc1tK3NJERC7FzaA9gjq3DpI5mtOsnxFzsi+b2sRRtEWobhkkbhprPjzKCuDfaldSBtCWowqcKIHGNBUO8KCkr8+raVa01ZyIamgssErByHozwfUdZrRGEY8R7uab5UAoZS/1zaw6tPWrZuqhYV8d/DcxvjbBtRHTetP+CDAAI419J+opiIAAAAAASUVORK5CYII="},pluH:function(t,o,n){"use strict";n.r(o),n("ilju");var s=n("5B+z"),a=(n("2jwP"),n("CzMu")),e=(n("vacd"),n("XkYy")),i=(n("X1+7"),n("8lM+")),c=(n("4X9F"),n("IkEG")),u={props:{disabled:{type:Boolean,required:!1,default:!1},defaultStationName:{type:String,required:!1,default:""},getType:{type:Number,required:!1,default:0}},data:function(){return{popupVisible:!1,defaultStation:"暂无默认加油加气站",changedStation:null,slots:[]}},created:function(){},mounted:function(){0==this.getType?this.initStationList():1==this.getType&&this.initSubAccount()},methods:{initStationList:function(){var t=this;this.$http.post("/app/json/station/findCommonStationList",{}).then((function(o){var n=o.data;0==n.status?(t.$emit("getComUseStationList",n.data),n.data.forEach((function(o,s){1==o.isDefault&&(t.defaultStation=o.stationName,t.$store.state.refuelStation.stationName?t.$emit("getDefaultStation",t.$store.state.refuelStation):t.$emit("getDefaultStation",o),n.data.unshift(n.data.splice(s,1)[0]),t.slots=n.data)}))):t.$Toast(n.info)}))},initSubAccount:function(){var t=this;this.$http.post("/app/json/account/listSubAccount",{}).then((function(o){var n=o.data;0==n.status&&(t.slots=n.data||[])})).catch((function(){t.$Toast("加载地市公司列表出错")}))},changeStation:function(){this.disabled||(this.popupVisible=!0)},confirm:function(t,o){this.$store.commit("setStationInfo",t),this.$emit("getCurrentStation",t),this.popupVisible=!1},getContainer:function(){return document.getElementsByTagName("body")[0]}},computed:{stationName:function(){return!!this.$store.state.refuelStation.stationName&&this.$store.state.refuelStation.stationName}},watch:{},components:{VanPopup:s.a,VanPicker:i.a}},l=(n("Zw9j"),n("KHd+")),p={name:"mycoupon",components:{DefaultStation:Object(l.a)(u,(function(){var t=this,o=t.$createElement,s=t._self._c||o;return s("div",[s("div",{staticClass:"station-chose",on:{click:t.changeStation}},[s("img",{staticClass:"icon",attrs:{src:n("oF0E"),alt:""}}),t._v(" "),t.stationName?s("span",[t._v(t._s(t.stationName))]):s("span",[t._v(t._s(t.defaultStation))])]),t._v(" "),s("van-popup",{attrs:{"get-container":t.getContainer,position:"bottom"},model:{value:t.popupVisible,callback:function(o){t.popupVisible=o},expression:"popupVisible"}},[0==t.getType?s("van-picker",{attrs:{columns:t.slots,"value-key":"stationName","show-toolbar":!0},on:{cancel:function(o){t.popupVisible=!1},confirm:t.confirm}}):s("van-picker",{attrs:{columns:t.slots,"value-key":"ouName","show-toolbar":!0},on:{cancel:function(o){t.popupVisible=!1},confirm:t.confirm}})],1)],1)}),[],!1,null,"d8422296",null).exports,CouponDetail:n("E3kW").a,VanDialog:c.a.Component,VanPicker:i.a,VanTabs:e.a,VanTab:a.a,VanPopup:s.a},data:function(){return{hasMechan:!1,moreStationList:!1,defaultStation:{},stationCode:"",page:1,totalPage:1,obj:{},couponList:[],noResultText:"",slots:[],userType:1}},methods:{clertnocan:function(t){var o=this;0==t.couUseType?this.$http.post("/app/json/user_coupon/getCouDistUsedUserInfo",{couNo:t.couNo}).then((function(t){var n=t.data;0==n.status&&(o.moreStationList=!0,o.slots=n.data.stationNameList)})).catch((function(t){o.$Toast(t)})):2===t.couUseType?this.$Toast("该券未满足激活条件"):this.couponDetail(t)},couponDetail:function(t){this.$router.push({path:"/cnooc-my-coupon-detail?temp = "+Math.random(),query:{couNo:t.couNo,couUseType:t.couUseType}})},goUsedCpupon:function(){this.$router.push({path:"/cnooc-my-couponused",query:{stationCode:this.obj.stationCode,userType:this.userType,hasMechan:this.hasMechan}})},loadCoupons:function(){var t=this,o=this;if(o.page>o.totalPage)this.$Toast("没有更多了!");else{var n={stationCode:o.obj.stationCode,couUseType:-1};this.$http.post("/app/json/user_coupon/getAllCouponList",n).then((function(n){var s=n.data;if(0==s.status)if(s.data){for(var a=s.data,e=0;e<a.length;e++)a[e].startDate=a[e].validStartDate.substring(0,10),a[e].endDate=a[e].validEndDate.substring(0,10);a.sort((function(t,o){return 1==t.couUseType?-1:1})),o.couponList=a,0==t.couponList.length&&(t.noResultText="暂无优惠券"),o.totalPage=s.totalPages}else t.noResultText="暂无优惠券";else t.$Toast(s.info),t.noResultText="暂无优惠券"})).catch((function(o){t.$Toast(o)}))}},selectStation:function(t){this.couponList=[],this.$store.state.refuelStation.stationName?this.obj=this.$store.state.refuelStation:this.obj=t,this.loadCoupons()},tabClick:function(t,o){this.couponList=[],0==t?(this.userType=1,this.loadCoupons()):1==t&&(this.userType=2,this.loadCoupons())}},mounted:function(){var t=this;this.$http.post("/app/json/user/loginOrgUser",{}).then((function(o){var n=o.data;0==n.status?n.data?t.hasMechan=!0:t.hasMechan=!1:(t.$Toast(n.info),t.hasMechan=!1)})).catch((function(o){t.$Toast(o),t.hasMechan=!1}))}},r=(n("Mzcy"),Object(l.a)(p,(function(){var t=this,o=t.$createElement,n=t._self._c||o;return n("div",{staticClass:"container"},[n("nav-top",{on:{backEvent:function(o){return t.$router.go(-1)}}}),t._v(" "),n("nav-content",[n("default-station",{staticClass:"chose-station-c",on:{getDefaultStation:t.selectStation,getCurrentStation:t.selectStation}}),t._v(" "),n("div",{staticClass:"my-coupon"},[t.couponList.length>0?n("div",{staticClass:"coupon-list"},t._l(t.couponList,(function(o,s){return n("div",{key:s,staticClass:"coupon-item",on:{click:function(n){return t.clertnocan(o)}}},[1===o.userType?n("div",{staticClass:"userType"},[t._v("个人")]):2===o.userType?n("div",{staticClass:"userType"},[t._v("机构")]):t._e(),t._v(" "),n("coupon-detail",{attrs:{useType:0,item:o}})],1)})),0):n("div",{staticClass:"no-info"},[t._v(t._s(t.noResultText))])]),t._v(" "),n("div",{staticClass:"confirm-btn"},[n("div",{staticClass:"btn-group"},[n("div",{staticClass:"btn",on:{click:t.goUsedCpupon}},[t._v("已使用电子券")])])]),t._v(" "),n("van-popup",{staticClass:"reset-station-popup-w",model:{value:t.moreStationList,callback:function(o){t.moreStationList=o},expression:"moreStationList"}},[n("p",{staticClass:"title"},[t._v("当前优惠券适用加油加气站")]),t._v(" "),n("div",{staticClass:"content"},t._l(t.slots,(function(o,s){return n("div",{key:s,staticClass:"item-text"},[t._v(t._s(o))])})),0),t._v(" "),n("div",{staticClass:"btn-c",on:{click:function(o){t.moreStationList=!1}}},[t._v("我知道了")])])],1)],1)}),[],!1,null,"f05e2b68",null));o.default=r.exports}}]);