(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-604ed7f4"],{"032b":function(t,e,a){"use strict";a("8d3b")},"1b5e":function(t,e,a){"use strict";a("62ad")},"350c":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"scenicdetail"},[a("div",{ref:"detailTop2",staticClass:"detail-top",style:{height:this.$store.state.barHeight+this.$market.getNavHeight()+"px"}},[a("div",{staticClass:"navcontent",style:{top:this.$store.state.barHeight+"px",height:this.$market.getNavHeight()+"px","line-height":this.$market.getNavHeight()+"px"}},[a("div",{staticClass:"nav-back-btn",staticStyle:{left:"10px",top:"5px",width:"34px",height:"34px"},on:{click:t.backEvent}},[a("img",{staticStyle:{display:"block",width:"100%",height:"100%"},attrs:{src:"static/image/mall2/back.png"}})])])]),t.isShow?a("nav-content",{staticStyle:{top:"0px"}},[a("div",{ref:"ticketdetailscrl",staticClass:"scroll-con"},[a("van-swipe",{staticClass:"top-image",attrs:{autoplay:2e3,"indicator-color":"white"}},t._l(t.detail.picUrls,(function(t,e){return a("van-swipe-item",{key:e},[a("img",{attrs:{src:t}})])})),1),a("div",{staticClass:"top-title shadow-cell theme_bg_white"},[a("div",{staticClass:"left-title "},[a("p",{staticClass:"bigtitlefont"},[t._v(t._s(t.detail.showTitle))]),a("p",{staticClass:"describe theme_font_gray"},[t._v(t._s(t.detail.storeOuName))])])]),a("div",{staticClass:"detail-con"},[a("div",{staticClass:"date-list"},t._l(t.detail.featureList,(function(e,i){return a("div",{staticClass:"choosedate",class:{theme_bg_red:t.chooseIndex==i},on:{click:function(a){return t.chooseDate(e,i)}}},[a("p",{staticClass:"week-con theme_font_gray",class:{theme_font_white:t.chooseIndex==i}},[t._v(" "+t._s(e.featureName))]),a("P",{staticClass:"day-con theme_font_common",class:{theme_font_white:t.chooseIndex==i}},[t._v(t._s(e.curDate))])],1)})),0),t._l(t.childList,(function(e){return a("div",{staticClass:"shadow-cell flex-con padding-con"},[t._v(" "+t._s(t.dataProcessing(e))+" "),a("div",{staticClass:"left-ticket"},[a("P",{staticClass:"bigtitlefont"},[t._v(t._s(e.featureName))]),a("p",{staticClass:"price"},[a("span",{staticClass:"price-x theme_font_red"},[t._v("￥")]),a("span",{staticClass:"price-z theme_font_red"},[t._v(t._s(e.dpedData.integer))]),a("span",{staticClass:"price-x theme_font_red"},[t._v("."+t._s(e.dpedData.decimals))]),t._v("   "),a("span",{staticClass:"price-x theme_font_tint",class:{"line-through":2==t.$store.state.globalConfig.priceShowType}},[1==t.$store.state.globalConfig.priceShowType?a("span",[t._v("原价:")]):t._e(),t._v("￥"+t._s(t.$util.toDecimal2(e.dpedData.linePrice)))]),e.stockNum&&""!=e.stockNum?a("span",{staticClass:"theme_font_tint"},[t._v("  (仅剩"+t._s(e.stockNum)+"张)")]):t._e()])],1),a("div",{staticClass:"right-ticket theme_bg_red theme_font_white",on:{click:function(a){return t.bookClick(e)}}},[t._v("立即预定")])])})),a("div",{staticClass:"shadow-cell padding-con"},[a("p",{staticClass:"html-title"},[t._v("购票须知")]),a("div",{domProps:{innerHTML:t._s(t.detail.proSkuMediaModel.mobileParam)}})]),a("div",{staticClass:"shadow-cell padding-con"},[a("p",{staticClass:"html-title"},[t._v("游玩攻略")]),a("div",{staticStyle:{overflow:"hidden"},domProps:{innerHTML:t._s(t.detail.proSkuMediaModel.mobileDetail)}})])],2)],1)]):t._e(),t.status?a("div",{staticClass:"bottom-btns"},[Object.keys(t.objStype).length?a("div",{staticClass:"bottom-box upDown"},[a("div",{staticClass:"btn",class:1==t.objStype.queryType?"theme_standard_font_i":"theme_standard_bg theme_font_white",on:{click:t.upDownMethod}},[a("span",{staticClass:"iconfont"},[t._v(t._s(1==t.objStype.queryType?"下架":"上架"))])]),1==t.objStype.queryType?a("div",{staticClass:"btn theme_font_white theme_standard_bg",on:{click:t.upDownShareMethod}},[a("p",{staticClass:"title"},[t._v("分享推广")])]):t._e()]):a("div",{staticClass:"bottom-box add"},[0==t.listData.hidden?a("div",{staticClass:"addIco theme_standard_font_i",on:{click:t.addMethod}},[t._v(" 添加 ")]):t._e(),a("div",{staticClass:"addText theme_font_white theme_standard_bg",on:{click:t.shareMethod}},[a("p",{staticClass:"title"},[t._v("分享推广")])])])]):t._e(),t.popupShow?a("Share",{attrs:{shareObj:t.shareObj},on:{setshareData:t.setshareData}}):t._e()],1)},s=[],o=a("5530"),r=(a("ac1f"),a("1276"),a("d3b7"),a("4c2d"),a("7aab")),n=a("2f62"),l=a("986e"),c=a("da71"),d={name:"scenicdetail",components:{Share:r["a"]},computed:Object(o["a"])({},Object(n["c"])(["getPutaggregate"])),data:function(){return{status:!1,isShow:!1,chooseIndex:0,score:"5.0",remark_cou:"12345",detail:{},swiperOption:{autoHeight:!1,spaceBetween:0,speed:500,autoplay:{delay:3e3},loop:!0,pagination:{el:".swiper-pagination",clickable:!1},paginationShow:!0},childList:[],scrollValue:0,objStype:{},listData:{},popupShow:!1,shareObj:{popupShow:!1},storeOuCode:"",deliveryType:"",proSkuDistributionId:""}},methods:{dataProcessing:function(t){var e={integer:"0",decimals:"00",linePrice:"0.00"},a=t.marketPrice+"";e.linePrice=a;var i=t.salePrice+"",s=i.split(".");s&&(1==s.length?(e.integer=s[0],""==e.integer&&(e.integer="0"),e.decimals="00"):2==s.length&&(e.integer=s[0],e.decimals=s[1],e.decimals.length<2&&(e.decimals=e.decimals+"0"))),t.dpedData=e},chooseDate:function(t,e){this.chooseIndex=e,this.childList=t.childList},bookClick:function(t){var e=this,a=""!=this.detail.saleNumBegin?this.detail.saleNumBegin:1,i=""!=this.detail.saleNumStep?this.detail.saleNumStep:1,s=""!=this.detail.saleNumMax?this.detail.saleNumMax:20,o=""!=t.stockNum?t.stockNum:9999;this.$Loading.open();var r="/app/json/app_cart/SettleCart",n={token:this.$store.state.login.token,carts:[{skuId:t.skuId,storeOuCode:this.detail.storeOuCode,number:a,checked:"1"}],deliveryType:this.detail.deliveryType};this.$http.post(r,n).then((function(t){e.$Loading.close();var r=t.data;0==r.status?1==e.$mallCommon.isExistCanNotAttendActivity(r.data.occur)?e.$MessageBox.confirm("部分商品不能参加活动</br>将按原价购买，是否继续？","提示",{confirmButtonText:"确定"}).then((function(t){e.$router.push({name:"立即下单",params:{occur:r.data.occur,proName:e.detail.showTitle,saleNumBegin:a,saleNumStep:i,saleNumMax:s,stockNum:o}})}))["catch"]((function(t){})):e.$router.push({name:"立即下单",params:{occur:r.data.occur,proName:e.detail.showTitle,saleNumBegin:a,saleNumStep:i,saleNumMax:s,stockNum:o}}):e.$Toast(r.info)}),(function(t){e.$Loading.close(),e.$Toast("请求数据失败！")}))},_getDateSkuSaleDetail:function(t){var e=this,a="/app/json/product/getAppProDetail";this.$Loading.open();var i={token:this.$store.state.login.token,skuId:t,deliverType:this.deliveryType,storeOuCode:this.storeOuCode};this.$http.post(a,i).then((function(t){e.$Loading.close();var a=t.data;if(0==a.status){if(e.status=!0,e.detail=a.data,e.detail.featureList.length){var i=e.detail.featureList[0];i.childList.length&&(e.childList=i.childList)}e.isShow=!0}else e.isShow=!1,e.$Toast(a.info)}),(function(t){e.isShow=!1,e.$Loading.close(),e.$Toast("获取数据失败")}))},backEvent:function(){this.$router.go(-1),this.$keepaliveHelper.deleteCache(this)},addMethod:function(){var t=this;this.$messagebox.confirm("确定要添加该商品到店铺吗!","提示").then((function(e){t.$Loading.open(),t.$http.post("/app/json/app_distribution_order/addProToMicroStore",{skuId:t.skuId,storeId:t.getPutaggregate.id}).then((function(e){t.$Loading.close(),0==e.data.status?(t.$Toast("添加成功!"),t.listData.hidden=1,l["a"].$emit("setlistData",t.skuId)):t.$Toast(e.data.info)}))}))["catch"]((function(){}))},shareMethod:function(){var t=this,e={};e.showTitle=this.detail.showTitle,e.sharetext=this.detail.skuName,e.picUrls=[this.detail.phMainUrl],e.id=this.detail.id,e.skuId=this.detail.skuId,e.productType=this.detail.productType,e.deliveryType=this.detail.deliveryType,this.detail.featureList.length&&(e.dpedData={},e.dpedData.linePrice=this.detail.featureList[0].childList[0].marketPrice,e.dpedData.featureName=this.detail.featureList[0].childList[0].featureName),e.detailurl=this.$store.state.globalConfig.wxBaseUrl+c["a"].shareUrl+this.$route.fullPath,1==this.detailData.deliveryType&&(e.detailurl=e.detailurl+"&storeID="+this.$store.state.mall2.zitiAddress.id),this.$store.state.login.token&&""!=this.$store.state.login.token&&(e.detailurl=e.detailurl+"&recommend="+this.$store.state.userInfo.userId,e.detailurl=e.detailurl+"&recommendPhone="+this.$store.state.login.phone),"1"!=this.listData.hidden?(this.$Loading.open(),this.$http.post("/app/json/app_distribution_order/addProToMicroStore",{skuId:this.skuId,storeId:this.getPutaggregate.id}).then((function(a){t.$Loading.close(),0==a.data.status?(t.$Toast("添加成功!"),t.listData.hidden=1,l["a"].$emit("setlistData",t.skuId),t.shareObj=Object.assign({},t.shareObj,e),t.popupShow=!0,t.shareObj.popupShow=!0):t.$Toast(a.data.info)}))):(this.shareObj=Object.assign({},this.shareObj,e),this.popupShow=!0,this.shareObj.popupShow=!0)},upDownMethod:function(){var t=this;this.$messagebox.confirm("确定要".concat(1==this.objStype.queryType?"下架":"上架","该商品吗!"),"提示").then((function(e){var a=1==t.objStype.queryType?"0":"1";t.$Loading.open(),t.$http.post("/app/json/app_distribution_order/updateProFromMicroStore",{skuId:t.skuId,storeId:t.getPutaggregate.id,status:a}).then((function(e){t.$Loading.close(),0==e.data.status?(t.$Toast("".concat(1==t.objStype.queryType?"下架":"上架","成功!")),t.objStype.queryType=1==t.objStype.queryType?"0":"1"):t.$Toast(e.data.info)}))}))["catch"]((function(){}))},upDownShareMethod:function(){var t={};t.showTitle=this.detail.showTitle,t.sharetext=this.detail.skuName,t.picUrls=[this.detail.phMainUrl],t.id=this.detail.id,t.skuId=this.detail.skuId,t.productType=this.detail.productType,t.deliveryType=this.detail.deliveryType,this.detail.featureList.length&&(t.dpedData={},t.dpedData.linePrice=this.detail.featureList[0].childList[0].marketPrice,t.dpedData.featureName=this.detail.featureList[0].childList[0].featureName),t.detailurl=this.$store.state.globalConfig.wxBaseUrl+c["a"].shareUrl+this.$route.fullPath,1==this.detailData.deliveryType&&(t.detailurl=t.detailurl+"&storeID="+this.$store.state.mall2.zitiAddress.id),this.$store.state.login.token&&""!=this.$store.state.login.token&&(t.detailurl=t.detailurl+"&recommend="+this.$store.state.userInfo.userId,t.detailurl=t.detailurl+"&recommendPhone="+this.$store.state.login.phone),this.shareObj=Object.assign({},{proSkuDistributionId:this.proSkuDistributionId},this.shareObj,this.detailData),this.popupShow=!0,this.shareObj.popupShow=!0},setshareData:function(t){this.popupShow=!1,this.shareObj=Object.assign({},t)}},created:function(){this.proSkuDistributionId=this.$route.query.proSkuDistributionId||"",this.$route.query.obj?"[object String]"==Object.prototype.toString.call(this.$route.query.obj)?this.objStype=JSON.parse(sessionStorage.getItem("microShoStype")):(this.objStype=this.$route.query.obj,sessionStorage.setItem("microShoStype",JSON.stringify(this.objStype))):this.objStype={},this.$route.query.listData?"[object String]"==Object.prototype.toString.call(this.$route.query.listData)?this.listData=JSON.parse(sessionStorage.getItem("microShoListData")):(this.listData=this.$route.query.listData,sessionStorage.setItem("microShoListData",JSON.stringify(this.listData))):this.listData={},this.storeOuCode=this.$route.query.storeOuCode?this.$route.query.storeOuCode:"",this.skuId=this.$route.query.skuId?this.$route.query.skuId:"",this.deliveryType=this.$route.query.deliveryType;var t=this.$route.query.id;null!=t&&void 0!=t&&""!=t&&this._getDateSkuSaleDetail(t)},activated:function(){},beforeRouteLeave:function(t,e,a){this.$keepaliveHelper.deleteCache(this),a()}},h=d,u=(a("032b"),a("0c7c")),p=Object(u["a"])(h,i,s,!1,null,"41ab55db",null);e["default"]=p.exports},"4c2d":function(t,e,a){},"62ad":function(t,e,a){},"7aab":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box"},[a("van-popup",{attrs:{position:"bottom"},on:{"click-overlay":t.clickOverlay},model:{value:t.detailData.popupShow,callback:function(e){t.$set(t.detailData,"popupShow",e)},expression:"detailData.popupShow"}},[a("div",{staticClass:"popup"},[a("div",{staticClass:"popup-content",on:{click:t.sharewx}},[a("img",{attrs:{src:"static/image/mall2/weixin.png",alt:""}}),a("span",[t._v("微信")])]),a("div",{staticClass:"popup-content",on:{click:t.QRcode}},[a("img",{attrs:{src:"static/image/microShop/code@2x.png",alt:""}}),a("span",[t._v("二维码")])])])]),t.codeShow?a("div",{staticClass:"code-div",on:{click:function(e){return e.target!==e.currentTarget?null:t.btnbox.apply(null,arguments)}}},[a("div",{ref:"imageWrapper",staticClass:"code-content"},[a("div",{staticClass:"code-content-img"},[a("div",{staticClass:"code-content-img-top"},[a("img",{attrs:{src:t.imgUrl,alt:"",crossOrigin:"anonymous"}})]),t.detailData.groupFlag?a("div",{staticClass:"code-content-img-buttom"},[a("div",{staticClass:"price theme_font_red"},t._l(t.getPrices(),(function(e,i){return a("div",{staticClass:"price-item"},[0!=i?a("p",{staticClass:"xian"},[t._v(" ~ ")]):t._e(),a("p",[t._v("¥")]),a("p",{staticClass:"big"},[t._v(t._s(e.iNum)+".")]),a("p",[t._v(t._s(e.dNum))])])})),0),a("div",{staticClass:"text theme_font_black"},[t._v(t._s(t.detailData.showTitle))])]):a("div",{staticClass:"code-content-img-buttom"},[a("div",{staticClass:"text theme_font_red"},[a("span",{staticClass:"font-small price-z theme_font_red",staticStyle:{"font-weight":"700"}},[t._v("￥")]),a("span",{staticClass:"price-z theme_font_red",staticStyle:{"margin-left":"-4px"}},[t._v(t._s(t.getInteger(t.detailData.salePrice)))]),a("span",{staticClass:"font-small price-z theme_font_red",staticStyle:{"margin-left":"-4px","font-weight":"700"}},[t._v("."+t._s(t.getDecimals(t.detailData.salePrice)))])]),a("div",{staticClass:"text theme_font_black"},[t._v(t._s(t.detailData.dpedData.featureName||t.detailData.skuName))])])]),a("div",{staticClass:"code-content-line"}),t._m(0),a("div",{staticClass:"code-content-zanwei"})]),a("div",{staticClass:"code-btn"},[a("div",{staticClass:"btn theme_bg_red",on:{click:function(e){return e.stopPropagation(),t.preservation.apply(null,arguments)}}},[t._v("保存图片到本地")]),a("div",{staticClass:"text"},[t._v("记得发送给朋友或发布到朋友圈呦！")])])]):t._e()],1)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"code-content-code"},[a("canvas",{staticClass:"qrcode",attrs:{id:"qrcode"}}),a("p",[t._v("微信扫码或长按识别二维码")])])}],o=a("5530"),r=(a("ac1f"),a("1276"),a("99af"),a("e25e"),a("c0e9")),n=a.n(r),l=a("da71"),c=a("d055"),d=a.n(c),h=a("2f62"),u=a("ae5c"),p={name:"share",props:["shareObj"],computed:Object(o["a"])({},Object(h["c"])(["getPutaggregate"])),data:function(){return{imgUrl:"",timeOutEvent:0,popupShow:!0,codeShow:this.shareObj.codeShow,detailData:this.$util.deepClone(this.shareObj)}},mounted:function(){this.setOssImg(this.detailData.phMainUrl||this.detailData.picMainUrl||this.detailData.picUrls[0])},methods:{getPrices:function(){return u["a"].getPriceShow(this.detailData.purPriceRules)},setOssImg:function(t){var e=this;this.imgUrl="",this.$request.post("/app/json/home/getFileBase64",{filePath:t}).then((function(t){0==t.status?t.data?e.imgUrl="data:image/png;base64,".concat(t.data||""):e.$Toast("getFileBase64 返回为空"):e.$Toast(t.info)}))},getInteger:function(t){var e=this.$util.toDecimal2(t),a=e.split(".");return a[0]},getDecimals:function(t){var e=this.$util.toDecimal2(t),a=e.split(".");return a[1]},clickOverlay:function(){this.detailData.popupShow=!1,this.$emit("setshareData",this.detailData.storeCode)},sharewx:function(){var t="/micro_sho/shareDetail/";this.detailData.groupFlag&&(t="/micro_sho/sharebuyingDetail/");var e={};e={},e.title=this.detailData.showTitle||this.detailData.skuName,e.sharetext=this.detailData.skuName,e.imageurl=this.detailData.phMainUrl,e.detailurl=this.$store.state.globalConfig.wxBaseUrl+l["a"].shareUrl+"".concat(t).concat(this.$util.getDataString()),e.detailurl=e.detailurl+"?id="+(this.detailData.id||this.detailData.skuId)+"&skuId="+(this.detailData.skuId||this.detailData.id)+"&microStoreCode="+this.getPutaggregate.storeCode+"&storeName="+this.getPutaggregate.storeName+"&productType="+this.detailData.productType+"&deliveryType="+this.$store.state.mall2.staticDeliverType+"&storeOuCodeNew="+this.$store.state.mall2.zitiAddress.id+"&proSkuDistributionId="+this.detailData.proSkuDistributionId,this.$store.state.login.token&&""!=this.$store.state.login.token&&(e.detailurl=e.detailurl+"&recommend="+this.$store.state.userInfo.userId,e.detailurl=e.detailurl+"&recommendPhone="+this.$store.state.login.phone),this.$bridgefunc.wechatShare(e)},QRcode:function(){var t=this,e="/micro_sho/shareDetail";this.detailData.groupFlag&&(e="/micro_sho/sharebuyingDetail"),this.codeShow=!0,this.$emit("qRcodeStstus",this.codeShow),this.$nextTick((function(a){var i="".concat(t.$store.state.globalConfig.wxBaseUrl).concat(l["a"].shareUrl).concat(e),s="".concat(i,"/").concat(t.$util.getDataString(),"?id=").concat(t.detailData.id||t.detailData.skuId,"&skuId=").concat(t.detailData.skuId||t.detailData.id,"&microStoreCode=").concat(t.getPutaggregate.storeCode,"&storeName=").concat(t.getPutaggregate.storeName,"&productType=").concat(t.detailData.productType,"&deliveryType=").concat(t.$store.state.mall2.staticDeliverType,"&storeOuCodeNew=").concat(t.$store.state.mall2.zitiAddress.id,"&proSkuDistributionId=").concat(t.detailData.proSkuDistributionId);d.a.toCanvas(document.getElementById("qrcode"),s,{width:140})}))},btnbox:function(){this.codeShow=!1,this.$emit("qRcodeStstus",this.codeShow)},preservation:function(){var t=this,e=document.querySelector(".code-content"),a=parseInt(window.getComputedStyle(e).width),i=parseInt(window.getComputedStyle(e).height),s=document.createElement("canvas"),o=2;s.width=a*o,s.height=i*o,s.getContext("2d").scale(o,o);var r={useCORS:!0,scale:o,canvas:s,backgroundColor:"#000"};n()(this.$refs.imageWrapper,r).then((function(e){var a=e.toDataURL("image/png");t.codeShow=!1;var i=a.split("base64,");t.$bridgefunc.savePhoto(i[1],(function(e){"1"==e?(t.detailData.popupShow=!1,t.$emit("setshareData",t.detailData),t.$Toast("保存成功！")):t.$Toast("保存失败！")}))}))}}},g=p,m=(a("1b5e"),a("0c7c")),f=Object(m["a"])(g,i,s,!1,null,"06153066",null);e["a"]=f.exports},"8d3b":function(t,e,a){},"986e":function(t,e,a){"use strict";var i=a("a026");e["a"]=new i["default"]},ae5c:function(t,e,a){"use strict";a("ac1f"),a("1276");var i=a("ca00"),s={getPriceShow:function(t){if(0==t.length)return"";for(var e=t[0].price,a=t[0].price,i=1;i<t.length;i++){var s=t[i].price;e>s&&(e=s),a<s&&(a=s)}if(e==a){var o=this.getINumDNum(e);return[o]}var r=this.getINumDNum(e),n=this.getINumDNum(a);return[r,n]},getINumDNum:function(t){var e=i["a"].toDecimal2(t),a=e.split("."),s=a[0],o=a[1];return{iNum:s,dNum:o}}};e["a"]=s}}]);