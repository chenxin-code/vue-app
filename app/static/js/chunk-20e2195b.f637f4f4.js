(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-20e2195b"],{7578:function(t,e,i){},c0e2:function(t,e,i){"use strict";i("7578")},d483:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("nav-top",{on:{backEvent:t.backEvent}}),i("nav-content",[i("div",{ref:t.$route.path,staticClass:"selectcitybottom"},[i("div",{ref:"allcitybar",staticClass:"allcity-bar"},["/cityselector/0"==t.$route.path?i("div",{staticClass:"city-item-list"},[i("div",{staticClass:"city-title-1"},[t._v("当前位置")]),i("ul",[i("li",{staticClass:"city-item",on:{click:function(e){return e.stopPropagation(),t.selectLocal.apply(null,arguments)}}},[t._v(t._s(t.localtion.city&&""!=t.localtion.city?t.localtion.city:"定位中..."))])])]):t._e(),t._l(t.cityList,(function(e,a){return t.cityList?i("div",{staticClass:"city-item-list"},[i("div",{staticClass:"city-title"},[t._v(t._s(a))]),i("ul",t._l(e,(function(e,a){return i("li",{staticClass:"city-item",on:{click:function(i){return i.stopPropagation(),t.selectCity(e)}}},[t._v(t._s(e.areaName)+" ")])})),0)]):t._e()}))],2),i("div",{staticClass:"fast-sel-bar"},t._l(t.cityList,(function(e,a,o){return i("p",{staticClass:"fast-sel-item",class:{fastSelActive:o===t.curCityListIndex},attrs:{"data-index":o},on:{touchstart:t.onSelectFastTouchStart,touchmove:function(e){return e.stopPropagation(),e.preventDefault(),t.onSelectFastTouchMove.apply(null,arguments)}}},[t._v(" "+t._s(a)+" ")])})),0)])])],1)},o=[],s=(i("c975"),i("d81d"),i("4e82"),i("e25e"),i("76a0")),r=i("1fba"),n=(i("8a77"),{name:"select-city",components:{Toast:s["Toast"]},data:function(){return{cityList:[],listHeight:[],scrollY:0,touch:{},cityDomList:null,curCityListIndex:0,areaParentId:null,directCity:"",localtion:{},provinceName:""}},created:function(){var t=this;this.directCity=this.$route.query.directCity?this.$route.query.directCity:"",this.areaParentId=this.$route.query.areacode?this.$route.query.areacode:null,this.provinceName=this.$route.query.province?decodeURIComponent(this.$route.query.province):"",this.getCityList(),this.$bridgefunc.getLocation((function(e){t.localtion=e}))},mounted:function(){this.cityDomList=this.$refs.allcitybar.getElementsByClassName("city-item-list")},watch:{scrollY:function(t){var e=this.listHeight;if(t>0)this.curCityListIndex=0;else{for(var i=0;i<e.length-1;i++){var a=e[i],o=e[i+1];if(-t>=a&&-t<o)return this.curCityListIndex=i,void(this.diff=o+t)}this.currentIndex=e.length-2}}},methods:{backEvent:function(){this.$router.go(-1)},selectLocal:function(){var t=this;if("4"==this.$store.state.location.selectType){var e={province:this.localtion.province,city:this.localtion.city,district:this.localtion.area};return this.localtion.city==this.localtion.province&&(e.city=this.localtion.area,e.district=""),void this.$mallCommon.pureLocationAnalysis((function(e){sessionStorage.setItem("Address_City_Seleted",JSON.stringify(e)),t.$router.go(-1)}),e)}this.$mallCommon.addressAnalysis((function(e,i){t.$store.state.indexData.province=t.localtion.province,t.$store.state.indexData.city=t.localtion.city,e&&(t.$store.state.indexData.provinceId=i.provinceId,t.$store.state.indexData.cityId=i.cityId),t.$router.go(-1)}),this.localtion)},_updateArea:function(t,e,i,a){var o=this;this.$Loading.open("保存中");var r="/app/json/user/modifyUserInfo",n=this.$store.state.login.token,c=this.$store.state.userInfo,l={realName:c.realName?c.realName:"",gender:c.gender?c.gender:"",email:c.email?c.email:"",idType:c.idType?c.idType:"",idNumber:c.idNumber?c.idNumber:"",address:c.address?c.address:"",provinceName:t,cityName:e,provinceCode:i,cityCode:a,postCode:"",userType:"",token:n};this.$http.post(r,l).then((function(i){o.$Loading.close();var a=i.data;0==a.status?(Object(s["Toast"])({message:"修改地区成功",position:"bottom",duration:2e3}),o.$store.state.userInfo.provinceName=t,o.$store.state.userInfo.cityName=e,o.$store.state.location.selectType="0","1"==o.directCity?o.$router.go(-1):o.$router.go(-2)):Object(s["Toast"])({message:a.info?a.info:"修改地区失败",position:"bottom",duration:2e3})}),(function(t){o.$Loading.close(),Object(s["Toast"])({message:"修改地区失败",position:"bottom",duration:2e3})}))},selectCity:function(t){var e=this;if(this.areaParentId){var i=this.provinceName;if("3"==this.$store.state.location.selectType)return void this._updateArea(i,t.areaName,this.areaParentId,t.areaCode);if("1"==this.$store.state.location.selectType)return this.$store.state.location.login.province=i,this.$store.state.location.login.city=t.areaName,this.$store.state.location.selectType="0",void("1"==this.directCity||"1"==this.$store.state.globalConfig.onlyProvince_area?this.$router.go(-1):this.$router.go(-2));if("2"==this.$store.state.location.selectType)return this.$store.state.indexData.province=i,this.$store.state.indexData.city=t.areaName,this.$store.state.indexData.cityId=t.areaCode,this.$store.state.location.selectType="0",void this.$bridgefunc.vuexStorage((function(){"1"==e.directCity||"1"==e.$store.state.globalConfig.onlyProvince_area?e.$router.go(-1):e.$router.go(-2)}));if("4"==this.$store.state.location.selectType){var a={cityName:t.areaName,cityId:t.areaCode,provinceId:this.areaParentId,provinceName:i};sessionStorage.setItem("Address_City_Seleted",JSON.stringify(a)),"1"==this.$store.state.globalConfig.onlyProvince_area?this.$router.go(-1):this.$router.go(-2)}}else this.$router.push({path:"/cityselector/"+t.areaCode,isnativetop:1,query:{areacode:t.areaCode,province:encodeURIComponent(t.areaName)}})},getShortName:function(t){var e=t;return-1==e.indexOf("省")&&-1==e.indexOf("市")||(e=e.substring(0,e.length-1)),e},getCityList:function(){var t=this;this.$Loading.open();var e="/app/json/home/getAreaList",i={};this.areaParentId&&(i.areaParentId=this.areaParentId),this.$http.post(e,i).then((function(e){t.$Loading.close();var i=e.data;if("1"!=t.$store.state.globalConfig.onlyProvince_area||t.areaParentId){var a=t.formCityData(i.data);t.cityList=a;var o=t;t.$nextTick((function(){o._initScroll(),o.calculateHeight()}))}else for(var s=i.data,r=0;r<s.length;r++){var n=s[r];if(t.getShortName(n.areaName)==t.getShortName(t.$store.state.globalConfig.province))return t.areaParentId=n.areaCode,t.directCity=n.areaName,t.provinceName=n.areaName,void t.getCityList()}}),(function(e){t.$Loading.close()}))},formCityData:function(t){for(var e=this,i=t.map((function(t){return{areaName:t.areaName,firstLetter:e.getFirstLetter(t.areaName),areaCode:t.areaCode}})),a=i.sort((function(t,e){return t.firstLetter.localeCompare(e.firstLetter)})).map((function(t){return{areaName:t.areaName,firstLetter:t.firstLetter.toLocaleUpperCase(),areaCode:t.areaCode}})),o={},s=0;s<a.length;s++){var r=a[s],n=r.firstLetter,c=o[n];c||(c=[]),c.push(r),o[n]=c}return o},getFirstLetter:function(t){return-1!=t.indexOf("重庆")||-1!=t.indexOf("长春")?"C":pinyinUtil.getFirstLetter(t.substr(0,1),!1)[0]},_initScroll:function(){var t=this,e=this.$route.path;this.cityListScroll=new r["a"](this.$refs[e],{click:!0,probeType:3}),this.cityListScroll.on("scroll",(function(e){t.scrollY=e.y}))},calculateHeight:function(){var t=this;this.$nextTick((function(){var e=t.$refs.allcitybar.getElementsByClassName("city-item-list"),i=0;t.listHeight.push(i);for(var a=0;a<e.length;a++){var o=e[a];i+=o.clientHeight,t.listHeight.push(i)}}))},onSelectFastTouchStart:function(t){var e=t.target.getAttribute("data-index"),i=t.touches[0];this.touch.y1=i.pageY,this.touch.anchorIndex=e;var a=this.cityDomList[e];this.scrollY=-this.listHeight[e],this.cityListScroll.scrollToElement(a)},onSelectFastTouchMove:function(t){var e=t.touches[0];this.touch.y2=e.pageY;var i=.4*parseInt(20),a=(this.touch.y2-this.touch.y1)/i|0,o=parseInt(this.touch.anchorIndex)+a,s=this.cityDomList[o];this.scrollY=-this.listHeight[o],this.cityListScroll.scrollToElement(s)}}}),c=n,l=(i("c0e2"),i("0c7c")),u=Object(l["a"])(c,a,o,!1,null,"0ff1b26d",null);e["default"]=u.exports}}]);