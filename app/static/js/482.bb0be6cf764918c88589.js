(window.webpackJsonp=window.webpackJsonp||[]).push([[482],{"4AGy":function(t,e,i){"use strict";var s=i("9HhZ");i.n(s).a},"9HhZ":function(t,e,i){},ONxU:function(t,e,i){"use strict";i.r(e),i("TC2U");var s=i("2nGb"),a={name:"scenicdetail",components:{},data:function(){return{isShow:!1,chooseIndex:0,score:"5.0",remark_cou:"12345",detail:{},swiperOption:{autoHeight:!1,spaceBetween:0,speed:500,autoplay:{delay:3e3},loop:!0,pagination:{el:".swiper-pagination",clickable:!1},paginationShow:!0},childList:[],scrollValue:0,proSkuDistributionId:"",microStoreCode:""}},methods:{dataProcessing:function(t){var e={integer:"0",decimals:"00",linePrice:"0.00"},i=t.marketPrice+"";e.linePrice=i;var s=(t.salePrice+"").split(".");s&&(1==s.length?(e.integer=s[0],""==e.integer&&(e.integer="0"),e.decimals="00"):2==s.length&&(e.integer=s[0],e.decimals=s[1],e.decimals.length<2&&(e.decimals=e.decimals+"0"))),t.dpedData=e},chooseDate:function(t,e){console.log("testFunc"),this.chooseIndex=e,this.childList=t.childList},bookClick:function(t){var e=this,i=""!=this.detail.saleNumBegin?this.detail.saleNumBegin:1,s=""!=this.detail.saleNumStep?this.detail.saleNumStep:1,a=""!=this.detail.saleNumMax?this.detail.saleNumMax:20,o=""!=t.stockNum?t.stockNum:9999;this.$Loading.open();var l={token:this.$store.state.login.token,carts:[{skuId:t.skuId,storeOuCode:this.detail.storeOuCode,number:i,proSkuDistributionId:this.proSkuDistributionId,checked:"1"}],deliveryType:this.detail.deliveryType};this.$http.post("/app/json/app_cart/SettleCart",l).then((function(t){e.$Loading.close();var l=t.data;0==l.status?1==e.$mallCommon.isExistCanNotAttendActivity(l.data.occur)?e.$MessageBox.confirm("部分商品不能参加活动</br>将按原价购买，是否继续？","提示",{confirmButtonText:"确定"}).then((function(t){e.$router.push({name:"立即下单",params:{occur:l.data.occur,proName:e.detail.showTitle,saleNumBegin:i,saleNumStep:s,saleNumMax:a,stockNum:o}})})).catch((function(t){})):e.$router.push({name:"立即下单",params:{occur:l.data.occur,proName:e.detail.showTitle,saleNumBegin:i,saleNumStep:s,saleNumMax:a,stockNum:o}}):e.$Toast(l.info)}),(function(t){e.$Loading.close(),e.$Toast("请求数据失败！")}))},_getDateSkuSaleDetail:function(t){var e=this;this.$Loading.open();var i={token:this.$store.state.login.token,id:t};console.log(i),this.$http.post("/app/json/product/getAppProDetail",i).then((function(t){e.$Loading.close();var i=t.data;if(0==i.status){if(e.detail=i.data,e.detail.featureList.length){var s=e.detail.featureList[0];s.childList.length&&(e.childList=s.childList)}e.isShow=!0}else e.isShow=!1,e.$Toast(i.info)}),(function(t){e.isShow=!1,e.$Loading.close(),console.log("获取门票详情",t),e.$Toast("获取数据失败")}))},backEvent:function(){this.$router.go(-1)},shareClick:function(){var t={};(t={}).title=this.detail.showTitle,t.sharetext=this.detail.skuName,t.imageurl=this.detail.phMainUrl,t.detailurl=this.$store.state.globalConfig.wxBaseUrl+s.a.shareUrl+this.$route.fullPath,1==this.detailData.deliveryType&&(t.detailurl=t.detailurl+"&storeID="+this.$store.state.mall2.zitiAddress.id),this.$store.state.login.token&&""!=this.$store.state.login.token&&(t.detailurl=t.detailurl+"&recommend="+this.$store.state.userInfo.userId,t.detailurl=t.detailurl+"&recommendPhone="+this.$store.state.login.phone),this.$bridgefunc.wechatShare(t)}},created:function(){var t=this.$route.query.id;null!=t&&null!=t&&""!=t&&(this.microStoreCode=this.$route.query.microStoreCode?this.$route.query.microStoreCode:"",this.proSkuDistributionId=this.$route.query.proSkuDistributionId?this.$route.query.proSkuDistributionId:"",this._getDateSkuSaleDetail(t))},activated:function(){},beforeRouteLeave:function(t,e,i){this.$keepaliveHelper.deleteCache(this),i()}},o=(i("4AGy"),i("KHd+")),l=Object(o.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"scenicdetail"},[i("div",{ref:"detailTop2",staticClass:"detail-top",style:{height:this.$store.state.barHeight+this.$market.getNavHeight()+"px"}},[i("div",{staticClass:"navcontent",style:{top:this.$store.state.barHeight+"px",height:this.$market.getNavHeight()+"px","line-height":this.$market.getNavHeight()+"px"}},[i("div",{staticClass:"nav-back-btn",staticStyle:{left:"10px",top:"5px",width:"34px",height:"34px"},on:{click:t.backEvent}},[i("img",{staticStyle:{display:"block",width:"100%",height:"100%"},attrs:{src:"static/image/mall2/back.png"}})]),t._v(" "),i("div",{staticClass:"nav-back-btn",staticStyle:{right:"10px",top:"5px",width:"34px",height:"34px"},on:{click:t.shareClick}},[i("img",{staticStyle:{display:"block",width:"100%",height:"100%"},attrs:{src:"static/image/mall2/fenxiang.png"}})])])]),t._v(" "),t.isShow?i("nav-content",{staticStyle:{top:"0px"}},[i("div",{ref:"ticketdetailscrl",staticClass:"scroll-con"},[i("van-swipe",{staticClass:"top-image",attrs:{autoplay:2e3,"indicator-color":"white"}},t._l(t.detail.picUrls,(function(t,e){return i("van-swipe-item",{key:e},[i("img",{attrs:{src:t}})])})),1),t._v(" "),i("div",{staticClass:"top-title shadow-cell theme_bg_white"},[i("div",{staticClass:"left-title "},[i("p",{staticClass:"bigtitlefont"},[t._v(t._s(t.detail.showTitle))]),t._v(" "),i("p",{staticClass:"describe theme_font_gray"},[t._v(t._s(t.detail.storeOuName))])])]),t._v(" "),i("div",{staticClass:"detail-con"},[i("div",{staticClass:"date-list"},t._l(t.detail.featureList,(function(e,s){return i("div",{staticClass:"choosedate",class:{theme_bg_red:t.chooseIndex==s},on:{click:function(i){return t.chooseDate(e,s)}}},[i("p",{staticClass:"week-con theme_font_gray",class:{theme_font_white:t.chooseIndex==s}},[t._v("\n              "+t._s(e.featureName))]),t._v(" "),i("P",{staticClass:"day-con theme_font_common",class:{theme_font_white:t.chooseIndex==s}},[t._v(t._s(e.curDate))])],1)})),0),t._v(" "),t._l(t.childList,(function(e){return i("div",{staticClass:"shadow-cell flex-con padding-con"},[t._v("\n          "+t._s(t.dataProcessing(e))+"\n          "),i("div",{staticClass:"left-ticket"},[i("P",{staticClass:"bigtitlefont"},[t._v(t._s(e.featureName))]),t._v(" "),i("p",{staticClass:"price"},[i("span",{staticClass:"price-x theme_font_red"},[t._v("￥")]),i("span",{staticClass:"price-z theme_font_red"},[t._v(t._s(e.dpedData.integer))]),i("span",{staticClass:"price-x theme_font_red"},[t._v("."+t._s(e.dpedData.decimals))]),t._v("  \n              "),i("span",{staticClass:"price-x theme_font_tint",class:{"line-through":2==t.$store.state.globalConfig.priceShowType}},[1==t.$store.state.globalConfig.priceShowType?i("span",[t._v("原价:")]):t._e(),t._v("￥"+t._s(t.$util.toDecimal2(e.dpedData.linePrice)))]),t._v(" "),e.stockNum&&""!=e.stockNum?i("span",{staticClass:"theme_font_tint"},[t._v("  (仅剩"+t._s(e.stockNum)+"张)")]):t._e()])],1),t._v(" "),i("div",{staticClass:"right-ticket theme_bg_red theme_font_white",on:{click:function(i){return t.bookClick(e)}}},[t._v("立即预定")])])})),t._v(" "),i("div",{staticClass:"shadow-cell padding-con"},[i("p",{staticClass:"html-title"},[t._v("购票须知")]),t._v(" "),i("div",{domProps:{innerHTML:t._s(t.detail.proSkuMediaModel.mobileParam)}})]),t._v(" "),i("div",{staticClass:"shadow-cell padding-con"},[i("p",{staticClass:"html-title"},[t._v("游玩攻略")]),t._v(" "),i("div",{staticStyle:{overflow:"hidden"},domProps:{innerHTML:t._s(t.detail.proSkuMediaModel.mobileDetail)}})])],2)],1)]):t._e()],1)}),[],!1,null,"49e5b31a",null);e.default=l.exports},TC2U:function(t,e,i){}}]);