(window.webpackJsonp=window.webpackJsonp||[]).push([[374],{"6NrC":function(t,e,i){"use strict";var a=i("ltZD");i.n(a).a},QFaU:function(t,e,i){"use strict";i("aO+S"),i("nXDD"),i("N0PS"),i("Cf6i")},ZoCG:function(t,e,i){t.exports=i.p+"static/img/user-default.8e419da.png"},gbqt:function(t,e,i){"use strict";i.r(e);var a=i("Qyje"),r=i.n(a),s=(i("rMTE"),{name:"orderList",props:{},data:function(){return{defaultAvatar:i("ZoCG"),tab:[{name:"待发货",value:1},{name:"待提货",value:3},{name:"已完成",value:4},{name:"已取消",value:5}],allList:[],currentTab:0,refreshing:!1,loading:!1,finished:!1,showPopup:!1,currentPage:1,error:!1,skuInfo:{}}},created:function(){this.loading=!0},methods:{goBack:function(){this.$router.go(-1)},changesTab:function(t){this.currentTab=t,this.currentPage=1,this.allList=[],this.onLoad()},onLoad:function(){this.loading=!0,this.error=!1,this.finished=!1;var t=this.currentPage,e=this.finished,i=this.tab,a=this.currentTab,r={pageNum:t,pageSize:10,sortBy:"create_time_DESC",orderItemState:i[a].value?i[a].value:""};e||this.getListFn(r)},onRefresh:function(){this.currentPage=1,this.finished=!1,this.refreshing=!0,this.loading=!0;var t={pageNum:this.currentPage,pageSize:10,sortBy:"create_time_DESC",orderItemState:tab[currentTab]?tab[currentTab].value:""};this.getListFn(t)},getListFn:function(t){var e=this,i=this.currentPage;this.$http.post("/app/json/group_buying_order/findGroupBuyingActivityOrderItemListByOrderId",r.a.stringify(t)).then((function(t){if(e.loading=!1,e.refreshing=!1,"success"==t.data.result){var a=t.data.data;if(i<a.pages||i==a.pages){var r=a.records;r.map((function(t){if(""!==t.productSkuInfo){var e=JSON.parse(t.productSkuInfo)[0];t.orderSkuImg=e.groupbuySkuPicurl.split(",")}else t.orderSkuImg=[]})),e.allList=e.allList.concat(r),e.currentPage++,i==a.pages&&(e.finished=!0)}else e.finished=!0}else e.refreshing=!1,e.error=!0})).catch((function(t){e.$toast("请求失败，点击重新加载"),e.refreshing=!1,e.loading=!1,e.error=!0}))},navToDetail:function(t){this.$router.push({path:"/bulk_order_detail",query:{id:JSON.stringify(t.activityOrderItemNo)}})},confirm:function(t){this.showPopup=!0,this.skuInfo=t},confirmOrder:function(){var t,e=this;t=1==this.skuInfo.activityOrderItemState||2==this.skuInfo.activityOrderItemState||3==this.skuInfo.activityOrderItemState?this.skuInfo.activityOrderItemState:void 0,this.$http.post("/app/json/group_buying_order/confirmReceiveDeliveryPickup",{orderItemId:this.skuInfo.activityOrderItemNo,confirmType:t}).then((function(t){t.data.data.isTrue&&(e.showPopup=!1,e.$toast("操作成功"),e.changesTab(e.currentTab)),"error"==t.data.result&&(e.showPopup=!1,e.$toast(t.data.info))})).catch((function(t){e.showPopup=!1,e.$toast("请求失败，请重新尝试")}))}}}),n=(i("6NrC"),i("KHd+")),o=Object(n.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"orderList"},[i("van-sticky",[i("div",{staticClass:"heard"},[i("div",{staticClass:"tab"},[i("div",{staticClass:"tab_back",on:{click:function(e){return t.goBack()}}},[i("van-icon",{staticClass:"arrow_left",attrs:{name:"arrow-left",color:"#000000",size:"0.471467rem"}})],1),t._v(" "),t._l(t.tab,(function(e,a){return i("div",{key:a,staticClass:"tab_item",class:t.currentTab==a?"current_tab":"",on:{click:function(e){return t.changesTab(a)}}},[t._v("\n          "+t._s(e.name)+"\n        ")])}))],2)])]),t._v(" "),i("div",{staticClass:"goods_list"},[i("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[i("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",error:t.error,"error-text":"请求失败，点击重新加载"},on:{load:t.onLoad,"update:error":function(e){t.error=e}},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.allList,(function(e,a){return i("div",{key:a,staticClass:"goods_item",on:{click:function(i){return t.navToDetail(e)}}},[i("div",{staticClass:"goods_title"},[i("div",{staticClass:"goods_ID"},[t._v("#"+t._s(e.activityOrderItemNo))]),t._v(" "),i("div",{staticClass:"goods_type"},[t._v("\n              "+t._s(0==e.activityOrderItemState?"待支付":1==e.activityOrderItemState?"待发货":2==e.activityOrderItemState?"待配送":3==e.activityOrderItemState?"待提货":4==e.activityOrderItemState?"已完成":5==e.activityOrderItemState?"已取消":"")+"\n            ")])]),t._v(" "),i("div",{staticClass:"good_user"},[i("div",{staticClass:"user"},[i("van-image",{staticClass:"user-image",attrs:{src:e.contactAvatar,"error-icon":t.defaultAvatar}}),t._v(" "),i("div",{staticClass:"user_name"},[t._v(t._s(e.contactName))]),t._v(" "),i("div",{staticClass:"user_phone"},[t._v(t._s(e.contactPhone))])],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:2==e.activityOrderItemState||3==e.activityOrderItemState,expression:"\n                item.activityOrderItemState == 2 ||\n                item.activityOrderItemState == 3\n              "}],staticClass:"user_type",class:2==e.activityOrderItemState?"delivery":3==e.activityOrderItemState?"pick_up":""},[t._v("\n              "+t._s(2==e.activityOrderItemState?"配送上门":3==e.activityOrderItemState?"自提":"")+"\n            ")])]),t._v(" "),i("div",{staticClass:"goods_img"},t._l(e.orderSkuImg,(function(t){return i("img",{key:t,attrs:{src:t,alt:""}})})),0),t._v(" "),i("div",{staticClass:"goods_detail"},[i("div",{staticClass:"detail"},[i("span",[t._v("共计"+t._s(e.productQuantity)+"件商品，合计支付 ")]),t._v(" "),i("span",[t._v(t._s(e.totalAmount))])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:0!==e.activityOrderItemState&&4!==e.activityOrderItemState&&5!==e.activityOrderItemState,expression:"\n                item.activityOrderItemState !== 0 &&\n                item.activityOrderItemState !== 4 &&\n                item.activityOrderItemState !== 5\n              "}],staticClass:"confirm",on:{click:function(i){return i.stopPropagation(),t.confirm(e)}}},[t._v("\n              确认"+t._s(1==e.activityOrderItemState?"送达":2==e.activityOrderItemState?"配送":3==e.activityOrderItemState?"提货":"")+"\n            ")])])])})),0)],1)],1),t._v(" "),i("van-popup",{model:{value:t.showPopup,callback:function(e){t.showPopup=e},expression:"showPopup"}},[i("div",{staticClass:"popup"},[i("div",{staticClass:"popup_title"},[t._v("确认订单商品")]),t._v(" "),i("div",{staticClass:"popup_detail"},[t._v("\n        "+t._s(1==t.skuInfo.activityOrderItemState?"抵达":2==t.skuInfo.activityOrderItemState?"送达消费者":3==t.skuInfo.activityOrderItemState?"被消费者提走":"")+"\n      ")]),t._v(" "),i("div",{staticClass:"popup_btn"},[i("div",{staticClass:"confirm_btn",on:{click:function(e){return t.confirmOrder()}}},[t._v("确认")]),t._v(" "),i("div",{staticClass:"cancel_btn",on:{click:function(e){t.showPopup=!1}}},[t._v("取消")])])])])],1)}),[],!1,null,"a72941b4",null);e.default=o.exports},ltZD:function(t,e,i){},rMTE:function(t,e,i){"use strict";i("QFaU");var a=i("RL95");i("oCYn").default.use(a.a)}}]);