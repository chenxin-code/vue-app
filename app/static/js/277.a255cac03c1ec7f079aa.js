(window.webpackJsonp=window.webpackJsonp||[]).push([[277],{"0Lyl":function(t,e,i){"use strict";var s=i("0xPc");i.n(s).a},"0xPc":function(t,e,i){},"E/Gw":function(t,e,i){"use strict";i.r(e);var s=i("rlxw"),a=i("L2JU"),o=i("eqsK"),n=i("hlqo"),r=i("A+eP"),l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},d={name:"detail",components:{Share:o.a},data:function(){var t=this;return{id:"",objStype:{},listData:{},popupShow:!1,shareObj:{groupFlag:0,popupShow:!1},skuId:"",isRecommend:1,detailData:{},loaded:!1,proImgIndex:0,swiperOption:{autoHeight:!1,spaceBetween:0,speed:500,autoplay:{delay:3e3,clickable:!0,disableOnInteraction:!1},loop:!0,paginationShow:!0,initialSlide:0,observer:!0,observeParents:!0,scrollbarDraggable:!0,scrollbarSnapOnRelease:!0,scrollbarHide:!1,on:{slideChange:function(){t.proImgIndex=this.realIndex}}},selectedNum:1,introductionIndex:1,introduction1:"",introduction2:"",introduction3:"",deliverType:this.$store.state.mall2.staticDeliverType}},computed:l({},Object(a.c)(["getPutaggregate"])),methods:{selectPickUpAddress:function(){var t=this;r.a.open({initData:{selectedId:this.$store.state.mall2.zitiAddress.id,token:this.$store.state.login.token,posx:this.$store.state.currentLocation.posx,posy:this.$store.state.currentLocation.posy,skuIds:[this.detailData.id]},addressEvent:function(e){r.a.close(),e&&(t.$store.state.mall2.zitiAddress=e,t.$bridgefunc.vuexStorage(),t.$userCenter._setDefaultPickupAddress(e.id))},otherAddressEvent:function(){var e=[t.detailData.id];t.$router.push({path:"/mall2/selfliftingsite",query:{skuIds:JSON.stringify(e)}}),r.a.close()}})},selectArea:function(){var t=this;n.a.open({initData:{selectedId:this.$store.state.mall2.selectAddress.id,token:this.$store.state.login.token},addressEvent:function(e,i){t.$store.state.mall2.selectAddress=e,t.$bridgefunc.vuexStorage(),n.a.close()}})},backEvent:function(){this.$router.go(-1)},introductionSelected:function(t){this.introductionIndex=t},getPrices:function(){return s.a.getPriceShow(this.detailData.purPriceRules)},getProductImgs:function(){return this.detailData.picUrlJson.split(",")},showBigImageEvent:function(){},getPurchaseDetail:function(){var t=this,e={id:this.id};this.$Loading.open(),this.$http.post("/app/json/pro_sku_purchase/queryPurchaseDetail",e).then((function(e){t.$Loading.close();var i=e.data;0==i.status?(t.detailData=i.data,t.selectedNum=t.detailData.minPurNumber,t.introduction1=t.detailData.proSkuMedia.mobileDetail,t.introduction2=t.detailData.proSkuMedia.mobileParam,t.introduction3=t.detailData.afterHelp,t.loaded=!0):t.$Toast(i.info)}),(function(e){t.$Loading.close(),t.$Toast("请求数据失败！")}))},addMethod:function(){var t=this;this.$messagebox.confirm("确定要添加该商品到店铺吗!","提示").then((function(e){t.$Loading.open(),t.$http.post("/app/json/app_distribution_order/addProToMicroStore",{skuId:t.skuId,storeId:t.getPutaggregate.id}).then((function(e){if(t.$Loading.close(),0==e.data.status){t.$Toast("添加成功!"),t.listData.hidden=1,eventBus.$emit("setlistData",t.skuId);var i=JSON.parse(sessionStorage.getItem("microShoListData"));i.hidden=1,sessionStorage.setItem("microShoListData",JSON.stringify(i))}else t.$Toast(e.data.info)}))})).catch((function(){}))},shareMethod:function(){var t=this;"1"!=this.listData.hidden?(this.$Loading.open(),this.$http.post("/app/json/app_distribution_order/addProToMicroStore",{skuId:this.skuId,storeId:this.getPutaggregate.id}).then((function(e){t.$Loading.close(),0==e.data.status?(t.$Toast("添加成功!"),t.listData.hidden=1,eventBus.$emit("setlistData",t.skuId),t.shareObj=Object.assign({},t.shareObj,t.detailData),t.popupShow=!0,t.shareObj.popupShow=!0):t.$Toast(e.data.info)}))):(this.shareObj=Object.assign({},this.shareObj,this.detailData),this.popupShow=!0,this.shareObj.popupShow=!0)},upDownMethod:function(){var t=this;this.$messagebox.confirm("确定要"+(1==this.objStype.queryType?"下架":"上架")+"该商品吗!","提示").then((function(e){var i=1==t.objStype.queryType?"0":"1";t.$Loading.open(),console.log(1),t.$http.post("/app/json/app_distribution_order/updateProFromMicroStore",{skuId:t.skuId,storeId:t.getPutaggregate.id,status:i}).then((function(e){t.$Loading.close(),0==e.data.status?(t.$Toast((1==t.objStype.queryType?"下架":"上架")+"成功!"),t.objStype.queryType=1==t.objStype.queryType?"0":"1"):t.$Toast(e.data.info)}))})).catch((function(){}))},upDownShareMethod:function(){this.shareObj=Object.assign({},{proSkuDistributionId:this.proSkuDistributionId},this.shareObj,this.detailData,{deliverType:this.detailData.deliveryType,salePrice:this.detailData.activityPrice}),this.popupShow=!0,this.shareObj.popupShow=!0,this.shareObj.groupFlag=this.$route.query.groupFlag},setshareData:function(t){this.popupShow=!1,this.shareObj=Object.assign({},t)}},created:function(){this.id=this.$route.query.id,this.skuId=this.$route.query.skuId?this.$route.query.skuId:"",this.$route.query.obj?"[object String]"==Object.prototype.toString.call(this.$route.query.obj)?this.objStype=JSON.parse(sessionStorage.getItem("microShoStype")):(this.objStype=this.$route.query.obj,sessionStorage.setItem("microShoStype",JSON.stringify(this.objStype))):this.objStype={},this.$route.query.listData?"[object String]"==Object.prototype.toString.call(this.$route.query.listData)?this.listData=JSON.parse(sessionStorage.getItem("microShoListData")):(this.listData=this.$route.query.listData,sessionStorage.setItem("microShoListData",JSON.stringify(this.listData))):this.listData={},this.isRecommend=this.$route.query.isRecommend,this.getPurchaseDetail()},beforeRouteLeave:function(t,e,i){"/mall2/purchaseplace"==t.path||"/mall2/selfliftingsite"==t.path||this.$keepaliveHelper.deleteCache(this),i()}},c=(i("0Lyl"),i("KHd+")),u=Object(c.a)(d,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"detail mall2"},[t.loaded?i("div",{staticClass:"detail-content"},[i("div",{staticClass:"nav-top",style:{top:t.$store.state.barHeight+"px",height:t.$market.getNavHeight(!0)+"px","line-height":t.$market.getNavHeight(!0)+"px"}},[i("div",{staticClass:"nav-back-btn",staticStyle:{left:"10px",top:"5px",width:"34px",height:"34px",padding:"5px"},on:{click:t.backEvent}},[i("img",{staticStyle:{display:"block",width:"100%",height:"100%"},attrs:{src:"static/image/mall2/back.png"}})])]),t._v(" "),i("div",{staticClass:"scroll-div",style:{top:t.$store.state.barHeight+"px"}},[i("div",{staticClass:"swiper-div theme_bg_white",on:{click:t.showBigImageEvent}},[i("swiper",{attrs:{options:t.swiperOption}},t._l(t.getProductImgs(),(function(t,e){return i("swiper-slide",{key:e},[i("div",{staticClass:"swiper-img-div"},[i("img",{attrs:{src:t}})])])})),1),t._v(" "),i("div",{staticClass:"swiper-index"},t._l(t.getProductImgs(),(function(e,s){return i("div",{staticClass:"si-item theme_bg_white_ef",class:{"cus-index":t.proImgIndex==s,theme_bg_red_i:t.proImgIndex==s}})})),0)],1),t._v(" "),i("div",{staticClass:"pro-info"},[i("div",{staticClass:"price theme_font_red"},t._l(t.getPrices(),(function(e,s){return i("div",{staticClass:"price-item"},[0!=s?i("p",{staticClass:"xian"},[t._v(" ~ ")]):t._e(),t._v(" "),i("p",[t._v("¥")]),t._v(" "),i("p",{staticClass:"big"},[t._v(t._s(e.iNum)+".")]),t._v(" "),i("p",[t._v(t._s(e.dNum))])])})),0),t._v(" "),i("p",{staticClass:"title single-line"},[t._v(t._s(t.detailData.showTitle))]),t._v(" "),i("p",{staticClass:"theme_font_gray"},[t._v("起购数量："+t._s(t.detailData.minPurNumber))])]),t._v(" "),i("div",{staticClass:"block-div theme_bg_white"},[t._m(0),t._v(" "),t._l(t.detailData.purPriceRules,(function(e){return i("div",{staticClass:"flex-row"},[i("div",{staticClass:"theme_font_common full"},[t._v("购买数量 "+t._s(e.number))]),t._v(" "),i("div",{staticClass:"theme_font_common"},[t._v("售价： ")]),t._v(" "),i("div",{staticClass:"theme_font_red"},[t._v(" ¥"+t._s(t.$util.toDecimal2(e.price)))])])}))],2),t._v(" "),"2"==t.deliverType?i("div",{staticClass:"block-div theme_bg_white"},[i("div",{staticClass:"flex-row",staticStyle:{"align-items":"flex-start"},on:{click:t.selectArea}},[i("div",{staticClass:"label-min theme_font_gray"},[t._v("送至")]),t._v(" "),""==t.$store.state.mall2.selectAddress.id?i("div",{staticClass:"theme_font_black full address-div"},[t._v("\n            请选择配送区域\n          ")]):t._e(),t._v(" "),""!=t.$store.state.mall2.selectAddress.id?i("div",{staticClass:"theme_font_black full address-div"},[t._v("\n            "+t._s(t.$store.state.mall2.selectAddress.addressFull)+"\n          ")]):t._e(),t._v(" "),t._m(1)])]):t._e(),t._v(" "),"1"==t.deliverType?i("div",{staticClass:"block-div theme_bg_white"},[i("div",{staticClass:"flex-row",staticStyle:{"align-items":"flex-start"},on:{click:t.selectPickUpAddress}},[i("div",{staticClass:"label-middle theme_font_gray"},[t._v("自提点")]),t._v(" "),i("div",{staticClass:"theme_font_black full"},[t._v(t._s(t.$store.state.mall2.zitiAddress.storeName))]),t._v(" "),t._m(2)])]):t._e(),t._v(" "),i("div",{staticClass:"btns-div theme_bg_white"},[i("div",{staticClass:"btn-item theme_font_gray",class:{theme_font_red_i:1==t.introductionIndex},on:{click:function(e){return t.introductionSelected(1)}}},[t._v("商品介绍\n        ")]),t._v(" "),i("div",{staticClass:"btn-item theme_font_gray",class:{theme_font_red_i:2==t.introductionIndex},on:{click:function(e){return t.introductionSelected(2)}}},[t._v("规格参数\n        ")]),t._v(" "),i("div",{staticClass:"btn-item theme_font_gray",class:{theme_font_red_i:3==t.introductionIndex},on:{click:function(e){return t.introductionSelected(3)}}},[t._v("售后包装\n        ")])]),t._v(" "),i("div",{staticClass:"detail-detail"},[1==t.introductionIndex?i("div",{staticClass:"introduction-div",domProps:{innerHTML:t._s(t.introduction1)}}):t._e(),t._v(" "),2==t.introductionIndex?i("div",{staticClass:"introduction-div",domProps:{innerHTML:t._s(t.introduction2)}}):t._e(),t._v(" "),3==t.introductionIndex?i("div",{staticClass:"introduction-div",domProps:{innerHTML:t._s(t.introduction3)}}):t._e()])])]):t._e(),t._v(" "),t.loaded?i("div",{staticClass:"bottom-btns"},[Object.keys(t.objStype).length?i("div",{staticClass:"bottom-box upDown"},[t.isRecommend?t._e():i("div",{staticClass:"btn",class:1==t.objStype.queryType?"theme_standard_font_i":"theme_standard_bg theme_font_white",on:{click:t.upDownMethod}},[i("span",{staticClass:"iconfont"},[t._v(t._s(1==t.objStype.queryType?"下架":"上架"))])]),t._v(" "),1==t.objStype.queryType?i("div",{staticClass:"btn theme_font_white theme_standard_bg",on:{click:t.upDownShareMethod}},[i("p",{staticClass:"title"},[t._v("分享推广")])]):t._e()]):i("div",{staticClass:"bottom-box add"},[0==t.listData.hidden?i("div",{staticClass:"addText theme_font_white theme_standard_bg",on:{click:t.addMethod}},[i("p",{staticClass:"title"},[t._v(t._s("添加"))])]):i("div",{staticClass:"addText theme_font_white theme_standard_bg"},[i("p",{staticClass:"title"},[t._v(t._s("已添加"))])])])]):t._e(),t._v(" "),t.popupShow?i("Share",{attrs:{shareObj:t.shareObj},on:{setshareData:t.setshareData}}):t._e()],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"flex-row"},[e("div",{staticClass:"theme_font_gray full"},[this._v("采购价格说明")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("i",{staticClass:"iconfont mall-gengduo more-icon theme_font_tint"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("i",{staticClass:"iconfont mall-gengduo more-icon theme_font_tint"})])}],!1,null,"2d4185f6",null);e.default=u.exports},IYJV:function(t,e,i){"use strict";var s=i("ZI3E");i.n(s).a},ZI3E:function(t,e,i){},eqsK:function(t,e,i){"use strict";var s=i("lR8Q"),a=i.n(s),o=i("2nGb"),n=i("0FX9"),r=i.n(n),l=i("L2JU"),d=i("rlxw"),c={name:"share",props:["shareObj"],computed:(Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t})({},Object(l.c)(["getPutaggregate"])),data:function(){return{imgUrl:"",timeOutEvent:0,popupShow:!0,codeShow:this.shareObj.codeShow,detailData:this.$util.deepClone(this.shareObj)}},mounted:function(){this.setOssImg(this.detailData.phMainUrl||this.detailData.picMainUrl||this.detailData.picUrls[0])},methods:{getPrices:function(){return d.a.getPriceShow(this.detailData.purPriceRules)},setOssImg:function(t){var e=this;this.imgUrl="",this.$request.post("/app/json/home/getFileBase64",{filePath:t}).then((function(t){0==t.status?t.data?e.imgUrl="data:image/png;base64,"+(t.data||""):e.$Toast("getFileBase64 返回为空"):e.$Toast(t.info)}))},getInteger:function(t){return this.$util.toDecimal2(t).split(".")[0]},getDecimals:function(t){return this.$util.toDecimal2(t).split(".")[1]},clickOverlay:function(){this.detailData.popupShow=!1,this.$emit("setshareData",this.detailData.storeCode)},sharewx:function(){var t="/micro_sho/shareDetail/";this.detailData.groupFlag&&(t="/micro_sho/sharebuyingDetail/");var e={};(e={}).title=this.detailData.showTitle||this.detailData.skuName,e.sharetext=this.detailData.skuName,e.imageurl=this.detailData.phMainUrl,e.detailurl=this.$store.state.globalConfig.wxBaseUrl+o.a.shareUrl+""+t+this.$util.getDataString(),e.detailurl=e.detailurl+"?id="+(this.detailData.id||this.detailData.skuId)+"&skuId="+(this.detailData.skuId||this.detailData.id)+"&microStoreCode="+this.getPutaggregate.storeCode+"&storeName="+this.getPutaggregate.storeName+"&productType="+this.detailData.productType+"&deliveryType="+this.$store.state.mall2.staticDeliverType+"&storeOuCodeNew="+this.$store.state.mall2.zitiAddress.id+"&proSkuDistributionId="+this.detailData.proSkuDistributionId,this.$store.state.login.token&&""!=this.$store.state.login.token&&(e.detailurl=e.detailurl+"&recommend="+this.$store.state.userInfo.userId,e.detailurl=e.detailurl+"&recommendPhone="+this.$store.state.login.phone),console.log("shareData",e),this.$bridgefunc.wechatShare(e)},QRcode:function(){var t=this,e="/micro_sho/shareDetail";this.detailData.groupFlag&&(e="/micro_sho/sharebuyingDetail"),this.codeShow=!0,this.$emit("qRcodeStstus",this.codeShow),this.$nextTick((function(i){var s=""+t.$store.state.globalConfig.wxBaseUrl+o.a.shareUrl+e+"/"+t.$util.getDataString()+"?id="+(t.detailData.id||t.detailData.skuId)+"&skuId="+(t.detailData.skuId||t.detailData.id)+"&microStoreCode="+t.getPutaggregate.storeCode+"&storeName="+t.getPutaggregate.storeName+"&productType="+t.detailData.productType+"&deliveryType="+t.$store.state.mall2.staticDeliverType+"&storeOuCodeNew="+t.$store.state.mall2.zitiAddress.id+"&proSkuDistributionId="+t.detailData.proSkuDistributionId;r.a.toCanvas(document.getElementById("qrcode"),s,{width:140})}))},btnbox:function(){this.codeShow=!1,this.$emit("qRcodeStstus",this.codeShow)},preservation:function(){var t=this,e=document.querySelector(".code-content"),i=parseInt(window.getComputedStyle(e).width),s=parseInt(window.getComputedStyle(e).height),o=document.createElement("canvas");o.width=2*i,o.height=2*s,o.getContext("2d").scale(2,2);var n={useCORS:!0,scale:2,canvas:o,backgroundColor:"#000"};a()(this.$refs.imageWrapper,n).then((function(e){var i=e.toDataURL("image/png");t.codeShow=!1;var s=i.split("base64,");console.log(i),t.$bridgefunc.savePhoto(s[1],(function(e){"1"==e?(t.detailData.popupShow=!1,t.$emit("setshareData",t.detailData),t.$Toast("保存成功！")):t.$Toast("保存失败！")}))}))}}},u=(i("IYJV"),i("KHd+")),h=Object(u.a)(c,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"box"},[i("van-popup",{attrs:{position:"bottom"},on:{"click-overlay":t.clickOverlay},model:{value:t.detailData.popupShow,callback:function(e){t.$set(t.detailData,"popupShow",e)},expression:"detailData.popupShow"}},[i("div",{staticClass:"popup"},[i("div",{staticClass:"popup-content",on:{click:t.sharewx}},[i("img",{attrs:{src:"static/image/mall2/weixin.png",alt:""}}),t._v(" "),i("span",[t._v("微信")])]),t._v(" "),i("div",{staticClass:"popup-content",on:{click:t.QRcode}},[i("img",{attrs:{src:"static/image/microShop/code@2x.png",alt:""}}),t._v(" "),i("span",[t._v("二维码")])])])]),t._v(" "),t.codeShow?i("div",{staticClass:"code-div",on:{click:function(e){return e.target!==e.currentTarget?null:t.btnbox(e)}}},[i("div",{ref:"imageWrapper",staticClass:"code-content"},[i("div",{staticClass:"code-content-img"},[i("div",{staticClass:"code-content-img-top"},[i("img",{attrs:{src:t.imgUrl,alt:"",crossOrigin:"anonymous"}})]),t._v(" "),t.detailData.groupFlag?i("div",{staticClass:"code-content-img-buttom"},[i("div",{staticClass:"price theme_font_red"},t._l(t.getPrices(),(function(e,s){return i("div",{staticClass:"price-item"},[0!=s?i("p",{staticClass:"xian"},[t._v(" ~ ")]):t._e(),t._v(" "),i("p",[t._v("¥")]),t._v(" "),i("p",{staticClass:"big"},[t._v(t._s(e.iNum)+".")]),t._v(" "),i("p",[t._v(t._s(e.dNum))])])})),0),t._v(" "),i("div",{staticClass:"text theme_font_black"},[t._v(t._s(t.detailData.showTitle))])]):i("div",{staticClass:"code-content-img-buttom"},[i("div",{staticClass:"text theme_font_red"},[i("span",{staticClass:"font-small price-z theme_font_red",staticStyle:{"font-weight":"700"}},[t._v("￥")]),t._v(" "),i("span",{staticClass:"price-z theme_font_red",staticStyle:{"margin-left":"-4px"}},[t._v(t._s(t.getInteger(t.detailData.salePrice)))]),t._v(" "),i("span",{staticClass:"font-small price-z theme_font_red",staticStyle:{"margin-left":"-4px","font-weight":"700"}},[t._v("."+t._s(t.getDecimals(t.detailData.salePrice)))])]),t._v(" "),i("div",{staticClass:"text theme_font_black"},[t._v(t._s(t.detailData.dpedData.featureName||t.detailData.skuName))])])]),t._v(" "),i("div",{staticClass:"code-content-line"}),t._v(" "),t._m(0),t._v(" "),i("div",{staticClass:"code-content-zanwei"})]),t._v(" "),i("div",{staticClass:"code-btn"},[i("div",{staticClass:"btn theme_bg_red",on:{click:function(e){return e.stopPropagation(),t.preservation(e)}}},[t._v("保存图片到本地")]),t._v(" "),i("div",{staticClass:"text"},[t._v("记得发送给朋友或发布到朋友圈呦！")])])]):t._e()],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"code-content-code"},[e("canvas",{staticClass:"qrcode",attrs:{id:"qrcode"}}),this._v(" "),e("p",[this._v("微信扫码或长按识别二维码")])])}],!1,null,"1e8a9c88",null);e.a=h.exports},rlxw:function(t,e,i){"use strict";var s=i("ygAv"),a={getPriceShow:function(t){if(0==t.length)return"";for(var e=t[0].price,i=t[0].price,s=1;s<t.length;s++){var a=t[s].price;e>a&&(e=a),i<a&&(i=a)}return e==i?[this.getINumDNum(e)]:[this.getINumDNum(e),this.getINumDNum(i)]},getINumDNum:function(t){var e=s.a.toDecimal2(t).split(".");return{iNum:e[0],dNum:e[1]}}};e.a=a}}]);