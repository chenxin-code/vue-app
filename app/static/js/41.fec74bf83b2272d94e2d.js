(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{"0Q/+":function(t,e,s){"use strict";var a=s("K3pP");s.n(a).a},ANbv:function(t,e,s){"use strict";var a=s("H7qB"),o=function(t,e){var s,a,o,i=[],n="";s=function(){a.forEach((function(t,e){var s=i[e];void 0===s?t.removeAttribute("style"):t.setAttribute("style",s)}))},function t(e,s){e&&e.parentElement&&(s.push(e.parentNode),t(e.parentElement,s))}(t,o=[]),o.push(t),a=o.filter((function(t){return"none"===function(t,e){return t.style[e]?t.style[e]:t.currentStyle?t.currentStyle[e]:window.getComputedStyle(t,null)[e]}(t,"display")})),n+="visibility: hidden !important; display: block !important; ",a.forEach((function(t,e){var s=t.getAttribute("style");i.push(s),t.setAttribute("style",s?s+";"+n:n)}));var c=0;return"width"==e?c=t.clientWidth:"height"==e&&(c=t.clientHeight),s(),c},i={name:"",props:{dataList:{type:Array,default:function(){return[]}},click:{type:Boolean,default:!0},percentWidth:{type:Number,default:0}},data:function(){return{}},mounted:function(){this._refresh()},methods:{touchstart:function(t){},disable:function(){this.scroll&&this.scroll.disable()},enable:function(){this.scroll&&this.scroll.enable()},_refresh:function(){var t=this;this.$nextTick((function(){setTimeout((function(){t._setWidth(),t._initScroll()}),200)}))},_setWidth:function(){if(this.$refs.scrollContent){for(var t=this.$refs.scrollContent.children,e=this.$refs.scroll.clientWidth,s=0,a=0;a<t.length;a++){var i=t[a];this.percentWidth&&(i.style.width=e*this.percentWidth/100+"px"),s+=o(i,"width")}this.$refs.scrollContent.style.width=s+10+"px"}},_initScroll:function(){this.$refs.scroll&&(this.scroll=new a.a(this.$refs.scroll,{scrollX:!0,scrollY:!1,click:this.click,preventDefault:!1}))}},components:{},watch:{dataList:{handler:function(t){t&&t.length&&this._refresh()},immediate:!0}}},n=(s("JmlT"),s("KHd+")),c=Object(n.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{ref:"scroll",staticClass:"scroll-wrapper",on:{touchstart:this.touchstart}},[e("div",{ref:"scrollContent",staticClass:"scroll-content"},[this._t("default")],2)])}),[],!1,null,"43d437b2",null);e.a=c.exports},JmlT:function(t,e,s){"use strict";var a=s("rGnI");s.n(a).a},Jvtp:function(t,e,s){"use strict";s.r(e);var a=s("KJ3S"),o=s("ANbv"),i=s("lqQh"),n=s("WQzh"),c=s("A8ay"),r={name:"coupon-jfhq",props:["myIndex","usePorpData","propData"],computed:{pageData:function(){return 1==this.usePorpData?this.propData:this.$store.state.pageData},moduleData:function(){return this.pageData.moduleList[this.myIndex].data}},components:{PriceOrder:n.a,HScroll:o.a,ExchangeCoupon:i.a},mixins:[c.a],data:function(){return{totalAccount:"",accountType:""}},methods:{exchangeEvent:function(t){this.$market.exchangeCoupon(t)},accTypeName:function(){var t="积分";return 9===this.accountType&&(t=this.$store.state.globalConfig.Employees_wallet||"福豆"),t},checkScore:function(){var t=this;if(""!=this.$store.state.login.token||-1==this.$store.state.webtype){var e={token:this.$store.state.login.token,acctType:this.accountType,groupValue:"1"};this.$http.post("/app/json/acct/getAccountBaseInfo",e).then((function(e){var s=e.data;if(0==s.status&&(3===t.accountType?t.totalAccount=s.data.balanceUnit:9===t.accountType&&(t.totalAccount=s.data.balanceUnit),t.moduleData.showTips)){var a="兑换成功，您的账户剩余"+t.totalAccount+t.accTypeName();t.$Toast(a)}}))}},exchangeContinue:function(t){for(var e=[],s=0;s<this.moduleData.rows.length;s++)t==s&&(this.moduleData.rows[s].isExchangeSuccess=!1),e.push(this.moduleData.rows[s]);this.moduleData.rows=e},useCoupon:function(){this.$util.linkToCouponList()},confirmExchange:function(t,e){var s=this;if(-1!=this.$store.state.webtype){this.$Loading.open();var a={token:this.$store.state.login.token,deliveryType:2,virtualUserPhone:this.$store.state.login.phone};t.perDiscountEmpRewardsPrice?(a.carts=[{number:1,skuId:t.skuId,storeOuCode:t.storeOuCode,empRewardsPrice:t.perDiscountEmpRewardsPrice,price:0,selfActivityId:t.activityId}],a.payDigital=[{payDigital:t.perDiscountEmpRewardsPrice,acctType:"EmpRewards"}]):t.perDiscountRewardsPrice?(a.carts=[{number:1,skuId:t.skuId,storeOuCode:t.storeOuCode,rewardsPrice:t.perDiscountRewardsPrice,price:0,selfActivityId:t.activityId}],a.payDigital=[{payDigital:t.perDiscountRewardsPrice,acctType:"Rewards"}]):(a.carts=[{number:1,skuId:t.skuId,storeOuCode:t.storeOuCode,pointsPrice:t.points,price:0,selfActivityId:t.activityId}],a.payDigital=[{payDigital:t.points,acctType:"Points"}]),this.$http.post("/app/json/app_shopping_order/submit",a).then((function(t){var a=t.data;if(0==a.status){for(var o=[],i=0;i<s.moduleData.rows.length;i++)e==i&&(s.moduleData.rows[i].isExchangeSuccess=!0),o.push(s.moduleData.rows[i]);s.moduleData.rows=o,s.checkScore(!0)}else s.$Toast(a.info);s.$Loading.close()}))}},redeemNow:function(t,e){-1!=this.$store.state.webtype&&(t.distCntCurUser>=t.discountGoodsCntPerUser?this.$Toast("每人限购"+t.discountGoodsCntPerUser+"个，您已到达上限，去看看其它商品吧！"):0==t.remainNum?this.$Toast("已售完"):100==t.selfSoldNum?this.$Toast("今日可领取次数已用尽"):this.confirmExchange(t,e))},excTypeVal:function(t){return t.activityTags.indexOf("YouDouExCoupon")>=0?t.perDiscountEmpRewardsPrice:t.activityTags.indexOf("RewardExCoupon")>=0?t.perDiscountRewardsPrice:t.points},excTypeIcon:function(t){return t.activityTags.indexOf("YouDouExCoupon")>=0||t.activityTags.indexOf("RewardExCoupon")>=0?100==t.soldNum?"static/image/coupon/emp-reward-dis.png":"static/image/coupon/emp-reward.png":100==t.soldNum?"static/image/coupon/point-de.png":"static/image/coupon/point-icon.png"},excTypeName:function(t){return t.activityTags.indexOf("YouDouExCoupon")>=0?this.$store.state.globalConfig.Employees_wallet||"福豆":t.activityTags.indexOf("RewardExCoupon")>=0?this.$store.state.globalConfig.Employees_wallet||"福豆":"积分"},_getMyData:function(){var t=this;if(null!=this.moduleData.couponFrom){var e=this.$market.apiBaseURL()+"/app/json/product/getAppProSearchList",s={page:1,rows:this.moduleData.couponFrom.number};""!=this.$store.state.login.token&&-1!=this.$store.state.webtype&&(s.token=this.$store.state.login.token),s.activityId=this.moduleData.couponFrom.activity.activityId,"513"==this.moduleData.productType&&(s.productType="513"),this.$http.post(e,s).then((function(e){var s=e.data;if(0==s.status){t.moduleData.rows=[];for(var a=s.data.list,o=0;o<a.length;o++){var i=t.$market.dataProcessing(a[o]);t.moduleData.rows.push(i)}if(a.length>0){var n=a[0];n.activityTags.indexOf("YouDouExCoupon")>=0?t.accountType=9:n.activityTags.indexOf("RewardExCoupon")>=0?t.accountType=9:t.accountType=3,t.checkScore()}}}),(function(t){}))}},getBgDivStyle:function(){var t="",e=this.moduleData.bgImgUrl;""!=e&&(t+="background: url('"+e+"') no-repeat center center / 100% 100%;");var s=this.moduleData.bgColor;return""!=s&&(t+="background-color: "+s+";"),t},getSidesStyle:function(){var t="",e=this.moduleData.sidesMargin;return e>0&&(t+="margin-left: "+e+"%; margin-right: "+e+"%;"),t},modeleReshow:function(){this._getMyData()}},created:function(){var t=this;this.moduleData.rows=[],this._getMyData(),a.a.$on("CouponHQRefresh",(function(){t._getMyData()}))}},u=(s("zgaS"),s("KHd+")),l=Object(u.a)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-jfhq",style:t.getBgDivStyle()},[""!=t.totalAccount&&t.moduleData.showTips?s("div",{staticClass:"tip"},[t._v("您的账户还有"),s("span",{staticClass:"theme_font_red"},[t._v(t._s(t.totalAccount))]),t._v(t._s(t.accTypeName()))]):t._e(),t._v(" "),2==t.moduleData.styleTempl?s("div",[t.moduleData.rows.length>0||1!=t.usePorpData?s("div",{staticClass:"coupon-content style-h",style:t.getSidesStyle()},[s("HScroll",{attrs:{dataList:t.moduleData.rows,click:!1}},t._l(t.moduleData.rows,(function(e,a){return s("div",{key:a,staticClass:"item"},[s("div",{staticClass:"item-content"},[s("div",{staticClass:"coupon"},[s("img",{staticClass:"bg-img",attrs:{src:"static/images/hk/coupon-bg-2.png"}}),t._v(" "),s("div",{staticClass:"couFaceValue"},[t._v(t._s(e.skuPropValues||"0元"))]),t._v(" "),s("div",{staticClass:"name single-line"},[t._v(t._s(e.shortName))])]),t._v(" "),s("div",{staticClass:"price single-line"},[s("PriceOrder",{attrs:{listitem:e,isRMBEnd:!0}})],1),t._v(" "),s("div",{staticClass:"btn",on:{click:function(s){return t.exchangeEvent(e)}}},[t._v("立即兑换")])])])})),0)],1):t._e()]):3==t.moduleData.styleTempl?s("div",[t.moduleData.rows.length>0||1!=t.usePorpData?s("div",{staticClass:"coupon-content style-3",style:t.getSidesStyle()},t._l(t.moduleData.rows,(function(e,a){return s("div",{key:a,staticClass:"item"},[s("img",{staticClass:"bg-img",attrs:{src:"static/images/hk/coupon-bg.png"}}),t._v(" "),s("div",{staticClass:"coup-cont"},[s("div",{staticClass:"couFaceValue"},[t._v("¥"),s("span",[t._v(t._s(e.couFaceValue))])]),t._v(" "),s("div",{staticClass:"center-info line_left"},[s("div",{staticClass:"title"},[t._v(t._s(e.couTypeTitle))]),t._v(" "),s("div",{staticClass:"term"},[t._v("有效期：兑换成功后90天内有效")])]),t._v(" "),s("div",{staticClass:"right-div"},[s("div",[t._v("兑换价")]),t._v(" "),s("div",{staticClass:"price single-line"},[t._v(t._s(t.excTypeVal(e)||0)+t._s(t.excTypeName(e)))]),t._v(" "),s("div",{staticClass:"btn",on:{click:function(s){return t.exchangeEvent(e)}}},[t._v("立即兑换")])])])])})),0):t._e()]):s("div",[t.moduleData.rows.length>0||1!=t.usePorpData?s("div",{staticClass:"coupon-content",style:t.getSidesStyle()},t._l(t.moduleData.rows,(function(e,a){return s("div",{key:a,staticClass:"coupon-item"},[s("ExchangeCoupon",{attrs:{couponInfo:e,entryType:1}},[100==e.soldNum?s("div",{staticClass:"operate out"},[s("p",{staticClass:"title"},[t._v("消耗"+t._s(t.excTypeName(e)))]),t._v(" "),s("div",[s("span",{staticClass:"point-wrapper"},[s("img",{staticClass:"img",attrs:{src:t.excTypeIcon(e),alt:""}}),t._v(" "),s("span",{staticClass:"point-num"},[t._v(t._s(t.excTypeVal(e)))])])]),t._v(" "),s("div",{staticClass:"btn"},[t._v("已抢光")])]):s("div",{staticStyle:{height:"100%"}},[e.isExchangeSuccess?s("div",{staticClass:"operate"},[s("img",{staticClass:"exchange-success",attrs:{src:"static/image/coupon/convert.png",alt:""}}),t._v(" "),s("div",{staticClass:"btn theme_bg_red",on:{click:t.useCoupon}},[t._v("去使用")]),t._v(" "),s("div",{staticClass:"btn theme_bg_red",on:{click:function(e){return t.exchangeContinue(a)}}},[t._v("继续兑换")])]):s("div",{staticClass:"operate"},[s("p",{staticClass:"title"},[t._v("消耗"+t._s(t.excTypeName(e)))]),t._v(" "),s("div",[s("span",{staticClass:"point-wrapper"},[s("img",{staticClass:"img",attrs:{src:t.excTypeIcon(e),alt:""}}),t._v(" "),s("span",{staticClass:"point-num"},[t._v(t._s(t.excTypeVal(e)||0))])])]),t._v(" "),s("div",{staticClass:"btn",on:{click:function(s){return t.redeemNow(e,a)}}},[t._v("立即兑换\n              ")])])])])],1)})),0):t._e()])])}),[],!1,null,"f990ec08",null);e.default=l.exports},K3pP:function(t,e,s){},lqQh:function(t,e,s){"use strict";var a={JY:"bg-color-4",CZ:"bg-color-3",DSF:"bg-color-2",BLD:"bg-color-1",SC:"bg-color-0"},o={name:"",props:{disabled:{type:Boolean,default:!1},couponInfo:{type:Object,required:!1,default:function(){return{}}},entryType:{type:Number,required:!1,default:0}},data:function(){return{}},mounted:function(){},methods:{dealwithCouFaceValue:function(t){return Number(t)>100?parseInt(t):t},getDiscount:function(t){return 1e3*t/100},calAmount:function(t){return t?t=parseInt(t):0},calRandomAmount:function(t,e){return t&&e?t+"-"+e:"0-0"},formatCouType:function(t){return this.couponInfo.couPicReal||this.couponInfo.couPic?"":t&&a[t]?a[t]:"bg-color-1"},moveToDetail:function(){this.$emit("moveDetail",this.couponInfo)}},components:{}},i=(s("0Q/+"),s("KHd+")),n=Object(i.a)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-container"},[s("div",{staticClass:"coupon-left",on:{click:t.moveToDetail}},[s("div",{staticClass:"media-object",class:[t.formatCouType(t.couponInfo.couTypeCategoryAlias)]},[t.couponInfo.couPicReal||t.couponInfo.couPic?[0==t.entryType?s("img",{staticClass:"img",attrs:{src:t.couponInfo.couPicReal,alt:""}}):1==t.entryType?s("img",{staticClass:"img",attrs:{src:t.couponInfo.couPic,alt:""}}):t._e()]:[1!=t.couponInfo.isHideAmount?[10==t.couponInfo.couCategory?[s("div",{staticClass:"media-object-price-info"},[s("span",{staticClass:"unit"},[t._v("￥")]),t._v(" "),s("span",{staticClass:"price"},[t._v(t._s(t.dealwithCouFaceValue(t.couponInfo.couFaceValue)))])])]:20==t.couponInfo.couCategory?[s("div",{staticClass:"media-object-price-info"},[s("span",{staticClass:"unit"},[t._v("￥")]),t._v(" "),s("span",{staticClass:"price"},[t._v(t._s(t.dealwithCouFaceValue(t.couponInfo.couFaceValue)))])]),t._v(" "),s("div",{staticClass:"msg"},[t._v("满"+t._s(t.couponInfo.couThresholdAmount)+"元可用")])]:40==t.couponInfo.couCategory?[t.couponInfo.couDiscountValue?s("div",{staticClass:"media-object-price-info"},[s("span",{staticClass:"price"},[t._v(t._s(t.getDiscount(t.couponInfo.couDiscountValue)))]),t._v(" "),s("span",{staticClass:"unit"},[t._v("折")])]):s("div",{staticClass:"media-object-price-info"},[s("span",{staticClass:"price"},[t._v("折扣券")])]),t._v(" "),s("div",{staticClass:"msg"},[t._v("满"+t._s(t.couponInfo.couThresholdAmount)+"元可用")])]:[s("div",{staticClass:"media-object-price-info"},[s("span",{staticClass:"unit"},[t._v("￥")]),t._v(" "),s("span",{staticClass:"price"},[t._v(t._s(t.couponInfo.couFaceValue))])])]]:[s("span",[t._v(t._s(t.couponInfo.couTypeTitle))])]]],2),t._v(" "),(0==t.entryType&&t.couponInfo.couFaceValueType,s("div",{staticClass:"content"},[s("p",{staticClass:"name single-line coupon-title"},[t._v(t._s(t.couponInfo.couTypeTitle))])]))]),t._v(" "),s("div",{staticClass:"coupon-right"},[t._t("default")],2)])}),[],!1,null,"ee0b6962",null);e.a=n.exports},"r+6d":function(t,e,s){},rGnI:function(t,e,s){},zgaS:function(t,e,s){"use strict";var a=s("r+6d");s.n(a).a}}]);