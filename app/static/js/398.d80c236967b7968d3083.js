(window.webpackJsonp=window.webpackJsonp||[]).push([[398],{"1aAl":function(t,e,n){"use strict";n.r(e),n("ONWt");var s,i=n("dyrN"),o=(n("Gedb"),n("W34l")),r=n("uQt8");function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var l={components:(s={},a(s,i.a.name,i.a),a(s,"CountButton",r.a),s),data:function(){return{msgCode:"",phone:"",checked:!1,isShowRegisterModal:!1}},created:function(){this.thirdUserId=this.$store.state.login.thirdUserId},activated:function(){this.checked=this.$store.state.isAgreement},methods:{getMsgCode:function(t,e){var n=this;if(this.thirdUserId)if(this.phone){this.$refs.countBtn.startTime(),this.$Loading.open();var s={phone:this.phone,smsType:"1020",imgVerifyCode:t,uuid:e};this.$http.post("/app/json/login/sendSms",s).then((function(t){n.$Loading.close();var e=t.data;0==e.status?n.$Toast("获取短信验证码成功"):(n.$Toast(e.info?e.info:"获取短信验证码失败"),n.$refs.countBtn.resetClock())}),(function(t){n.$Loading.close(),n.$Toast("系统运行过程中遇到问题，请稍候再试"),n.$refs.countBtn.resetClock()}))}else this.$Toast("手机号不能为空!");else this.$Toast("该账号无法登录，请联系客服!")},registerFun:function(){var t=this;if(this.checked)if(this.phone)if(this.msgCode){this.$store.state.isAgreement||(this.isShowRegisterModal=!0);var e={phone:this.phone,thirdUserId:this.thirdUserId,smsVerifyCode:this.msgCode,regChannel:5,bindType:4,loginChannel:6};this.$store.state.rfrCode&&(e.rfrCode=this.$store.state.rfrCode,e.rfrCodeType=1),this.$store.state.enterPriseOuCode&&(e.enterPriseOuCode=this.$store.state.enterPriseOuCode),2==this.$store.state.webtype?(this.$Loading.open(),o.a.getWechatSignature((function(n){n?o.a.wxGetLocation((function(n){t.$store.state.currentLocation.posx=n?n.longitude:"",t.$store.state.currentLocation.posy=n?n.latitude:"",t.$mallCommon.addressAnalysis((function(n){t.$Loading.close(),e.province=t.$store.state.mall2.selectAddress.provinceName,e.provinceCode=t.$store.state.mall2.selectAddress.provinceId,e.city=t.$store.state.mall2.selectAddress.cityName,e.cityCode=t.$store.state.mall2.selectAddress.cityId,e.longitude=t.$store.state.currentLocation.posx,e.latitude=t.$store.state.currentLocation.posy,t.apiEvent(e)}),n)})):t.apiEvent(e)}))):(e.province=this.$store.state.mall2.selectAddress.provinceName,e.provinceCode=this.$store.state.mall2.selectAddress.provinceId,e.city=this.$store.state.mall2.selectAddress.cityName,e.cityCode=this.$store.state.mall2.selectAddress.cityId,e.longitude=this.$store.state.currentLocation.posx,e.latitude=this.$store.state.currentLocation.posy,this.apiEvent(e))}else this.$Toast("验证码不能为空!");else this.$Toast("手机号不能为空!");else this.$Toast("请同意服务条款及隐私政策!")},apiEvent:function(t){var e=this;this.$Loading.open(),this.$http.post("/app/json/login/bindThirdUser",t).then((function(t){e.$Loading.close(),console.log(t.data);var n=t.data;0==n.status?(e.$Toast("绑定成功"),e.$userCenter.retsetToIndex(n.data,1)):2002==n.errorCode?e.$Toast(n.info?n.info:"手机号已存在用户已注册"):e.$Toast(n.info?n.info:"注册失败")}),(function(t){e.$Loading.close(),e.$Toast("系统运行过程中遇到问题，请稍候再试")}))},viewsTerms:function(){console.log("阅读服务条款"),this.$router.push("/terms_service")}}},c=(n("tFhQ"),n("KHd+")),d=Object(c.a)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("div",{staticClass:"content"},[s("img",{staticClass:"logo",attrs:{src:n("mDCr"),alt:""}}),t._v(" "),s("van-form",{ref:"loginForm"},[s("div",{staticClass:"field-c"},[s("van-field",{attrs:{maxlength:"11",pattern:"[0-9]*",name:"手机号",placeholder:"请输入手机号",type:"tel",border:!1,clearable:""},on:{input:function(e){t.phone=/^\d+/.exec(t.phone)?/^\d+/.exec(t.phone)[0]:""}},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}})],1),t._v(" "),s("div",{staticClass:"field-c reset-margin-top"},[s("van-field",{attrs:{pattern:"[0-9]*",name:"验证码",type:"digit",border:!1,placeholder:"请输入验证码",clearable:""},on:{input:function(e){t.msgCode=t.$util.checkVerifyCodeLenght(t.msgCode)}},model:{value:t.msgCode,callback:function(e){t.msgCode=e},expression:"msgCode"}},[s("count-button",{ref:"countBtn",staticClass:"verif-code-btn",attrs:{slot:"button",phone:t.phone},on:{getSmsEvent:t.getMsgCode},slot:"button"})],1)],1),t._v(" "),s("div",{staticClass:"agreement",on:{click:function(e){return e.stopPropagation(),t.viewsTerms(e)}}},[s("van-checkbox",{staticClass:"agreement-label",attrs:{disabled:"","checked-color":"#c89f62",shape:"square"},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}}),t._v(" "),s("span",{staticClass:"agreement-name"},[t._v("服务条款及隐私政策")])],1),t._v(" "),s("div",{staticClass:"submit-btn chum-public-btn"},[s("van-button",{attrs:{round:"",block:"",type:"info",color:"linear-gradient(270deg,rgba(49,49,49,1) 0%,rgba(84,84,84,1) 51%,rgba(49,49,49,1) 100%)"},nativeOn:{click:function(e){return t.registerFun(e)}}},[t._v("绑定\n        ")])],1)])],1)])}),[],!1,null,"5bb68c5b",null);e.default=d.exports},ONWt:function(t,e,n){"use strict";n("aO+S")},dyrN:function(t,e,n){"use strict";var s=n("0oIA"),i=n("24U3"),o=Object(s.a)("form"),r=o[0],a=o[1];e.a=r({props:{colon:Boolean,labelWidth:[Number,String],labelAlign:String,inputAlign:String,scrollToError:Boolean,validateFirst:Boolean,errorMessageAlign:String,submitOnEnter:{type:Boolean,default:!0},validateTrigger:{type:String,default:"onBlur"},showError:{type:Boolean,default:!0},showErrorMessage:{type:Boolean,default:!0}},provide:function(){return{vanForm:this}},data:function(){return{fields:[]}},methods:{validateSeq:function(){var t=this;return new Promise((function(e,n){var s=[];t.fields.reduce((function(t,e){return t.then((function(){if(!s.length)return e.validate().then((function(t){t&&s.push(t)}))}))}),Promise.resolve()).then((function(){s.length?n(s):e()}))}))},validateAll:function(){var t=this;return new Promise((function(e,n){Promise.all(t.fields.map((function(t){return t.validate()}))).then((function(t){(t=t.filter((function(t){return t}))).length?n(t):e()}))}))},validate:function(t){return t?this.validateField(t):this.validateFirst?this.validateSeq():this.validateAll()},validateField:function(t){var e=this.fields.filter((function(e){return e.name===t}));return e.length?new Promise((function(t,n){e[0].validate().then((function(e){e?n(e):t()}))})):Promise.reject()},resetValidation:function(t){this.fields.forEach((function(e){t&&e.name!==t||e.resetValidation()}))},scrollToField:function(t,e){this.fields.some((function(n){return n.name===t&&(n.$el.scrollIntoView(e),!0)}))},addField:function(t){this.fields.push(t),Object(i.a)(this.fields,this)},removeField:function(t){this.fields=this.fields.filter((function(e){return e!==t}))},getValues:function(){return this.fields.reduce((function(t,e){return t[e.name]=e.formValue,t}),{})},onSubmit:function(t){t.preventDefault(),this.submit()},submit:function(){var t=this,e=this.getValues();this.validate().then((function(){t.$emit("submit",e)})).catch((function(n){t.$emit("failed",{values:e,errors:n}),t.scrollToError&&t.scrollToField(n[0].name)}))}},render:function(){return(0,arguments[0])("form",{class:a(),on:{submit:this.onSubmit}},[this.slots()])}})},mDCr:function(t,e,n){t.exports=n.p+"static/img/chum-logo.0473e1e.png"},oOUl:function(t,e,n){},tFhQ:function(t,e,n){"use strict";var s=n("oOUl");n.n(s).a}}]);