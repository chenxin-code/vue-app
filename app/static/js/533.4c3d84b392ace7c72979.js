(window.webpackJsonp=window.webpackJsonp||[]).push([[533],{CEw4:function(t,e,i){"use strict";e.a={methods:{exportinvoiceData:function(t){return this.$http.post("/app/json/user_invoice_assistant/importUserInvoiceHead",t)},golddetailData:function(t){return this.$http.post("/app/json/user_invoice_assistant/detailsOfInvoiceInfo",t)},invoicetipData:function(t){return this.$http.post("/app/json/news/getNewsList",t)},refundData:function(t){return this.$http.post("/app/json/user_invoice_assistant/invoiceRushRed",t)},cardMoData:function(t){return this.$http.post("/app/json/card/getUserCardList",t)},mingxiData:function(t){return this.$http.post("/app/json/user_invoice_assistant/detailsOfInvoiceList",t)},malldetailData:function(t){return this.$http.post("/app/json/app_shopping_order/detail",t)},shopdetailData:function(t){return this.$http.post("/app/json/user_invoice_assistant/convenienceStoredetail",t)},oildetailData:function(t){return this.$http.post("/app/json/refuel_center/detail",t)},hisdetailData:function(t){return this.$http.post("/app/json/user_invoice_assistant/invoiceContentDetails",t)},hisData:function(t){return this.$http.post("/app/json/user_invoice_assistant/invoiceContentDetailsList",t)},mallData:function(t){return this.$http.post("/app/json/app_shopping_order/queryOrder",t)},storeData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryConvenienceStoreOrder",t)},appData:function(t){return this.$http.post("/app/json/refuel_center/queryOrder",t)},goldData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryCashIn",t)},walletData:function(t){return this.$http.post("/app/json/user_invoice_assistant/sinopecWalletInvoiceList",t)},cardData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryUserRefuelingCardInfoList",t)},commitselfinvoiceData:function(t){return this.$http.post("/app/json/user_invoice_assistant/orderInvoicingInMall",t)},commitselfcardinvoiceData:function(t){return this.$http.post("/app/json/user_invoice_assistant/gasCardInvoice",t)},commitselfgoldinvoiceData:function(t){return this.$http.post("/app/json/user_invoice_assistant/cashInInvoicing",t)},emailData:function(t){return this.$http.post("/app/json/user_invoice_assistant/invoiceModifyMailbox",t)},histroydetailData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryInvoiceDetails",t)},histroyData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryInvoicedList",t)},riseData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryUserInvoiceHeadList",t)},openedData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryInvoicedList",t)},commitData:function(t){return this.$http.post("/app/json/user_invoice_assistant/addOrUpdateUserInvoiceHead",t)},delData:function(t){return this.$http.post("/app/json/user_invoice_assistant/deleteUserInvoiceHead",t)},morenData:function(t){return this.$http.post("/app/json/user_invoice_assistant/setDefaultUserInvoiceHead",t)},detailData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryInvoiceDetails",t)},souData:function(t){return this.$http.post("/app/json/user_invoice_assistant/searchInvoiceList",t)},soudetailData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryUserInvoiceHeadDetails",t)},tijiaoData:function(t){return this.$http.post("/app/json/user_invoice_assistant/addInvoicing",t)},saoData:function(t){return this.$http.post("/app/json/user_invoice_assistant/getResultFromQrcode",t)},morentitleData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryDefaultTittle",t)},daikaiData:function(t){return this.$http.post("/app/json/user_invoice_assistant/unInvoicingList",t)},chakanData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryUserInvoiceHeadDetails",t)}}}},b6gG:function(t,e,i){"use strict";i.r(e),i("5+UC");var a=i("05lO"),s=i("CEw4"),n=(i("F8w7"),{name:"invoicing",mixins:[s.a],data:function(){return{radio:"5",checked:!0,amount:"",orderId:"",detail:"",companyAddress:"",userEmail:"",orgTaxNo:"",title:"",openingBank:"",userPhone:"",bankAccount:"",showPage:!0,typeObj:{titleType:5},detailData1:!1,people:!1,paramsData:{},open:"",ouCode:"",orderType:"",dropDown:!1,isText:[],idDetail:"",detailObj1:{titleType:4},detailObj2:{titleType:5},vals:"",qrCode:"",stationOuCode:"",storeOuName:"",invoiceDetail:{},list:{},isShow:"",showPaperticketButton:-1,isOpenTicket:!1}},created:function(){this.qrCode=this.$route.query.StationInvoice},mounted:function(){this.sweepDetail(),this.defaultTitle()},methods:{openPaperTickets:function(){var t=this;console.log(this.list),this.$request.post("/app/json/user_invoice_assistant/unLockInvoiceMark",{storeBranchOrgOuCode:this.list.stationOuCode,shoppingOrderId:this.list.orderId,storeStandCode:this.list.ouCode,refuelRecordId:this.list.orderId}).then((function(e){0==e.status?t.$Toast(e.info?e.info:"开票成功"):t.$Toast(e.info?e.info:"获取我的拼团失败")}))},showPaperticketsBtn:function(t){var e=this;this.$request.post("/app/json/user_invoice_assistant/querShowPaperticketButton",{storeOuCode:t.order.storeOuCode}).then((function(t){0==t.status?(1==t.data&&1==e.isShow?e.showPaperticketButton=1:e.showPaperticketButton=-1,console.log("showPaperticketButton",e.showPaperticketButton)):e.$Toast(t.info)}))},dateCompare:function(t,e){var i=new Date(e),a=new Date(i.getTime()+18e5);return t.valueOf()>a.valueOf()?(console.log("已过期"),-1):t.valueOf()<a.valueOf()?(console.log("未过期"),1):void 0},close:function(){this.dropDown=!1},closeDetail:function(){this.detailData1=!1},goDetail:function(){this.detailData1=!0},detailData:function(t){4==t.titleType?this.detailObj1=t:5==t.titleType&&(this.detailObj2=t)},monitor:function(t){var e=this;t&&this.throttle((function(){var i={token:e.$store.state.login.token,title:t};e.souData(i).then((function(t){t.data.data.length>0?(e.isText=t.data.data,e.dropDown=!0):e.dropDown=!1}))}),500)()},throttle:function(t,e){var i=this;return function(){for(var a=arguments.length,s=Array(a),n=0;n<a;n++)s[n]=arguments[n];i.timer&&clearTimeout(i.timer),i.timer=setTimeout((function(){t.apply(i,s)}),e)}},commit:function(){var t=this;if(console.log(this.isOpenTicket),0==this.isOpenTicket){var e={};if(4==this.typeObj.titleType?(this.detailObj1.titleType=4,Object.assign(e,this.detailObj1)):5==this.typeObj.titleType&&(this.detailObj2.titleType=5,Object.assign(e,this.detailObj2)),console.log(this.detailObj1),console.log(this.detailObj2),console.log(e),!e.title)return void Object(a.a)({message:"请输入发票抬头",duration:2e3});if(!e.userEmail&&!e.userPhone)return void Object(a.a)({message:"请输入邮箱或者手机号",duration:2e3});if(e.userPhone&&!/^1(3|4|5|7|8|9)\d{9}$/.test(e.userPhone))return void Object(a.a)({message:"请输入正确的手机号",duration:2e3});if(e.userEmail&&!/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(e.userEmail))return void Object(a.a)({message:"请输入正确的邮箱",duration:2e3});if(5==e.titleType&&!e.orgTaxNo)return void Object(a.a)({message:"请输入税号",duration:2e3});this.$Loading.open(),this.tijiaoData({token:this.$store.state.login.token,userInvoiceHeadModel:e,stationInvoiceQrcodeModel:this.list}).then((function(e){t.$Loading.close(),"success"===e.data.result?(t.isOpenTicket=!0,a.a.success("开票成功")):Object(a.a)(e.data.info)}))}else a.a.success("已开票")},sweepDetail:function(){var t=this,e=this,i={token:this.$store.state.login.token,qrcode:e.qrCode};e.saoData(i).then((function(i){var a=i.data.data||{};if(e.state=a.state,0===a.state){if(e.list=a,e.orderId=a.stationOrder.orderId,e.amount=a.stationOrder.nrecAmount,e.storeOuCode=a.stationOrder.storeOuCode,e.orderType=a.orderType,e.ouCode=a.ouCode,e.stationOuCode=a.stationOuCode,e.storeOuName=a.stationOrder.storeOuName,console.log(t.$store.state.globalConfig.papertickets),1==t.$store.state.globalConfig.papertickets){var s=a.order.cashRefuelingRecordModelList[0].transactionTime;console.log(s);var n=s.slice(0,4)+"-"+s.slice(4,6)+"-"+s.slice(6,8)+" "+s.slice(8,10)+":"+s.slice(10,12)+":"+s.slice(12,14);console.log(n),t.isShow=t.dateCompare(new Date,n),t.showPaperticketsBtn(a)}a.stationOrder&&(t.invoiceDetail=t.$assign({},a.stationOrder.itemList[0],a.stationOrder.payList[0]))}else 1===a.state?e.$router.push({name:"invalid",params:{state:e.state}}):2===a.state&&e.$router.push({name:"invalid",params:{state:e.state}})}))},defaultTitle:function(){var t=this,e={token:this.$store.state.login.token};t.morentitleData(e).then((function(e){var i=e.data.data||{};i.titleType?t.typeObj.titleType=e.data.data.titleType:t.typeObj.titleType=5,4==t.typeObj.titleType?t.detailObj1=i:5==t.typeObj.titleType&&(t.detailObj2=i)}))}}}),o=(i("xXNh"),i("KHd+")),r=Object(o.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"body"},[i("nav-top",{attrs:{title:"开具发票"},on:{backEvent:function(e){return t.$router.go(-1)}}}),t._v(" "),i("nav-content",[t.showPage?i("div",[i("div",{on:{click:t.close}},[i("div",{staticClass:"publicInvoice publicInvoice1"},[i("van-cell-group",[i("van-field",{attrs:{type:"tel",label:"订单号",disabled:""},model:{value:t.orderId,callback:function(e){t.orderId=e},expression:"orderId"}}),t._v(" "),i("van-field",{attrs:{label:"金额",disabled:""},model:{value:t.amount,callback:function(e){t.amount=e},expression:"amount"}}),t._v(" "),i("div",{staticClass:"publicInvoiceDiv"},[i("van-field",{staticClass:"nei",attrs:{label:"发票内容",disabled:""},model:{value:t.detail,callback:function(e){t.detail=e},expression:"detail"}}),t._v(" "),i("div",{staticClass:"mingxi",on:{click:t.goDetail}},[i("span",[t._v("明细")]),t._v(" "),i("span",{staticClass:"img iconfont mall-gengduojiantou"})])],1)],1)],1),t._v(" "),i("div",{staticClass:"publicInvoice"},[4==t.typeObj.titleType?i("van-cell-group",{staticStyle:{position:"relative"}},[i("van-field",{staticClass:"paragraph",attrs:{label:"发票抬头",placeholder:"请输入发票抬头"},on:{input:t.monitor},model:{value:t.detailObj1.title,callback:function(e){t.$set(t.detailObj1,"title",e)},expression:"detailObj1.title"}}),t._v(" "),i("div",{class:{divPut:1==t.dropDown,nothing:0==t.dropDown}},[i("div",{staticClass:"divPut1"}),t._v(" "),i("div",{staticClass:"divPut2"},[i("ul",t._l(t.isText,(function(e,a){return t.dropDown?i("li",{on:{click:function(i){return t.detailData(e)}}},[t._v(t._s(e.title))]):t._e()})),0)])])],1):t._e(),t._v(" "),5==t.typeObj.titleType?i("van-cell-group",{staticStyle:{position:"relative"}},[i("van-field",{staticClass:"paragraph",attrs:{label:"发票抬头",placeholder:"请输入发票抬头"},on:{input:t.monitor},model:{value:t.detailObj2.title,callback:function(e){t.$set(t.detailObj2,"title",e)},expression:"detailObj2.title"}}),t._v(" "),i("div",{class:{divPut:1==t.dropDown,nothing:0==t.dropDown}},[i("div",{staticClass:"divPut1"}),t._v(" "),i("div",{staticClass:"divPut2"},[i("ul",t._l(t.isText,(function(e,a){return t.dropDown?i("li",{on:{click:function(i){return t.detailData(e)}}},[t._v(t._s(e.title))]):t._e()})),0)])])],1):t._e(),t._v(" "),i("van-radio-group",{model:{value:t.typeObj.titleType,callback:function(e){t.$set(t.typeObj,"titleType",e)},expression:"typeObj.titleType"}},[i("div",[t._v("抬头类型")]),t._v(" "),i("van-radio",{attrs:{name:4,"checked-color":"#f44"}},[t._v("个人/非企业单位")]),t._v(" "),i("van-radio",{attrs:{name:5,"checked-color":"#f44"}},[t._v("企业")])],1),t._v(" "),i("div",[4==t.typeObj.titleType?i("div",[i("van-cell-group",[i("van-field",{attrs:{type:"tel",label:"电话号码",placeholder:"输入手机号"},model:{value:t.detailObj1.userPhone,callback:function(e){t.$set(t.detailObj1,"userPhone",e)},expression:"detailObj1.userPhone"}}),t._v(" "),i("van-field",{attrs:{label:"电子邮箱",placeholder:"输入电子邮箱"},model:{value:t.detailObj1.userEmail,callback:function(e){t.$set(t.detailObj1,"userEmail",e)},expression:"detailObj1.userEmail"}})],1)],1):t._e(),t._v(" "),5==t.typeObj.titleType?i("div",[i("van-cell-group",[i("van-field",{attrs:{label:"税号",placeholder:"请输入税号"},model:{value:t.detailObj2.orgTaxNo,callback:function(e){t.$set(t.detailObj2,"orgTaxNo",e)},expression:"detailObj2.orgTaxNo"}}),t._v(" "),i("van-field",{attrs:{label:"电话号码",placeholder:"输入手机号"},model:{value:t.detailObj2.userPhone,callback:function(e){t.$set(t.detailObj2,"userPhone",e)},expression:"detailObj2.userPhone"}}),t._v(" "),i("van-field",{attrs:{label:"电子邮箱",placeholder:"输入电子邮箱"},model:{value:t.detailObj2.userEmail,callback:function(e){t.$set(t.detailObj2,"userEmail",e)},expression:"detailObj2.userEmail"}}),t._v(" "),i("van-field",{attrs:{label:"单位地址",placeholder:"选填"},model:{value:t.detailObj2.companyAddress,callback:function(e){t.$set(t.detailObj2,"companyAddress",e)},expression:"detailObj2.companyAddress"}}),t._v(" "),i("van-field",{attrs:{label:"开户银行",placeholder:"选填"},model:{value:t.detailObj2.openingBank,callback:function(e){t.$set(t.detailObj2,"openingBank",e)},expression:"detailObj2.openingBank"}}),t._v(" "),i("van-field",{attrs:{label:"银行账号",placeholder:"选填"},model:{value:t.detailObj2.bankAccount,callback:function(e){t.$set(t.detailObj2,"bankAccount",e)},expression:"detailObj2.bankAccount"}})],1)],1):t._e()])],1),t._v(" "),1==t.showPaperticketButton?i("div",{staticClass:"open-paper-tickets",on:{click:t.openPaperTickets}},[i("span",[t._v("我要开纸票")])]):t._e(),t._v(" "),i("div",{staticClass:"answer theme_bg_red",class:{active:t.isOpenTicket},on:{click:t.commit}},[t._v("申请开票")])])]):t._e(),t._v(" "),i("van-popup",{staticClass:"detail-modal",model:{value:t.detailData1,callback:function(e){t.detailData1=e},expression:"detailData1"}},[i("div",{staticClass:"detail-modal-content"},[i("div",{staticClass:"div1"},[i("span",[t._v("订单号")]),t._v(" "),i("span",[t._v(t._s(t.orderId))])]),t._v(" "),i("div",{staticClass:"div1"},[i("span",[t._v("油站")]),t._v(" "),i("span",[t._v(t._s(t.storeOuName))])]),t._v(" "),i("div",{staticClass:"div1"},[i("span",[t._v("开票金额")]),t._v(" "),i("span",[t._v(t._s(t.invoiceDetail.nrecAmount))])]),t._v(" "),i("div",{staticClass:"div1"},[i("span",[t._v("商品明细")]),t._v(" "),i("span",[t._v(t._s(t.invoiceDetail.skuName))])]),t._v(" "),i("div",{staticClass:"div1"},[i("span",[t._v("商品单价")]),t._v(" "),i("span",[t._v(t._s(t.invoiceDetail.price))])]),t._v(" "),i("div",{staticClass:"div1"},[i("span",[t._v("订单金额")]),t._v(" "),i("span",[t._v(t._s(t.invoiceDetail.payAmount))])]),t._v(" "),i("div",{staticClass:"div1"},[i("span",[t._v("支付明细")]),t._v(" "),i("span",[t._v(t._s(t.invoiceDetail.payModeName))])]),t._v(" "),i("div",{staticClass:"closeBtn",on:{click:t.closeDetail}},[i("i",{staticClass:"iconfont mall-guanbi"})])])])],1)],1)}),[],!1,null,"47b51861",null);e.default=r.exports},jKs7:function(t,e,i){},xXNh:function(t,e,i){"use strict";var a=i("jKs7");i.n(a).a}}]);