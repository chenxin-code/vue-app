(window.webpackJsonp=window.webpackJsonp||[]).push([[251,52],{AbvJ:function(t,e,s){},GRpt:function(t,e,s){},"HC/5":function(t,e,s){"use strict";s.r(e);var i=s("afTz"),a={name:"share",components:{LiveStream:s("fP9E").a,Countdown:i.default},data:function(){return{showLiveStream:!1,showPop:!1,playId:"",detail:{},list:[],shareInfo:{},isTimeOut:!1}},computed:{getCountdownTime:function(){return this.$util.getDateFromString(this.shareInfo.startTime)}},methods:{cancelSubscribe:function(){var t=this;this.$Loading.open();var e={streamerId:this.shareInfo.id,isSubscribe:"0",type:"0"};this.$http.post("/app/json/live_broadcast/liveSubscribe",e).then((function(e){t.$Loading.close();var s=e.data;0==s.status?t.getShareInfo():t.$Toast(s.info)}),(function(e){t.$Loading.close(),t.$Toast("获取数据失败")}))},subscribe:function(){var t=this;this.$Loading.open();var e={streamerId:this.shareInfo.id,isSubscribe:"1",type:"1"};this.$http.post("/app/json/live_broadcast/liveSubscribe",e).then((function(e){t.$Loading.close();var s=e.data;0==s.status?t.getShareInfo():t.$Toast(s.info)}),(function(e){t.$Loading.close(),t.$Toast("获取数据失败")}))},timeOut:function(){this.isTimeOut=!0,this.getShareInfo()},backEvent:function(){this.showLiveStream=!1,this.$router.replace({path:"/live-stream/list",query:{backType:"backindex"}})},getDetailInfo:function(){var t=this;this.$Loading.open();var e={lbId:this.playId};this.$http.post("/app/json/live_broadcast/detail",e).then((function(e){t.$Loading.close();var s=e.data;0==s.status?(t.list=[s.data],t.detail=s.data,t.showLiveStream=!0,t.$refs.LiveStream.playDetail(t.detail)):t.$Toast(s.info)}),(function(e){t.$Loading.close(),t.$Toast("获取数据失败")}))},getShareInfo:function(){var t=this;this.$Loading.open();var e={liveQrCode:this.liveQrCode};this.$http.post("/app/json/live_broadcast/getStreamerInfoByQrCode",e).then((function(e){t.$Loading.close();var s=e.data;0==s.status?(t.shareInfo=s.data,t.playId=s.data.liveId,"1"==t.shareInfo.type?(t.showPop=!1,t.getDetailInfo()):t.showPop=!0):t.$Toast(s.info)}),(function(e){t.$Loading.close(),t.$Toast("获取数据失败")}))}},created:function(){this.liveQrCode=this.$route.query.liveQrCode||"",this.liveQrCode?this.getShareInfo():(this.playId=this.$route.query.playId||"",this.getDetailInfo())}},n=(s("tAt4"),s("KHd+")),o=Object(n.a)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"share"},[s("LiveStream",{directives:[{name:"show",rawName:"v-show",value:t.showLiveStream,expression:"showLiveStream"}],ref:"LiveStream",attrs:{list:t.list},on:{backEvent:t.backEvent}}),t._v(" "),s("van-popup",{attrs:{"close-on-click-overlay":!1},model:{value:t.showPop,callback:function(e){t.showPop=e},expression:"showPop"}},[s("div",{staticClass:"subscribe-div"},[s("div",{staticClass:"top-div line_bottom"},[s("div",{staticClass:"header-img"},[s("img",{attrs:{src:t.shareInfo.liveHeadImg}})]),t._v(" "),s("div",{staticClass:"title"},[t._v(t._s(t.shareInfo.liveTitle))])]),t._v(" "),s("div",{staticClass:"content"},[t.isTimeOut?s("div",[s("div",{staticClass:"tip"},[s("span",[t._v("主播还在来的路上，可点击下方订阅按钮，我们会在主播开播后第一时间通知您~")])])]):s("div",[s("div",{staticClass:"start-time"},[t._v("直播时间："+t._s(t.shareInfo.startTime))]),t._v(" "),s("div",{staticClass:"count-down-cell"},[s("span",[t._v("距离开始还剩：")]),t._v(" "),s("Countdown",{attrs:{endTime:t.getCountdownTime},on:{timeOut:t.timeOut}})],1)]),t._v(" "),0==t.shareInfo.isSubscribe?s("div",{staticClass:"btn line_circle subscribe-btn",on:{click:t.subscribe}},[t._v("订阅")]):s("div",{staticClass:"btn line_circle cancel-btn",on:{click:t.cancelSubscribe}},[t._v("取消订阅")])])])])],1)}),[],!1,null,"58574b1d",null);e.default=o.exports},Wr4Z:function(t,e,s){"use strict";var i=s("AbvJ");s.n(i).a},afTz:function(t,e,s){"use strict";s.r(e);var i=s("nV03"),a={name:"countdown",props:["endTime","type","hiddenDay","callback"],components:{},data:function(){return{d:"0",h:"00",m:"00",s:"00",trigger:!0}},methods:{parsingTime:function(){var t=this;if(this.endTime){var e=this.$store.state.severTime.currentTime,s=this.endTime-e;this.d=0,this.h="0",this.m="0",this.s="0",s<0?this.trigger&&(this.trigger=!1,setTimeout((function(){t.$emit("timeOut")}),1e3)):(this.trigger=!0,s>59?(this.s=s%60,(s=parseInt(s/60))>59?(this.m=s%60,(s=parseInt(s/60))>23?(this.h=parseInt(s%24),s=parseInt(s/24),this.d=s):this.h=s):this.m=s):s>=0&&(this.s=s),this.h<10&&(this.h="0"+this.h),this.m<10&&(this.m="0"+this.m),this.s<10&&(this.s="0"+this.s))}}},created:function(){this.parsingTime(),i.a.heartbeat()},destroyed:function(){i.a.removeHeartbeat()},watch:{"$store.state.severTime.currentTime":function(){this.parsingTime()}}},n=(s("Wr4Z"),s("KHd+")),o=Object(n.a)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"countdown",class:{quan:"theme_bg_quan"==t.type}},[0==t.d||t.hiddenDay?t._e():s("div",{staticClass:"red-div theme_font_white",class:[t.type||"theme_bg_red"]},[t._v(t._s(t.d))]),t._v(" "),0==t.d||t.hiddenDay?t._e():s("span",[t._v("天")]),t._v(" "),s("div",{staticClass:"red-div theme_font_white",class:[t.type||"theme_bg_red"]},[t._v(t._s(t.h))]),t._v("\n  :\n  "),s("div",{staticClass:"red-div theme_font_white",class:[t.type||"theme_bg_red"]},[t._v(t._s(t.m))]),t._v("\n  :\n  "),s("div",{staticClass:"red-div theme_font_white",class:[t.type||"theme_bg_red"]},[t._v(t._s(t.s))])])}),[],!1,null,"403fc346",null);e.default=o.exports},nV03:function(t,e,s){"use strict";var i=s("ZToj"),a=void 0,n=0,o={heartbeat:function(){n++,a||(a=window.setInterval((function(){var t=parseInt((new Date).getTime()/1e3);i.a.state.severTime.currentTime=t+i.a.state.severTime.jetlag}),1e3))},removeHeartbeat:function(){n>0&&n--,0==n&&(window.clearInterval(a),a=null)}};e.a=o},tAt4:function(t,e,s){"use strict";var i=s("GRpt");s.n(i).a}}]);