(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-76bd7720"],{1148:function(t,e,i){"use strict";var a=i("a691"),n=i("1d80");t.exports=function(t){var e=String(n(this)),i="",s=a(t);if(s<0||s==1/0)throw RangeError("Wrong number of repetitions");for(;s>0;(s>>>=1)&&(e+=e))1&s&&(i+=e);return i}},"1a53":function(t,e,i){"use strict";i("7830")},"408a":function(t,e,i){var a=i("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=a(t))throw TypeError("Incorrect invocation");return+t}},"6c4f":function(t,e,i){"use strict";i("efb3")},7830:function(t,e,i){},b680:function(t,e,i){"use strict";var a=i("23e7"),n=i("a691"),s=i("408a"),r=i("1148"),o=i("d039"),c=1..toFixed,l=Math.floor,u=function(t,e,i){return 0===e?i:e%2===1?u(t,e-1,i*t):u(t*t,e/2,i)},d=function(t){var e=0,i=t;while(i>=4096)e+=12,i/=4096;while(i>=2)e+=1,i/=2;return e},p=function(t,e,i){var a=-1,n=i;while(++a<6)n+=e*t[a],t[a]=n%1e7,n=l(n/1e7)},h=function(t,e){var i=6,a=0;while(--i>=0)a+=t[i],t[i]=l(a/e),a=a%e*1e7},g=function(t){var e=6,i="";while(--e>=0)if(""!==i||0===e||0!==t[e]){var a=String(t[e]);i=""===i?a:i+r.call("0",7-a.length)+a}return i},f=c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!o((function(){c.call({})}));a({target:"Number",proto:!0,forced:f},{toFixed:function(t){var e,i,a,o,c=s(this),l=n(t),f=[0,0,0,0,0,0],m="",v="0";if(l<0||l>20)throw RangeError("Incorrect fraction digits");if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(m="-",c=-c),c>1e-21)if(e=d(c*u(2,69,1))-69,i=e<0?c*u(2,-e,1):c/u(2,e,1),i*=4503599627370496,e=52-e,e>0){p(f,0,i),a=l;while(a>=7)p(f,1e7,0),a-=7;p(f,u(10,a,1),0),a=e-1;while(a>=23)h(f,1<<23),a-=23;h(f,1<<a),p(f,1,1),h(f,2),v=g(f)}else p(f,0,i),p(f,1<<-e,0),v=g(f)+r.call("0",l);return l>0?(o=v.length,v=m+(o<=l?"0."+r.call("0",l-o)+v:v.slice(0,o-l)+"."+v.slice(o-l))):v=m+v,v}})},c4d2:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("nav-top",{on:{backEvent:function(e){return t.$router.go(-1)}}}),i("nav-content",{staticClass:"navclass"},[i("div",{staticClass:"banner"},[i("img",{attrs:{src:t.donateItem.projectPic}})]),i("div",{staticClass:"curr-root"},[i("van-progress",{staticClass:"progress",attrs:{"track-color":"#DCDDDD",color:"#F02C2D","stroke-width":"5px",percentage:t.donatePercent>100?100:t.donatePercent,"show-pivot":!1}}),i("div",{staticClass:"donate-current"},[i("div",{staticClass:"intent"},[i("div",{staticClass:"intent-curr"},[t._v(t._s(t.donateItem.curDonationUnit))]),i("div",{staticClass:"intent-plan"},[t._v("目标 "+t._s(t.donateItem.projectExpect))])]),i("div",[i("div",{staticClass:"intent-curr"},[t._v(t._s(""==t.donateItem.curDonationCnt?"0":t.donateItem.curDonationCnt))]),i("div",{staticClass:"intent-plan"},[t._v("爱心 (份)")])]),i("div",[i("div",{staticClass:"intent-curr"},[t._v(t._s(t.donatePercent)+"%")]),i("div",{staticClass:"intent-plan"},[t._v("捐赠进度")])])])],1),i("div",{staticClass:"item-name"},[i("div",{staticClass:"item-title"},[t._v(t._s(t.donateItem.projectName))]),i("div",{staticClass:"item-des"},[t._v(t._s(t.donateItem.projectIntro))])]),i("div",{staticClass:"item-read"},[i("div",{staticClass:"item-read-title"},[t._v("项目说明")]),i("div",{staticClass:"item-detail",domProps:{innerHTML:t._s(t.donateItem.projectDesc)}})]),i("div",{staticClass:"emtpy"}),i("div",{staticClass:"donate-btn",on:{click:t.toDonate}},[t._v("我要捐助")]),i("van-popup",{staticClass:"popup",attrs:{position:"bottom"},model:{value:t.showInputPop,callback:function(e){t.showInputPop=e},expression:"showInputPop"}},[t.showInputPop?i("div",[i("donate-input",{attrs:{integrations_p:t.integrations,currentIntegrate_p:t.currentIntegrate,integralList_p:t.integralList,myintegralList_p:t.myintegralList,remark_p:t.remark},on:{agreeToDonateDo:function(e){return t.agreeToDonateDo(e)}}})],1):t._e()])],1)],1)},n=[],s=(i("4160"),i("159b"),i("e25e"),i("ac1f"),i("5319"),i("acd8"),i("b680"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"donate-input-root"},[i("div",{staticClass:"input-title"},[t._v("我要捐助")]),i("div",{staticClass:"account-curr"},[t._v("账户剩余积分 "+t._s(""==t.integralList?"0":t.integralList))]),i("div",{staticClass:"selects"},t._l(t.integrations,(function(e){return i("div",{key:e.value,staticClass:"integrate-area"},[i("div",{staticClass:"integrate-unselect single-line",class:{integrateSelect:e.selected},on:{click:function(i){return t.selectIntegrate(e)}}},[t._v(t._s(e.value))])])})),0),i("div",{staticClass:"input-line"},[i("van-field",{attrs:{type:"number",placeholder:"自定义捐赠分数"},on:{focus:t.focusEdit},model:{value:t.myintegralList,callback:function(e){t.myintegralList=e},expression:"myintegralList"}})],1),i("div",{staticClass:"textarea-line"},[i("van-field",{attrs:{type:"textarea",placeholder:"为你的爱心留个言吧~"},model:{value:t.remark,callback:function(e){t.remark=e},expression:"remark"}})],1),i("div",{staticClass:"read-agreement"},[t._v(" 查看 "),i("span",{staticClass:"agreenment",on:{click:t.readAgreement}},[t._v("《捐赠协议》")])]),i("div",{staticClass:"donate-btn",on:{click:t.agreeToDonate}},[t._v("同意协议并捐赠")])])}),r=[],o={name:"donate-input",props:["integrations_p","currentIntegrate_p","integralList_p","myintegralList_p","remark_p"],data:function(){return{integrations:[],currentIntegrate:"",integralList:"",myintegralList:"",remark:""}},watch:{integrations_p:{handler:function(t,e){this.integrations=this.integrations_p,this.$forceUpdate()},deep:!0,immediate:!1}},methods:{selectIntegrate:function(t){t.selected=!t.selected,this.integrations.forEach((function(e){e.type!=t.type&&(e.selected=!1)})),this.currentIntegrate=t},agreeToDonate:function(){var t={currentIntegrate:this.currentIntegrate,integralList:this.integralList,myintegralList:this.myintegralList,remark:this.remark};this.$emit("agreeToDonateDo",t)},readAgreement:function(){this.$router.push({path:"/usercenter/agreement",query:{value:18}})},focusEdit:function(){this.currentIntegrate="",this.integrations.forEach((function(t){t.selected=!1}))}},mounted:function(){this.integrations=this.integrations_p,this.currentIntegrate=this.currentIntegrate_p,this.integralList=this.integralList_p,this.myintegralList=this.myintegralList_p,this.remark=this.remark_p}},c=o,l=(i("6c4f"),i("0c7c")),u=Object(l["a"])(c,s,r,!1,null,"18d14528",null),d=u.exports,p=i("efff"),h=i("19e7"),g={components:{donateInput:d},data:function(){return{showInputPop:!1,donateItem:"",donatePercent:0,integrations:[{type:0,value:10,selected:!1},{type:1,value:50,selected:!1},{type:2,value:100,selected:!1},{type:3,value:1e3,selected:!1}],currentIntegrate:"0",integralList:"",myintegralList:"",payDigitals:[],isNeedPayPwd:!1,digitalPWD:"",currObjData:"",remark:""}},methods:{toDonate:function(){this.myintegralList="",this.integrations.forEach((function(t){t.selected=!1})),this.showInputPop=!0},getAccountBaseInfo:function(){var t=this,e={acctType:3};this.$http.post("/app/json/acct/getAccountBaseInfo",e).then((function(e){var i=e.data;0==i.status?t.integralList=i.data.balanceUnit:t.$Toast("获取当前积分失败")}))["catch"]((function(e){t.$Toast(e)}))},agreeToDonateDo:function(t){if(this.currentIntegrate=t.currentIntegrate,this.integralList=t.currentIntegrate,this.myintegralList=t.myintegralList,this.remark=t.remark,""!=this.myintegralList||""!=this.currentIntegrate){if(""!=this.myintegralList){if(parseInt(this.myintegralList)>=parseInt(this.integralList))return void this.$Toast("捐赠的积分不能超过当前剩余积分")}else if(parseInt(this.currentIntegrate.value)>=parseInt(this.integralList))return void this.$Toast("捐赠的积分不能超过当前剩余积分");this.settleAccounts()}else this.$Toast("捐赠积分不能为空")},settleAccounts:function(){var t=this,e="/app/json/shopping_donate/settle",i={projectId:this.donateItem.id,payDigital:[]};""==this.currentIntegrate||0==this.currentIntegrate?i.donateValue=this.myintegralList:i.donateValue=this.currentIntegrate.value,this.$Loading.open(),this.$http.post(e,i).then((function(e){if(t.$Loading.close(),0==e.data.status){var i=e.data.data.digitalList;t.currObjData=e.data.data,i&&i.length>0&&(i.forEach((function(e){if(3==e.acctTypeCode){var i=e;t.payDigital=[],i.payDigital,i.fixedDigital,t.payDigitals.push({acctType:i.acctType,userBalanceDigital:i.userBalanceDigital,payDigital:i.userCanUseDigital+i.fixedDigital})}})),t.isNeedPayPwd=e.data.data.needPayPwd,t.toXiaDan(t.isNeedPayPwd))}else t.$Toast(e.data.info)}))["catch"]((function(e){t.$Loading.close()}))},toXiaDan:function(t){t?this.checkNeedPwd(t):this.submitOrder()},submitOrder:function(){var t=this,e="/app/json/shopping_donate/submit",i={projectId:this.donateItem.id,payDigital:this.payDigitals,remark:this.remark};""==this.currentIntegrate||0==this.currentIntegrate?i.donateValue=this.myintegralList:i.donateValue=this.currentIntegrate.value,this.$Loading.open(),this.digitalPWD&&this.digitalPWD.length>0&&(i.payPwd=Object(h["a"])(this.digitalPWD)),this.$http.post(e,i).then((function(e){t.$Loading.close();var i=e.data,a=i.status,n=i.info;i.data;0==a?(t.$router.replace({path:"/donate-result",query:{donateItem:t.donateItem}}),t.$keepaliveHelper.deleteCache(t)):t.$Toast(n),t.showInputPop=!1}))["catch"]((function(e){t.$Loading.close(),t.showInputPop=!1}))},checkNeedPwd:function(t){var e=this;if(this.digitalPWD="",t){var i=!0;if(i){if("1"==this.currObjData.payPwdState)return void this.$Toast("支付密码已锁定，请稍后再试！");p["a"].open({initData:{payPwdState:this.currObjData.payPwdState},toSettingPwd:function(){e.$router.push({path:"/usercenter/nosetpwd",query:{isSet:0}}),p["a"].close()},inputFinished:function(t){e.digitalPWD=t,e.submitOrder(),p["a"].close()}})}else this.submitOrder()}else this.submitOrder()}},created:function(){this.getAccountBaseInfo(),this.donateItem=this.$route.query.donateItem,this.donateItem.curDonationUnit=""==this.donateItem.curDonationUnit?"0":this.donateItem.curDonationUnit,this.donateItem.projectDesc=this.$util.replaceH5Img(this.donateItem.projectDesc),this.donatePercent=parseFloat(this.donateItem.curDonationUnit)/parseFloat(this.donateItem.projectExpect)*100,this.donatePercent=this.donatePercent.toFixed(2)},beforeRouteLeave:function(t,e,i){"/donate-home"==t.path&&this.$keepaliveHelper.deleteCache(this),i()}},f=g,m=(i("1a53"),Object(l["a"])(f,a,n,!1,null,"49f8d9ba",null));e["default"]=m.exports},efb3:function(t,e,i){}}]);