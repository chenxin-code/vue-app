(window.webpackJsonp=window.webpackJsonp||[]).push([[158],{"3c8u":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAB+UExURUdwTP8AGP8AGP8AF/8AGP8AGP8AD/8AF/8AAP8AGP8AF/8AD/8AGP8AFv8AFf8AF/8AGP8AF/8AF/8AFf8AFf8AF/8AF/8AGP8AF/8AAP8AE/8AF/8AF/8AGP8AF/8AF/8AFf8AFv8AF/8AFv8AGP8AF/8AF/8AFv8AF/8AGck/cRcAAAApdFJOUwDb44Tv/RHpAvjJC/U3H5O9xJgpPNRasWoGGap1z4q3MXqhb6ZMjkNkFOKsMQAAAXtJREFUeNq9lMmWgyAQRQsUEeM8BoeYOan//8FuoJOTXoBsuu9CN9dnneId4C+p6HSJfGX8hnV1L/1kQ1odsk05WDm+IIfdpt8WVYqGsPYYR/ZnbnT6AA+O2ZkpW8zgRb7X8dfYTz8Nyk5G8GPVg7e+o4Rq60nhl94QVIjaqwW7CjVp4aMHiC99t73yEN/6ftPO0rfNGr85DBO4kQw/2Iie8JPV6V7wN7nDjcLfLnetL2C8uXXJlfhM0XEJcCQAgwmWDrfFQHWVxZChpncdCM4A8MQIINHy4qoR3tWL5wA9alzlpoOWRwBJN8+w6rQcqclNPRyLPqc6X69caPtgl/eoQolUz1rLof1YGrypZNX7+IAae6ljQR+nYYmhHSgaCFgh5t8hQ2SlsW+uq8NAgzzWX/LaKhd4nydMgjY2fSXJwo42uceHXEr5uhcSIqjobHKOc0kj6AfTWM5R0ApspIjrcxD1zyZDes0cjUZFOYKmCEZwMAu23DP4N74ARew6Pl+JUOQAAAAASUVORK5CYII="},"5jYd":function(t,e,s){"use strict";s.r(e);var o=s("Ziuy"),a=(s("W34l"),s("ZGFV")),i=s("db0i"),n=s("7//l"),r=s("Gedb"),l=s("Pee1"),u=s("VGP3"),c={mixins:[l.a],data:function(){return{settleInfo:null,isMutex:!1,digitalList:[],showModal:!1,usedCoupons:[],supportCompany:!1,showQyPay:!1,showQyModal:!1,showKeyboard:!1,couponList:[],tankOilName:"",oilName:"",selectedPayWay:null,payWay:[],payDigitals:[],digitalPWD:"",referrer:"",canEditReferrer:!0,mutexChecked:!1,promote_is_mutex:!1,activityId:"",activity:null,backReloadCoupon:!1,hasToPay:!1,sumPay:0,clusterIds:"",enjoyCardType:null,item2:{},item1:{},ruleFlag:!1,showCluDom:"",qyAmount:0,qyDialog:!0,showPopup:!1,orderCategory:0,qyPayAmount:0,source:"",payData:{},qySettleInfo:{},qyDigitalList:[],qyPayDigital:[],qyUsedCoupons:[],qyPayValue:""}},components:{Coupon:o.a,PayMode:u.a},computed:{digitalListFinal:function(){return this.isMutex&&this.mutexChecked?this.digitalList:this.settleInfo?this.settleInfo.digitalList:[]},recommendDisabled:function(){return 1!=this.$store.state.globalConfig.recommendRefuelDisabled},showClu:function(){var t=!0,e=void 0;Array.isArray(this.clusterIds)?e=this.clusterIds:(console.log(this.clusterIds,"cluds"),e=this.clusterIds?this.clusterIds.split(","):"");var s=this.$store.state.globalConfig.onlinecar_hailingprotocol,o=this.$store.state.globalConfig.occupation_group_id;return e.includes(o)&&0!=s&&0===this.settleInfo.discountAmount||(t=!1),t},isScan:function(){return!!this.$route.query.comeFromPage},settleAmount:function(){if(this.settleInfo)return this.settleInfo.payAmount?this.settleInfo.payAmount.toFixed(2):0},settleQyAmount:function(){return this.qyPayAmount?this.qyPayAmount.toFixed(2):0}},created:function(){var t=this;this.initPage=!1,this.$store.state.globalConfig.rfrCodeType&&this.$store.state.rfrCodeMap&&(this.referrer=this.$store.state.rfrCodeMap[this.$store.state.globalConfig.rfrCodeType]),this.canEditReferrer=1==this.$store.state.globalConfig.appCanEditReferrer||!this.referrer,this.$http.post("/app/json/news/getNewsList?values=73").then((function(e){var s=e.data;0==s.status?s.data[0]&&(t.showCluDom=s.data[0].content):t.$toast(e.info)})),1==this.$store.state.globalConfig.wx_discount_card_display&&this.collectCard()},mounted:function(){var t=this;if(this.$userCenter._getUserBehalf((function(e){t.clusterIds=e.clusterIds||""})),this.source=this.$route.query.source,this.gunNo=this.$route.query.gunNo,this.ouCode=this.$route.query.ouCode,this.uniCode=this.$route.query.uniCode,this.recordId=this.$route.query.recordId,this.tankOilName=this.$route.query.tankOilName,this.oilName=this.$route.query.oilName,this.isMutex="false"!=this.$store.state.globalConfig.order_refuel_virtual_pay_is_mutex,this.promote_is_mutex="false"!=this.$store.state.globalConfig.order_refuel_promote_virtual_pay_is_mutex,this.settlement(),this.isMutex&&this.settlement(1),this.orderType="100005",this.$route.query.comeFromPage&&(this.orderType="100002"),"offline"==this.source&&(this.orderType="200001010"),2==this.$store.state.webtype){var e=sessionStorage.getItem("recommendPhone");e&&e.length&&(this.referrer=e,this.canEditReferrer=!1)}},methods:{checkCouponPrice:function(t){this.settleInfo.cashCouponFaceValue>this.settleInfo.cashCouponAmount?this.$MessageBox.confirm("您的优惠券金额比订单金额大，确定使用吗？","提示",{confirmButtonText:"确定"}).then((function(e){t()})).catch((function(t){})):t()},unDone:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(t||0)-(e||0)},openActive:function(){this.activityId=-1==this.activityId?"":-1,this.orderCategory=0,this.settlement()},collectCard:function(){var t=this,e={token:this.$store.state.login.token,orderType:100005};this.$http.post("/app/json/wx_discount_card/getOrderEndDisplay",e).then((function(e){console.log(e,"res");var s=e.data;0==s.status&&(s.data.item1?(t.enjoyCardType=1,t.item1=s.data.item1||{}):Array.isArray(s.data.item2)&&s.data.item2.length&&(t.enjoyCardType=2,t.item2=s.data.item2[0]||{}))}))},getCard:function(){var t=this,e={discountCardId:this.item2.id};this.$http.post("/system/json/wx_discount_card/applyDiscountCard",e).then((function(e){var s=e.data;0==s.status?s.data&&s.data.prepare_card_token?wx.navigateToMiniProgram({appId:"wxcc2e4fbc5887661e",path:"/pages/get-card/get-card?prepare_card_token="+s.data.prepare_card_token}):t.$toast("未获取到先享卡分享地址token"):t.$toast(s.info)}))},changeQyPay:function(){this.settlement()},inputPhone:function(t){var e=this;this.$nextTick((function(){11==e.qyPayValue.length&&(e.showKeyboard=!1)}))},qyPayOrder:function(){if(!this.$util.checkMobile(this.qyPayValue))return this.$toast("请输入正确的手机号码"),void(this.qyPayValue="");this.showQyModal=!1,this.showPopup=!0},toggle:function(t){var e=this;this.qyAmount<this.settleInfo.payAmount?this.$toast("企业余额不足，请选择其他支付方式"):(this.$refs.checkboxes.toggle(),this.$nextTick((function(){e.$refs.payModeRef.init(e.orderType,e.ouCode)})))},settleMobelAmount:function(t,e){return(t||0)+(e||0)},confirmPay:function(){if(this.supportCompany)this.showPopup=!0;else{if(!this.selectedPayWay)return void this.$Toast("请选择支付方式！");this.showModal=!0}},sumAmount:function(t){var e=0;return Array.isArray(t)&&t.length&&t[0].sumOilLiter&&(e=Math.round(t[0].sumOilLiter)),e},backEvent:function(){this.$router.go(-1)},settlement:function(t){var e=this;this.$Loading.open();var s="/app/json/refuel_center/settle",o={};this.$route.query.comeFromPage?(s="/app/json/refuel_scan_code/settle",o={token:this.$store.state.login.token,tankOilNo:this.$route.query.tankOilNo,amount:this.$route.query.amount,kshopOrgid:this.$route.query.kshopOrgid||"",kshopGasoilno:this.$route.query.kshopGasoilno||"",rfrCode:this.$route.query.rfrCode||""}):o={token:this.$store.state.login.token,ouCode:this.ouCode,uniCode:this.uniCode,recordId:this.recordId,gunNo:this.gunNo},o.orderCategory=this.orderCategory,1==t?(o.payDigital=[{acctType:"Points",payDigital:0},{acctType:"Rewards",payDigital:0},{acctType:"EmpRewards",payDigital:0},{acctType:"LimitWallet",payDigital:0},{acctType:"Enterprise",payDigital:0},{acctType:"Elec",payDigital:0}],o.couNo=["-1"],o.activityId=-1):2==t?(o.payDigital=this.qyPayDigital,this.qyUsedCoupons.length?o.couNo=this.qyUsedCoupons:o.couNo=["-1"],o.activityId=-1):(-1==this.activityId?o.activityId=-1:""==this.activityId&&this.activity&&1==this.activity.isMeetCondition&&this.promote_is_mutex&&(this.usedCoupons=[],this.payDigitals=[]),this.usedCoupons.length&&!this.usedCoupons.includes("-1")&&this.isMutex&&(this.payDigitals=[]),o.payDigital=this.payDigitals,o.couNo=this.usedCoupons),this.$http.post(s,o).then((function(s){var o=s.data;if(0==o.status){if(1==t)e.digitalList=o.data.digitalList;else if(2==t)e.qySettleInfo=o.data,e.qyDigitalList=o.data.digitalList,e.qySettleInfo.couNo&&e.qySettleInfo.couNo.length&&(e.qyUsedCoupons=e.qySettleInfo.couNo);else{if(e.settleInfo=o.data,e.occurOuCode=o.data.ouCode,e.showQyPay=o.data.supportCompany,e.settleInfo.couNo&&e.settleInfo.couNo.length&&(e.usedCoupons=e.settleInfo.couNo),!e.initPage){e.initPage=!0,e.activity=o.data.activity&&o.data.activity[0];var a=o.data.digitalList||[],i=!0,n=!1,r=void 0;try{for(var l,u=a[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var c=l.value;if(c.payDigital>c.fixedDigital){e.payDigitals.push(c);break}}}catch(t){n=!0,r=t}finally{try{!i&&u.return&&u.return()}finally{if(n)throw r}}}o.data.activity&&o.data.activity.length&&e.promote_is_mutex,e.mutexChecked=!(!e.usedCoupons.length||e.usedCoupons.includes("-1")),e.selectedPayWay||(e.$route.query.comeFromPage?e.occurOuCode:e.ouCode,e.$nextTick((function(){e.$refs.payModeRef.init(e.orderType,e.ouCode)})))}o.data.supportCompany&&0==e.sumPay&&o.data.digitalList.length&&(e.sumPay=1,e.orderCategory=3,e.settlement(2)),o.data.supportCompany&&o.data.digitalList.length&&2==t&&(o.data.digitalList.forEach((function(t){"Enterprise"==t.acctType&&(e.qyAmount=t.userBalanceDigital,e.qyPayAmount=t.userCanUseDigital,e.qyPayDigital=[{acctType:t.acctType,payDigital:t.userCanUseDigital}])})),!e.qyAmount||e.qyAmount<e.qyPayAmount||o.data.payAmount?(e.orderCategory=0,e.supportCompany=!1):(e.supportCompany=!0,e.$nextTick((function(){e.$refs.payModeRef.init(e.orderType,e.ouCode)}))))}else e.$Toast(o.info);e.$Loading.close(),e.reloadSelectedCoupon()}))},submitBill:function(){var t=this;this.showPopup=!1,this.showQyModal=!1,this.$Loading.open();var e="/app/json/refuel_center/submit",s={};this.$route.query.comeFromPage?(e="/app/json/refuel_scan_code/submit",s={token:this.$store.state.login.token,tankOilNo:this.$route.query.tankOilNo,amount:this.$route.query.amount}):(s.token=this.$store.state.login.token,s.ouCode=this.ouCode,s.uniCode=this.uniCode,s.recordId=this.recordId,s.activityId=this.activityId,s.gunNo=this.gunNo,this.referrer&&this.referrer.length&&(s.rfrCode=this.referrer,this.referrer==this.scanCode?s.rfrCodeType=2:s.rfrCodeType=1)),this.showQyPay&&this.supportCompany?(s.orderCategory=3,s.empPhone=this.qyPayValue):s.orderCategory=0,s.kshopOrgid=this.$route.query.kshopOrgid||"",s.kshopGasoilno=this.$route.query.kshopGasoilno||"",this.$route.query.rfrCode&&(s.rfrCode=this.$route.query.rfrCode),s.couNo=this.usedCoupons.includes("-1")?[]:this.usedCoupons,this.supportCompany&&(s.couNo=this.qyUsedCoupons.includes("-1")?[]:this.qyUsedCoupons),s.activityId=this.activityId,s.orderScene=i.a.queryOrderScene(),this.payDigitals.length&&(s.payDigital=this.payDigitals),this.showQyPay&&this.supportCompany&&(s.payDigital=this.qyPayDigital),""!=this.digitalPWD&&(s.payPwd=Object(r.a)(this.digitalPWD)),this.$http.post(e,s).then((function(e){t.$Loading.close(),console.log(e.data,"第一步res.data");var s=e.data;0==s.status?(t.hasToPay=!0,t.payTime=(new Date).getTime(),t.payData=s.data||{},t.payBill(s.data)):t.$Toast(s.info||"提交订单失败！")}),(function(e){t.$Loading.close(),t.$Toast("请求数据失败！")}))},payBill:function(t){var e=this;if(console.log(t,"098"),0!=t.payAmount){var s=this.$route.query.comeFromPage?"refuelScanPayEvent":"refuelPayEvent";i.a[s](this.selectedPayWay,t.orderType,t.orderId).then((function(){e.resultHand("1",t)}),(function(){e.resultHand("0",t)}))}else this.resultHand("1",t)},resultHand:function(t,e){var s=this;if(this.$Loading.close(),console.log("加油支付结果",t),console.log("comeFromPage",this.$route.query.comeFromPage),a.a.addLog("支付结果",t?"成功":"失败"),"1"==t)try{this.$router.replace({path:this.isScan?"/firmScanDetail":"/firmDetail",query:{orderType:e.orderType,orderId:e.orderId,fromPage:1,source:this.source}})}catch(t){console.log(t)}else{var o="/app/json/refuel_center/cancelOrder";this.$route.query.comeFromPage&&(o="/app/json/refuel_scan_code/cancelOrder");var i={token:this.$store.state.login.token,orderType:e.orderType,orderId:e.orderId};this.$http.post(o,i).then((function(t){var e=t.data;0==e.status?s.$Toast("支付已取消"):s.$Toast(e.info)}))}},reloadSelectedCoupon:function(){if(0!=this.backReloadCoupon){this.backReloadCoupon=!1;for(var t=this.showPopup?this.qySettleInfo:this.settleInfo,e=this.showPopup?this.qyUsedCoupons:this.usedCoupons,s=0;s<t.userCanUseCoupon.length;s++){var a=t.userCanUseCoupon[s].couNo;t.userCanUseCoupon[s].selected=!1;for(var i=0;i<e.length;i++)e[i]==a&&(t.userCanUseCoupon[s].selected=!0)}o.a.reloadSelectedCoupon(t.userCanUseCoupon,[],t.userCanUseWhenNotSelectCoupon)}},chooseCoupon:function(){for(var t=this,e=this.showPopup?this.qySettleInfo:this.settleInfo,s=this.showPopup?this.qyUsedCoupons:this.usedCoupons,a=0;a<e.userCanUseCoupon.length;a++){var i=e.userCanUseCoupon[a].couNo;e.userCanUseCoupon[a].selected=!1;for(var n=0;n<s.length;n++)s[n]==i&&(e.userCanUseCoupon[a].selected=!0)}o.a.open({initData:{listData:[],userCanNotUseCoupon:e.userCanNotUseCoupon,userCanUseCoupon:e.userCanUseCoupon,userCanUseWhenNotSelectCoupon:e.userCanUseWhenNotSelectCoupon,type:"use",skuId:"",categoryId:"",storeOuCode:"",token:this.$store.state.login.token,payAmount:this.$util.toDecimal2(parseFloat(e.amount))},selectedCoupon:function(e){for(var s=[],o=0;o<e.length;o++)s.unshift(e[o].couNo);0==s.length&&s.push("-1"),t.showPopup?t.qyUsedCoupons=s:t.usedCoupons=s,t.backReloadCoupon=!0,t.showPopup?(t.orderCategory=3,t.settlement(2)):(t.orderCategory=0,t.settlement(3))}})},setHour:function(t){return t?this.$util.formatDate(new Date(t),"yyyy-MM-dd hh:mm"):""},setPayWays:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1],Array.isArray(t)?this.selectedPayWay=null:(this.selectedPayWay=t,this.supportCompany=!1)},getDigitalDisplayName:function(t){return this.$mallCommon.accTypeToName(t,"100")},getDigitalDisplayUnit:function(t){for(var e=this.$store.state.globalConfig.acctList,s=0;s<e.length;s++){var o=e[s];if(o.acctType==t)return o.displayUnit}},getCanNotUseStr:function(t){return 1==t||3==t?"余额不足":1==t?"订单金额不够":"未知原因"},useDigitalEvent:function(t){if(t.userCanUseDigital<=0){var e=this.getCanNotUseStr(t.deductionState);this.$Toast(e+"，不支持"+this.getDigitalDisplayName(t.acctType)+"支付！")}else this.setDigitalList(t),this.payDigitals.length&&this.isMutex&&(this.usedCoupons=["-1"]),this.settlement()},setDigitalList:function(t){var e=t.acctType,s=t.payDigital<=t.fixedDigital?t.userCanUseDigital+t.fixedDigital:t.fixedDigital||0,o=!1;this.payDigitals=this.payDigitals.map((function(t){return t.acctType===e&&(t.payDigital=s,o=!0),t})),o||this.payDigitals.push({acctType:e,payDigital:s}),console.log("虚拟支付结果： ",this.payDigitals)},checkNeedPwd:function(){var t=this;if(this.digitalPWD="",this.settleInfo.needPayPwd){if("1"==this.settleInfo.payPwdState)return void this.$Toast("支付密码已锁定，请稍后再试！");n.a.open({initData:{payPwdState:this.settleInfo.payPwdState},toSettingPwd:function(){t.$router.push({path:"/usercenter/nosetpwd",query:{isSet:0}}),n.a.close()},inputFinished:function(e){t.digitalPWD=e,t.submitBill(),n.a.close()}})}else this.submitBill()},queryWechatUserState:function(){var t=this;return new Promise((function(e,s){var o={occurOuCode:t.ouCode,orderType:t.orderType,openid:t.$store.state.login.thirdUserId};t.$request.post("/app/json/app_pay/queryWechatUserState",o).then((function(o){0===o.status?0==o.data.returnCode?o.data.path?e(o.data.path):t.$Toast(o.data.returnmsg):s(o.data.info):t.$Toast(o.info)}))}))},payScene:function(){var t=this;this.selectedPayWay&&"210009"==this.selectedPayWay.payModeSub?(this.$Loading.open(),this.queryWechatUserState().then((function(e){t.$Loading.close(),t.payFn()}),(function(e){t.$Loading.close(),wx.miniProgram.navigateTo({url:"/pages/signPay/main?signInfo="+encodeURIComponent(e)})}))):this.payFn()},submitSel:function(){this.showQyPay&&this.supportCompany?(this.showModal=!1,this.showPopup=!0):this.showModal=!0},submitOrder:function(){var t=this;if(this.payData&&Object.keys(this.payData).length>0)this.payBill(this.payData);else{var e=this.supportCompany?this.qySettleInfo:this.settleInfo;e.cashCouponFaceValue>e.cashCouponAmount?this.$MessageBox.confirm(this.$store.state.globalConfig.appCouponPayTip||"您的优惠券金额比订单金额大，确定使用吗？","提示",{confirmButtonText:"确定"}).then((function(e){t.payScene()})).catch((function(t){})):this.payScene()}},payFn:function(){for(var t=0;t<this.payDigitals.length;t++){var e=this.payDigitals[t];if(e.payDigital>0&&e.payDigital>e.userBalanceDigital){var s=this.getDigitalDisplayName(e.acctType);return s+="余额不足！",this.$Toast(s),void this.settlement()}}this.checkNeedPwd()},scanCodeFunc:function(){var t=this;this.$bridgefunc.scanCode((function(e){var s=e.code;s.indexOf("http")>-1&&(s=t.$util.getUrlParam(s,"qrCode")),t.scanCode=s,t.referrer=s}))}},filters:{state:function(t){console.log(t,"val");var e="";switch(t){case"ONGOING":e="约定进行中";break;case"CHECKING":e="到期核对中";break;case"FINISHED":e="已完成约定";break;case"UNFINISHED":e="未完成约定"}return e}}},p=(s("R5IT"),s("KHd+")),d=Object(p.a)(c,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"firmorder"},[o("nav-top",{attrs:{title:"确认账单"},on:{backEvent:function(e){return t.$router.go(-1)}}}),t._v(" "),o("nav-content",[t.settleInfo?o("div",{staticClass:"firm"},[o("div",{staticClass:"firm-one"},[o("p",[o("img",{attrs:{src:s("NQte"),alt:""}}),t._v(" "),o("span",[t._v(t._s(t.oilName))])]),t._v(" "),t.$route.query.comeFromPage?t._e():o("p",[o("img",{attrs:{src:s("3c8u"),alt:""}}),t._v(" "),o("span",[t._v(t._s(t.settleInfo.refuelGunNo)+"号油枪")])]),t._v(" "),o("p",[o("img",{attrs:{src:s("PbvB"),alt:""}}),t._v(" "),o("span",[t._v(t._s(t.tankOilName))])])]),t._v(" "),o("div",{staticClass:"firm-two"},[t.$route.query.comeFromPage?t._e():o("p",[o("span",[t._v("TTC")]),t._v(" "),o("span",[t._v(t._s(t.$route.query.posTtc))])]),t._v(" "),t.$route.query.comeFromPage?t._e():o("p",[o("span",[t._v("加油时间")]),t._v(" "),o("span",[t._v(t._s(t.settleInfo.refuelTakeDate))])]),t._v(" "),t.$route.query.comeFromPage?t._e():o("p",[o("span",[t._v("加油升数")]),t._v(" "),o("span",[t._v(t._s(t.settleInfo.refuelLiter)+"L")])])]),t._v(" "),o("div",{staticClass:"firm-two"},[o("p",[o("span",[t._v("加油金额")]),t._v(" "),t.$route.query.comeFromPage?o("span",[t._v("￥"+t._s(t.$route.query.amount))]):o("span",[t._v("￥"+t._s(t.settleInfo.amount&&t.settleInfo.amount.toFixed(2)))])]),t._v(" "),t.source?t._e():o("p",{staticClass:"coupon-item",on:{click:t.chooseCoupon}},[t.settleInfo?[o("span",[t._v("加油券")]),t._v(" "),0!=t.settleInfo.couponAmount?o("span",[t._v("￥"+t._s(t.settleInfo.couponAmount||0))]):t._e(),t._v(" "),0==t.settleInfo.couponAmount&&0!=t.settleInfo.userCanUseCoupon.length?o("span",[t._v("有可用券")]):t._e(),t._v(" "),0==t.settleInfo.couponAmount&&0==t.settleInfo.userCanUseCoupon.length?o("span",[t._v("无可用券")]):t._e(),t._v(" "),o("i",{staticClass:"iconfont mall-gengduo more-icon theme_font_tint"})]:t._e()],2),t._v(" "),t.settleMobelAmount(t.settleInfo.thirdDiscountAmount,t.settleInfo.thirdDiscountAmount2)?o("p",[o("span",[t._v("移动优惠金额")]),t._v(" "),o("span",[t._v("￥"+t._s(t.settleMobelAmount(t.settleInfo.thirdDiscountAmount,t.settleInfo.thirdDiscountAmount2)))])]):t._e(),t._v(" "),t._l(t.digitalListFinal,(function(e,s){return o("div",{key:s},[0!=e.deductionState&&"Enterprise"!==e.acctType?o("div",{staticClass:"flex-row"},[o("div",{staticClass:"label-middle theme_font_common inline_block"},[t._v(t._s(t.getDigitalDisplayName(e.acctType)))]),t._v(" "),"元"==t.getDigitalDisplayUnit(e.acctType)?[e.userCanUseDigital>0?o("div",{staticClass:"right-margin inline_block"},[t._v("\n                余额："+t._s(e.userBalanceDigital)+"元，可用"+t._s(e.userCanUseDigital)+"元\n              ")]):o("div",{staticClass:"right-margin inline_block"},[t._v("\n                余额："+t._s(e.userBalanceDigital)+"元，"+t._s(t.getCanNotUseStr(e.deductionState))+"，不能使用\n              ")])]:[e.userCanUseDigital>0?o("div",{staticClass:"right-margin inline_block"},[e.userBalanceDigital<1e4?o("span",[t._v("共"+t._s(e.userBalanceDigital)+"个，")]):t._e(),t._v("\n                可用"+t._s(e.userCanUseDigital)+"个，抵￥"+t._s(t.$util.toDecimal2(e.userCanUseDigitalAmount))+"元\n              ")]):o("div",{staticClass:"right-margin inline_block"},[e.userBalanceDigital<1e4?o("span",[t._v("共"+t._s(e.userBalanceDigital)+"个，")]):t._e(),t._v("\n                "+t._s(t.getCanNotUseStr(e.deductionState))+"，不能使用\n              ")])],t._v(" "),o("div",{staticClass:"swith inline_block",on:{click:function(s){return t.useDigitalEvent(e)}}},[e.payDigital>e.fixedDigital?o("img",{staticStyle:{width:"25px"},attrs:{src:"static/image/mall2/switch-on.png"}}):t._e(),t._v(" "),e.payDigital<=e.fixedDigital?o("img",{staticStyle:{width:"25px"},attrs:{src:"static/image/mall2/switch-off.png"}}):t._e()])],2):t._e()])})),t._v(" "),t.activity&&1==t.activity.isMeetCondition?o("div",{staticClass:"flex-row"},[o("div",{staticClass:"label-middle theme_font_common inline_block"},[t._v(t._s(t.activity.mktActivityTitle))]),t._v(" "),o("div",{staticClass:"swith inline_block",on:{click:function(e){return t.openActive()}}},[-1==t.activityId?o("img",{staticStyle:{width:"25px"},attrs:{src:"static/image/mall2/switch-off.png"}}):o("img",{staticStyle:{width:"25px"},attrs:{src:"static/image/mall2/switch-on.png"}})])]):t._e(),t._v(" "),t.settleInfo.discountAmount&&t.settleInfo.discountAmount>0?o("p",[o("span",[t._v("优惠金额")]),t._v(" "),o("span",[t._v("- ￥"+t._s(t.settleInfo.discountAmount&&t.settleInfo.discountAmount.toFixed(2)))])]):t._e(),t._v(" "),t.sumAmount(t.settleInfo.mktMoneyOffModelList)?o("p",[o("span",[t._v("活动累计加油升数")]),t._v(" "),o("span",[t._v(t._s(t.sumAmount(t.settleInfo.mktMoneyOffModelList))+"L")])]):t._e()],2),t._v(" "),t.showClu?o("div",{staticClass:"cul-tip",on:{click:function(e){t.ruleFlag=!0}}},[o("span",[t._v("网约车认证无优惠")]),t._v(" "),o("van-icon",{attrs:{name:"question-o"}})],1):t._e(),t._v(" "),2==t.enjoyCardType?o("div",{staticClass:"priority-card"},[o("div",{staticClass:"card-left"},[o("p",{staticClass:"title"},[t._v("领先享卡立减5元")]),t._v(" "),o("p",{staticClass:"info"},[t._v("微信支付分|信用优享")])]),t._v(" "),o("van-button",{attrs:{round:"",type:"info",color:"rgba(240, 44, 45, 1)",size:"small"},on:{click:t.getCard}},[t._v("立即领卡")])],1):1==t.enjoyCardType?o("div",{staticClass:"priority-card"},[o("van-button",{attrs:{round:"",type:"info",p:"",color:"rgba(240, 44, 45, 1)",size:"small"}},[t._v(t._s(t._f("state")(t.item1.state)))]),t._v(" "),o("span",[t._v("已完成"+t._s(t.item1.completeCnt||0)+"次，待完成"+t._s(t.unDone(t.item1.objectiveCnt,t.item1.completeCnt))+"次")])],1):t._e(),t._v(" "),t.recommendDisabled&&!t.isScan?o("div",{staticClass:"recommend"},[o("span",{staticClass:"label"},[t._v("推荐人")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.referrer,expression:"referrer"}],staticClass:"form-control",attrs:{type:"text",placeholder:"请输入推荐码",disabled:!t.canEditReferrer},domProps:{value:t.referrer},on:{input:function(e){e.target.composing||(t.referrer=e.target.value)}}}),t._v(" "),o("img",{directives:[{name:"show",rawName:"v-show",value:t.canEditReferrer,expression:"canEditReferrer"}],staticClass:"scan-code",attrs:{src:"static/image/setting/icon-scan.png"},on:{click:t.scanCodeFunc}})]):t._e(),t._v(" "),t.showQyPay?o("div",{staticClass:"qy"},[o("van-cell-group",{class:{sel:t.supportCompany}},[o("van-cell",{attrs:{clickable:"",title:"企业预付款支付",label:"企业预付款支付不支持个人支付优惠",value:"余额：￥"+t.qyAmount},on:{click:t.toggle},scopedSlots:t._u([{key:"right-icon",fn:function(){return[o("van-checkbox",{ref:"checkboxes",attrs:{"checked-color":"#f02c2d","icon-size":"14"},model:{value:t.supportCompany,callback:function(e){t.supportCompany=e},expression:"supportCompany"}})]},proxy:!0}],null,!1,4083768182)})],1)],1):t._e(),t._v(" "),o("pay-mode",{ref:"payModeRef",attrs:{supportCompany:t.supportCompany},on:{setPayWay:t.setPayWays}}),t._v(" "),t.$store.state.globalConfig.oilPayOrderVirtualDes?o("div",{staticClass:"virtual-tip"},[t._v("\n        温馨提示："+t._s(t.$store.state.globalConfig.oilPayOrderVirtualDes)+"\n      ")]):t._e(),t._v(" "),o("div",{staticClass:"footer"},[o("p",{staticClass:"tip"},[t._v("请核对账单进行支付")]),t._v(" "),o("div",{staticClass:"btn-wrapper"},[o("span",{staticClass:"price"},[o("i",{staticClass:"unit"},[t._v("￥")]),o("span",{staticClass:"num"},[t._v(t._s(t.supportCompany?t.settleQyAmount:t.settleAmount))])]),t._v(" "),o("span",{staticClass:"btn",on:{click:t.submitSel}},[t._v("确认支付")])])])],1):t._e(),t._v(" "),t.showModal?o("div",{staticClass:"confirm-pay-modal"},[o("div",{staticClass:"modal-content"},[o("div",{staticClass:"modal-title"},[t._v("确认支付？")]),t._v(" "),o("div",{staticClass:"firm-two"},[o("p",[o("span",[t._v("支付方式")]),t._v(" "),o("span",[t._v(t._s(t.selectedPayWay.text))])]),t._v(" "),o("p",[o("span",[t._v("金额")]),t._v(" "),o("span",[t._v("￥"+t._s(t.settleInfo.amount&&t.settleInfo.amount.toFixed(2)))])]),t._v(" "),t.$route.query.comeFromPage?t._e():o("p",[o("span",[t._v("加油时间")]),t._v(" "),o("span",[t._v(t._s(t.settleInfo.refuelTakeDate))])]),t._v(" "),t.$route.query.comeFromPage?t._e():o("p",[o("span",[t._v("加油升数")]),t._v(" "),o("span",[t._v(t._s(t.settleInfo.refuelLiter)+"L")])]),t._v(" "),t.settleInfo.couponAmount?o("p",[o("span",[t._v("加油券抵扣")]),t._v(" "),o("span",[t._v("- ¥"+t._s(t.settleInfo.couponAmount||0))])]):t._e(),t._v(" "),t._l(t.settleInfo.digitalList,(function(e,s){return 0!=e.digitalAmount?o("p",{key:s},[o("span",[t._v(t._s(t.getDigitalDisplayName(e.acctType))+"支付抵扣")]),t._v(" "),o("span",[t._v("- ¥"+t._s(e.digitalAmount))])]):t._e()})),t._v(" "),t.settleInfo.discountAmount&&t.settleInfo.discountAmount>0?o("p",[o("span",[t._v("优惠金额")]),t._v(" "),o("span",{staticClass:"theme_font_red"},[t._v("- ￥"+t._s(t.settleInfo.discountAmount&&t.settleInfo.discountAmount.toFixed(2)))])]):t._e(),t._v(" "),t.settleMobelAmount(t.settleInfo.thirdDiscountAmount,t.settleInfo.thirdDiscountAmount2)?o("p",[o("span",[t._v("移动优惠金额")]),t._v(" "),o("span",[t._v("￥"+t._s(t.settleMobelAmount(t.settleInfo.thirdDiscountAmount,t.settleInfo.thirdDiscountAmount2)))])]):t._e(),t._v(" "),o("p",[o("span",[t._v("应付金额")]),t._v(" "),o("span",{staticClass:"theme_font_red"},[o("span",[t._v("￥")]),t._v(t._s(t.settleAmount))])])],2),t._v(" "),o("div",{staticClass:"firm-three"},[o("p",{staticClass:"btn cancel-btn",on:{click:function(e){t.showModal=!1}}},[t._v("否")]),t._v(" "),o("p",{staticClass:"btn",on:{click:t.submitOrder}},[t._v("是")])])])]):t._e(),t._v(" "),t.showQyModal?o("div",{staticClass:"confirm-pay-modal"},[o("div",{staticClass:"modal-content"},[o("div",{staticClass:"modal-title"},[t._v("请确认车牌号")]),t._v(" "),o("div",{staticClass:"firm-two"},[o("p",[t._v("\n            加油车牌号码：\n          ")]),t._v(" "),o("div",{staticClass:"carNum"},[t._v("\n            "+t._s(t.qySettleInfo.plateNumber||"暂无")+"\n          ")]),t._v(" "),o("p",{staticStyle:{"font-size":"13px","margin-bottom":"20px"}},[t._v("\n            请核对加油车辆，并输入加油员服务号码\n          ")]),t._v(" "),o("div",{staticClass:"pwd"},[o("van-password-input",{attrs:{value:t.qyPayValue,length:11,mask:!1,focused:t.showKeyboard},on:{focus:function(e){t.showKeyboard=!0}}})],1)]),t._v(" "),o("div",{staticClass:"firm-three"},[o("p",{staticClass:"btn cancel-btn",on:{click:function(e){t.showQyModal=!1}}},[t._v("取消")]),t._v(" "),o("p",{staticClass:"btn",on:{click:t.submitOrder}},[t._v("确认")])])])]):t._e(),t._v(" "),o("van-popup",{class:{"two-zindex":t.showQyModal},style:{height:"40%"},attrs:{round:"",position:"bottom",closeable:""},model:{value:t.showPopup,callback:function(e){t.showPopup=e},expression:"showPopup"}},[o("div",{staticClass:"pop-content"},[o("div",{staticClass:"order-title"},[t._v("\n          企业预付款支付\n        ")]),t._v(" "),o("div",{staticClass:"qy-order"},[o("p",[t._v("\n            企业预付款支付\n          ")]),t._v(" "),o("p",[t._v("\n            余额：￥"+t._s(t.qyAmount)+"\n          ")])]),t._v(" "),o("div",{staticClass:"qy-order",on:{click:t.chooseCoupon}},[o("p",[t._v("\n            企业优惠券支付\n          ")]),t._v(" "),o("p",[t.qySettleInfo?[0!=t.qySettleInfo.couponAmount?o("span",[t._v("￥"+t._s(t.qySettleInfo.couponAmount||0))]):t._e(),t._v(" "),0==t.qySettleInfo.couponAmount&&0!=t.qySettleInfo.userCanUseCoupon.length?o("span",[t._v("有可用券")]):t._e(),t._v(" "),0==t.qySettleInfo.couponAmount&&0==t.qySettleInfo.userCanUseCoupon.length?o("span",[t._v("无可用券")]):t._e(),t._v(" "),o("i",{staticClass:"iconfont mall-gengduo more-icon theme_font_tint"})]:t._e()],2)])]),t._v(" "),o("div",{staticClass:"qy-submit"},[o("p",[t._v("\n            实付金额：\n            "),o("span",{staticClass:"price"},[o("i",{staticClass:"unit"},[t._v("￥")]),o("span",{staticClass:"num"},[t._v(t._s(t.settleQyAmount))])])]),t._v(" "),o("div",{on:{click:function(e){t.showQyModal=!0}}},[t._v("确认支付")])])]),t._v(" "),o("van-number-keyboard",{attrs:{show:t.showKeyboard},on:{input:t.inputPhone,blur:function(e){t.showKeyboard=!1}},model:{value:t.qyPayValue,callback:function(e){t.qyPayValue=e},expression:"qyPayValue"}}),t._v(" "),o("van-dialog",{attrs:{"confirm-button-text":"我知道了",title:"网约车加油优惠规则"},model:{value:t.ruleFlag,callback:function(e){t.ruleFlag=e},expression:"ruleFlag"}},[o("div",{staticClass:"rule-content",domProps:{innerHTML:t._s(t.showCluDom)}})])],1)],1)}),[],!1,null,"0b707706",null);e.default=d.exports},GZl2:function(t,e,s){},HMz6:function(t,e,s){"use strict";var o=s("GZl2");s.n(o).a},NQte:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAABaUExURUdwTP8AF/8AGP8AGP8AEf8AF/8AF/8AGP8ADv8AGP8AF/8AF/8AAP8AGP8AF/8ACP8AF/8AGP8AFf8AGP8AGP8AF/8AFv8AFv8AFP8AF/8AF/8AGP8AGP8AGdzj2ekAAAAddFJOUwB58cgOY5PQEOfVKAT73Ame9xeIt2wzWj3Ay0qnV+hs8QAAANtJREFUeNrt0skOhCAMgGFEAVFxX2br+7/m0DGODtakHk3mPwBpv4uJ4sINFoKkLnBRN30S2AmItF/c/B0Huqew9Isc9trgrDTfMocD3ET4MG2I1XYwOsSrTgJciW3ZgkWHWgcYb2LSlogtC6cZfGLhCE5gdQYXSneWizHDweCMOsDpDy5hrqZx3aZrAywpAlPd8ctiJhaV1w0Tz/M/vjJ++DPBP9Ax8Mufj94fGQM/l2fEwKKeX3HFwUUkARqdrPR2b0gcK+T5WIlNFg5yudgl4SgCT5amshOX7w0BmltiDZY0mAAAAABJRU5ErkJggg=="},PbvB:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAB1UExURUdwTP8AAP8AGP8AFf8AGP8AGP8AEv8AFv8AGP8AAP8AFv8AEP8AF/8AAP8AGP8AGP8AGP8AF/8AGP8AF/8AF/8AGP8AGP8AGP8AEv8AF/8AGP8AF/8AFv8AF/8AGP8AFv8AF/8AFv8AGP8AFv8AF/8AGf8AGTK15hsAAAAmdFJOUwAI3Srz4wxQsANIEtYBZu74uPyCeH6ZkRu/qIsyyec3oG8/OVbMl7U6IAAAAPRJREFUeNrd0tnOgjAQBeCCbaHsCoi4of8y7/+IcohGicrMhXrhuekp+dJMG9QHsjI0pJXggM6JX4278ByrXhsvCi6J2EFauqbIGEyjrK0UI/5WipHimIpwsjRYwliAfavsGsX88niObVb0bVGlHC4i7GcJ+jxmL1i6/oM9oO5/OEztahhFY5TaMZjy21E89p03ONBbotYspt0wSo0n5DHlASZBYzHSeGkzgfVY65wmcLSncSbwv6rk+E9ZLcXGKdVIcYm3kuItii/EFiUU4q5fnfTkZIZfR4QRX5MUI1+L9XOb3+HNc1zdYVeah3Kxy1L19pwANp91pvMgfngAAAAASUVORK5CYII="},Pee1:function(t,e,s){"use strict";e.a={data:function(){return{getResultTimes:0,clearTimer:null,payTime:0}},mounted:function(){},methods:{checkPayResult:function(){var t=this;this.queryState().then((function(e){if(1==e)t.resultHand(1);else if(2==e)t.resultHand(0);else if(0==e){if(t.getResultTimes++,t.getResultTimes>20)return;t.clearTimer=setTimeout((function(){t.checkPayResult()}),1e3)}}))},queryState:function(){var t=this;return new Promise((function(e,s){var o="/app/json/refuel_center/queryPayState";t.isScan&&(o="/app/json/refuel_scan_code/queryPayState");var a={token:t.$store.state.login.token,tradeNo:t.payData.tradeNo};t.$Loading.open(),t.$http.post(o,a).then((function(o){t.$Loading.close();var a=o.data;0==a.status?e(a.data.state):s(),a.data.msg})).catch((function(){t.$Loading.close()}))}))}},destroyed:function(){clearTimeout(this.clearTimer)}}},R5IT:function(t,e,s){"use strict";var o=s("mX1F");s.n(o).a},VGP3:function(t,e,s){"use strict";var o=s("db0i"),a={name:"pay-mode",props:{supportCompany:Boolean},data:function(){return{payWay:[],selectedPayWay:{}}},mounted:function(){},methods:{init:function(t,e){var s=this;o.a.getPayWays(t,e).then((function(t){s.payWay=t||[],s.supportCompany?s.selectedPayWay=[]:s.selectedPayWay=s.payWay[0],s.$emit("setPayWay",s.selectedPayWay,"init")}))},payWaySelected:function(t){t.payMode?(this.selectedPayWay=t,this.$emit("setPayWay",this.selectedPayWay)):this.$Toast("暂未开通！")}},components:{}},i=(s("HMz6"),s("KHd+")),n=Object(i.a)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pay-mode"},[s("div",{staticClass:"title"},[t._v("支付方式")]),t._v(" "),t._l(t.payWay,(function(e){return s("div",{staticClass:"pay-mode-item",on:{click:function(s){return t.payWaySelected(e)}}},["210009"!=e.payModeSub||"210009"==e.payModeSub&&3==t.$store.state.webtype?[s("div",{staticClass:"icon"},[s("img",{attrs:{src:e.icon}})]),t._v(" "),s("div",{staticClass:"text"},[t._v(t._s(e.text))]),t._v(" "),s("div",{staticClass:"selected"},[t.selectedPayWay.payModeSub!=e.payModeSub?s("i",{staticClass:"iconfont mall-weixuanzhong theme_font_tint"}):t._e(),t._v(" "),t.selectedPayWay.payModeSub==e.payModeSub?s("i",{staticClass:"iconfont mall-xuanzhong theme_font_red"}):t._e()])]:t._e()],2)}))],2)}),[],!1,null,"0b904960",null);e.a=n.exports},mX1F:function(t,e,s){}}]);