(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-021efb40"],{"1b5e":function(t,e,a){"use strict";a("62ad")},"62ad":function(t,e,a){},"71c9":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"list"},[a("nav-top",{attrs:{noTitle:!0},on:{backEvent:t.backEvent}},[a("div",{staticClass:"search-div theme_bg_white_f5 microSearch",on:{click:t.toSearchEvent}},[a("i",{staticClass:"iconfont mall-sousuo theme_font_tint microSearchI"}),a("span",{staticClass:"theme_font_tint microSearchSpan"},[t._v(t._s(t.searchKey?t.searchKey:"输入你想要的商品名称"))])])]),a("nav-content",[a("div",{staticClass:"main"},[a("div",{staticClass:"row"},[a("div",t._l(t.deliveryTypes,(function(e,s){return a("div",{key:s,staticClass:"type-btn",class:{theme_light_bg:t.selectedType==e.tag,theme_standard_bdr_i:t.selectedType==e.tag},on:{click:function(a){return t.selectedTypeEvent(e.tag)}}},[a("i",{staticClass:"iconfont theme_font_common icon-size",class:[e.fontclass,{theme_standard_font_i:t.selectedType==e.tag}]}),a("span",{staticClass:"theme_font_common",class:{theme_standard_font_i:t.selectedType==e.tag}},[t._v(t._s(e.text))])])})),0),1==t.getPutaggregate.empFlag?a("div",{staticClass:"type-btn",on:{click:t.isRecommendBtn}},[a("van-icon",{staticStyle:{"margin-right":"4px","margin-top":"-3px","vertical-align":"middle"},attrs:{name:t.isRecommend?"arrow-up":"arrow-down"}}),a("span",[t._v(t._s(t.recommendText))])],1):t._e()]),a("div",{staticClass:"screen"},t._l(t.screenArr,(function(e,s){return a("div",{key:s,staticClass:"btn",class:{theme_standard_font_i:t.screenType==e.type},on:{click:function(a){return t.screenBtn(e)}}},[t._v(t._s(e.name+"（"+e.number+"）"))])})),0),a("list",{ref:"list",attrs:{params:t.params,styleObj:t.styleObj},on:{productEvent:t.productEvent,addshare:t.addshareBtn,listData:t.listData,upperShelf:t.upperShelf,deleteShare:t.deleteShare}})],1)]),t.popupShow?a("Share",{attrs:{shareObj:t.shareObj},on:{setshareData:t.setshareData,qRcodeStstus:t.qRcodeStstus}}):t._e(),a("van-action-sheet",{attrs:{actions:t.actions},on:{select:t.onSelect},model:{value:t.isRecommend,callback:function(e){t.isRecommend=e},expression:"isRecommend"}}),a("van-action-sheet",{attrs:{actions:t.threePointsArr},on:{select:t.onSelectPoints},model:{value:t.isThreePoints,callback:function(e){t.isThreePoints=e},expression:"isThreePoints"}})],1)},i=[],o=a("2909"),r=a("5530"),n=(a("99af"),a("b0c0"),a("0ae6")),c=a("7aab"),l=a("2f62"),d=a("2f9a"),h={name:"shop-preview",components:{list:n["a"],Share:c["a"]},computed:Object(r["a"])({},Object(l["c"])(["getPutaggregate","getGlobalConfig"])),data:function(){return{actions:[{name:"全部商品",value:""},{name:"自主商品",value:"2"},{name:"推荐商品",value:"1"}],itemAddshare:{},isThreePoints:!1,threePointsArr:[],threePointsArrQB:[{name:"商品分享",value:"1"}],threePointsArrZD:[{name:"商品下架",value:"0"},{name:"商品置顶",value:"2"}],threePointsArrQZD:[{name:"商品下架",value:"0"},{name:"取消置顶",value:"2"}],deliveryTypes:[{text:"配送",fontclass:"mall-peisong",tag:"2"},{text:"自提",fontclass:"mall-ziti",tag:"1"}],screenArr:[{name:"出售中",number:"0",type:1},{name:"已下架",number:"0",type:2},{name:"无效商品",number:"0",type:0}],params:{page:"",rows:"",skuName:"",groupFlag:this.$route.query.groupFlag,queryTypeRecommend:"",deliverType:this.$store.state.mall2.staticDeliverType,queryType:"1"},styleObj:{listStyle:!1,rowStyle:3,isObject:1,isHeight:"88",url:"/app/json/app_distribution_order/getProList"},isType:"",selectedType:this.$store.state.mall2.staticDeliverType,screenType:"1",showView:!0,popupShow:!1,shareObj:{groupFlag:0,popupShow:!1,codeShow:!1,deliverType:this.$store.state.mall2.staticDeliverType},objData:{},isRecommend:!1,recommendText:"全部商品",codeStstus:!1,searchKey:""}},beforeRouteLeave:function(t,e,a){this.codeStstus?this.shareObj.codeShow=!1:this.popupShow?this.popupShow=!1:a()},created:function(){"1"==this.$store.state.globalConfig.delivertype_default?this.deliveryTypes=[{text:"自提",fontclass:"mall-ziti",tag:"1"}]:"2"==this.$store.state.globalConfig.delivertype_default&&(this.deliveryTypes=[{text:"配送",fontclass:"mall-peisong",tag:"2"}])},methods:{backEvent:function(){this.$router.go(-1)},qRcodeStstus:function(t){this.codeStstus=t},toSearchEvent:function(){var t=this;d["a"].open({initData:{barHeight:this.$store.state.barHeight,searchHistory:this.$store.state.mall2.searchHistory},clearSearchHistory:function(){t.$store.state.mall2.searchHistory=[]},searchEvent:function(e){d["a"].close(),t.$mallCommon.pushSearchHistory(e),t.searchKey=e,t.params.page=0,t.params.skuName=e}})},selectedTypeEvent:function(t){this.selectedType=t,this.shareObj.deliverType=t,this.$store.state.mall2.staticDeliverType=t,2==this.selectedType?this.showView=!0:this.showView=!1,this.params.deliverType=t,this.screenType=1,this.params.queryType="1"},screenBtn:function(t){this.screenType=t.type,this.params.queryType=t.type,this.$store.state.microSho.screenType=t.type},listData:function(t){var e=t.data||{};this.$set(this.screenArr[2],"number",e.numsForInvalid),this.$set(this.screenArr[0],"number",e.numsForSale),this.$set(this.screenArr[1],"number",e.numsForSoldOut)},setshareData:function(t){this.popupShow=!1,this.shareObj=Object.assign({},t)},upperShelf:function(t){var e=this;this.$messagebox.confirm("确定上架？","提示").then((function(a){e.$Loading.open();var s="/app/json/app_distribution_order/updateProFromMicroStore",i={token:e.$store.state.login.token,skuId:t.skuId,storeId:e.getPutaggregate.id,status:"1"};e.$http.post(s,i).then((function(t){e.$Loading.close();var a=t.data;0==a.status?(e.$Toast("上架成功！"),e.$refs.list._loadProList(!0)):e.$Toast(a.info)}))}))},deleteShare:function(t){var e=this;this.$messagebox.confirm("该商品已经停止分销，是否要删除？","提示").then((function(a){e.$Loading.open();var s="/app/json/app_distribution_order/removeProFromMicroStore",i={token:e.$store.state.login.token,storeId:e.getPutaggregate.id,skuId:t.skuId,proSkuDistributionId:t.proSkuDistributionId};e.$http.post(s,i).then((function(t){e.$Loading.close();var a=t.data;0==a.status?(e.$Toast("删除成功！"),e.$refs.list._loadProList(!0)):e.$Toast(a.info)}))}))["catch"]((function(){}))},productEvent:function(t){if(0!=this.screenType){var e="/micro_sho/detail/"+this.$util.getDataString();t.groupFlag&&(e="/micro_sho/purchasedetail/"+this.$util.getDataString()),this.$router.push({path:e,query:{id:t.skuId,skuId:t.skuId,lastPath:this.$route.path,deliveryType:t.deliverType,deliverType:t.deliverType,productType:t.productType,isRecommend:t.isRecommend,proSkuDistributionId:t.proSkuDistributionId,groupFlag:this.$route.query.groupFlag,obj:{queryType:this.screenType}}})}},addshareBtn:function(t){this.isThreePoints=!0,this.itemAddshare=t,t.isRecommend?this.threePointsArr=[].concat(Object(o["a"])(this.threePointsArrQB),[{name:"取消",value:"-1"}]):t.topFlag?this.threePointsArr=[].concat(Object(o["a"])(this.threePointsArrQB),Object(o["a"])(this.threePointsArrQZD),[{name:"取消",value:"-1"}]):this.threePointsArr=[].concat(Object(o["a"])(this.threePointsArrQB),Object(o["a"])(this.threePointsArrZD),[{name:"取消",value:"-1"}])},onSelectPoints:function(t){0==t.value?this.upDownMethod():1==t.value?(this.shareObj=Object.assign({},this.shareObj,this.itemAddshare,{phMainUrl:this.itemAddshare.mainMobilePicUrl,showTitle:this.itemAddshare.skuName,dpedData:{linePrice:this.itemAddshare.salePrice}}),this.popupShow=!0,this.shareObj.popupShow=!0,this.shareObj.groupFlag=this.$route.query.groupFlag):2==t.value&&this.microStoreProTop(),this.isThreePoints=!1},microStoreProTop:function(){var t=this;this.$messagebox.confirm("确定要操作该商品吗!","提示").then((function(e){t.$Loading.open(),t.$http.post("/app/json/app_distribution_order/microStoreProTop",{id:t.itemAddshare.microStoreProId}).then((function(e){t.$Loading.close(),0==e.data.status?(t.$Toast("操作成功!"),t.$refs.list._loadProList(t.params)):t.$Toast(e.data.info)}))}))},upDownMethod:function(){var t=this;this.$messagebox.confirm("确定要下架该商品吗!","提示").then((function(e){t.$Loading.open(),t.$http.post("/app/json/app_distribution_order/updateProFromMicroStore",{skuId:t.itemAddshare.skuId,storeId:t.getPutaggregate.id,status:0}).then((function(e){t.$Loading.close(),0==e.data.status?(t.$Toast("下架成功!"),t.$refs.list._loadProList(t.params)):t.$Toast(e.data.info)}))}))},isRecommendBtn:function(){this.isRecommend=!0},onSelect:function(t){this.recommendText=t.name,this.isRecommend=!1,this.params.queryTypeRecommend=t.value}}},u=h,p=(a("b7f64"),a("0c7c")),m=Object(p["a"])(u,s,i,!1,null,"043b75d8",null);e["default"]=m.exports},"7aab":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box"},[a("van-popup",{attrs:{position:"bottom"},on:{"click-overlay":t.clickOverlay},model:{value:t.detailData.popupShow,callback:function(e){t.$set(t.detailData,"popupShow",e)},expression:"detailData.popupShow"}},[a("div",{staticClass:"popup"},[a("div",{staticClass:"popup-content",on:{click:t.sharewx}},[a("img",{attrs:{src:"static/image/mall2/weixin.png",alt:""}}),a("span",[t._v("微信")])]),a("div",{staticClass:"popup-content",on:{click:t.QRcode}},[a("img",{attrs:{src:"static/image/microShop/code@2x.png",alt:""}}),a("span",[t._v("二维码")])])])]),t.codeShow?a("div",{staticClass:"code-div",on:{click:function(e){return e.target!==e.currentTarget?null:t.btnbox.apply(null,arguments)}}},[a("div",{ref:"imageWrapper",staticClass:"code-content"},[a("div",{staticClass:"code-content-img"},[a("div",{staticClass:"code-content-img-top"},[a("img",{attrs:{src:t.imgUrl,alt:"",crossOrigin:"anonymous"}})]),t.detailData.groupFlag?a("div",{staticClass:"code-content-img-buttom"},[a("div",{staticClass:"price theme_font_red"},t._l(t.getPrices(),(function(e,s){return a("div",{staticClass:"price-item"},[0!=s?a("p",{staticClass:"xian"},[t._v(" ~ ")]):t._e(),a("p",[t._v("¥")]),a("p",{staticClass:"big"},[t._v(t._s(e.iNum)+".")]),a("p",[t._v(t._s(e.dNum))])])})),0),a("div",{staticClass:"text theme_font_black"},[t._v(t._s(t.detailData.showTitle))])]):a("div",{staticClass:"code-content-img-buttom"},[a("div",{staticClass:"text theme_font_red"},[a("span",{staticClass:"font-small price-z theme_font_red",staticStyle:{"font-weight":"700"}},[t._v("￥")]),a("span",{staticClass:"price-z theme_font_red",staticStyle:{"margin-left":"-4px"}},[t._v(t._s(t.getInteger(t.detailData.salePrice)))]),a("span",{staticClass:"font-small price-z theme_font_red",staticStyle:{"margin-left":"-4px","font-weight":"700"}},[t._v("."+t._s(t.getDecimals(t.detailData.salePrice)))])]),a("div",{staticClass:"text theme_font_black"},[t._v(t._s(t.detailData.dpedData.featureName||t.detailData.skuName))])])]),a("div",{staticClass:"code-content-line"}),t._m(0),a("div",{staticClass:"code-content-zanwei"})]),a("div",{staticClass:"code-btn"},[a("div",{staticClass:"btn theme_bg_red",on:{click:function(e){return e.stopPropagation(),t.preservation.apply(null,arguments)}}},[t._v("保存图片到本地")]),a("div",{staticClass:"text"},[t._v("记得发送给朋友或发布到朋友圈呦！")])])]):t._e()],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"code-content-code"},[a("canvas",{staticClass:"qrcode",attrs:{id:"qrcode"}}),a("p",[t._v("微信扫码或长按识别二维码")])])}],o=a("5530"),r=(a("ac1f"),a("1276"),a("99af"),a("e25e"),a("c0e9")),n=a.n(r),c=a("da71"),l=a("d055"),d=a.n(l),h=a("2f62"),u=a("ae5c"),p={name:"share",props:["shareObj"],computed:Object(o["a"])({},Object(h["c"])(["getPutaggregate"])),data:function(){return{imgUrl:"",timeOutEvent:0,popupShow:!0,codeShow:this.shareObj.codeShow,detailData:this.$util.deepClone(this.shareObj)}},mounted:function(){this.setOssImg(this.detailData.phMainUrl||this.detailData.picMainUrl||this.detailData.picUrls[0])},methods:{getPrices:function(){return u["a"].getPriceShow(this.detailData.purPriceRules)},setOssImg:function(t){var e=this;this.imgUrl="",this.$request.post("/app/json/home/getFileBase64",{filePath:t}).then((function(t){0==t.status?t.data?e.imgUrl="data:image/png;base64,".concat(t.data||""):e.$Toast("getFileBase64 返回为空"):e.$Toast(t.info)}))},getInteger:function(t){var e=this.$util.toDecimal2(t),a=e.split(".");return a[0]},getDecimals:function(t){var e=this.$util.toDecimal2(t),a=e.split(".");return a[1]},clickOverlay:function(){this.detailData.popupShow=!1,this.$emit("setshareData",this.detailData.storeCode)},sharewx:function(){var t="/micro_sho/shareDetail/";this.detailData.groupFlag&&(t="/micro_sho/sharebuyingDetail/");var e={};e={},e.title=this.detailData.showTitle||this.detailData.skuName,e.sharetext=this.detailData.skuName,e.imageurl=this.detailData.phMainUrl,e.detailurl=this.$store.state.globalConfig.wxBaseUrl+c["a"].shareUrl+"".concat(t).concat(this.$util.getDataString()),e.detailurl=e.detailurl+"?id="+(this.detailData.id||this.detailData.skuId)+"&skuId="+(this.detailData.skuId||this.detailData.id)+"&microStoreCode="+this.getPutaggregate.storeCode+"&storeName="+this.getPutaggregate.storeName+"&productType="+this.detailData.productType+"&deliveryType="+this.$store.state.mall2.staticDeliverType+"&storeOuCodeNew="+this.$store.state.mall2.zitiAddress.id+"&proSkuDistributionId="+this.detailData.proSkuDistributionId,this.$store.state.login.token&&""!=this.$store.state.login.token&&(e.detailurl=e.detailurl+"&recommend="+this.$store.state.userInfo.userId,e.detailurl=e.detailurl+"&recommendPhone="+this.$store.state.login.phone),this.$bridgefunc.wechatShare(e)},QRcode:function(){var t=this,e="/micro_sho/shareDetail";this.detailData.groupFlag&&(e="/micro_sho/sharebuyingDetail"),this.codeShow=!0,this.$emit("qRcodeStstus",this.codeShow),this.$nextTick((function(a){var s="".concat(t.$store.state.globalConfig.wxBaseUrl).concat(c["a"].shareUrl).concat(e),i="".concat(s,"/").concat(t.$util.getDataString(),"?id=").concat(t.detailData.id||t.detailData.skuId,"&skuId=").concat(t.detailData.skuId||t.detailData.id,"&microStoreCode=").concat(t.getPutaggregate.storeCode,"&storeName=").concat(t.getPutaggregate.storeName,"&productType=").concat(t.detailData.productType,"&deliveryType=").concat(t.$store.state.mall2.staticDeliverType,"&storeOuCodeNew=").concat(t.$store.state.mall2.zitiAddress.id,"&proSkuDistributionId=").concat(t.detailData.proSkuDistributionId);d.a.toCanvas(document.getElementById("qrcode"),i,{width:140})}))},btnbox:function(){this.codeShow=!1,this.$emit("qRcodeStstus",this.codeShow)},preservation:function(){var t=this,e=document.querySelector(".code-content"),a=parseInt(window.getComputedStyle(e).width),s=parseInt(window.getComputedStyle(e).height),i=document.createElement("canvas"),o=2;i.width=a*o,i.height=s*o,i.getContext("2d").scale(o,o);var r={useCORS:!0,scale:o,canvas:i,backgroundColor:"#000"};n()(this.$refs.imageWrapper,r).then((function(e){var a=e.toDataURL("image/png");t.codeShow=!1;var s=a.split("base64,");t.$bridgefunc.savePhoto(s[1],(function(e){"1"==e?(t.detailData.popupShow=!1,t.$emit("setshareData",t.detailData),t.$Toast("保存成功！")):t.$Toast("保存失败！")}))}))}}},m=p,g=(a("1b5e"),a("0c7c")),v=Object(g["a"])(m,s,i,!1,null,"06153066",null);e["a"]=v.exports},"7fed":function(t,e,a){},ae5c:function(t,e,a){"use strict";a("ac1f"),a("1276");var s=a("ca00"),i={getPriceShow:function(t){if(0==t.length)return"";for(var e=t[0].price,a=t[0].price,s=1;s<t.length;s++){var i=t[s].price;e>i&&(e=i),a<i&&(a=i)}if(e==a){var o=this.getINumDNum(e);return[o]}var r=this.getINumDNum(e),n=this.getINumDNum(a);return[r,n]},getINumDNum:function(t){var e=s["a"].toDecimal2(t),a=e.split("."),i=a[0],o=a[1];return{iNum:i,dNum:o}}};e["a"]=i},b7f64:function(t,e,a){"use strict";a("7fed")}}]);