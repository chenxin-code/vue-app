(window.webpackJsonp=window.webpackJsonp||[]).push([[223],{"02kl":function(t,e,o){"use strict";var n=o("C3sG");o.n(n).a},C3sG:function(t,e,o){},"CG+W":function(t,e,o){"use strict";var n,s=o("0FX9"),i=(n=o.n(s).a.toCanvas,function(){var t=Array.prototype.slice.call(arguments);return new Promise((function(e,o){t.push((function(t,n){t?o(t):e(n)})),n.apply(null,t)}))}),a=function(t,e){var o=document.createElement("canvas");return i(o,t,e).then((function(){return o.width}))},r=function(t){return t.length>36?"M":t.length>16?"Q":"H"},c=function(t){var e=t.canvas,o=(t.content,t.logo);if(o){var n=e.width,s=o.logoSize,i=void 0===s?.15:s,a=o.borderColor,r=o.bgColor,c=void 0===r?a||"#ffffff":r,u=o.borderSize,l=void 0===u?.05:u,g=o.crossOrigin,f=o.borderRadius,h=void 0===f?8:f,v=o.logoRadius,m=void 0===v?0:v,C="string"==typeof o?o:o.src,p=n*i,y=n*(1-i)/2,$=n*(i+l),b=n*(1-i-l)/2,_=e.getContext("2d");d(_)(b,b,$,$,h),_.fillStyle=c,_.fill();var q=new Image;return(g||m)&&q.setAttribute("crossOrigin",g||"anonymous"),q.src=C,new Promise((function(t,e){q.onload=function(){m?function(t){var e=document.createElement("canvas");e.width=y+p,e.height=y+p,e.getContext("2d").drawImage(t,y,y,p,p),d(_)(y,y,p,p,m),_.fillStyle=_.createPattern(e,"no-repeat"),_.fill()}(q):function(t){_.drawImage(t,y,y,p,p)}(q),t()}}))}},d=function(t){return function(e,o,n,s,i){var a=Math.min(n,s);return i>a/2&&(i=a/2),t.beginPath(),t.moveTo(e+i,o),t.arcTo(e+n,o,e+n,o+s,i),t.arcTo(e+n,o+s,e,o+s,i),t.arcTo(e,o+s,e,o,i),t.arcTo(e,o,e+n,o,i),t.closePath(),t}},u=function(t){return function(t){var e=t.canvas,o=t.content,n=t.width,s=void 0===n?0:n,c=t.nodeQrCodeOptions,d=void 0===c?{}:c;return d.errorCorrectionLevel=d.errorCorrectionLevel||r(o),a(o,d).then((function(t){return d.scale=0===s?void 0:s/t*4,i(e,o,d)}))}(t).then((function(){return t})).then(c)},l={toCanvas:u,toImage:function(t){var e=document.createElement("canvas");return t.canvas=e,t.logo&&("string"==typeof t.logo&&(t.logo={src:t.logo}),t.logo.crossOrigin="Anonymous"),u(t).then((function(){var o=t.image,n=void 0===o?new Image:o,s=t.downloadName,i=void 0===s?"qr-code":s,a=t.download;n.src=e.toDataURL(),(!0===a||"function"==typeof a)&&(a=!0===a?function(t){return t()}:a)((function(){!function(t,e){var o=t.src,n=document.createElement("a");n.download=e,n.href=o,document.body.appendChild(n),n.click(),document.body.removeChild(n)}(n,i)}))}))}};e.a=l},Ctyn:function(t,e,o){"use strict";var n=o("ZToj");e.a=function(t){var e=void 0;return"海南省"==n.a.state.globalConfig.province&&(e="hainan"),e?"static/enterpriseImg/"+e+"/"+t:null}},Fybm:function(t,e,o){"use strict";var n={name:"agreement-content",components:{},props:["value","noloading"],data:function(){return{agreementContent:""}},methods:{getAgreement:function(){var t=this;"true"!=this.noloading&&this.$Loading.open();var e=void 0,o=void 0;18==this.value?(e="/app/json/news/getNewsList",o={values:52}):(e="/app/json/news/getList",o={token:this.$store.state.login.token,value:this.value}),this.$http.post(e,o).then((function(e){"true"!=t.noloading&&t.$Loading.close();var o=e.data.data;if(o&&""!=o){var n=o[0];t.agreementContent=n.content}else console.log("协议内容为空")}),(function(e){"true"!=t.noloading&&t.$Loading.close(),t.$Toast("请求数据失败！")}))}},mounted:function(){this.getAgreement()},created:function(){}},s=(o("02kl"),o("KHd+")),i=Object(s.a)(n,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"agreement-content"},[e("div",{staticClass:"content",domProps:{innerHTML:this._s(this.agreementContent)}})])}),[],!1,null,"5e72c5d8",null);e.a=i.exports},aOpt:function(t,e,o){"use strict";var n=o("vw6J");o.n(n).a},vtH6:function(t,e,o){"use strict";o.r(e);var n=o("CG+W"),s=o("Ctyn"),i=o("YsXA"),a=o.n(i),r=o("Fybm"),c=o("2nGb"),d={name:"my-qrcode",components:{QRCode:n.a,AgreementContent:r.a},data:function(){return{myInfo:{},myTimeout:null,brightnessResult:{}}},methods:{backEvent:function(){this.$router.go(-1)},refreshBtn:function(){this.requestCode()},getMycode:function(){var t=this;this.$Loading.open();var e={token:this.$store.state.login.token};this.$http.post("/app/json/user/queryQrCodeInfo",e).then((function(e){t.$Loading.close();var o=e.data;0==o.status?(t.myInfo=o.data,t.$nextTick((function(){t.myInfo.qrCodeWithAppDownload?t.createQRCode(t.myInfo.qrCodeWithAppDownload):t.toCanvas(),t.myTimeout&&(clearTimeout(t.myTimeout),t.myTimeout=null),t.myTimeout=setTimeout((function(){t.getMycode()}),18e4)}))):t.$Toast(o.info)}),(function(e){t.$Loading.close()}))},toCanvas:function(){if("2"!=this.$store.state.globalConfig.user_qrCode_type){var t=document.getElementById("barcode");a()(t,this.myInfo.qrCode,{displayValue:!1})}if("1"!=this.$store.state.globalConfig.user_qrCode_type){var e=document.getElementById("qrcode");e.getContext("2d").clearRect(0,0,e.width,e.height);var o=""+this.$store.state.globalConfig.wxBaseUrl+c.a.shareUrl+"/usercenter/downloadshare",n=this.myInfo.qrCode;this.$route.query.isToRegiste&&(o=""+this.$store.state.globalConfig.wxBaseUrl+c.a.shareUrl+"/usercenter/loginbindqrcode"),this.$route.query.isPreRegiste&&(o=""+this.$store.state.globalConfig.wxBaseUrl+c.a.shareUrl+"/usercenter/preregistration"),2==this.$store.state.globalConfig.user_getUserRfrCode_isShortAddress?this.createQRCode(o+"?qrCode="+n):this.getShort(o,n)}},getShort:function(t,e){var o=this;this.$Loading.open();var n={token:this.$store.state.login.token,longAddress:t,addressData:e};this.$http.post("/app/json/short_address/makeShortAddress",n).then((function(t){o.$Loading.close();var n=t.data;0==n.status?o.createQRCode(n.data+"?qrCode="+e):o.$Toast(n.info)}),(function(t){o.$Loading.close(),console.log("获取我的电子券",t)}))},createQRCode:function(t){if("2"!=this.$store.state.globalConfig.user_qrCode_type){var e=document.getElementById("barcode");a()(e,this.myInfo.qrCode,{displayValue:!1})}if("1"!=this.$store.state.globalConfig.user_qrCode_type){var o={canvas:document.getElementById("qrcode"),content:t,width:140,nodeQrCodeOptions:{margin:0}},i=Object(s.a)("qr-logo.png");i&&(o.logo={src:i}),n.a.toCanvas(o)}},getUserRfrCode:function(){var t=this;this.$Loading.open();var e={token:this.$store.state.login.token};this.$http.post("/app/json/user/getUserRfrCode",e).then((function(e){t.$Loading.close();var o=e.data;0==o.status?(t.myInfo=o.data,t.$nextTick((function(){t.toCanvas()}))):t.$Toast(o.info)}),(function(e){t.$Loading.close(),console.log("获取我的电子券",e)}))},requestCode:function(){this.$route.query.isToRegiste||this.$route.query.isPreRegiste?this.getUserRfrCode():this.getMycode()}},mounted:function(){},created:function(){var t=this;this.requestCode(),this.$bridgefunc.brightness(1,0,(function(e){t.brightnessResult=e}))},destroyed:function(){this.myTimeout&&(clearTimeout(this.myTimeout),this.myTimeout=null),this.$bridgefunc.brightness(this.brightnessResult.value,this.brightnessResult.isauto,(function(t){}))}},u=(o("aOpt"),o("KHd+")),l=Object(u.a)(d,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"my-qrcode"},[o("nav-top",{on:{backEvent:t.backEvent}}),t._v(" "),o("nav-content",{staticClass:"my-qrcode-container"},[o("div",{staticClass:"code-content"},[o("div",{staticClass:"top-div"},[o("div",{staticClass:"title-div"},[o("img",{attrs:{src:"static/image/setting/qrcode-tag.png",alt:""}}),t._v(" "),o("p",{staticClass:"theme_font_white"},[t._v("会员码: "+t._s(t.myInfo.userNo))])])]),t._v(" "),o("div",{staticClass:"qr-div"},[o("div",{staticClass:"head-div"},[o("img",{staticClass:"headImg",attrs:{src:t.$store.state.globalConfig.user_qrcode_icon?t.$store.state.globalConfig.user_qrcode_icon:"static/image/setting/logo.png",alt:""}})]),t._v(" "),o("p",{staticClass:"phone"},[t._v(t._s(t.$store.state.login.phone))]),t._v(" "),"2"!=t.$store.state.globalConfig.user_qrCode_type?o("div",{staticClass:"barcode"},[o("canvas",{attrs:{id:"barcode"}})]):t._e(),t._v(" "),"1"!=t.$store.state.globalConfig.user_qrCode_type?o("div",{staticClass:"codeimg-content"},[o("div",{ref:"qrcode",staticClass:"qrcode"},[o("canvas",{attrs:{id:"qrcode"}})]),t._v(" "),o("div",{staticClass:"icon",on:{click:t.refreshBtn}},[o("i",{staticClass:"iconfont mall-shuaxin"})])]):t._e()]),t._v(" "),o("div",{staticClass:"qrcode-agreement"},[o("AgreementContent",{attrs:{value:"1"}})],1)])])],1)}),[],!1,null,"1eade69f",null);e.default=l.exports},vw6J:function(t,e,o){}}]);