(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8d1897ae"],{1787:function(t,e,i){"use strict";i("6ae0")},"272a":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"firmdetail"},[i("div",{staticClass:"header"},[i("div",{staticClass:"header-top"},[i("i",{staticClass:"iconfont mall-fanhui theme_font_black backmall",on:{click:t.backEvent}}),i("span",{staticClass:"title"},[t._v("加油支付凭证详情")])]),1==t.fromPage?i("div",{staticClass:"headerTime"},[i("div",{staticClass:"time"},[i("span",[t._v(t._s(t.month))]),i("span",[t._v("月")]),i("span",[t._v(t._s(t.day))]),i("span",[t._v("日")]),i("span",[t._v(t._s(t.hour))]),i("span",[t._v("时")]),i("span",[t._v(t._s(t.min))]),i("span",[t._v("分")]),i("span",[t._v(t._s(t.second))]),i("span",[t._v("秒")]),i("span",{staticClass:"millisecond"},[t._v(t._s(t.millisecond))])])]):t._e()]),t.orderDetail?[i("div",{staticClass:"detailstation"},[t._v(t._s(t.orderDetail.storeName))]),i("div",{staticClass:"detailm"},[i("div",{staticClass:"money detailmon"},[t._m(0),i("p",[t._v("¥"),i("span",[t._v(t._s(t.orderDetail.totalAmount.toFixed(2)))])])])]),i("div",{staticClass:"detailli"},[i("ul",[i("li",[i("span",[t._v("员工编号")]),i("span",[t._v(t._s(t.orderDetail.refuelCashierId))])]),i("li",[i("span",[t._v("员工姓名")]),i("span",[t._v(t._s(t.orderDetail.refuelCashierName))])]),t.source||"offline"==t.source?t._e():i("li",[i("span",[t._v("asn加油卡序列号")]),i("span",[t._v(t._s(t.orderDetail.refuelCardNo))])])])]),i("div",{staticClass:"detailli"},[i("ul",[i("li",[i("span",[t._v("加油时间")]),i("span",[t._v(t._s(t.orderDetail.submitTime))])]),i("li",[i("span",[t._v("油品")]),i("span",[t._v(t._s(t.orderDetail.refuelOilName))])]),i("li",[i("span",[t._v("实付金额")]),i("span",[t._v("¥"+t._s(t.orderDetail.payAmount.toFixed(2)))])]),t.source||"offline"==t.source?t._e():i("li",[i("span",[t._v("优惠抵扣金额")]),i("span",[t._v("¥"+t._s(t.discountAmountCom))])])])]),i("div",{staticClass:"evaluation"},[2==t.$store.state.globalConfig.oil_appraise_type?i("div",[i("div",{staticClass:"question"})]):t._e()]),i("van-popup",{staticClass:"eva-con",attrs:{closeable:""},model:{value:t.hasPrizeFlag,callback:function(e){t.hasPrizeFlag=e},expression:"hasPrizeFlag"}},[i("p",{staticClass:"title"},[t._v("通知")]),i("div",{staticClass:"icon-bg"},[i("div",{staticClass:"conten"},[t._v("您在"+t._s(t.orderDetail.storeName))]),i("div",{staticClass:"conten"},[t._v("加油¥"+t._s(t.orderDetail.payAmount.toFixed(2))+"元")]),i("div",{staticClass:"conten"},[t._v("请对本次服务进行评价！")])]),i("van-button",{staticClass:"btn",attrs:{round:"",type:"info",color:"#F02C2D",size:"small"},on:{click:t.enterEvaluate}},[t._v("去评价")]),t.hasPrize?i("div",[t.prize.length>0&&"20030"!=t.prize[0].prizeType?i("p",[t._v("* 完成评价后有机会获赠"+t._s(t.prize[0].prizeNum)+"张"+t._s(t.prize[0].prizeName)+t._s(t.prize.length>1?"等":""))]):t._e(),t.prize.length>0&&"20030"==t.prize[0].prizeType?i("p",[t._v("* 完成评价后有机会获赠"+t._s(t.prize[0].prizeName)+t._s(t.prize[0].prizeNum)+"次"+t._s(t.prize.length>1?"等":""))]):t._e()]):t._e()],1)]:t._e()],2)},s=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("p",[i("span",[t._v("加油金额")])])}],r=(i("a9e3"),i("fb6a"),i("0d03"),i("4795"),i("e89c")),o={components:{evaluate:r["a"]},data:function(){return{month:"",day:"",hour:"",min:"",second:"",millisecond:"",orderDetail:null,fromPage:"",configId:"",source:"",prize:{},hasPrize:null,hasPrizeFlag:!1}},computed:{discountAmountCom:function(){var t=Number(this.orderDetail.couponAmount)||0,e=Number(this.orderDetail.pointsAmount)||0,i=Number(this.orderDetail.discountAmount)||0,a=Number(this.orderDetail.rewardsAmount)||0,s=Number(this.orderDetail.empRewardsAmount)||0,r=Number(this.orderDetail.enterpriseAmount)||0,o=Number(this.orderDetail.randomDeductionAmount)||0;return t+e+i+a+s+r+o},refuelCardNo:function(){var t=this.orderDetail?this.orderDetail.refuelCardNo:"";return t.slice(-6)||""}},created:function(){this.orderType=this.$route.query.orderType,this.orderId=this.$route.query.orderId,this.fromPage=this.$route.query.fromPage,this.source=this.$route.query.source,1==this.fromPage&&this.counttime(),this._getOrderDetail(),2==this.$store.state.globalConfig.oil_appraise_type&&this.getEvaluateOrder()},methods:{enterEvaluate:function(){this.$router.push({path:"/evaluateList"})},goEvaluation:function(){this.$router.push({path:"/service/questionlist",query:{id:this.configId,orderId:this.orderDetail.refuelOrderId}})},backEvent:function(){this.$router.go(-1)},counttime:function(){var t=new Date;this.month=t.getMonth()+1,this.day=t.getDate(),this.hour=t.getHours(),this.min=this.padZero(t.getMinutes()),this.second=this.padZero(t.getSeconds()+1),this.millisecond=this.padZero(t.getMilliseconds(),3);var e=this;clearTimeout(this.timer),this.timer=setTimeout((function(){e.counttime()}),1)},_getOrderDetail:function(){var t=this;this.$Loading.open();var e="/app/json/refuel_center/detail",i={token:this.$store.state.login.token,orderType:this.orderType,orderId:this.orderId};this.$http.post(e,i).then((function(e){t.$Loading.close();var i=e.data;0==i.status?t.orderDetail=i.data:t.$Toast(i.info)}),(function(e){t.$Loading.close(),t.$Toast("请求数据失败！")}))},getEvaluateOrder:function(t){var e=this;if(""!=this.$store.state.login.token){var i={token:this.$store.state.login.token},a="/app/json/questionaire/getLatestAppraise";this.$http.post(a,i).then((function(t){var i=t.data;0==i.status?(e.hasPrize=i.data.hasPrize,e.hasPrizeFlag=!0,i.data.questionPrize&&(e.prize=JSON.parse(i.data.questionPrize))):e.$Toast("网络加载较慢，请稍后重试!")}),(function(t){}))}},padZero:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=t+"";return("0000".substr(0,e)+i).substr(i.length)}}},n=o,l=(i("c809"),i("0c7c")),u=Object(l["a"])(n,a,s,!1,null,"3bd9ecda",null);e["default"]=u.exports},"4c53":function(t,e,i){"use strict";var a=i("23e7"),s=i("857a"),r=i("af03");a({target:"String",proto:!0,forced:r("sub")},{sub:function(){return s(this,"sub","","")}})},"6ae0":function(t,e,i){},"797f":function(t,e,i){"use strict";var a="/app/json/questionaire/startAnswer",s="/app/json/questionaire/appUserConfig",r="/app/json/questionaire/submit",o="/app/json/questionaire/completeAct",n="/app/json/questionaire/findQuestionaireByuserId",l="/app/json/questionaire/historyQuestionaireList",u="/app/json/questionaire/questionaireDetail";e["a"]={methods:{participateData:function(t){return this.$http.post(a,t)},questionData:function(t){return this.$http.post(s,t)},commitData:function(t){return this.$http.post(r,t)},prizeData:function(t){return this.$http.post(o,t)},listData:function(t){return this.$http.post(n,t)},historyData:function(t){return this.$http.post(l,t)},historydetailData:function(t){return this.$http.post(u,t)}}}},c809:function(t,e,i){"use strict";i("f0365")},e89c:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"title"},[t._v("请您提出意见，我们将持续改进与提升")]),t._l(t.answerList,(function(e,a){return i("div",{key:a,staticClass:"top"},[6===e.kindId?i("div",{staticClass:"singleList score"},[i("div",{staticClass:" score-con"},[i("label",{staticClass:"title-con"},[t._v(t._s(e.title))]),i("div",{staticClass:"evaluteBox"},[1===e.styleType?i("van-rate",{attrs:{color:"#ffd21e","void-icon":"star"},on:{change:function(e){return t.evaluateData(a,e)}},model:{value:e.result,callback:function(i){t.$set(e,"result",i)},expression:"item.result"}}):t._e(),2===e.styleType?i("van-rate",{attrs:{color:"#25aff8",icon:"like","void-color":"#25aff8","void-icon":"like-o"},on:{change:function(e){return t.evaluateData(a,e)}},model:{value:e.result,callback:function(i){t.$set(e,"result",i)},expression:"item.result"}}):t._e(),3===e.styleType?i("van-rate",{attrs:{color:"#25aff8",icon:"static/image/microShop/xiaoicon.png","void-color":"#25aff8","void-icon":"smile-o"},on:{change:function(e){return t.evaluateData(a,e)}},model:{value:e.result,callback:function(i){t.$set(e,"result",i)},expression:"item.result"}}):t._e(),i("p",[t._v(t._s(e.evaluate))])],1)])]):t._e(),1===e.kindId?i("div",{staticClass:"singleList"},[i("div",{staticClass:"divObj"},[i("span",{staticClass:"wall-title"},[t._v(t._s(e.orderNo)+"、"+t._s(e.title))]),i("van-radio-group",{on:{change:t.changeResult},model:{value:e.result,callback:function(i){t.$set(e,"result",i)},expression:"item.result"}},t._l(e.options,(function(e,a){return i("van-radio",{key:a,attrs:{"checked-color":"#25aff8",name:t.optionsObj[a]}},[t._v(t._s(t.optionsObj[a])+" 、"+t._s(e.lable)+" ")])})),1)],1)]):t._e(),2===e.kindId?i("div",{staticClass:"singleList che-con multipleList"},[i("div",{staticClass:" "},[i("span",{staticClass:"wall-title"},[t._v(t._s(e.orderNo)+"、"+t._s(e.title))]),i("div",{staticClass:"checkItem-con"},t._l(e.options,(function(a,s){return i("van-button",{key:s,staticClass:"btn-con",class:a.flag?"select":"",attrs:{round:"",type:"default",size:"small"},on:{click:function(i){return t.selectO(e.options,e,s)}}},[t._v(t._s(a.lable))])})),1)])]):t._e(),5===e.kindId?i("div",{staticClass:"singleList"},[i("div",{staticClass:"divObj divObj1"},[e.limitMin&&!e.limitMax?i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.result,expression:"item.result"}],staticClass:"textType",staticStyle:{"min-height":"90px"},attrs:{placeholder:t.placeHolder?t.placeHolder:"对其他方面不满意，可描述问题帮加油站改善哦～"},domProps:{value:e.result},on:{input:function(i){i.target.composing||t.$set(e,"result",i.target.value)}}}):t._e(),e.limitMax&&!e.limitMin?i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.result,expression:"item.result"}],staticClass:"textType",staticStyle:{"min-height":"90px"},attrs:{placeholder:t.placeHolder?t.placeHolder:"对其他方面不满意，可描述问题帮加油站改善哦～"},domProps:{value:e.result},on:{input:function(i){i.target.composing||t.$set(e,"result",i.target.value)}}}):t._e(),e.limitMin&&e.limitMax?i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.result,expression:"item.result"}],staticClass:"textType",staticStyle:{"min-height":"90px"},attrs:{placeholder:t.placeHolder?t.placeHolder:"对其他方面不满意，可描述问题帮加油站改善哦～"},domProps:{value:e.result},on:{input:function(i){i.target.composing||t.$set(e,"result",i.target.value)}}}):t._e(),e.limitMin||e.limitMax?t._e():i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.result,expression:"item.result"}],staticClass:"textType",staticStyle:{"min-height":"90px"},attrs:{placeholder:t.placeHolder?t.placeHolder:"对其他方面不满意，可描述问题帮加油站改善哦～"},domProps:{value:e.result},on:{input:function(i){i.target.composing||t.$set(e,"result",i.target.value)}}})])]):t._e(),7===e.kindId?i("div",{staticClass:"singleList text-con"},[i("div",{staticClass:"lin-con"}),i("div",{},[i("span",{staticClass:"wall-title"},[t._v(t._s(e.title))]),i("van-field",{staticStyle:{width:"100%",background:"white",border:"1px solid #ccc","border-radius":"8px"},attrs:{rows:"2",autosize:"",maxlength:e.limitMax||100,type:"textarea",placeholder:"亲，您对加油站的评价，是我们更好服务的动力哦！","show-word-limit":""},model:{value:e.result,callback:function(i){t.$set(e,"result",i)},expression:"item.result"}})],1)]):t._e(),4===e.kindId?i("div",{staticClass:"singleList"},[i("div",{staticClass:"divObj"},[i("span",{staticClass:"wall-title"},[t._v(t._s(e.orderNo)+"、"+t._s(e.title))]),i("div",{staticClass:"xiala",on:{click:function(i){return t.select1(e)}}},[i("span",[t._v(t._s(e.result||"请选择"))]),i("span",{staticClass:"icon iconfont mall-xiala"})]),i("van-action-sheet",{attrs:{id:"xialaView",actions:e.options},on:{select:function(i){return t.onSelect(i,e)}},model:{value:e.show,callback:function(i){t.$set(e,"show",i)},expression:"item.show"}})],1)]):t._e(),3===e.kindId?i("div",{staticClass:"singleList"},[i("div",{staticClass:"divObj"},[i("span",{staticClass:"wall-title"},[t._v(t._s(e.orderNo)+"、"+t._s(e.title))]),t._l(e.options,(function(a,s){return i("div",{key:s,staticClass:"pics"},[i("div",[i("span",[t._v(t._s(t.optionsObj[s])+"、")]),i("img",{attrs:{src:a.imgUrl,alt:""}})]),i("div",[i("van-radio-group",{model:{value:e.result,callback:function(i){t.$set(e,"result",i)},expression:"item.result"}},[i("van-radio",{attrs:{"checked-color":"#25aff8",name:t.optionsObj[s]}},[t._v(t._s(a.lable)+" ")])],1)],1)])}))],2)]):t._e()])})),t.answerList.length>0?i("div",{staticClass:"handler"},[i("van-button",{staticClass:"btn",attrs:{round:"",type:"info",color:"#F02C2D"},on:{click:t.commit}},[t._v("提交")]),t.hasPrize?i("div",[t.prize.length>0&&"20030"!=t.prize[0].prizeType?i("p",[t._v("* 完成评价后可获赠"+t._s(t.prize[0].prizeName))]):t._e(),t.prize.length>0&&"20030"==t.prize[0].prizeType?i("p",[t._v("* 完成评价后可获赠"+t._s(t.prize[0].prizeName)+"参与次数"+t._s(t.prize[0].prizeNum))]):t._e()]):t._e()],1):t._e(),i("van-popup",{attrs:{"close-on-click-overlay":!1},model:{value:t.commitModel,callback:function(e){t.commitModel=e},expression:"commitModel"}},[i("div",{staticClass:"modal"},[i("p",{staticClass:"title-p"},[i("span",[t._v("成功提交问券")]),t.showFlag1?i("span",[t._v("恭喜您获得以下奖品")]):t._e()]),t.showFlag1?i("ul",t._l(t.mktAwardList,(function(e,a){return i("li",{key:a},[i("img",{attrs:{src:e.prizeImgUrl?e.prizeImgUrl:"static/image/microShop/icon52x.png",alt:""}}),i("span",[t._v(t._s(e.prizeName)+"("+t._s(e.prizeNum)+")")]),i("span",{on:{click:function(i){return t.seeView(e.prizeType,e.prizeCode)}}},[t._v("查看")])])})),0):t._e(),t.toEvaluatedNum?i("div",{staticClass:"order"},[i("div",{staticStyle:{"margin-top":"10px"}},[t._v("您在最近"+t._s(t.limitOrderDayNum)+"天内还有"+t._s(t.toEvaluatedNum)+"条待评价订单 ")])]):t._e()]),i("div",{staticClass:"btns"},[i("span",{staticClass:"theme_bg_red",on:{click:t.closeBtn}},[t._v(t._s(t.toEvaluatedNum?"继续评价":"确定"))])])])],2)},s=[],r=(i("e7e5"),i("d399")),o=(i("4160"),i("159b"),i("c975"),i("4c53"),i("0d03"),i("d3b7"),i("25f0"),i("b0c0"),i("797f")),n={props:["detail"],name:"",mixins:[o["a"]],components:{},data:function(){return{answerList:[],randomId:null,commitModel:!1,showFlag1:!1,mktAwardList:[],prize:{},hasPrize:null,toEvaluatedNum:null,limitOrderDayNum:null}},computed:{placeHolder:function(){var t=this,e=null;return this.answerList.length>0&&this.answerList.forEach((function(i,a){5==i.kindId&&(e=JSON.parse(t.answerList[a].options)[0].placeHolder)})),e}},methods:{seeView:function(t,e){var i="";if("20030"==t)this.$market.enterGamesFunc({gameTypeCode:e},!0);else if("20010"==t)i="/usercenter/rebatebonus";else if("20020"==t)i="/mall2/integralinfo";else if("20001"==t&&(i=this.$store.state.globalConfig.questionaire_prize_coupon_list||"/coupon_list",-1!=i.indexOf("uhuitong.com")))return void this.$market.enterNav({link:{type:"3",url:i,useOldProtocal:!0}});this.$router.push({path:i,query:{}})},evaluateData:function(t,e){var i=this.answerList[t];1==i.result?i.evaluate="非常差":2==i.result?i.evaluate="差":3==i.result?i.evaluate="一般":4==i.result?i.evaluate="满意":5==i.result&&(i.evaluate="非常满意")},closeBtn:function(){this.toEvaluatedNum>0?(this.commitModel=!0,this.$router.push({path:"/evaluatelist"})):this.commitModel=!1},commit:function(){this.sub()},sub:function(){var t=this,e=this,i=[];e.answerList.forEach((function(t){i.push({kindId:t.kindId,configId:t.configId,subjectId:t.id,kindName:t.kindName,options:t.options,title:t.title,styleType:t.styleType,orderNo:e.detail.marketOrderNo,result:t.result?t.result.toString():""})}));var a=!0;if(e.answerList.forEach((function(t){1==t.mustAnswer&&""==t.result&&(a=!1)})),a){var s=!0;if(e.answerList.forEach((function(t,i){5==t.kindId&&(t.limitMin&&!t.limitMax&&t.result.length<t.limitMin&&(e.tip="第"+(i+1)+"题简答题最少输入"+t.limitMin+"个字",s=!1),t.limitMax&&!t.limitMin&&t.result.length>t.limitMax&&(e.tip="第"+(i+1)+"题简答题最多输入"+t.limitMax+"个字",s=!1),t.limitMin&&t.limitMax&&(t.result.length>=t.limitMin&&t.result.length<=t.limitMax?s=!0:(e.tip="第"+(i+1)+"题简答题字数限制在"+t.limitMin+"至"+t.limitMax+"之间",s=!1)))})),s){e.$Loading.open();var o=Object.assign({resultJson:JSON.stringify(i),id:e.details.id,orderId:e.detail.marketOrderNo});e.commitData(o).then((function(i){if(e.$Loading.close(),"success"===i.data.result){Object(r["a"])("提交成功");var a={id:e.details.id,orderId:e.detail.marketOrderNo};e.$Loading.open(),e.prizeData(a).then((function(i){e.$Loading.close(),"success"===i.data.result?(e.mktAwardList=i.data.data.mktAwardList||[],e.mktAwardList.length>0?t.showFlag1=!0:t.showFlag1=!1,t.getEvaluateOrder()):(e.commitModel=!1,e.$router.go(-1))}))}else Object(r["a"])(i.data.info)}))}else Object(r["a"])(e.tip)}else Object(r["a"])("您还有必答题尚未答完，请先答完必答题！")},getEvaluateOrder:function(t){var e=this;if(""!=this.$store.state.login.token){var i={token:this.$store.state.login.token},a="/app/json/questionaire/getLatestAppraise";this.$http.post(a,i).then((function(i){var a=i.data;0==a.status?(e.limitOrderDayNum=a.data.limitOrderDayNum,e.toEvaluatedNum=a.data.toEvaluatedNum,t||(e.toEvaluatedNum>0||1==e.showFlag1?e.commitModel=!0:e.commitModel=!1),e.hasPrize=a.data.hasPrize):e.$Toast("网络加载较慢，请稍后重试!")}),(function(t){}))}},loadData:function(){var t=this;this.randomId=Math.random().toString(36).substr(2);var e=this,i={orderId:this.detail.marketOrderNo};e.$http.post("/app/json/questionaire/getDefaultConfig",i).then((function(i){if("success"===i.data.result){t.details=i.data.data,t.getQuest(),t.prize=JSON.parse(i.data.data.questionPrize);var a=JSON.parse(i.data.data.subjectJson);e.userId=i.data.data.userId;i.data.data.questionShare&&JSON.parse(i.data.data.questionShare);a.forEach((function(t){if(t.show=!1,1===t.kindId||2===t.kindId||3===t.kindId||4===t.kindId){var e=JSON.parse(t.options);e.forEach((function(t){t.name=t.lable})),t.options=e}2===t.kindId?t.result=[]:6===t.kindId?t.result=0:(t.result="",4===t.kindId&&(t.show=!1))})),a.forEach((function(t){t.evaluate="",t.tips=""})),e.answerList=JSON.parse(JSON.stringify(a)),e.answerList.forEach((function(t,i,a){2==t.kindId&&t.options.forEach((function(t,a,s){e.$set(e.answerList[i].options[a],"flag",!1)}))})),e.shareTitle=i.data.data.shareTitle,e.shareContent=i.data.data.shareContent,e.shareImgUrl=i.data.data.shareImgUrl}}))},getQuest:function(){var t=this,e={id:this.details.id,orderId:this.detail.marketOrderNo,ouCode:this.detail.storeOuCode};this.$http.post("/app/json/questionaire/startAnswer",e).then((function(e){t.$Loading.close(),e.data.result}))}},created:function(){this.loadData(),this.getEvaluateOrder(!0)}},l=n,u=(i("1787"),i("0c7c")),c=Object(u["a"])(l,a,s,!1,null,"9100ab4a",null);e["a"]=c.exports},f0365:function(t,e,i){}}]);