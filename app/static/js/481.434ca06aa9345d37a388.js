(window.webpackJsonp=window.webpackJsonp||[]).push([[481],{"0snt":function(t,s,i){t.exports=i.p+"static/img/jyq-icon-2.c9b858a.png"},"2wRi":function(t,s,i){t.exports=i.p+"static/img/top-bg.9972178.png"},"4q4R":function(t,s,i){"use strict";var a=i("FBIn");i.n(a).a},FBIn:function(t,s,i){},w0PA:function(t,s,i){"use strict";i.r(s);var a=i("p46w"),o=i.n(a),n={name:"station-detail",components:{},data:function(){return{jyCouponList:[],jfhqCouponList:[],station:null,couponDetail:{},nowTop:0,isUp:!1}},methods:{submitOrder:function(t){var s=this,i={},a=[{skuId:t.skuId,storeOuCode:t.storeOuCode,number:1,checked:1,isGift:0}];i.deliveryType="2",i.virtualUserPhone=this.$store.state.userInfo.phone,i.orderScene=this.$util.orderScene(),i.carts=a,this.$Loading.open(),this.$http.post("/app/json/fee_life_order/submit",i).then((function(t){s.$Loading.close();var i=t.data,a=i.data||{};0==i.status?s.$market.payEvent({payMode:305,payModeSub:305005},a.orderType,a.orderId).then((function(){o.a.set("icbc_tradeNo",a.tradeNo)})).catch((function(){s.$Toast("支付失败！")})):s.$Toast(i.info)}),(function(t){s.$Loading.close(),s.$Toast("请求数据失败！")}))},submitExchangeOrder:function(t){var s=this,i={exchangeDetailId:t.id};this.$Loading.open(),this.$http.post("/app/json/app_exchange/submitExchangeOrder",i).then((function(t){s.$Loading.close();var i=t.data,a=i.data||{};0==i.status?s.$market.doPay({payMode:305,payModeSub:305007},i.data.payInfo).then((function(){o.a.set("icbc_tradeNo",a.tradeNo)})).catch((function(){s.$Toast("支付失败！")})):s.$Toast(i.info)}),(function(t){s.$Loading.close(),s.$Toast("请求数据失败！")}))},resultHand:function(t,s){this.$Loading.close(),"1"==t?this.$router.replace({path:"/icbc/success",query:{orderType:s.orderType,orderId:s.id,fromPage:1}}):this.$Toast("支付失败！")},buyCouponEvent:function(t){this.$router.push({path:"/icbc/coupondetail",query:{couponData:JSON.stringify(t)}})},buyCouponEvent2:function(t){this.$router.push({path:"/icbc/coupondetail",query:{type:2,couponData:JSON.stringify(t)}})},setStationDetail:function(t){this.station=t},getJFCouponList:function(){var t=this,s={longitude:this.$store.state.currentLocation.posx,latitude:this.$store.state.currentLocation.posy};this.$Loading.open(),this.$http.post("/app/json/app_exchange/queryExchangeDetailList",s).then((function(s){t.$Loading.close();var i=s.data;0===i.status?t.jfhqCouponList=i.data:t.$Toast(i.info)}),(function(s){t.$Loading.close(),t.$Toast("系统运行过程中遇到问题，请稍候再试")}))},getJYCouponList:function(){var t=this,s={productType:"513",page:1,rows:20};s.area={provinceId:this.$store.state.indexData.provinceId,cityId:this.$store.state.indexData.cityId},this.$Loading.open(),this.$http.post("/app/json/product/getAppProSearchList",s).then((function(s){t.$Loading.close();var i=s.data;0===i.status?t.jyCouponList=i.data.list:t.$Toast(i.info)}),(function(s){t.$Loading.close(),t.$Toast("系统运行过程中遇到问题，请稍候再试")}))},getJYCouponInfo:function(){var t=this,s={userId:this.$store.state.userInfo.userId};this.$Loading.open(),this.$http.post("/app/json/djljy/router?m=getAccount",s).then((function(s){t.$Loading.close();var i=s.data;0===i.status?t.couponDetail=JSON.parse(i.data).walletObj:t.$Toast(i.info)}),(function(s){t.$Loading.close(),t.$Toast("系统运行过程中遇到问题，请稍候再试")}))},backEvent:function(){this.$router.go(-1)}},mounted:function(){var t=this;this.setStationDetail(JSON.parse(this.$route.query.station)),this.$nextTick((function(){t.domHeight=document.documentElement.clientHeight,t.nowTop=.7*t.domHeight})),this.getJFCouponList(),this.getJYCouponInfo()}},e=(i("4q4R"),i("KHd+")),c=Object(e.a)(n,(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"station-detail"},[a("nav-top",{attrs:{bgImg:i("2wRi")},on:{backEvent:t.backEvent}}),t._v(" "),a("nav-content",[a("div",{ref:"StationDetail",staticClass:"station-detail"},[a("div",{staticClass:"station-detail-info"},[t.station?a("div",{staticClass:"station-detail-info-content"},[a("div",{staticClass:"local-detail"},[a("div",{staticClass:"img-div"},[a("img",{attrs:{src:"static/images/esh-nearstation/logo.png"}})]),t._v(" "),a("div",{staticClass:"info-div"},[a("div",{staticClass:"row"},[a("div",{staticClass:"title single-line"},[t._v(t._s(t.station.name))]),t._v(" "),t.station.distance<500?a("div",{staticClass:"yz-btn"},[a("img",{attrs:{src:"static/images/esh-nearstation/jzjy.png"}}),t._v(" "),a("span",[t._v("进站加油")])]):a("div",{staticClass:"yz-btn"},[a("img",{staticClass:"dhdz",attrs:{src:"static/images/esh-nearstation/dhdz.png"}}),t._v(" "),a("span",[t._v("导航到站")])])]),t._v(" "),a("div",{staticClass:"row1"},[a("div",{staticClass:"dw"},[a("img",{attrs:{src:"static/images/esh-nearstation/dw2.png",alt:""}})]),t._v(" "),a("div",{staticClass:"address double-line"},[t._v(t._s(t.station.address))]),t._v(" "),t.station.distance>1e3?a("div",{staticClass:"distance"},[t._v("\n                  距您"+t._s(t.$util.toDecimal2(t.station.distance/1e3))+"km\n                ")]):a("div",{staticClass:"distance"},[t._v("\n                  距您"+t._s(t.station.distance)+"m\n                ")])])])]),t._v(" "),a("div",{staticClass:"block",on:{click:function(s){return t.$router.push({path:"/icbc/oilcoupon",query:{noDetail:!0}})}}},[a("div",{staticClass:"icon"},[a("img",{attrs:{src:i("0snt")}})]),t._v(" "),a("div",{staticClass:"title"},[t._v("电子加油券")]),t._v(" "),a("div",{staticClass:"right"},[a("div",{staticClass:"amount"},[t._v("¥"+t._s(t.$util.toDecimal2(t.couponDetail.totalAmount)))]),t._v(" "),a("div",{staticClass:"btn line_circle"},[t._v("立即加油")])])])]):t._e(),t._v(" "),a("div",{staticClass:"coupon-list-group"},[t.station&&t.jfhqCouponList.length>0?a("div",{staticClass:"jfhq-div",class:{"jfhq-div-1":t.isUp}},[a("div",{staticClass:"title"},[t._v("积分换券")]),t._v(" "),t._l(t.jfhqCouponList,(function(s){return a("div",{staticClass:"coupon",on:{click:function(i){return t.buyCouponEvent2(s)}}},[a("div",{staticClass:"mianer"},[a("span",[t._v("¥")]),t._v(" "),a("span",{staticClass:"big"},[t._v(t._s(t.$util.toDecimal2(s.couType.couFaceValue)))])]),t._v(" "),a("div",{staticClass:"cou-info"},[a("div",{staticClass:"cou-title double-line"},[t._v(t._s(s.couType.couTypeTitle))]),t._v(" "),a("div",{staticClass:"cou-time"},[t._v("有效期："+t._s(s.couType.validDays)+"天")])]),t._v(" "),a("div",{staticClass:"right"},[a("div",{staticClass:"text"},[t._v("消耗积分")]),t._v(" "),a("div",{staticClass:"points"},[t._v(t._s(s.exchangeUnit))]),t._v(" "),a("div",{staticClass:"btn",on:{click:function(i){return i.stopPropagation(),t.submitExchangeOrder(s)}}},[t._v("立即兑换")])])])}))],2):t._e(),t._v(" "),t.jyCouponList.length>0&&t.station?a("div",{staticClass:"jyq-div",class:{"jyq-div-1":t.isUp}},[a("div",{staticClass:"title"},[t._v("抢券加油")]),t._v(" "),t._l(t.jyCouponList,(function(s){return a("div",{staticClass:"coupon",on:{click:function(i){return t.buyCouponEvent(s)}}},[a("div",{staticClass:"mianer"},[a("p",{staticClass:"big"},[t._v("加油券")]),t._v(" "),s.stockNum?a("p",{staticClass:"number"},[t._v("剩余"+t._s(s.stockNum>=100?"99+":s.stockNum)+"张")]):a("p",{staticClass:"number"},[t._v("剩余99+张")])]),t._v(" "),a("div",{staticClass:"cou-info"},[a("div",{staticClass:"cou-title double-line"},[t._v(t._s(s.showTitle))]),t._v(" "),a("div",{staticClass:"cou-time"},[t._v("有效期：180天")])]),t._v(" "),a("div",{staticClass:"right"},[a("div",{staticClass:"price"},[t._v("¥"+t._s(s.activityPrice))]),t._v(" "),a("div",{staticClass:"text"},[t._v("¥"+t._s(s.salePrice))]),t._v(" "),a("div",{staticClass:"btn",on:{click:function(i){return i.stopPropagation(),t.submitOrder(s)}}},[t._v("立即购买")])])])}))],2):t._e()])])])])],1)}),[],!1,null,"dc92a290",null);s.default=c.exports}}]);