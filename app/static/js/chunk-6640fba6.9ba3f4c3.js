(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6640fba6"],{"08b4":function(t,a,e){"use strict";e("72ba")},"199c":function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("van-popup",{staticClass:"protocol-modal",attrs:{position:"bottom","close-on-click-overlay":!1},model:{value:t.isShowProModal,callback:function(a){t.isShowProModal=a},expression:"isShowProModal"}},[e("p",{staticClass:"title"},[t._v(t._s(t.protocolData.title))]),e("div",{staticClass:"content",domProps:{innerHTML:t._s(t.protocolData.content)}}),e("div",{staticClass:"btm-btn"},[e("van-button",{staticClass:"btn",attrs:{round:"",type:"default"},on:{click:t.disagreeHandler}},[t._v("不同意")]),e("van-button",{staticClass:"btn",attrs:{round:"",color:"linear-gradient(270deg,rgba(49,49,49,1) 0%,rgba(84,84,84,1) 51%,rgba(49,49,49,1) 100%)",type:"info"},on:{click:t.agreeHandler}},[t._v("同意 ")])],1)])],1)},n=[],s={name:"member-protocol",model:{prop:"isShowProModal",event:"change"},props:{isShowProModal:Boolean},data:function(){return{protocolData:{title:"",content:""}}},mounted:function(){this.initProtocol()},methods:{initProtocol:function(){var t=this;this.$http.post("/app/json/news/getNewsList?values=55").then((function(a){var e=a.data;0==e.status?t.protocolData=e.data[0]||{}:t.$Toast(e.info)}))["catch"]((function(a){t.$Toast("getNewsList err ".concat(a))}))},agreeHandler:function(){this.$emit("change",!1),this.$emit("getProtocolResult",!0)},disagreeHandler:function(){this.$emit("change",!1),this.$emit("getProtocolResult",!1)}}},o=s,r=(e("9aab"),e("0c7c")),c=Object(r["a"])(o,i,n,!1,null,"37c3240e",null);a["a"]=c.exports},"68ad":function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[t.hasNavTop?e("nav-top",{attrs:{noBack:t.noBack},on:{backEvent:function(a){return t.$router.go(-1)}}}):t._e(),e("nav-content",{staticClass:"container",style:{top:t.computedTop()+"px"}},[e("van-tabs",{attrs:{color:"#C9A063","title-active-color":"#C9A063"},on:{click:t.changeTabs},model:{value:t.activeTab,callback:function(a){t.activeTab=a},expression:"activeTab"}},[e("van-tab",{attrs:{title:"未激活"}}),e("van-tab",{attrs:{title:"生效中"}}),e("van-tab",{attrs:{title:"已赠送"}}),e("van-tab",{attrs:{title:"已过期"}})],1),0==t.activeTab?e("div",{staticClass:"exchange-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.dynamicCode,expression:"dynamicCode"}],staticClass:"enter-input",attrs:{type:"text",placeholder:"请输入兑换码领取会员卡"},domProps:{value:t.dynamicCode},on:{input:function(a){a.target.composing||(t.dynamicCode=a.target.value)}}}),e("van-button",{staticClass:"exchange-btn",attrs:{type:"primary",color:"linear-gradient(270deg,rgba(49,49,49,1) 0%,rgba(84,84,84,1) 51%,rgba(49,49,49,1) 100%)"},on:{click:t.exchangeHandler}},[t._v("领取 ")])],1):t._e(),e("div",{ref:"cardList",staticClass:"card-list",style:{top:0==t.activeTab?"112px":"45px"}},[e("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",offset:200},on:{load:t.loadMore},model:{value:t.isLoading,callback:function(a){t.isLoading=a},expression:"isLoading"}},[0!==t.cardList.length?e("ul",{staticClass:"card-c"},t._l(t.cardList,(function(a,i){return e("li",{key:i,staticClass:"item"},[e("PublicCard",{attrs:{cardData:a},on:{resultHandler:t.cardFeatures}})],1)})),0):t._e()])],1)],1),e("MemberProtocol",{on:{getProtocolResult:t.getProtocolResult},model:{value:t.isShowProModal,callback:function(a){t.isShowProModal=a},expression:"isShowProModal"}})],1)},n=[],s=(e("e17f"),e("2241")),o=e("2909"),r=e("5530"),c=(e("a9e3"),e("a78e")),d=e.n(c),l=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"card-container"},[i("div",{staticClass:"top",style:{"background-image":"url("+t.cardData.backgroundPic+")"},on:{click:t.cardClick}},[i("p",{staticClass:"card-name"},[t._v(t._s(t.cardData.equityCardName))]),i("div",{staticClass:"top-b-info"},[1==t.cardData.validityType?i("p",{staticClass:"expiration-date"},[t._v("有效期：永久有效")]):2==t.cardData.equityCardState||3==t.cardData.equityCardState||0==t.cardData.equityCardState&&2==t.cardData.validityType?i("p",{staticClass:"expiration-date"},[t._v("自激活之日起："+t._s(t.cardData.days)+"天内有效")]):2==t.cardData.equityCardState||3==t.cardData.equityCardState||0==t.cardData.equityCardState&&3==t.cardData.validityType?i("p",{staticClass:"expiration-date"},[t._v("有效期："+t._s(t.dealWithTime(t.cardData.activeTime))+"至"+t._s(t.dealWithTime(t.cardData.invalidTime)))]):i("p",{staticClass:"expiration-date"},[t._v("有效期至："+t._s(t.dealWithTime(t.cardData.invalidTime)))]),i("p",{staticClass:"card-no"},[t._v("NO."+t._s(t.cardData.equityCardCode))])]),4==t.cardData.receiveType?i("span",{staticClass:"tips"},[t._v("好友赠送")]):t._e(),4==t.cardData.equityCardState?i("img",{staticClass:"expired-icon",attrs:{src:e("9fb5"),alt:""}}):t._e()]),4!=t.cardData.equityCardState?i("div",{staticClass:"bottom"},[4!=t.cardData.receiveType&&0==t.cardData.equityCardState?i("div",{staticClass:"btn-container"},[i("van-button",{staticClass:"func-btn",attrs:{round:"",plain:"",hairline:"",type:"default"},on:{click:t.handsel}},[t._v("赠送")]),i("van-button",{staticClass:"func-btn",attrs:{round:"",plain:"",hairline:"",type:"danger"},on:{click:t.activation}},[t._v("激活")])],1):4==t.cardData.receiveType&&0==t.cardData.equityCardState?i("div",{staticClass:"btn-container"},[i("van-button",{staticClass:"func-btn",attrs:{round:"",plain:"",hairline:"",type:"danger"},on:{click:t.activation}},[t._v("激活")])],1):1==t.cardData.equityCardState?i("div",{staticClass:"btn-container"},[i("van-button",{staticClass:"func-btn",attrs:{round:"",plain:"",hairline:"",type:"danger"},on:{click:t.goToUse}},[t._v("去使用")])],1):t._e(),3==t.cardData.equityCardState?i("div",{staticClass:"btn-container"},[i("van-button",{staticClass:"func-btn",attrs:{round:"",plain:"",hairline:"",type:"default"},on:{click:t.cancelGift}},[t._v("取消赠送")]),i("van-button",{staticClass:"func-btn",attrs:{round:"",plain:"",hairline:"",type:"danger"},on:{click:t.viewLink}},[t._v("查看链接")])],1):t._e(),2==t.cardData.equityCardState?i("div",{staticClass:"btn-container"},[t.cardData.receiver||t.cardData.receiverPhone?i("span",[t._v(" 领取用户："+t._s(t.cardData.receiver)+"("+t._s(t.cardData.receiverPhone)+") ")]):i("span",[t._v(" 领取用户：暂无~ ")])]):t._e()]):t._e()])},u=[],p=e("c1df"),h=e.n(p),f={props:{cardData:{type:Object,required:!0,default:function(){return{}}}},data:function(){return{}},mounted:function(){},methods:{dealWithTime:function(t){return t?h()(t).format("YYYY-MM-DD"):"-"},handsel:function(){this.$emit("resultHandler",1,this.cardData)},activation:function(){this.$emit("resultHandler",2,this.cardData)},goToUse:function(){this.$emit("resultHandler",3,this.cardData)},cancelGift:function(){this.$emit("resultHandler",4,this.cardData)},viewLink:function(){this.$emit("resultHandler",5,this.cardData)},cardClick:function(){1==this.cardData.equityCardState&&this.$emit("resultHandler",3,this.cardData)}}},v=f,g=(e("08b4"),e("0c7c")),C=Object(g["a"])(v,l,u,!1,null,"68870c90",null),b=C.exports,y=e("199c"),m={data:function(){return{hasNavTop:!1,noBack:!1,activeTab:0,tempActiveTab:0,dynamicCode:"",isLoading:!0,finished:!1,cardList:[],isShowProModal:!1,pageInfo:{page:0,rows:10},cardId:"",scrollPosition:0}},activated:function(){this.$refs.cardList.scrollTop=this.scrollPosition},mounted:function(){var t=this;this.$route.query.noBack&&(this.noBack=!0),1==this.$route.query.hasNavTop&&(this.hasNavTop=!0),void 0!==this.$route.query.entryTab&&(this.activeTab=Number(this.$route.query.entryTab)),this.loadMore(),this.$nextTick((function(){t.$refs.cardList.addEventListener("scroll",(function(a){t.scrollPosition=t.$refs.cardList.scrollTop}))}))},components:{PublicCard:b,MemberProtocol:y["a"]},computed:{isNativeTop:function(){return 1!=d.a.get("isnativetop")},top:function(){return this.isNativeTop?this.$store.state.barHeight+this.$market.getNavHeight():0}},methods:{computedTop:function(){return this.hasNavTop?this.top:0},changeTabs:function(t){this.tempActiveTab!=t&&(this.pageInfo={page:0,rows:10},this.cardList=[],this.isLoading=!0,this.finished=!1,this.activeTab=t,this.tempActiveTab=t,this.loadMore())},exchangeHandler:function(){var t=this;this.dynamicCode&&(this.$Loading.open(),this.$http.post("/app/json/user/getUserCertificateList",{cateType:0}).then((function(a){t.$Loading.close();var e=a.data;0==e.status?e.data?t.receivesCard():t.$router.push({path:"/perfect_information",query:{cardId:e.id}}):t.$Toast(e.info)}))["catch"]((function(a){t.$Loading.close(),t.$Toast("getUserCertificateList err ".concat(a))})))},receivesCard:function(){var t=this;this.$http.post("/app/json/equity_card/receiveBusinessCard",{dynamicCode:this.dynamicCode}).then((function(a){var e=a.data;0==e.status?(t.$Toast("领取成功！"),t.dynamicCode="",t.pageInfo={page:0,rows:10},t.cardList=[],t.isLoading=!0,t.finished=!1,t.loadMore()):t.$Toast(e.info)}))["catch"]((function(a){t.$Toast("receiveBusinessCard err ".concat(a))}))},loadMore:function(){var t=this;this.isLoading=!0,this.pageInfo.page++,this.$Loading.open();var a=Object(r["a"])({equityCardState:this.activeTab},this.pageInfo);3==this.activeTab&&(a.equityCardState=4),this.$http.post("/app/jqGrid/equity_card/myCardBag",a).then((function(a){t.isLoading=!1;var e,i=a.data;0==i.status?i.data instanceof Array?((e=t.cardList).push.apply(e,Object(o["a"])(i.data)),t.cardList.length>=i.totalRecords&&(t.finished=!0)):t.finished=!0:(t.finished=!0,t.$Toast(i.info));t.$Loading.close()}))["catch"]((function(a){t.$Toast("myCardBag err ".concat(a)),t.$Loading.close()}))},getProtocolResult:function(t){t&&this.toActivationCard()},toActivationCard:function(){var t=this;this.$Loading.open(),this.$http.post("/app/json/equity_card/activationCard",{id:this.cardId}).then((function(a){t.$Loading.close();var e=a.data;0==e.status?(t.pageInfo={page:0,rows:10},t.cardList=[],t.isLoading=!0,t.finished=!1,t.loadMore(),s["a"].alert({title:"提示",message:"激活成功！"}).then((function(){}))):t.$Toast(e.info)}))["catch"]((function(a){t.$Loading.close(),t.$Toast("activationCard err ".concat(a))}))},cardFeatures:function(t,a){var e=this;if(1==t)this.$router.push({path:"/verify_sms",query:{equityCardName:a.equityCardName,backgroundPic:a.backgroundPic,userId:a.userId,equityCardId:a.equityCardId,cardId:a.id}});else if(2==t)this.$Loading.open(),this.$http.post("/app/json/user/getUserCertificateList",{cateType:0}).then((function(t){e.$Loading.close();var i=t.data;0==i.status?i.data?(e.isShowProModal=!0,e.cardId=a.id):e.$router.push({path:"/perfect_information",query:{cardId:a.id}}):e.$Toast(i.info)}))["catch"]((function(t){e.$Loading.close(),e.$Toast("getUserCertificateList err ".concat(t))}));else if(3==t)if(5==a.receiveType)this.$router.push({path:"/interest_card_list",query:{equityCardMemberId:a.id}});else{var i=0;this.$router.push({path:"/my_interests",query:{entryType:i,equityCardName:a.equityCardName,equityCardId:a.id}})}else 4==t?s["a"].confirm({title:"提示",message:"确定取消赠送么？"}).then((function(){e.$Loading.open(),e.$http.post("/app/json/equity_card/updateEquityCardState",{equityCardState:0,id:a.id}).then((function(t){e.$Loading.close();var a=t.data;0==a.status?s["a"].alert({title:"说明",message:"取消赠送成功！"}).then((function(){e.cardList=[],e.isLoading=!0,e.finished=!1,e.loadMore()})):s["a"].alert({title:"说明",message:a.info}).then((function(){}))}))["catch"]((function(t){e.$Loading.close(),e.$Toast("giveEquityCard err ".concat(t))}))}))["catch"]((function(){})):5==t&&this.$router.push({path:"/presentation_card",query:{equityCardName:a.equityCardName,backgroundPic:a.backgroundPic,userId:a.userId,equityCardId:a.equityCardId,cardId:a.id}})}},beforeRouteLeave:function(t,a,e){"/verify_sms"!=t.path&&"/perfect_information"!=t.path&&"/my_interests"!=t.path&&"/interest_card_list"!=t.path&&"/presentation_card"!=t.path&&"/perfect_information"!=t.path&&this.$keepaliveHelper.deleteCache(this),e()}},$=m,T=(e("9f8b"),Object(g["a"])($,i,n,!1,null,"0434ad60",null));a["default"]=T.exports},6978:function(t,a,e){},"72ba":function(t,a,e){},"9aab":function(t,a,e){"use strict";e("f123")},"9f8b":function(t,a,e){"use strict";e("6978")},"9fb5":function(t,a,e){t.exports=e.p+"static/images/ae66f5709e9bad784b1eebd8232d67c2.png"},f123:function(t,a,e){}}]);