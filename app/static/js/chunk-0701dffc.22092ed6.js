(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0701dffc","chunk-2d0e24d1","chunk-2d0e24d1"],{"1ee1":function(t,s,e){"use strict";e("7ded")},"2df1":function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",[a("nav-top",{attrs:{title:"历史中奖纪录"},on:{backEvent:t.backEvent}},[t.$store.state.globalConfig.kshop_rewardList_url&&void 0!=t.$store.state.globalConfig.kshop_rewardList_url?a("div",{staticClass:"right-btn theme_font_gray",staticStyle:{right:"0px",height:"44px",top:"0px","padding-right":"10px","font-size":"12px"},on:{click:t.toHistory}},[t._v("历史记录 ")]):t._e()]),a("nav-content",[a("div",{staticClass:"award-list-container"},[a("div",{staticClass:"nav-tab"},t._l(t.navMenu,(function(s,e){return a("div",{staticClass:"nav-tab-item",class:{active:t.curState===s.awardState},on:{click:function(e){return t.nav(s.awardState)}}},[a("span",{staticClass:"text"},[t._v(t._s(s.name))])])})),0),a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],staticClass:"award-list-content",attrs:{"infinite-scroll-disabled":"loading","infinite-scroll-immediate-check":!0,"infinite-scroll-distance":"100"}},[t._l(t.prizeList,(function(s,i){return a("div",{staticClass:"table-view award-item"},[a("div",{staticClass:"table-view-cell"},[3==s.fromType?a("div",{staticClass:"pull-left"},[t._v(t._s(100==s.awardType?"抽奖活动":"领取活动"))]):a("div",{staticClass:"pull-left"},[t._v(t._s(s.gameTypeTitle))]),a("div",{staticClass:"pull-right"},[t._v(t._s(s.createTime))])]),3==s.fromType?a("div",{staticClass:"table-view-cell"},[a("div",{staticClass:"award-body clearfix"},[a("img",{staticClass:"award-img",attrs:{src:s.awardPic?s.awardPic:"static/image/live-stream/gift.png",alt:""}}),a("div",{staticClass:"award-con"},[a("p",{staticClass:"award-name m-ellipsis"},[t._v(t._s(s.awardName)+" "),a("span",{staticClass:"status"},[t._v(t._s(s.awardStateStr))])]),a("p",{staticClass:"award-num"},[t._v("数量："+t._s(s.awardNum))]),s.deliverCheckcode&&5==t.curState?a("p",{staticClass:"award-address"},[s.addressInfo?a("span",[t._v("地址："+t._s(JSON.parse(s.addressInfo).addressFull))]):t._e(),1==s.deliverType?a("span",{staticClass:"edit-btn",on:{click:function(e){return t.showPickupQrcode(s.deliverCheckcode)}}},[t._v("提货码")]):2==s.deliverType&&s.addressInfo?a("span",{staticClass:"edit-btn",on:{click:function(e){return t.modifyAddress(s)}}},[t._v("修改")]):a("span",{staticClass:"edit-btn",on:{click:function(e){return t.modifyAddress(s)}}},[t._v("设置收货地址")])]):t._e()])])]):a("div",{staticClass:"table-view-cell"},[a("div",{staticClass:"award-body clearfix"},[a("img",{staticClass:"award-img",attrs:{src:s.awardPic?s.awardPic:"static/image/live-stream/gift.png",alt:""}}),a("div",{staticClass:"award-con"},[a("p",{staticClass:"award-name m-ellipsis"},[t._v(t._s(s.awardName)+" "),a("span",{staticClass:"status"},[t._v(t._s(s.awardStateStr))])]),a("p",{staticClass:"award-num"},[t._v("数量："+t._s(s.awardNum))]),a("p",{staticClass:"award-address"},[s.addressInfo?a("span",[t._v("地址："+t._s(JSON.parse(s.addressInfo).addressFull))]):t._e(),10!=s.awardState?a("span",{staticClass:"edit-btn",on:{click:function(e){return t.getAddress(s.id,s.deliverType)}}},[t._v(t._s(s.addressInfo?"修改":"设置收货地址"))]):t._e()]),s.addressInfo&&1==JSON.parse(s.addressInfo).chooseDeliverType?a("div",{staticClass:"qr-code",on:{click:function(e){return t.showQrcode(s.id)}}},[a("img",{staticClass:"img",attrs:{src:e("f4c0"),alt:""}})]):t._e()])])])])})),a("div",{staticClass:"tip-data"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.hasMore,expression:"hasMore"}],staticClass:"has-data"},[t._v(" 正在加载 "),a("mt-spinner",{staticClass:"icon",attrs:{size:22,type:"fading-circle"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.hasMore,expression:"!hasMore"}],staticClass:"no-data"},[t._v("已经到底啦~")])])],2)])]),a("van-popup",{attrs:{position:"bottom"},model:{value:t.modelShow,callback:function(s){t.modelShow=s},expression:"modelShow"}},[a("van-picker",{attrs:{"show-toolbar":"",title:"选择提货方式",columns:t.columns},on:{cancel:function(s){t.modelShow=!1},confirm:t.onConfirm}})],1),a("van-popup",{model:{value:t.qrCodeModelShow,callback:function(s){t.qrCodeModelShow=s},expression:"qrCodeModelShow"}},[a("canvas",{ref:"qrcode",staticClass:"qrcode",attrs:{id:"qrcode"}})]),a("van-popup",{staticClass:"pickup-pop",model:{value:t.showPickupCode,callback:function(s){t.showPickupCode=s},expression:"showPickupCode"}},[a("div",{staticClass:"pickup-div"},[a("div",{staticClass:"title"},[t._v("查看提货码")]),a("div",{staticClass:"code-text"},[t._v("提货码："+t._s(t.qrcodeStr))]),a("div",{staticClass:"qrcode-div"},[a("canvas",{attrs:{id:"pickupqrcode"}})]),a("div",{staticClass:"tip"},[t._v("请到任一门店出示此二维码提货")]),a("div",{staticClass:"btn",on:{click:function(s){t.showPickupCode=!1}}},[t._v("知道啦～")])])])],1)},i=[],r=e("5530"),o=(e("99af"),e("7db0"),"/app/json/app_game/queryGameAwardDist"),d={methods:{queryGameAwardDist:function(t){return this.$http.post(o,t)}}},n=e("2f62"),c=e("d055"),l=e.n(c),u={name:"",mixins:[d],data:function(){return{showPickupCode:!1,loading:!1,hasMore:!0,page:0,curId:"",deliverType:"",fromType:"",prizeList:[],navMenu:[{name:"未领取",awardState:5},{name:"已领取",awardState:10}],curState:5,modelShow:!1,columns:[{text:"自提",deliverType:1},{text:"配送",deliverType:2}],qrCodeModelShow:!1,qrcodeStr:""}},mounted:function(){this.loadMore()},methods:{showPickupQrcode:function(t){this.qrcodeStr=t,this.showPickupCode=!0,this.$nextTick((function(){l.a.toCanvas(document.getElementById("pickupqrcode"),t+"",{width:160})}))},toHistory:function(){var t=this;this.$Loading.open();var s=this.$store.state.globalConfig.kshop_rewardList_url,e="/app/json/login/redirectToKShop",a={redirectUrl:s};this.$http.post(e,a).then((function(s){t.$Loading.close();var e=s.data;if(0==e.status){var a=e.data;t.$bridgefunc.customPush({path:a,isnativetop:"1"},!1)}else t.$Toast(e.info)}),(function(s){t.$Loading.close(),t.$Toast("请求数据失败！")}))},backEvent:function(){"subject"==this.$route.query.type?this.$router.push({path:"/questionlist"}):"serviceSubject"==this.$route.query.type?this.$router.push({path:"/service/questionlist"}):this.$router.go(-1)},nav:function(t){this.curState!==t&&(this.curState=t,this.page=0,this.loading=!1,this.hasMore=!0,this.prizeList=[],this.loadMore())},loadMore:function(){var t=this;this.$Loading.open(),this.page++,this.loading=!0;var s={awardState:this.curState,page:this.page,rows:12,token:this.$store.state.login.token};this.queryGameAwardDist(s).then((function(s){var e=s.data;"success"==e.result&&0==e.status&&(t.prizeList=t.prizeList.concat(e.data),t.prizeList.length<e.totalRecords?t.loading=!1:t.hasMore=!1),t.$Loading.close()}))},showQrcode:function(t){this.qrCodeModelShow=!0,this.$nextTick((function(){l.a.toCanvas(document.getElementById("qrcode"),t+"")}))},getAddress:function(t,s,e){this.curId=t,this.deliverType=s,this.fromType=e,1==s?this.$router.push("/mall2/mypickupaddress?pageType=5"):2==s?this.$router.push("/mall2/addresslist"):12==s&&(this.modelShow=!0)},modifyAddress:function(t){this.curId=t.id,this.deliverType=t.deliverType,this.fromType=t.fromType,this.$router.push("/mall2/addresslist")},submitAddress:function(t){var s=this;this.$Loading.open(),t.chooseDeliverType=this.deliverType;var e={addressInfo:JSON.stringify(t),id:this.curId},a="/app/json/app_game/updateRecAwardAddress";"3"==this.fromType&&(a="/app/json/live_broadcast/liveAwardAddress",e.addressModel=JSON.stringify(t)),this.$http.post(a,e).then((function(e){var a=e.data;if("success"==a.result&&0==a.status){var i=s.prizeList.find((function(t){return t.id==s.curId}));i.addressInfo=JSON.stringify(t),s.$toast("设置成功")}else s.$toast(a.info||"设置失败");s.$Loading.close()}))},onConfirm:function(t){var s=t.deliverType;this.deliverType=s,1==s?this.$router.push("/mall2/mypickupaddress?pageType=5"):2==s&&this.$router.push("/mall2/addresslist")}},computed:Object(r["a"])({},Object(n["c"])(["getSelectAddress","getPickAddress"])),components:{},destroyed:function(){this.curId=""},watch:{getSelectAddress:function(t){this.curId&&2==this.deliverType&&this.submitAddress(t)},getPickAddress:function(t){this.curId&&1==this.deliverType&&this.submitAddress(t)}}},p=u,h=(e("1ee1"),e("0c7c")),v=Object(h["a"])(p,a,i,!1,null,"766b8109",null);s["default"]=v.exports},"7db0":function(t,s,e){"use strict";var a=e("23e7"),i=e("b727").find,r=e("44d2"),o="find",d=!0;o in[]&&Array(1)[o]((function(){d=!1})),a({target:"Array",proto:!0,forced:d},{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(o)},"7ded":function(t,s,e){},f4c0:function(t,s){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD4AAAA+CAMAAABEH1h2AAAABGdBTUEAALGPC/xhBQAAAJZQTFRFIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVIxgVAAAAIxgVy1NN+gAAADF0Uk5TVsj90VPTO36mWsE9I2PPWHhRCVQy6wfYQR+2CkYZwLDqlyBIkhEwQHDQoOBQkBCAAMeQb5sAAAFmSURBVEjH7Zdnc4MwDEDddO+ZHVpIoGyw/v+fKwibGNvsux65y/tkEj1yEbKFCHVsEwBmoJJSJAU9pu1Q4iyhjhYdYOkQG4brYBNzjD4nMEaHQl8nEpasW3LEWtATKhHLeixHJJPSNyFjV6fveMRGo/s8m1GdHvEI/6xPVT+kGW4ffRUxDKm+St3gEau2otXq3Wv+X3UrPnLIv3wvV6L+FWS85av72BJ05YjSb1hM/Xe+CiqH1anqqQzWmlh1br7GND55GZ94IxZM6CjO+nA9rYc9uCiosC0+3eJF/wadqDvupHXxuEBeZP3B4yyKrN3hxZD+Xvxw8eAmolfaRH+9vcdRVnULzFp/Xf2jHfTXn4znwfqR6egfWJ2D9c4vJ3uX06RXXkqVBt2449r7+4R1ZRgx9hmJoM99xvXNL/LY67Aqd1xUHYXMMfqs6xio1y+7DqF6nRA2AjfoXl5Lt1wvB5owvLiif4X2x4oZnHbEAAAAAElFTkSuQmCC"}}]);