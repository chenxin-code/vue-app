(window.webpackJsonp=window.webpackJsonp||[]).push([[976],{na4r:function(t,i,e){"use strict";var s=e("y0Sm");e.n(s).a},rgUB:function(t,i,e){"use strict";e.r(i),e("EHV1");var s,a=e("9gBv"),o=(e("4X9F"),e("IkEG")),n=e("lTco"),r=e("L2JU"),l=e("UevV");function c(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}var d={data:function(){return{receiver:{},addressInfo:{},switchBarType:1,switchBar:[{name:"配送",type:2},{name:"自提",type:1}],oilNum:"",oilPrice:"",oilLibrary:"",people:"",isOpenPopup:!0,phone:"",showPivot:!1,oilInfo:"",biddingData:{},lastPath:""}},mounted:function(){console.log(this.$route),this.lastPath=this.$route.query.lastPath,this.phone=this.$store.state.login.phone,this.people=this.$store.state.userInfo.nickName,this.biddingData=JSON.parse(this.$route.query.biddingData),this.activityData=this.biddingData.oilSaleActivityDetailModel?this.biddingData.oilSaleActivityDetailModel:this.biddingData,console.log(this.biddingData),this.oilNum=this.biddingData.tonnes||"",this.oilPrice=this.biddingData.price||"",this.queryPickUpDepot()},computed:(Object.assign||function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t})({},Object(r.c)(["vipUnitUser"])),methods:{queryPickUpDepot:function(){var t=this;this.$request.post("/app/json/app_oil_sale/queryPickUpDepot",{vipUnitUserCode:this.vipUnitUser.vipUnitUserId}).then((function(i){if(0===i.status){var e=[];i.data.map((function(t){return e.push({text:t.name,code:t.code}),e})),t.columns=e,t.oilInfo=t.columns[0],console.log(t.oilInfo),t.oilLibrary=t.columns[0].text}else t.$Toast(i.info?i.info:"获取自提油库失败")}))},switchHandler:function(t){this.switchBarType=t},info:function(t){this.addressInfo=t},nowGrabBill:function(){var t=this.phone;t=t.replace(/\s*/g,"");var i=/^(13[0-9]|14[0-9]|15[0-9]|16[0-9]|17[0-9]|18[0-9]|19[0-9])\d{8}$/;2==this.switchBarType?0==Object.keys(this.receiver).length||""==this.receiver.receiverName?this.$Toast("请输入收货人姓名"):""==this.receiver.mobile?this.$Toast("请输入收货人手机号"):i.test(this.receiver.mobile)?this.receiver.regionText?this.receiver.address?this.queryGrabBill():this.$Toast("请输入详细地址"):this.$Toast("请选择区域"):(this.$Toast("请输入请输入有效收货人手机号"),this.receiver.mobile=""):1==this.switchBarType&&(""==this.oilLibrary?this.$Toast("请选择自提油库"):""==this.people?this.$Toast("请输入提货人"):""==this.phone?this.$Toast("请输入联系方式"):i.test(t)?this.queryGrabBill():(this.phone="",this.$Toast("请输入有效手机号！")))},getOilInfo:function(t){this.oilInfo=t,this.oilLibrary=t.text},keyup:function(){this.oilNum=this.oilNum.replace(/\.{2,}/g,".").replace(".","$#$").replace(/\./g,"").replace("$#$",".").replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3")},openOilWarehouse:function(){this.$refs.mychild.queryPickUpDepot()},queryGrabBill:function(){var t,i=this;t=1==this.switchBarType?{id:this.biddingData.id,deliveryType:this.switchBarType,skuId:this.biddingData.skuId,pickUpOilDepot:this.oilInfo.code,pickUpOilDepotName:this.oilInfo.text,activityId:this.biddingData.activityId,activityDetailId:"",price:"",consignee:this.people,vipUnitUserCode:this.vipUnitUser.vipUnitUserId,consigneePhone:this.phone,tonnes:this.oilNum}:{id:this.biddingData.id,deliveryType:this.switchBarType,price:"",consignee:this.receiver.receiverName,consigneePhone:this.receiver.mobile,activityDetailId:"",skuId:this.biddingData.skuId,activityId:this.biddingData.activityId,vipUnitUserCode:this.vipUnitUser.vipUnitUserId,tonnes:this.oilNum,addressInfo:{address:this.receiver.address,regionText:this.receiver.regionText,mobile:this.receiver.mobile,receiverName:this.receiver.receiverName,cityId:this.addressInfo.cityId,cityName:this.addressInfo.cityName,countryId:this.addressInfo.countryId,countryName:this.addressInfo.countryName,provinceId:this.addressInfo.provinceId,provinceName:this.addressInfo.provinceName,townId:this.addressInfo.townId,townName:this.addressInfo.townName}},"/limit-order-result"!=this.lastPath&&"/buy-oil-order-list"!=this.lastPath?this.$request.post("/app/json/app_oil_sale/confirmSuccessBidOrder",t).then((function(t){0===t.status?i.$router.go(-2):i.$Toast(t.info)})):this.$request.post("/app/json/app_oil_sale/inputAddressInfo",t).then((function(t){0===t.status?i.$router.go(-2):i.$Toast(t.info)}))}},components:(s={},c(s,o.a.name,o.a),c(s,a.a.name,a.a),c(s,"TipsPopup",n.a),c(s,"Address",l.a),s)},p=(e("na4r"),e("KHd+")),h=Object(p.a)(d,(function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"oil-sale-container"},[e("nav-top",{attrs:{title:"收货方式"},on:{backEvent:function(i){return t.$router.go(-1)}}}),t._v(" "),e("nav-content",{staticClass:"bill-details-container"},[e("div",{staticClass:"bill-content"},[e("div",{staticClass:"buy-bill"},[e("div",{staticClass:"table-view"},[e("div",{staticClass:"table-view-cell"},[e("div",{staticClass:"table-view-cell-text"},[e("ul",{staticClass:"details-list"},[e("li",{staticClass:"details-item"},[e("div",{staticClass:"left"},[t._v("购油量")]),t._v(" "),e("div",{staticClass:"right"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.oilNum,expression:"oilNum"}],attrs:{type:"number",placeholder:"购油量(t)"},domProps:{value:t.oilNum},on:{keyup:t.keyup,input:function(i){i.target.composing||(t.oilNum=i.target.value)}}})])]),t._v(" "),e("li",{staticClass:"details-item"},[e("div",{staticClass:"left"},[t._v("配送方式")]),t._v(" "),e("div",{staticClass:"right"},[e("div",{staticClass:"switch-bar"},t._l(t.switchBar,(function(i){return e("div",{staticClass:"switch-bar-item",class:[i.type===t.switchBarType?"theme_bg_blue theme_font_white active":""],on:{click:function(e){return t.switchHandler(i.type)}}},[t._v(t._s(i.name)+"\n                                            ")])})),0)])]),t._v(" "),2==t.switchBarType?e("Address",{attrs:{receiver:t.receiver},on:{info:t.info}}):t._e(),t._v(" "),1==t.switchBarType?e("li",{staticClass:"details-item",on:{click:t.openOilWarehouse}},[e("div",{staticClass:"left"},[t._v("自提油库")]),t._v(" "),e("div",{staticClass:"right"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.oilLibrary,expression:"oilLibrary"}],attrs:{type:"text",disabled:"",placeholder:"选择油库"},domProps:{value:t.oilLibrary},on:{input:function(i){i.target.composing||(t.oilLibrary=i.target.value)}}})]),t._v(" "),e("TipsPopup",{ref:"mychild",attrs:{isOpenPopup:t.isOpenPopup},on:{getOilInfo:t.getOilInfo}})],1):t._e(),t._v(" "),1==t.switchBarType?e("li",{staticClass:"details-item"},[e("div",{staticClass:"left"},[t._v("提货人")]),t._v(" "),e("div",{staticClass:"right"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.people,expression:"people"}],attrs:{type:"text",placeholder:"请输入提货人"},domProps:{value:t.people},on:{input:function(i){i.target.composing||(t.people=i.target.value)}}})])]):t._e(),t._v(" "),1==t.switchBarType?e("li",{staticClass:"details-item"},[e("div",{staticClass:"left"},[t._v("提货人手机号")]),t._v(" "),e("div",{staticClass:"right"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.phone,expression:"phone"}],attrs:{maxlength:"11",type:"tel",pattern:"[0-9]*",onkeypress:"return( /[\\d]/.test(String.fromCharCode(event.keyCode)))",placeholder:"请输入提货人手机号"},domProps:{value:t.phone},on:{input:function(i){i.target.composing||(t.phone=i.target.value)}}})])]):t._e()],1)])]),t._v(" "),"/limit-order-result"!=t.lastPath?e("div",{staticClass:"table-view-cell"},[e("div",{staticClass:"table-view-cell-text"},[e("ul",{staticClass:"buy-bill-money-list"},[e("li",{staticClass:"buy-bill-money-item"},[e("div",{staticClass:"money"},[e("div",{staticClass:"left"},[t._v("竞拍单价")]),t._v(" "),e("div",{staticClass:"right"},[e("span",{staticClass:"num"},[t._v(t._s(t.oilPrice))]),t._v("元/吨\n                                        ")])]),t._v(" "),e("div",{staticClass:"money"},[e("div",{staticClass:"left"},[t._v("油品总金额")]),t._v(" "),e("div",{staticClass:"right"},[t._v("\n                                            ￥"),e("span",{staticClass:"num"},[t._v(t._s((t.oilNum*t.oilPrice).toFixed(2)))])])]),t._v(" "),e("div",{staticClass:"money"},[e("div",{staticClass:"left"},[t._v("实际需支付")]),t._v(" "),e("div",{staticClass:"right special"},[t._v("\n                                            ￥"),e("span",{staticClass:"num"},[t._v(t._s((t.oilNum*t.oilPrice).toFixed(2)))])])])])])])]):t._e()])]),t._v(" "),e("div",{staticClass:"now-buy-bill-btn",on:{click:t.nowGrabBill}},["/limit-order-result"!=t.lastPath&&"/buy-oil-order-list"!=t.lastPath?e("div",{staticClass:"btn"},[t._v("确认订单")]):e("div",{staticClass:"btn"},[t._v("确认")])])])])],1)}),[],!1,null,"63296b3d",null);i.default=h.exports},y0Sm:function(t,i,e){}}]);