(window.webpackJsonp=window.webpackJsonp||[]).push([[184],{"7KCi":function(t,i,e){"use strict";var a=(e("Y3uz"),e("KHd+")),r=Object(a.a)({name:"navbar",props:["title","backUrl"],data:function(){return{}},methods:{navBack:function(){this.backUrl?this.$router.push(this.backUrl):this.$router.go(-1)}}},(function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"navbar"},[i("van-sticky",[i("van-nav-bar",{attrs:{title:this.title},on:{"click-left":this.navBack},scopedSlots:this._u([{key:"left",fn:function(){return[i("van-icon",{staticClass:"arrow_left",attrs:{name:"arrow-left",color:"#000000",size:"0.471467rem"}})]},proxy:!0}])})],1)],1)}),[],!1,null,"bb0dcaac",null);i.a=r.exports},"88MK":function(t,i,e){"use strict";var a=e("Qslw");e.n(a).a},QFaU:function(t,i,e){"use strict";e("aO+S"),e("nXDD"),e("N0PS"),e("Cf6i")},Qslw:function(t,i,e){},XqoR:function(t,i,e){},Y3uz:function(t,i,e){"use strict";var a=e("XqoR");e.n(a).a},ZoCG:function(t,i,e){t.exports=e.p+"static/img/user-default.8e419da.png"},qvKQ:function(t,i,e){"use strict";e.r(i);var a=e("Qyje"),r=e.n(a),s=e("7KCi"),n=(e("rMTE"),{name:"orderList",props:{},components:{navbar:s.a},data:function(){return{defaultAvatar:e("ZoCG"),tab:[{name:"待发货"},{name:"待提货"},{name:"已完成"},{name:"已取消"}],allList:[],waitPayList:[],deliveryList:[],distributionList:[],pickUpList:[],finishedList:[],cancelList:[],currentTab:0,refreshing:!1,loading:!1,finished:!1,type:2,showPopup:!1,searchValue:"",currentPage:0,totalPage:0,error:!1,skuInfo:{},activityOrderNo:0}},created:function(){this.activityOrderNo=JSON.parse(this.$route.query.id)},methods:{changesTab:function(t){this.currentTab=t,this.currentPage=0,this.allList=[],this.waitPayList=[],this.deliveryList=[],this.distributionList=[],this.pickUpList=[],this.finishedList=[],this.cancelList=[],this.finished=!1,this.loading=!0,this.onLoad()},onLoad:function(){var t=this;this.loading=!0;var i=this.currentPage;i+=1,this.currentPage=i,this.refreshing=!1,console.log(this.currentTab);var e={pageNum:i,pageSize:10,sortBy:"create_time_DESC",activityNo:this.activityOrderNo,orderItemState:0==this.currentTab?1:1==this.currentTab?3:2==this.currentTab?4:3==this.currentTab?5:void 0};this.$http.post("/app/json/group_buying_order/findGroupBuyingActivityOrderItemListByOrderId",r.a.stringify(e)).then((function(e){if(i<e.data.data.pages||i==e.data.data.pages)if("success"==e.data.result){var a=e.data.data.records;switch(a.forEach((function(t){""!==t.productSkuInfo?t.orderSkuImg=JSON.parse(t.productSkuInfo)[0].groupbuySkuPicurl.split(","):t.orderSkuImg=[]})),t.currentTab){case 0:t.deliveryList=t.deliveryList.concat(a);case 1:t.pickUpList=t.pickUpList.concat(a);case 2:t.finishedList=t.finishedList.concat(a);case 3:t.cancelList=t.cancelList.concat(a)}t.page=e.data.data.pages,setTimeout((function(){t.loading=!1}),1e3)}else t.loading=!1,t.error=!0;else t.finished=!0})).catch((function(i){t.$toast("请求失败，点击重新加载"),t.loading=!1,t.error=!0,console.log(t.error)}))},onRefresh:function(){var t=this;this.page=1,this.finished=!1,this.loading=!0;var i={pageNum:1,pageSize:10,sortBy:"create_time_DESC",activityNo:this.activityOrderNo,orderItemState:0==this.currentTab?1:1==this.currentTab?3:2==this.currentTab?4:3==this.currentTab?5:void 0};this.$http.post("/app/json/group_buying_order/findGroupBuyingActivityOrderItemListByOrderId",r.a.stringify(i)).then((function(i){if(200==i.status){var e=i.data.data.records;switch(e.forEach((function(t){""!==t.productSkuInfo?t.orderSkuImg=JSON.parse(t.productSkuInfo)[0].groupbuySkuPicurl.split(","):t.orderSkuImg=[]})),t.currentTab){case 0:t.deliveryList=e;case 1:t.pickUpList=e;case 2:t.finishedList=e;case 3:t.cancelList=e}t.totalPage=i.data.pages,setTimeout((function(){t.$toast("刷新成功"),t.loading=!1,t.refreshing=!1}),800)}})).catch((function(i){t.$toast("网络繁忙,请稍后再试~")}))},navToDetail:function(t){this.$router.push({path:"/bulk_order_detail",query:{id:JSON.stringify(t.activityOrderItemNo)}})},confirm:function(t){this.showPopup=!0,this.skuInfo=t},confirmOrder:function(){var t,i=this;t=1==this.skuInfo.activityOrderItemState||2==this.skuInfo.activityOrderItemState||3==this.skuInfo.activityOrderItemState?this.skuInfo.activityOrderItemState:void 0,this.$http.post("/app/json/group_buying_order/confirmReceiveDeliveryPickup",{orderItemId:this.skuInfo.activityOrderItemNo,confirmType:t}).then((function(t){console.log(t.data),t.data.data.isTrue&&(i.showPopup=!1,i.$toast("操作成功"),i.changesTab(i.currentTab)),"error"==t.data.result&&(i.showPopup=!1,i.$toast(t.data.info))})).catch((function(t){i.showPopup=!1,i.$toast("请求失败，请重新尝试")}))}}}),o=(e("88MK"),e("KHd+")),c=Object(o.a)(n,(function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"orderList"},[e("van-sticky",[e("navbar",{attrs:{title:"本团订单"}}),t._v(" "),e("div",{staticClass:"tab"},t._l(t.tab,(function(i,a){return e("div",{key:a,staticClass:"tab_item",class:t.currentTab==a?"current_tab":"",on:{click:function(i){return t.changesTab(a)}}},[t._v("\n        "+t._s(i.name)+"\n      ")])})),0)],1),t._v(" "),e("div",{staticClass:"goods_list"},[e("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(i){t.refreshing=i},expression:"refreshing"}},[e("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",error:t.error,"error-text":"请求失败，点击重新加载"},on:{load:t.onLoad,"update:error":function(i){t.error=i}},model:{value:t.loading,callback:function(i){t.loading=i},expression:"loading"}},t._l(0==t.currentTab?t.deliveryList:1==t.currentTab?t.pickUpList:2==t.currentTab?t.finishedList:3==t.currentTab?t.cancelList:t.allList,(function(i,a){return e("div",{key:a,staticClass:"goods_item",on:{click:function(e){return t.navToDetail(i)}}},[e("div",{staticClass:"goods_title"},[e("div",{staticClass:"goods_ID"},[t._v("#"+t._s(i.activityOrderItemNo))]),t._v(" "),e("div",{staticClass:"goods_type"},[t._v("\n              "+t._s(1==i.activityOrderItemState?"待发货":3==i.activityOrderItemState?"待提货":4==i.activityOrderItemState?"已完成":5==i.activityOrderItemState?"已取消":"")+"\n            ")])]),t._v(" "),e("div",{staticClass:"good_user"},[e("div",{staticClass:"user"},[e("van-image",{staticClass:"user-image",attrs:{src:i.contactAvatar,"error-icon":t.defaultAvatar}}),t._v(" "),e("div",{staticClass:"user_name"},[t._v(t._s(i.contactName))]),t._v(" "),e("div",{staticClass:"user_phone"},[t._v(t._s(i.contactPhone))])],1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:2==i.activityOrderItemState||3==i.activityOrderItemState,expression:"\n                item.activityOrderItemState == 2 ||\n                item.activityOrderItemState == 3\n              "}],staticClass:"user_type",class:2==i.activityOrderItemState?"delivery":3==i.activityOrderItemState?"pick_up":""},[t._v("\n              "+t._s(2==i.activityOrderItemState?"配送上门":3==i.activityOrderItemState?"自提":"")+"\n            ")])]),t._v(" "),e("div",{staticClass:"goods_img"},t._l(i.orderSkuImg,(function(t){return e("img",{key:t,attrs:{src:t,alt:""}})})),0),t._v(" "),e("div",{staticClass:"goods_detail"},[e("div",{staticClass:"detail"},[e("span",[t._v("共计"+t._s(i.productQuantity)+"件商品，合计支付 ")]),t._v(" "),e("span",[t._v(t._s(i.totalAmount))])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:0!==i.activityOrderItemState&&4!==i.activityOrderItemState&&5!==i.activityOrderItemState,expression:"\n                item.activityOrderItemState !== 0 &&\n                item.activityOrderItemState !== 4 &&\n                item.activityOrderItemState !== 5\n              "}],staticClass:"confirm",on:{click:function(e){return e.stopPropagation(),t.confirm(i)}}},[t._v("\n              确认"+t._s(1==i.activityOrderItemState?"送达":2==i.activityOrderItemState?"配送":3==i.activityOrderItemState?"提货":"")+"\n            ")])])])})),0)],1)],1),t._v(" "),e("van-popup",{model:{value:t.showPopup,callback:function(i){t.showPopup=i},expression:"showPopup"}},[e("div",{staticClass:"popup"},[e("div",{staticClass:"popup_title"},[t._v("确认订单商品")]),t._v(" "),e("div",{staticClass:"popup_detail"},[t._v("\n        "+t._s(1==t.skuInfo.activityOrderItemState?"抵达":2==t.skuInfo.activityOrderItemState?"送达消费者":3==t.skuInfo.activityOrderItemState?"被消费者提走":"")+"\n      ")]),t._v(" "),e("div",{staticClass:"popup_btn"},[e("div",{staticClass:"confirm_btn",on:{click:function(i){return t.confirmOrder()}}},[t._v("确认")]),t._v(" "),e("div",{staticClass:"cancel_btn",on:{click:function(i){t.showPopup=!1}}},[t._v("取消")])])])])],1)}),[],!1,null,"21d00dfc",null);i.default=c.exports},rMTE:function(t,i,e){"use strict";e("QFaU");var a=e("RL95");e("oCYn").default.use(a.a)}}]);