(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0be13d94"],{1355:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"index"}},[n("mt-header",{attrs:{title:"加油卡绑定"}},[n("mt-button",{attrs:{slot:"left",icon:"back"},on:{click:t.backEvent},slot:"left"})],1),n("div",{staticClass:"conter"},[n("div",{staticClass:"unitcard-type"},t._l(t.unitcardTypeArr,(function(e,a){return n("p",{key:a,class:t.unitcardTypeArrIndex==a?"active":"",on:{click:function(n){return t.unitcardTypeClick(e,a)}}},[t._v(t._s(e))])})),0),n("div",{staticClass:"input"},[n("mt-field",{attrs:{label:"绑卡卡号",placeholder:"请输入有效加油卡卡号",type:"tel"},model:{value:t.cardNo,callback:function(e){t.cardNo=e},expression:"cardNo"}}),n("mt-field",{attrs:{label:"手机号码",placeholder:"请输入手机号",type:"tel"},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}}),0==t.unitcardTypeArrIndex?n("mt-field",{attrs:{label:"手机验证码",attr:{maxlength:6},placeholder:"请输入短信验证码",type:"type"},model:{value:t.phoneCode,callback:function(e){t.phoneCode=e},expression:"phoneCode"}},[n("input",{staticClass:"fl-right",style:{background:"#fff",fontSize:"12px",color:"获取验证码"===t.obtain?"#f02c2c":"#ccc"},attrs:{type:"button",value:t.obtain,disabled:t.disabled},on:{click:t.countdown}})]):t._e(),0==t.unitcardTypeArrIndex?n("mt-field",{attrs:{label:"身份证号码",placeholder:"请输入有效身份证号码",type:"tel"},model:{value:t.idcard,callback:function(e){t.idcard=e},expression:"idcard"}}):t._e(),n("p",{staticClass:"btn",on:{click:t.handleBindCard}},[t._v("提交")])],1),t.cardPrompt?n("div",{staticClass:"card-prompt"},[n("h3",{staticClass:"title"},[t._v("温馨提示：")]),n("div",{staticClass:"content",domProps:{innerHTML:t._s(t.cardPrompt)}})]):t._e()])],1)},o=[],i=(n("4795"),n("ac1f"),n("5319"),n("76a0")),s={data:function(){return{unitcardTypeArr:["单位主卡","单位副卡"],unitcardTypeArrIndex:0,phone:"",phoneCode:"",idcard:"",cardNo:"",obtain:"获取验证码",disabled:!1,noprefix:"",newList:"",cardPrompt:""}},created:function(){this.showagreement()},mounted:function(){this.getphone(),this.getCardNo()},methods:{unitcardTypeClick:function(t,e){this.unitcardTypeArrIndex=e},showagreement:function(){var t=this;this.$request.post("/app/json/news/getNewsList",{values:24}).then((function(e){0==e.status&&(t.cardPrompt=e.data[0]?e.data[0].content:"")}))},backEvent:function(){this.$router.go(-1)},countdown:function(){var t=this,e=this,n=this,a=60;function o(){if(0==a)return e.disabled=!1,e.obtain="获取验证码",a=60,!1;e.disabled=!0,e.obtain="重新发送("+a+")",a--,setTimeout((function(){o()}),1e3)}var s=/^[0-9]{19}$/;if(s.test(this.cardNo)){0==this.unitcardTypeArrIndex&&this.$request.post("/app/json/enterprise_card/checkBindInfo",{phone:this.phone}).then((function(e){if(0==e.status){if(e.data)return void t.$Toast("当前手机号已经绑定过单位主卡")}else t.$Toast(e.info)}));var r="/app/json/message/sendVerifyBindCardSms";this.$http.post(r,{token:n.$store.state.login.token,phone:this.phone,cardno:this.cardNo}).then((function(t){n.$Loading.close(),"error"===t.data.result?Object(i["Toast"])(t.data.info):(Object(i["Toast"])("获取验证码成功"),o())}))}else Object(i["Toast"])("请输入正确卡号")},handleBindCard:function(){var t=this,e=/^[0-9]{19}$/;if(e.test(this.cardNo))if(0!=this.unitcardTypeArrIndex||""!==this.phoneCode){var n="/app/json/enterprise_card/bindEnterpriseMainCard",a={phone:this.phone,phoneCode:this.phoneCode,idNumber:this.idcard,cardNo:this.cardNo};1==this.unitcardTypeArrIndex&&(n="/app/json/enterprise_card/bindEnterpriseDeputyCard",a={phone:this.phone,cardNo:this.cardNo}),this.$request.post(n,a).then((function(e){0==e.status?t.$router.replace({path:"/addCard"}):t.$Toast(e.info)}))}else Object(i["Toast"])("请输入正确短信验证码");else Object(i["Toast"])("请输入正确卡号")},getCardNo:function(){var t=this;this.$request.post("/app/json/enterprise_card/getCardNoByPhone",{phone:18907488002}).then((function(e){0==e.status||t.$Toast(e.info)}))},getphone:function(){var t=this;this.$Loading.open();var e=this,n="/app/json/card/getcardnopre";this.$http.post(n,{token:e.$store.state.login.token}).then((function(n){e.$Loading.close(),t.phone=n.data.data.phone,t.noprefix=n.data.data.noprefix}))},getNewsList:function(){var t=this;this.$Loading.open();var e=this,n="/app/json/news/getNewsList";this.$http.post(n,{token:e.$store.state.login.token,values:21}).then((function(n){e.$Loading.close(),t.newList=n.data.data[0]}))}}},r=s,d=(n("bbd7"),n("3893"),n("0c7c")),c=Object(d["a"])(r,a,o,!1,null,"2434b856",null);e["default"]=c.exports},"200d":function(t,e,n){},3893:function(t,e,n){"use strict";n("8d6f")},"8d6f":function(t,e,n){},bbd7:function(t,e,n){"use strict";n("200d")}}]);