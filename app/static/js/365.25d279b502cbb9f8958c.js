(window.webpackJsonp=window.webpackJsonp||[]).push([[365],{VbOM:function(t,i,e){},apmo:function(t,i,e){"use strict";e.r(i),e("4X9F");var s,a=e("IkEG"),o=e("lTco");function l(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}e("L2JU");var n={data:function(){return{switchBarType:2,switchBar:[{name:"配送",type:2},{name:"自提",type:1}],titleOil:"选择油品",titleCard:"选择油卡",titleDetalis:"选择油库",titleAddress:"选择配送地址",showTips:!1,overlay:!1,tradeStyle:"",oilName:"",oilCard:"",oilNum:"",tradeAddress:"",people:"",phone:"",isOpenPopup:!0,oilInfo:"",oilLibrary:""}},mounted:function(){this.tradeAddress=this.$store.state.mall2.selectAddress.addressFull,this.people=this.$store.state.mall2.selectAddress.receiverName,this.phone=this.$store.state.mall2.selectAddress.mobile},computed:{},methods:{nowBuyBill:function(){""==this.oilName?this.$Toast("请选择油品名称"):""==this.oilCard?this.$Toast("请选择提油卡号"):""==this.oilNum?this.$Toast("请输入提油数量"):1==this.switchBarType&&""==this.oilLibrary?this.$Toast("请选择自提油库"):""==this.people?this.$Toast("请输入提货人"):""==this.phone?this.$Toast("请输入联系方式人"):/^(13[0-9]|14[0-9]|15[0-9]|16[0-9]|17[0-9]|18[0-9]|19[0-9])\d{8}$/.test(this.phone)&&11==this.phone.length?this.showTips=!0:(this.phone="",this.$Toast("请输入有效的手机号码"))},getOilNameNum:function(t){this.oilName=t.text},getOilCard:function(t){this.oilCard=t.text},getOilInfo:function(t){this.oilInfo=t,this.oilLibrary=t.text},openAddress:function(){this.$router.push("/mall2/addresslist")},openOilCardNum:function(){this.$refs.mychildCardNum.appQueryTakeOilCardList()},openOilNameNum:function(){this.$refs.mychildOilName.appQueryTakeOilNameList()},openOilLibrary:function(){this.$refs.mychild.queryPickUpDepot()},queryBuyBill:function(){if(this.showTips=!1,this.switchBarType,this.oilName,this.oilCard,this.oilNum,this.tradeAddress,this.oilInfo.code,this.oilInfo.text,this.phone,this.people,this.vipUnitUser.vipUnitUserId,1==this.switchBarType){var t={deliveryType:this.switchBarType,matertialName:this.oilName,oilCardNo:this.oilCard,Tonnes:this.oilNum,pickUpOilDepot:this.oilInfo.code,pickUpOilDepotName:this.oilInfo.text,consigneePhone:this.phone,Consignee:this.people,vipUnitUserCode:this.vipUnitUser.vipUnitUserId};this.appsubmmitAppoint(t)}else{var i={deliveryType:this.switchBarType,matertialName:this.oilName,oilCardNo:this.oilCard,Tonnes:this.oilNum,deliveryAddress:this.tradeAddress,consigneePhone:this.phone,Consignee:this.people,vipUnitUserCode:this.vipUnitUser.vipUnitUserId};this.appsubmmitAppoint(i)}},appsubmmitAppoint:function(t){var i=this;this.$request.post("/app/json/app_oil_appoint/appsubmmitAppoint",t).then((function(t){if(0===t.status){var e=t.data;i.$router.push({path:"appointment-oil-results",query:{appointmentOilDetails:JSON.stringify(e)}})}else i.$Toast(t.info?t.info:"预约失败")})).catch((function(t){console.log(t)}))},switchHandler:function(t){this.switchBarType=t,2==this.switchBarType?(this.people=this.$store.state.mall2.selectAddress.receiverName,this.phone=this.$store.state.mall2.selectAddress.mobile):(this.people="",this.phone="")}},components:(s={},l(s,a.a.name,a.a),l(s,"TipsPopup",o.a),s)},r=(e("uNAB"),e("KHd+")),p=Object(r.a)(n,(function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"oil-sale-container"},[e("nav-top",{attrs:{title:"预约提油"},on:{backEvent:function(i){return t.$router.go(-1)}}}),t._v(" "),e("nav-content",{staticClass:"bill-details-container"},[e("div",{staticClass:"buy-bill"},[e("div",{staticClass:"table-view"},[e("div",{staticClass:"table-view-cell"},[e("div",{staticClass:"table-view-cell-text"},[e("ul",{staticClass:"details-list"},[e("li",{staticClass:"details-item"},[e("div",{staticClass:"left"},[t._v("配送方式")]),t._v(" "),e("div",{staticClass:"right"},[e("div",{staticClass:"switch-bar"},t._l(t.switchBar,(function(i){return e("div",{staticClass:"switch-bar-item",class:[i.type===t.switchBarType?"theme_bg_blue theme_font_white active":""],on:{click:function(e){return t.switchHandler(i.type)}}},[t._v(t._s(i.name)+"\n                      ")])})),0)])]),t._v(" "),e("li",{staticClass:"details-item",on:{click:t.openOilNameNum}},[e("div",{staticClass:"left"},[t._v("油品名称")]),t._v(" "),e("div",{staticClass:"right"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.oilName,expression:"oilName"}],attrs:{type:"text",disabled:"",placeholder:"请选择自提油品"},domProps:{value:t.oilName},on:{input:function(i){i.target.composing||(t.oilName=i.target.value)}}})]),t._v(" "),e("TipsPopup",{ref:"mychildOilName",attrs:{title:t.titleOil,isOpenPopup:t.isOpenPopup},on:{getOilNameNum:t.getOilNameNum}})],1),t._v(" "),e("li",{staticClass:"details-item",on:{click:t.openOilCardNum}},[e("div",{staticClass:"left"},[t._v(t._s(2==t.$store.state.globalConfig.oilExtractionCertificate?"提油卡号":"身份证号"))]),t._v(" "),e("div",{staticClass:"right"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.oilCard,expression:"oilCard"}],attrs:{type:"text",disabled:"",placeholder:2==t.$store.state.globalConfig.oilExtractionCertificate?"请选择提油卡号":"请选择身份证号"},domProps:{value:t.oilCard},on:{input:function(i){i.target.composing||(t.oilCard=i.target.value)}}})]),t._v(" "),e("TipsPopup",{ref:"mychildCardNum",attrs:{title:t.titleCard,isOpenPopup:t.isOpenPopup},on:{getOilCard:t.getOilCard}})],1),t._v(" "),e("li",{staticClass:"details-item"},[e("div",{staticClass:"left"},[t._v("提油数量")]),t._v(" "),e("div",{staticClass:"right"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.oilNum,expression:"oilNum"}],attrs:{type:"text",placeholder:"请输入提油数(t)"},domProps:{value:t.oilNum},on:{input:function(i){i.target.composing||(t.oilNum=i.target.value)}}})])]),t._v(" "),2==t.switchBarType?e("li",{staticClass:"details-item"},[e("div",{staticClass:"left"},[t._v("配送地址")]),t._v(" "),e("div",{staticClass:"right"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.tradeAddress,expression:"tradeAddress"}],staticClass:"address",attrs:{type:"text",disabled:"",placeholder:"请选择配送地址"},domProps:{value:t.tradeAddress},on:{input:function(i){i.target.composing||(t.tradeAddress=i.target.value)}}})]),t._v(" "),e("div",{staticClass:"icon-info",on:{click:t.openAddress}},[e("span",{staticClass:"icon"},[e("i",{staticClass:"small"}),t._v(" "),e("i",{staticClass:"big"}),t._v(" "),e("i",{staticClass:"small"})])])]):t._e(),t._v(" "),1==t.switchBarType?e("li",{staticClass:"details-item",on:{click:t.openOilLibrary}},[e("div",{staticClass:"left"},[t._v("自提油库")]),t._v(" "),e("div",{staticClass:"right"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.oilLibrary,expression:"oilLibrary"}],attrs:{type:"text",disabled:"",placeholder:"请选择自提油库"},domProps:{value:t.oilLibrary},on:{input:function(i){i.target.composing||(t.oilLibrary=i.target.value)}}})]),t._v(" "),e("TipsPopup",{ref:"mychild",attrs:{title:t.titleDetalis,isOpenPopup:t.isOpenPopup},on:{getOilInfo:t.getOilInfo}})],1):t._e(),t._v(" "),e("li",{staticClass:"details-item"},[e("div",{staticClass:"left"},[t._v("收货人")]),t._v(" "),e("div",{staticClass:"right"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.people,expression:"people"}],attrs:{type:"text",placeholder:"请输入提货人"},domProps:{value:t.people},on:{input:function(i){i.target.composing||(t.people=i.target.value)}}})])]),t._v(" "),e("li",{staticClass:"details-item"},[e("div",{staticClass:"left"},[t._v("联系方式")]),t._v(" "),e("div",{staticClass:"right"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.phone,expression:"phone"}],attrs:{maxlength:"11",placeholder:"请输入联系方式",type:"tel",autosize:"",onkeypress:"return( /[\\d]/.test(String.fromCharCode(event.keyCode)))",pattern:"[0-9]*"},domProps:{value:t.phone},on:{input:[function(i){i.target.composing||(t.phone=i.target.value)},function(i){t.phone=/^\d+/.exec(t.phone)?/^\d+/.exec(t.phone)[0]:""}]}})])])])])])])]),t._v(" "),e("div",{staticClass:"now-buy-bill-btn",on:{click:t.nowBuyBill}},[e("div",{staticClass:"btn"},[t._v("立即预约")])]),t._v(" "),e("van-popup",{attrs:{"close-on-click-overlay":t.overlay},model:{value:t.showTips,callback:function(i){t.showTips=i},expression:"showTips"}},[e("div",{staticClass:"tips-content"},[e("div",{staticClass:"title"},[t._v("温馨提示")]),t._v(" "),1==t.switchBarType?e("div",{staticClass:"content"},[t._v("您正在使用卡号为"+t._s(t.oilCard)+"的提油卡预约油品配送，预约成功之后将不可取消。")]):2==t.switchBarType?e("div",{staticClass:"content"},[t._v("\n            您正在使用卡号为"+t._s(t.oilCard)+"的提油卡预约去"+t._s(t.oilLibrary)+"提取"+t._s(t.oilName)+t._s(t.oilNum)+"t，预约成功之后将不可取消。\n          ")]):t._e(),t._v(" "),e("div",{staticClass:"btn-group"},[e("div",{staticClass:"btn",on:{click:function(i){t.showTips=!1}}},[t._v("再想想")]),t._v(" "),e("div",{staticClass:"btn",on:{click:t.queryBuyBill}},[t._v("确定预约")])])])])],1)],1)}),[],!1,null,"433f6095",null);i.default=p.exports},ey8M:function(t,i,e){},lTco:function(t,i,e){"use strict";var s=e("L2JU"),a=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},o={data:function(){return{columns:[],showOil:!1}},props:{isOpenPopup:{type:Boolean,default:!1},title:{type:String,default:"选择油库"}},mounted:function(){},methods:{onCancel:function(){this.showOil=!1},onConfirm:function(t,i){this.showOil=!1,this.$emit("getOilInfo",t),this.$emit("getOilNameNum",t),this.$emit("getOilCard",t)},openPopup:function(){1==this.isOpenPopup?this.showOil=!0:this.showOil=!1},queryPickUpDepot:function(){var t=this;this.$request.post("/app/json/app_oil_sale/queryPickUpDepot",{vipUnitUserCode:this.vipUnitUser.vipUnitUserId}).then((function(i){if(0===i.status){var e=[];i.data.map((function(t){return e.push({text:t.name,code:t.code}),e})),t.columns=e,t.$emit("getPickUpDepot",e)}else t.$Toast(i.info?i.info:"获取自提油库失败")}))},appQueryTakeOilCardList:function(){var t=this;this.$request.post("/app/json/app_oil_appoint/appQueryTakeOilCardList",{vipUnitUserCode:this.vipUnitUser.vipUnitUserId}).then((function(i){if(0===i.status){var e=[];i.data.map((function(t){return e.push({text:t.userCard}),e})),t.columns=e}else t.$Toast(i.info?i.info:"获取提油卡失败")})).catch((function(t){console.log(t)}))},appQueryTakeOilNameList:function(){var t=this;this.$request.post("/app/json/app_oil_appoint/appQueryTakeOilNameList",{vipUnitUserCode:this.vipUnitUser.vipUnitUserId}).then((function(i){if(0===i.status){var e=[];i.data.map((function(t){return e.push({text:t.oilname}),e})),t.columns=e}else t.$Toast(i.info?i.info:"获取油品名称失败")})).catch((function(t){console.log(t)}))}},computed:a({},Object(s.c)(["vipUnitUser"])),components:{}},l=(e("xQ2Z"),e("KHd+")),n=Object(l.a)(o,(function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("div",{staticClass:"icon-info",on:{click:t.openPopup}},[t._m(0)]),t._v(" "),e("van-popup",{attrs:{position:"bottom"},model:{value:t.showOil,callback:function(i){t.showOil=i},expression:"showOil"}},[e("van-picker",{attrs:{"show-toolbar":"",title:t.title,columns:t.columns},on:{cancel:t.onCancel,confirm:t.onConfirm}})],1)],1)}),[function(){var t=this.$createElement,i=this._self._c||t;return i("span",{staticClass:"icon"},[i("img",{attrs:{width:"20px",height:"20px",src:"static/image/mall2/area.png"}})])}],!1,null,"638721b8",null);i.a=n.exports},uNAB:function(t,i,e){"use strict";var s=e("VbOM");e.n(s).a},xQ2Z:function(t,i,e){"use strict";var s=e("ey8M");e.n(s).a}}]);