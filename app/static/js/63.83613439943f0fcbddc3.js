(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{NeUC:function(t,n,a){"use strict";a.r(n),a("/8Gb");var i={data:function(){return{dataInfo:{},timeInfo:"",stateInfo:"",iconType:1,recordList:[]}},created:function(){var t=this;this.$Loading.open();var n={id:this.$route.query.id};this.$http.post("/app/json/wx_discount_card/loadDiscountCardDetail",n).then((function(n){t.$Loading.close();var a=n.data;0==a.status?(t.dataInfo=a.data,t.recordList=t.dataInfo.detail||[],t.dataInfo.getTime&&(t.recordList.unshift({tradeTime:t.dataInfo.getTime,type:3,info:t.stateText()}),t.recordList.push({tradeTime:t.dataInfo.getTime,type:2}),console.log(t.recordList,"record"))):t.$toast(a.info)})).catch((function(n){t.$Loading.close()}))},methods:{goback:function(){this.$router.go(-1)},stateText:function(){if("APPLY"==this.dataInfo.state)return this.stateInfo="先享卡申请中",this.stateInfo;if("ONGOING"==this.dataInfo.state)return this.timeInfo="履约截止时间："+this.dataInfo.actEffEndTime,this.stateInfo="约定进行中",this.stateInfo+"，已享优惠"+(this.dataInfo.discountAmount||0)+"元";if("CHECKING"==this.dataInfo.state)return this.stateInfo="约定到期核对中",stateInfo;if("FINISHED"==this.dataInfo.state)return this.iconType=2,this.timeInfo=this.dataInfo.finishedTime+"已完成约定",this.stateInfo="已完成约定",this.stateInfo+"，已享优惠"+(this.dataInfo.discountAmount||0)+"元";if("UNFINISHED"==this.dataInfo.state){if(this.iconType=3,"PAYING"==this.dataInfo.payState)return this.timeInfo=this.dataInfo.finishedTime+"履约时间结束",this.stateInfo="未完成约定",this.stateInfo+"，奖励退还中";if("PAID"==this.dataInfo.payState)return"DUE_TO_QUIT"==this.dataInfo.unfinishedReason?this.timeInfo=this.dataInfo.finishedTime+"履约时间结束":"EARLY_QUIT"==this.dataInfo.unfinishedReason&&(this.timeInfo=this.dataInfo.finishedTime+"提前退出约定"),this.stateInfo="未完成约定",this.stateInfo+"，已退款"+(this.dataInfo.discountAmount||0)+"元"}},unDone:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(t||0)-(n||0)},range:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)||0;return t||n?parseInt(n/t*100):100}}},s=(a("Pu00"),a("KHd+")),e=Object(s.a)(i,(function(){var t=this,n=t.$createElement,a=t._self._c||n;return a("div",[a("nav-top",{attrs:{title:"先享卡详情"},on:{backEvent:t.goback}}),t._v(" "),a("nav-content",[a("div",{staticClass:"header"},[a("div",{staticClass:"icon",class:{icon2:2==t.iconType,icon3:3==t.iconType}}),t._v(" "),a("div",{staticClass:"info"},[t._v("\n        "+t._s(t.stateText())+"\n      ")]),t._v(" "),a("h2",[t._v(t._s(t.timeInfo))])]),t._v(" "),a("div",{staticClass:"state-warp"},[a("h2",[t._v("约定内容")]),t._v(" "),a("div",{staticClass:"card top"},[a("div",{staticClass:"detail"},[a("div",{staticClass:"time"},[t._v("\n            "+t._s(t.dataInfo.actEffEndTime)+"前\n          ")]),t._v(" "),a("h3",[t._v("\n            "+t._s(t.dataInfo.totalObjective)+"\n          ")]),t._v(" "),t.dataInfo.remark?a("div",{staticClass:"info"},[t._v("\n            "+t._s(t.dataInfo.remark)+"\n          ")]):t._e(),t._v(" "),a("div",{staticClass:"state"},[t.stateInfo?a("span",{staticClass:"btn"},[t._v(t._s(t.stateInfo))]):t._e(),t._v(" "),a("span",[t._v("已完成"+t._s(t.dataInfo.completeCnt||0)+"次，待完成"+t._s(t.unDone(t.dataInfo.objectiveCnt,t.dataInfo.completeCnt))+"次")])]),t._v(" "),a("van-progress",{attrs:{percentage:t.range(t.dataInfo.objectiveCnt,t.dataInfo.completeCnt),color:"#F02C2D","show-pivot":!1}})],1),t._v(" "),a("van-notice-bar",{attrs:{scrollable:"",text:"若未完成约定，仅扣回已享优惠不吃亏"}})],1),t._v(" "),t.recordList.length?a("h2",[t._v("先享卡享受优惠记录")]):t._e(),t._v(" "),t.recordList.length?a("div",{staticClass:"card bottom"},t._l(t.recordList,(function(n,i){return a("div",{key:i,staticClass:"record"},[a("div",{staticClass:"r-time"},[t._v("\n            "+t._s(n.tradeTime)+"\n          ")]),t._v(" "),2==n.type?a("div",[t._v("\n            领取先享卡成功\n          ")]):3==n.type?a("div",[t._v("\n            "+t._s(n.info)+"\n          ")]):a("div",{staticClass:"r-info"},[t._v("\n            使用奖励优惠1次，已享优惠"+t._s(n.discountAmount)+" 元\n          ")])])})),0):t._e()])])],1)}),[],!1,null,"f5db69fa",null);n.default=e.exports},Pu00:function(t,n,a){"use strict";var i=a("pveE");a.n(i).a},pveE:function(t,n,a){}}]);