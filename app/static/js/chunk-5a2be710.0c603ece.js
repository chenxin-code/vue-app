(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a2be710","chunk-2d0d6337","chunk-2d0e24d1","chunk-2d0e24d1"],{"46a3":function(t,e,a){},7217:function(t,e,a){"use strict";var s=a("53ca"),i=a("d4ec"),o=a("bee2"),r=(a("c975"),a("4795"),a("4160"),a("159b"),a("da71")),n=document.getElementsByTagName("head")[0],c=function(){function t(e,a){var s=this;Object(i["a"])(this,t),this.url=e||"",this.funcName=a;var o=document.createElement("script");e+=(~e.indexOf("?")?"&":"?")+"callback="+a,o.src=e,o.type="text/javascript",this.myTimer=setTimeout((function(){s.callCallback({status:1,info:"网络加载较慢！"}),s.clearup()}),1e4),window[a]=function(t){s.callCallback({status:0,data:t,info:""}),s.clearup()},o.onerror=function(){s.callCallback({status:1,info:"网络加载较慢！"}),s.clearup()},this.scriptNode=o,n.appendChild(this.scriptNode)}return Object(o["a"])(t,[{key:"then",value:function(t){this.callbackFunc=t}},{key:"callCallback",value:function(t){var e=this;setTimeout((function(){e.callbackFunc(t)}),0)}},{key:"clearup",value:function(){this.myTimer&&clearTimeout(this.myTimer),this.myTimer=null,this.scriptNode.src="",n.removeChild(this.scriptNode)}}]),t}(),l={request:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!t)throw new Error("url 不能为空");0!=t.indexOf("http")&&(t=r["a"].baseURL+t),a.forEach((function(e){if("object"===Object(s["a"])(e))for(var a in e)t+=~t.indexOf("?")?"&":"?",t+=a+"="+e[a]}));var i=new c(t,e);return i},cancelAll:function(){}};e["a"]=l},"72c7":function(t,e,a){"use strict";var s=a("378f"),i=a("653a"),o=a("751a"),r=a("550c"),n=a("99fa"),c=(a("ca00"),{checkIsInitialLoad:function(t){"cnooc"!=i["a"].state.globalConfig.app_home_special_flag?0==i["a"].state.mall2.pickupAddressChecked?(i["a"].state.mall2.pickupAddressChecked=!0,s["a"].vuexStorage(),c.getLocation(t)):t(null):t()},getLocation:function(t){s["a"].getLocation((function(e){e.city&&""!=e.city?(i["a"].state.currentLocation.posx=e.longitude,i["a"].state.currentLocation.posy=e.latitude,c.loadNeerPickupAddress(t)):t(null)}))},loadNeerPickupAddress:function(t){var e="/app/json/user_address/searchSelfliftAddressList",a={posx:i["a"].state.currentLocation.posx,posy:i["a"].state.currentLocation.posy,page:{index:1,pageSize:1}};o["a"].post(e,a).then((function(e){var a=e.data;if(0==a.status)if(a.data&&a.data.length>0){var s=a.data[0];c.checkEqualAndDistance(s,t)}else t(null);else t(null)}),(function(e){t(null)}))},checkEqualAndDistance:function(t,e){t.id!=i["a"].state.mall2.zitiAddress.id&&t.distance<500?r["a"].confirm("距离您最近的自提点是："+t.storeName+",是否切换到最近自提点","提示").then((function(a){c.reSelectPickupAddress(t,e)}))["catch"]((function(t){e(null)})):e(null)},reSelectPickupAddress:function(t,e){i["a"].state.mall2.zitiAddress=t,s["a"].vuexStorage((function(){e(t)})),i["a"].state.login.token&&""!=i["a"].state.login.token&&(n["a"]._addToMyPickupAddress(t.id),n["a"]._setDefaultPickupAddress(t.id))}});e["a"]=c},"7a9e":function(t,e,a){"use strict";a("8278")},"7db0":function(t,e,a){"use strict";var s=a("23e7"),i=a("b727").find,o=a("44d2"),r="find",n=!0;r in[]&&Array(1)[r]((function(){n=!1})),s({target:"Array",proto:!0,forced:n},{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),o(r)},8278:function(t,e,a){},9130:function(t,e,a){"use strict";a("46a3")},"99b4":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.showAdpage?a("div",{staticClass:"adpage",on:{click:function(e){return e.stopPropagation(),t.adPageHide.apply(null,arguments)}}},[a("div",[a("ImageAd",{attrs:{usePorpData:!0,propData:t.pageData},on:{closeEvent:t.adPageHide}})],1)]):t._e()},i=[],o=(a("d3b7"),a("3ca3"),a("ddb0"),a("7db0"),a("0d03"),a("7217")),r={name:"adpage",components:{ImageAd:function(){return a.e("chunk-1d60e26c").then(a.bind(null,"0401"))}},props:["pageAdKeywords","pgCode"],data:function(){return{pageData:null,show:!1}},computed:{showAdpage:function(){var t=this.show&&null!=this.pageData&&this.pageData.adData&&""!=this.pageData.adData;if(t){var e=this.pageData.adData,a=e.rows.find((function(t){return 0!=t.canSee}));void 0==a&&(t=!1)}return t}},methods:{adPageIsShow:function(t){var e=window.localStorage.getItem(this.pageAdKeywords+t);if(e){var a=(new Date).getTime();a>e&&(this.show=!0)}else this.show=!0},adPageHide:function(){this.show=!1},getMyPageData:function(){var t=this,e="/appcontent/js/app_vue_page/vuePageData.js",a="vuePageData_",s=[];if(s.push({appType:1}),s.push({accessType:2}),this.pgCode&&""!=this.pgCode)a+=this.pgCode,s.push({pgCode:this.pgCode});else{s.push({pageAdKeywords:this.pageAdKeywords});var i=this.$util.md5String(this.pageAdKeywords);a+=i}o["a"].request(e,a,s).then((function(e){if(0==e.status){var a=e.data.pageData;if(!a.pageDataJson)return;t.pageData=JSON.parse(a.pageDataJson);var s=e.data.id||"",i=t.pageData.adData;if(t.adPageIsShow(s),i&&t.show)if("1"==i.showFrequency){var o=new Date;o=o.setDate(o.getDate()+1),o=new Date(o).setHours(2,0,0,0);var r=new Date(o).getTime();window.localStorage.setItem(t.pageAdKeywords+s,r)}else if("2"==i.showFrequency){var n=new Date;n=n.setDate(n.getDate()+999);var c=new Date(n).getTime();window.localStorage.setItem(t.pageAdKeywords+s,c)}else if("3"==i.showFrequency){var l=(new Date).getTime()+36e3;window.localStorage.setItem(t.pageAdKeywords+s,l)}else if("4"==i.showFrequency){var d=(new Date).getTime()+0;window.localStorage.setItem(t.pageAdKeywords+s,d)}else{var h=(new Date).getTime()+36e5;window.localStorage.setItem(t.pageAdKeywords+s,h)}}}))}},created:function(){this.getMyPageData()}},n=r,c=(a("9130"),a("0c7c")),l=Object(c["a"])(n,s,i,!1,null,"1e81e30a",null);e["a"]=l.exports},e996:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"list"},[a("nav-top",{on:{backEvent:t.backEvent}}),a("nav-content",[a("div",{staticClass:"all-content"},[a("div",{staticClass:"row"},[a("div",{staticClass:"local-div single-line",on:{click:function(e){return t.selectAddressClick()}}},[a("span",{staticClass:"theme_font_gray single-line"},[t._v(t._s(t.location.cityName))]),a("i",{staticClass:"iconfont mall-arrow-down icon-size theme_font_gray"})]),a("div",{staticClass:"search-div theme_bg_white_f5",on:{click:t.toSearchEvent}},[a("i",{staticClass:"iconfont mall-sousuo theme_font_tint",staticStyle:{"font-size":"16px"}}),a("span",{staticClass:"theme_font_tint single-line"},[t._v(t._s(t.searchKey?t.searchKey:"搜你想要的商品"))])])]),a("div",{staticClass:"row row-filter top-showdow"},[""==t.categoryIdList?a("div",{staticClass:"filter-btn theme_font_black",on:{click:t.categoryEvent}},[a("i",{staticClass:"iconfont mall-datubiao filter-size-1 theme_font_black"}),a("span",{staticClass:"cate single-line"},[t._v(t._s(t.cateText))])]):t._e(),a("div",{staticClass:"filter-btn theme_font_black",on:{click:function(e){return t.filterEvent(0)}}},[a("span",{staticClass:"single-line",class:{theme_standard_font_i:0==t.filterType}},[t._v("综合排序")])]),a("div",{staticClass:"filter-btn theme_font_black",on:{click:function(e){return t.filterEvent(1)}}},[a("span",{staticClass:"single-line",class:{theme_standard_font_i:1==t.filterType||2==t.filterType}},[t._v("销量")])]),a("div",{staticClass:"filter-btn theme_font_black",on:{click:function(e){return t.filterEvent(2)}}},[a("span",{staticClass:"single-line",class:{theme_standard_font_i:3==t.filterType||4==t.filterType}},[t._v("价格")]),a("div",{directives:[{name:"show",rawName:"v-show",value:3==t.filterType||4==t.filterType,expression:"filterType == 3 || filterType == 4"}]},[a("i",{staticClass:"iconfont mall-sanjiaoxiabiao arrow-icon theme_font_tint",class:{theme_standard_font_i:3==t.filterType}}),a("i",{staticClass:"iconfont mall-xiala arrow-icon theme_font_tint",class:{theme_standard_font_i:4==t.filterType}})])]),a("div",{staticClass:"filter-btn theme_font_black",on:{click:t.superFilter}},[a("span",{staticClass:"single-line"},[t._v("筛选")]),a("i",{staticClass:"iconfont mall-shaixuan filter-size theme_font_tint"})])]),a("div",{staticClass:"list-content"},[a("div",{staticClass:"list-pull-to"},[a("pull-to",{ref:"listContent",attrs:{bottomConfig:{pullText:"",triggerText:"释放更新",loadingText:"加载中...",doneText:t.isCanLoadMore?"加载完成":"没有更多数据了",failText:"加载失败",loadedStayTime:400,stayDistance:40,triggerDistance:50},"bottom-load-method":t._loadProList,isBottomAutoS:!0,isBottomBounce:t.isCanLoadMore}},[a("div",[""!=t.pageType&&""!=t.endTime?a("div",{staticClass:"list-tip theme_bg_yl theme_font_red"},[a("p",[t._v("限时促销： "+t._s(t.tipText))]),a("p",[t._v("距离结束： "),a("countdown",{attrs:{endTime:t.endTime}})],1)]):t._e(),t.listData.length>0?a("CardList",{attrs:{listData:t.listData,cartProducts:t.cartProducts},on:{productEvent:t.productEvent,addToCart:t.addToCart}}):t._e(),a("div",{staticClass:"bottom-space"})],1)])],1),t.isNoList&&""==t.pageType?a("div",{staticClass:"no-list"},[a("div",{staticClass:"img-div"},[a("img",{attrs:{src:"static/image/mall2/no-data-img.png"}})]),a("div",{staticClass:"tip theme_font_gray"},[t._v("抱歉没有找到相应商品~")])]):t._e()]),t.cateList.length>0?a("div",{directives:[{name:"show",rawName:"v-show",value:t.showCategory,expression:"showCategory"}],staticClass:"category-div"},[a("Category",{attrs:{cateList:t.cateList},on:{closeEvent:function(e){t.showCategory=!1},cateEvent:t.cateEvent}})],1):t._e(),a("div",{staticClass:"settle-div"},[a("div",{staticClass:"cart-icon",on:{click:function(e){e.stopPropagation(),t.showCartProducts=!0}}},[a("i",{staticClass:"iconfont mall-gouwuche btn-icon theme_font_red"}),t.num>0?a("div",{staticClass:"num theme_bg_red"},[t._v(t._s(t.num))]):t._e()]),a("div",{staticClass:"info"},[a("div",{staticClass:"price"},[a("span",[t._v("¥")]),a("span",{staticClass:"big"},[t._v(t._s(t.occurData.payAmount||0))])]),a("div",{staticClass:"yf"},[t._v(" 另需配送费"+t._s(t.occurData.freightAmount||0)+"元 ")])]),a("div",{staticClass:"btn theme_standard_bg",on:{click:function(e){return e.stopPropagation(),t.toPlaceOrder.apply(null,arguments)}}},[t._v("去结算")])])])]),a("transition",{attrs:{name:"bounce"},on:{afterEnter:t.productImgAfterEnter}},[t.showProductImg&&t.addToCartItem?a("img",{staticClass:"productImg",attrs:{src:this.addToCartItem.phMainUrl,alt:""}}):t._e()]),a("transition",{on:{"after-enter":t.afterEnter,"before-enter":t.beforeEnter}},[t.showAddCartAn&&t.addToCartItem?a("div",{staticClass:"anProductImg"},[a("img",{attrs:{src:this.addToCartItem.phMainUrl,alt:""}})]):t._e()]),a("AllCategory",{directives:[{name:"show",rawName:"v-show",value:t.showAllCategory,expression:"showAllCategory"}],ref:"All_Category",attrs:{barHeight:t.$store.state.barHeight},on:{closeEvent:function(e){t.showAllCategory=!1},cateEvent:t.cateEvent}}),t.showCreated?a("Filtrate",{directives:[{name:"show",rawName:"v-show",value:t.showFiltrate,expression:"showFiltrate"}],attrs:{category:t.category},on:{filtrateEvent:t.filtrateEvent,closeEvent:t.filtrateCloseEvent}}):t._e(),t.showCartProducts?a("pop-view",{staticClass:"mall2",on:{closeEvent:function(e){t.showCartProducts=!1}}},[a("div",{staticClass:"pop-body"},[a("div",{staticClass:"pop-title theme_font_common"},[t._v("已选商品")]),a("div",{staticClass:"pop-scroll-div"},t._l(t.cartProducts,(function(e,s){return a("div",{staticClass:"pro-row"},[a("div",{staticClass:"img-div"},[a("img",{attrs:{src:e.phPictureUrl}})]),a("div",{staticClass:"info-div"},[a("div",{staticClass:"title theme_font_black"},[t._v(t._s(e.productName))]),a("div",{staticClass:"title theme_font_black"},[a("span",[t._v(t._s(e.specs))])]),a("div",{staticClass:"price pop-mdps"},[a("PriceOrder",{attrs:{productData:e}}),a("van-stepper",{staticClass:"wish-prod-stepper",attrs:{max:e.saleNumMax,min:0,step:e.saleNumStep,integer:""},on:{change:function(a){return t.onChange(e.skuId,e.number)}},model:{value:e.number,callback:function(a){t.$set(e,"number",a)},expression:"prodata.number"}})],1)])])})),0)])]):t._e()],1)},i=[],o=(a("a434"),a("acd8"),a("b0c0"),a("99af"),a("e25e"),a("e42a")),r=a("0d16"),n=a("4fe5"),c=a("2f9a"),l=a("c597"),d=a("8592"),h=a("f648"),u=a("b659"),p=a("6311"),f=a("69f4"),y=a("947f"),g=(a("72c7"),a("99b4")),v=a("590c"),m={name:"list",components:{PriceOrder:v["a"],Countdown:f["default"],CardList:o["a"],DetailList:r["a"],Filtrate:n["a"],GiftList:d["a"],PullTo:h["a"],Category:u["a"],Recommend:y["a"],AllCategory:p["a"],AdPage:g["a"]},props:["componentName","orderCategory","vipUnitUserCode"],data:function(){return{deductionSkuId:"",listStyle:1,pickuYD:!1,selectedType:2,listZitiId:"",filterType:0,category:"",listData:[],showCreated:!1,showFiltrate:!1,filterBrands:[],filterFeatureies:[],pageType:"",activityId:"",couponId:"",subtotal:"0.00",searchKey:"",scrollTopValue1:0,backRefresh:!1,activityInfo:{},cartJS:l["a"],cateLevel:"",nowPage:1,isCanLoadMore:!1,clsType:"1",isFirstEnter:!0,maxPrice:"",minPrice:"",lastPath:"",cateText:"全部分类",showCategory:!1,cateList:[],couFaceValue:"0",couThresholdAmount:"0",cartCanUseCouponAmount:"0",endTime:"",tipText:"",isNoList:!1,storeOuCode:"",showGuide:!1,showAllCategory:!1,addToCartItem:void 0,showProductImg:!1,showAddCartAn:!1,addCartBtnAn:!1,easyCardId:"",cardType:"",productType:"",categoryIdList:"",location:{},carts:[],num:0,occurData:{},paramsData_toPlaceOrder:{},resData_toPlaceOrder:{},cartProducts:[],showCartProducts:!1,loaded:!1}},mounted:function(){this.easyCardId=this.$route.query.easyCardId,this.cardType=this.$route.query.cardType},methods:{onChange:function(t,e){for(var a=-1,s=0;s<this.carts.length;s++){if(0==e){a=s;break}this.carts[s].skuId==t&&(this.carts[s].number=e)}a>-1&&this.carts.splice(a,1),this.carts.length?this._settleCart(this.carts[0].storeOuCode):(this.num=0,this.cartProducts=[],this.occurData={},this.saveTCPS_Carts())},getCouponTip:function(){var t=""!=this.cartCanUseCouponAmount?this.cartCanUseCouponAmount:"0";if(parseFloat(t)>parseFloat(this.couThresholdAmount))return"您已可以使用优惠券，优惠"+this.couFaceValue+"元";var e=this.$util.toDecimal2(parseFloat(this.couThresholdAmount)-parseFloat(t));return"还差"+e+"元可以优惠"+this.couFaceValue+"元"},cateEvent:function(t){this.showCreated=!1,this.filterBrands=[],this.filterFeatureies=[],this.showAllCategory=!1,this.showCategory=!1,this.cateText=t.name,this.category=t.id,this.cateLevel=t.cateLevel,this.clsType=t.clsType,this.nowPage=0,this._loadProList()},categoryEvent:function(){""!=this.pageType?this.showCategory=!this.showCategory:this.showAllCategory=!this.showAllCategory},getGiftText:function(){return 3==this.activityInfo.linkType?"选择赠品":4==this.activityInfo.linkType?"选择换购":5==this.activityInfo.linkType?"查看赠品":6==this.activityInfo.linkType?"查看换购":void 0},goCart:function(){1==this.$route.query.fromCart?this.$router.go(-1):this.$router.push({path:"/mall2/cart",query:{orderCategory:this.orderCategory,vipUnitUserCode:this.vipUnitUserCode}})},goGift:function(){var t=l["a"].getGiftIsOnlyScan(this.activityInfo),e=l["a"].getGiftType(this.activityInfo);d["a"].open({listData:this.activityInfo.gift,activityId:this.activityInfo.mktActivityId,sureFunc:this.sureFunc,isScan:t,giftType:e})},sureFunc:function(t){var e=this;this.$Loading.open();var a="/app/json/app_cart/addCart",s={token:this.$store.state.login.token,carts:t,deliveryType:this.selectedType,orderCategory:this.orderCategory,vipUnitUserCode:this.vipUnitUserCode};this.$http.post(a,s).then((function(t){e.$Loading.close();var a=t.data;0==a.status?(e.$store.state.mall2.cartNum=a.data,e.$Toast("添加购物车成功！")):e.$Toast(a.info)}),(function(t){e.$Loading.close(),e.$Toast("请求数据失败！")}))},backEvent:function(){this.$router.go(-1)},toSearchEvent:function(){var t=this;c["a"].open({initData:{barHeight:this.$store.state.barHeight,searchHistory:this.$store.state.mall2.searchHistory},clearSearchHistory:function(){t.$store.state.mall2.searchHistory=[]},searchEvent:function(e){c["a"].close(),t.$mallCommon.pushSearchHistory(e),t.searchKey=e,t.nowPage=0,t._loadProList()}})},listStyleEvent:function(){1==this.listStyle?this.listStyle=2:this.listStyle=1},filtrateCloseEvent:function(){this.showFiltrate=!1},selectedTypeEvent:function(t){this.$store.state.mall2.staticDeliverType=t,this.$bridgefunc.vuexStorage(),this.selectedType=t,1==t&&""==this.$store.state.mall2.zitiAddress.id?(this.backRefresh=!0,this.$router.push({path:"/mall2/mypickupaddress"})):(this.nowPage=0,this._loadProList(),this._getCartCount())},filterEvent:function(t){this.showCategory=!1,0==t?this.filterType=0:1==t?2==this.filterType?this.filterType=0:this.filterType=2:2==t&&(3==this.filterType?this.filterType=4:this.filterType=3),this.nowPage=0,this._loadProList()},filtrateEvent:function(t){this.showFiltrate=!1,this.filterBrands=[],this.filterFeatureies=[];for(var e=0;e<t.brands.length;e++)this.filterBrands.push(t.brands[e].id);for(var a=0;a<t.featureies.length;a++)this.filterFeatureies.push({id:t.featureies[a].id,featureType:t.featureies[a].featureType});this.maxPrice=t.maxPrice,this.minPrice=t.minPrice,this.nowPage=0,this._loadProList()},superFilter:function(){this.showCategory=!1,this.showFiltrate=!0,this.showCreated=!0},_loadProList:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isCanLoadMore=!1,this.isNoList=!1;var s=this.nowPage+1;0==this.nowPage&&(this.listData=[]),this.$Loading.open();var i="/app/json/product/getAppProSearchList",o={token:this.$store.state.login.token,page:s,rows:20,orderByKey:"",ascOrDesc:"",deliverType:this.selectedType,categoryId:this.category,cateLevel:this.cateLevel,brandIds:this.filterBrands,featureIds:this.filterFeatureies,couTypeCode:this.couponId,activityId:this.activityId,proName:this.searchKey,clsType:this.clsType,maxPrice:this.maxPrice,minPrice:this.minPrice,easyCardId:this.$route.query.easyCardId,orderCategory:this.orderCategory,vipUnitUserCode:this.vipUnitUserCode};1==this.filterType?(o.orderByKey="1",o.ascOrDesc="0"):2==this.filterType?(o.orderByKey="1",o.ascOrDesc="1"):3==this.filterType?(o.orderByKey="0",o.ascOrDesc="0"):4==this.filterType&&(o.orderByKey="0",o.ascOrDesc="1"),o.supportCountryDelivery="0",o.area={provinceId:this.location.provinceId,cityId:this.location.cityId,countryId:this.location.countryId,townId:this.location.townId};var r=this.$route.query.storeOuCode;r&&(o.storeOuCode=r),this.productType&&""!=this.productType&&(o.productType=this.productType),""!=this.categoryIdList&&(o.categoryIdList=this.categoryIdList),this.$http.post(i,o).then((function(s){e.$Loading.close();var i=s.data;if(0==i.status){if(e.activityId?e.$actionStatistics.listAction("130020",JSON.stringify(o),e.activityId):e.$actionStatistics.listAction("130010",JSON.stringify(o),e.activityId),0!=e.nowPage)e.listData=e.listData.concat(i.data.list);else{if(e.listData=i.data.list,0==e.listData.length){var r=sessionStorage.getItem("Pickup_YD_Is_Show");"1"!=r?(e.pickuYD=!0,sessionStorage.setItem("Pickup_YD_Is_Show","1")):e.isNoList=!0}else e.deductionSkuId=e.listData[0].skuId,e.storeOuCode=e.listData[0].storeOuCode,a&&e.$refs.All_Category.loadProCateList(e.storeOuCode);if(""!=e.pageType&&e.cateList.length<=1){var n=i.data.cateList;e.cateList=[{name:"全部分类",id:"",childList:[{name:"全部分类",id:""}]}];for(var c=0;c<n.length;c++){var l=n[c].childList;e.cateList=e.cateList.concat(l)}}}e.nowPage++,i.data.page.count<=e.listData.length?e.isCanLoadMore=!1:e.isCanLoadMore=!0}else e.$Toast(i.info);t&&t("done")}),(function(a){t&&t("done"),e.$Loading.close(),e.$Toast("请求数据失败！")}))},productEvent:function(t){var e="/mall2/city-delivery/detail";this.$router.push({path:e,query:{id:t.id,skuId:t.skuId,storeOuCode:this.$route.query.storeOuCode}})},_getCartCount:function(){var t=this;if(""!=this.$store.state.login.token){var e="/app/json/app_cart/getCartCount",a={token:this.$store.state.login.token,deliveryType:this.selectedType,orderCategory:this.orderCategory,vipUnitUserCode:this.vipUnitUserCode};this.$http.post(e,a).then((function(e){var a=e.data;0==a.status?t.$store.state.mall2.cartNum=a.data:t.$Toast(a.info)}),(function(e){t.$Loading.close(),t.$Toast("请求数据失败！")}))}},addToCart:function(t){for(var e=!1,a=0;a<this.carts.length;a++)if(this.carts[a].skuId==t.skuId){if(e=!0,t.stockNum<parseInt(this.carts[a].number)+1)return void this.$Toast("当前商品库存不足！");this.carts[a].number=parseInt(this.carts[a].number)+1}if(0==e){if(t.stockNum<1)return void this.$Toast("当前商品库存不足！");this.carts.push({skuId:t.skuId,storeOuCode:t.storeOuCode,activityId:this.activityId,selfActivityId:t.activityId,deliveryType:"2",number:1})}this._settleCart(t.storeOuCode)},_settleCart:function(t){var e=this;this.num=0;for(var a=0;a<this.carts.length;a++)this.num+=parseInt(this.carts[a].number);this.$Loading.open();var s="/app/json/app_cart/SettleCart",i={token:this.$store.state.login.token,carts:this.carts,deliveryType:"2",userAddress:this.location,userAddressId:"",couNo:["-1"]};this.$http.post(s,i).then((function(t){e.$Loading.close();var a=t.data;0==a.status?(e.loaded=!0,e.paramsData_toPlaceOrder=i,e.resData_toPlaceOrder=a.data,e.occurData=a.data.occur[0],e.getCartsProducts()):e.$Toast(a.info)}),(function(t){e.$Loading.close(),e.$Toast("请求数据失败！")}))},getCartsProducts:function(){var t=[];this.num=0;for(var e=[],a=this.occurData.store[0],s=0;s<a.activity.length;s++)for(var i=a.activity[s].cart,o=0;o<i.length;o++)t.push(i[o]),this.num+=i[o].number,e.push({skuId:i[o].skuId,storeOuCode:i[o].storeOuCode,activityId:this.activityId,selfActivityId:i[o].activityId,deliveryType:"2",number:i[o].number});for(var r=a.noActivityCart,n=0;n<r.length;n++)t.push(r[n]),this.num+=r[n].number,e.push({skuId:r[n].skuId,storeOuCode:r[n].storeOuCode,activityId:this.activityId,selfActivityId:r[n].activityId,deliveryType:"2",number:r[n].number});this.cartProducts=t,this.carts=e,this.saveTCPS_Carts()},saveTCPS_Carts:function(){sessionStorage.setItem("TCPS_Carts",JSON.stringify({carts:this.carts,cityId:this.location.cityId,storeOuCode:this.$route.query.storeOuCode}))},getTCPS_Carts:function(){return JSON.parse(sessionStorage.getItem("TCPS_Carts"))},selectAddressClick:function(){this.backRefresh=!0,this.$store.state.location.selectType="4",this.$router.push({path:"/cityselector/0"})},productImgAfterEnter:function(t){this.showProductImg=!1,this.showAddCartAn=!0},beforeEnter:function(t){t.style.transform="translate3d(0,0,0)",t.children[0].style.opacity=0},afterEnter:function(t){var e=this,a=t.getBoundingClientRect().bottom,s=t.children[0].getBoundingClientRect().left,i=this.$refs.gouwuche.getBoundingClientRect().left,o=this.$refs.gouwuche.getBoundingClientRect().top;t.style.transform="translate3d(0,".concat(o-a,"px,0)"),t.style.transition="transform .55s cubic-bezier(0.3, -0.25, 0.7, -0.15)",t.children[0].style.transform="translate3d(".concat(i-s,"px,0,0)"),t.children[0].style.transition="transform .55s linear",t.children[0].style.opacity=1,this.showAddCartAn=!1,t.addEventListener("transitionend",(function(){e.addCartBtnAn=!0,e.$refs.gouwuche.addEventListener("webkitAnimationEnd",(function(){e.addCartBtnAn=!1}))}))},toPlaceOrder:function(){if(0!=this.num){if(this.resData_toPlaceOrder.occur.length>0){var t=this.resData_toPlaceOrder.occur[0];if(t.startAmount>0&&t.startAmount>t.realAmount)return void this.$Toast(t.startAmount+"元起送！")}var e={res:this.resData_toPlaceOrder,paramsData:this.paramsData_toPlaceOrder,deliveryType:"2"};this.$router.push({name:"citydeliveryplaceorder",params:e})}},testCarts:function(){var t=this.getTCPS_Carts();t&&t.cityId==this.location.cityId&&t.storeOuCode==this.$route.query.storeOuCode?(this.carts=t.carts||[],this.carts.length>0&&this._settleCart(this.carts[0].storeOuCode)):(this.carts=[],this.cartProducts=[],this.num=0,this.occurData={},this.saveTCPS_Carts())}},created:function(){var t=this;"2"==this.$store.state.globalConfig.city_delivery_default_filter_type?this.filterType="2":"3"==this.$store.state.globalConfig.city_delivery_default_filter_type?this.filterType="3":"4"==this.$store.state.globalConfig.city_delivery_default_filter_type&&(this.filterType="4"),this.lastPath=this.$route.query.lastPath?this.$route.query.lastPath:"",this.searchKey=this.$route.query.searchKey?this.$route.query.searchKey:"",this.clsType=this.$route.query.clsType?this.$route.query.clsType:"1",this.cateText=this.$route.query.categoryName?this.$route.query.categoryName:"全部分类",this.nowPage=0,this.isCanLoadMore=!1,this.isNoList=!1;var e=sessionStorage.getItem("Address_City_Seleted");e?(e=JSON.parse(e),this.location=e,this._loadProList(null,!0),this.testCarts()):this.$bridgefunc.getLocation((function(e){var a={province:e.province,city:e.city,district:e.area};e.city==e.province&&(a.city=e.area,a.district=""),t.$mallCommon.pureLocationAnalysis((function(e){t.location=e,sessionStorage.setItem("Address_City_Seleted",JSON.stringify(e)),t._loadProList(null,!0),t.testCarts()}),a)}))},activated:function(){if(this.backRefresh){this.backRefresh=!1;var t=sessionStorage.getItem("Address_City_Seleted");t&&(t=JSON.parse(t),this.location=t,this.nowPage=0,this._loadProList(null,!0))}else this.$refs.listContent.setScrollTopValue(this.scrollTopValue1);this.loaded&&this.testCarts()},beforeRouteLeave:function(t,e,a){t.path!=this.lastPath?this.scrollTopValue1=this.$refs.listContent.getScrollTopValue():this.$keepaliveHelper.deleteCache(this),a()}},C=m,_=(a("7a9e"),a("0c7c")),w=Object(_["a"])(C,s,i,!1,null,"469fce26",null);e["default"]=w.exports}}]);