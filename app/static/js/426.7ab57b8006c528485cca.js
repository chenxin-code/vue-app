(window.webpackJsonp=window.webpackJsonp||[]).push([[426],{"3fMi":function(t,e,n){"use strict";var a=n("XcJb");n.n(a).a},"4goL":function(t,e,n){},AsfX:function(t,e,n){"use strict";var a=n("4goL");n.n(a).a},XcJb:function(t,e,n){},p3Dl:function(t,e,n){"use strict";n.r(e);var a=n("dqDD"),o={data:function(){return{number:"",phone:"",validate:"",referee:"",obtain:"获取验证码",disabled:!1,Member:"",prohibit:!1,noprefix:"",theScanCode:"",inway:"",lastPath:"",newList:"",cardPrompt:""}},mounted:function(){this.getphone(),this.recommenderHistory()},created:function(){this.showagreement(),this.inway=this.$route.query.inway?this.$route.query.inway:"",this.lastPath=this.$route.query.lastPath?this.$route.query.lastPath:"",this.rfrCodeType=1;var t=this.$store.state.mall2.behalf.referrerInvalidDate;t&&null!=t&&""!=t?new Date(t).getTime()>=(new Date).getTime()&&(this.referee=this.$store.state.mall2.behalf.referrer):this.referee=this.$store.state.mall2.behalf.referrer},methods:{gobindUnitCard:function(){this.$router.push({path:"/bindUnitCard"})},showagreement:function(){var t=this;this.$request.post("/app/json/news/getNewsList",{values:24}).then((function(e){0==e.status&&(t.cardPrompt=e.data[0]?e.data[0].content:"")}))},backEvent:function(){this.$router.go(-1)},jiami:function(t){return t.substr(0,4)+"****"+t.substr(-4)},changeRfrCodeType:function(){this.rfrCodeType=1},sweep:function(){var t=this;this.$bridgefunc.scanCode((function(e){t.rfrCodeType=2,console.log(e.code),t.theScanCode=e.code,t.referee=e.code}))},countdown:function(){var t=this,e=this,n=this,o=60;/^[0-9]{11}$/.test(this.number)?this.$request.post("/app/json/card/checkCardHasBind",{cardno:this.noprefix+this.number}).then((function(s){0==s.status?(t.$Loading.open(),t.$http.post("/app/json/message/sendVerifyBindCardSms",{token:n.$store.state.login.token,phone:t.phone,cardno:t.noprefix+t.number}).then((function(t){n.$Loading.close(),console.log(t),"error"===t.data.result?Object(a.Toast)(t.data.info):(Object(a.Toast)("获取验证码成功"),function t(){if(0==o)return e.disabled=!1,e.obtain="获取验证码",o=60,!1;e.disabled=!0,e.obtain="重新发送("+o+")",o--,setTimeout((function(){t()}),1e3)}())}))):t.$Toast(s.info)})):Object(a.Toast)("请输入正确卡号")},renders:function(){var t=this;if(console.log(this.number),console.log(this.phone),console.log(this.validate),this.referee==this.theScanCode?this.rfrCodeType=2:this.rfrCodeType=1,/^[0-9]{11}$/.test(this.number))if(""!==this.validate){console.log(),this.$Loading.open();var e=this;this.$http.post("/app/json/card/bindCard",{token:e.$store.state.login.token,cardno:this.noprefix+this.number,smscode:this.validate,referrer:this.referee,bindway:3,rfrCodeType:this.rfrCodeType}).then((function(n){e.$Loading.close(),console.log(n),-1!==n.data.status?0===n.data.status&&t.$router.go(-1):Object(a.Toast)(n.data.info)}))}else Object(a.Toast)("请输入正确短信验证码");else Object(a.Toast)("请输入正确卡号")},getphone:function(){var t=this;this.$Loading.open();var e=this;this.$http.post("/app/json/card/getcardnopre",{token:e.$store.state.login.token}).then((function(n){e.$Loading.close(),console.log(n),t.phone=n.data.data.phone,t.noprefix=n.data.data.noprefix,t.Member=t.phone}))},getNewsList:function(){var t=this;this.$Loading.open();var e=this;this.$http.post("/app/json/news/getNewsList",{token:e.$store.state.login.token,values:21}).then((function(n){e.$Loading.close(),t.newList=n.data.data[0],console.log(t.newList)}))},recommenderHistory:function(){this.$Loading.open();var t=this;this.$http.post("/app/json/card/getBindCardReferrer",{token:t.$store.state.login.token}).then((function(e){console.log(333,e),t.$Loading.close(),e.data.data?(t.referee=e.data.data?e.data.data:"",t.prohibit=!0):t.prohibit=!1}))}}},s=(n("3fMi"),n("AsfX"),n("KHd+")),i=Object(s.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"index"}},[n("mt-header",{attrs:{title:"加油卡绑定"}},[n("mt-button",{attrs:{slot:"left",icon:"back"},on:{click:t.backEvent},slot:"left"})],1),t._v(" "),n("div",{staticClass:"conter"},[n("p",{staticClass:"ma-top"}),t._v(" "),n("div",{staticClass:"input"},[n("ul",{staticClass:"inputnumber"},[n("li",{staticClass:"cardnoTitle"},[t._v("加油卡号")]),t._v(" "),n("li",{staticClass:"cardnoLi"},[t._v(t._s(t.noprefix))]),t._v(" "),n("li",{staticClass:"cardnoInput"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.number,expression:"number"}],attrs:{type:"number",placeholder:"请输入卡号后11位"},domProps:{value:t.number},on:{input:function(e){e.target.composing||(t.number=e.target.value)}}})])]),t._v(" "),n("mt-field",{attrs:{label:"手机号码",placeholder:"请输入手机号",disabled:"",type:"tel"},model:{value:t.Member,callback:function(e){t.Member=e},expression:"Member"}}),t._v(" "),n("mt-field",{attrs:{label:"手机验证码",attr:{maxlength:6},placeholder:"请输入短信验证码",type:"type"},model:{value:t.validate,callback:function(e){t.validate=e},expression:"validate"}},[n("input",{staticClass:"fl-right",style:{background:"#fff",fontSize:"12px",color:"获取验证码"===t.obtain?"#f02c2c":"#ccc"},attrs:{type:"button",value:t.obtain,disabled:t.disabled},on:{click:t.countdown}})]),t._v(" "),n("mt-field",{attrs:{label:"推荐人",placeholder:"请输入推荐人（选填）"},on:{input:t.changeRfrCodeType},model:{value:t.referee,callback:function(e){t.referee=e},expression:"referee"}},[n("img",{attrs:{src:"static/image/fuelcard//btn_Sweep.png",width:"25",height:"25"},on:{click:t.sweep}})]),t._v(" "),n("p",{staticClass:"btn",on:{click:t.renders}},[t._v("提交")]),t._v(" "),n("p",{staticClass:"bind-unit-card",on:{click:t.gobindUnitCard}},[t._v("单位加油卡绑定>")])],1),t._v(" "),t.cardPrompt?n("div",{staticClass:"card-prompt"},[n("h3",{staticClass:"title"},[t._v("温馨提示：")]),t._v(" "),n("div",{staticClass:"content",domProps:{innerHTML:t._s(t.cardPrompt)}})]):t._e()])],1)}),[],!1,null,"7dee79e0",null);e.default=i.exports}}]);