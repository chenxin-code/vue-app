(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57ead1e4","chunk-7baddb58"],{1497:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"bottom"},[s("nav-top",{attrs:{title:3==t.pageType?"附件的商铺":"自提站点"},on:{backEvent:t.backEvent}}),s("nav-content",[s("div",{staticClass:"search"},[s("div",{staticClass:"loacl-div",on:{click:t.selectArea}},[s("div",{staticClass:"text theme_font_common"},[t._v(t._s(t.regionText))]),s("div",{staticClass:"arrow"},[s("i",{staticClass:"iconfont mall-arrow-down theme_font_common"})])]),s("div",{staticClass:"graybg theme_bg_white_ef"},[s("i",{staticClass:"iconfont mall-sousuo theme_font_tint",on:{click:t.sraechClick}}),s("form",{staticClass:"search-input",attrs:{action:"",id:"form1"}},[s("input",{staticStyle:{display:"none"},attrs:{type:"text",name:"keyword"}}),s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchStr,expression:"searchStr"}],staticClass:"search-input",attrs:{type:"search",placeholder:"输入您想查找的自提点名称"},domProps:{value:t.searchStr},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sraechClick.apply(null,arguments)},input:function(e){e.target.composing||(t.searchStr=e.target.value)}}})])])]),s("div",{staticClass:"site-list-div"},[s("sitelist",{attrs:{selectedId:t.$store.state.mall2.zitiAddress.id,showDistance:!0,"site-list":t.siteList1,pageType:t.pageType},on:{selectsite:t.selectItem}}),t.siteList2.length>0?s("div",{staticClass:"no-stock"},[t._v("以下自提点无货")]):t._e(),s("sitelist",{attrs:{selectedId:t.$store.state.mall2.zitiAddress.id,showDistance:!0,"site-list":t.siteList2,pageType:t.pageType},on:{selectsite:t.selectItem}})],1)]),t.showSelect?s("RegionSelect",{ref:"regionselect",attrs:{initData:t.initData},on:{selectedItemsEvent:t.selectedItemsEvent,closeEvent:t.regionCloseEvent}}):t._e()],1)},a=[],n=(s("e17f"),s("2241")),o=(s("b0c0"),s("6f93")),c=s("99fa"),r=s("a026"),d=s("8431"),l={name:"sites",components:{Sitelist:o["a"],RegionSelect:d["default"]},data:function(){return{searchStr:"",isShowSureBtn:!1,siteList1:[],siteList2:[],selectedSite:{},initData:{title:"请选择地区",initAreas:[this.$store.state.indexData.province,this.$store.state.indexData.city],canNotReselect:!0},showSelect:!1,regionText:"附近",region:[],areaData:{provinceId:"",provinceName:"",cityId:"",cityName:"",countryId:"",countryName:"",townId:"",townName:""},pageType:0,skuIds:[],tags:[],productType:""}},methods:{selectArea:function(){this.initData={title:"请选择地区",initAreas:[this.$store.state.indexData.province,this.$store.state.indexData.city]},this.showSelect=!this.showSelect,1==this.showSelect&&this._getRegionData(0)},selectedItemsEvent:function(t){var e=t.item;if(this.selectedItems=t.selecteds,3==this.selectedItems.length)return this.showSelect=!1,this.region=this.selectedItems,void this.getRegionText();this._getRegionData(e.id)},regionCloseEvent:function(){this.showSelect=!1},_getRegionData:function(t){var e=this;this.$Loading.open();var s="/app/json/area/loadAreaList",i={token:this.$store.state.login.token,parentId:t};this.$http.post(s,i).then((function(t){e.$Loading.close();var s=t.data;if(0==s.status){var i=s.data;i.length>0?e.$refs.regionselect.pushCustomOptions(i):(e.showSelect=!1,e.region=e.selectedItems,e.getRegionText())}else e.$Toast(s.info)}),(function(t){e.$Loading.close(),e.$Toast("获取数据失败")}))},getRegionText:function(){for(var t="",e={provinceId:"",provinceName:"",cityId:"",cityName:"",countryId:"",countryName:"",townId:"",townName:"",id:"-1"},s=0;s<this.region.length;s++){var i=this.region[s];t=i.name,0==s?(e.provinceId=i.id,e.provinceName=i.name):1==s?(e.cityId=i.id,e.cityName=i.name):2==s?(e.countryId=i.id,e.countryName=i.name):3==s&&(e.townId=i.id,e.townName=i.name)}e.addressFull=e.provinceName+e.cityName+e.countryName+e.townName,this.areaData=e,this._getsitelist(),this.regionText=t,this.$refs.regionselect.reset(null)},backEvent:function(){this.$router.go(-1)},sureEvent:function(){},sraechClick:function(){this._getsitelist()},_getsitelist:function(){var t=this;this.$Loading.open();var e="/app/json/user_address/searchSelfliftAddressList";6==this.productType&&(e="/app/json/store/getStoreList");var s={storeName:this.searchStr,posx:this.$store.state.currentLocation.posx,posy:this.$store.state.currentLocation.posy,token:this.$store.state.login.token,provinceId:this.areaData.provinceId,cityId:this.areaData.cityId,countryId:this.areaData.countryId,townId:this.areaData.townId,page:{index:1,pageSize:50},skuIds:this.skuIds};this.isOpenCard&&6!=this.productType&&(s.isOpenCard=this.isOpenCard),this.tags&&(s.storeOuCodeList=this.tags),this.$http.post(e,s).then((function(e){t.$Loading.close();var s=e.data;if(0==s.status){for(var i=s.data,a=[],n=[],o=0;o<i.length;o++){var c=i[o];1==c.hasStock?a.push(c):n.push(c)}t.siteList1=a,t.siteList2=n}else t.$Toast(s.info)}),(function(e){t.$Loading.close(),t.$Toast("获取自提站点失败")}))},selectItem:function(t){var e=this;this.$store.state.addPickupAddressType?this.selectAddress(t):n["a"].confirm({title:"提示",message:"是否自动加入到我的自提点",cancelButtonText:"不加入",confirmButtonText:"自动加入"}).then((function(){e.$store.state.addPickupAddressType=1,e.selectAddress(t)}))["catch"]((function(){e.$store.state.addPickupAddressType=2,e.selectAddress(t)}))},selectAddress:function(t){if(this.selectedSite=t,r["default"].set(this.$store.state.mall2,"zitiAddress",t),c["a"]._addToMyPickupAddress(t.id),c["a"]._setDefaultPickupAddress(t.id),this.$bridgefunc.vuexStorage(),3==this.pageType){this.$store.state.mall2.staticDeliverType=1;var e="/mall2/list/"+this.$util.getDataString();this.$router.push({path:e,query:{lastPath:this.$route.path,productType:this.productType}})}else this.backEvent()}},created:function(){this.tags=this.$route.query.tags?this.$route.query.tags:"",this.skuIds=this.$route.query.skuIds?JSON.parse(this.$route.query.skuIds):[],this.pageType=this.$route.query.pageType?this.$route.query.pageType:0,this.productType=this.$route.query.productType||"",this.isOpenCard=this.$route.query.isOpenCard||"",3==this.pageType&&(document.title="附件的商铺"),this._getsitelist()},beforeRouteLeave:function(t,e,s){this.$keepaliveHelper.deleteCache(this),s()}},h=l,u=(s("b651"),s("0c7c")),p=Object(u["a"])(h,i,a,!1,null,"9db152aa",null);e["default"]=p.exports},"1d33":function(t,e,s){"use strict";s("a6be")},"35b9":function(t,e,s){},8431:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"region-select"},[s("div",{staticClass:"other-div",on:{click:t.close}}),s("transition",{attrs:{name:"pop_transiton"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.popShow,expression:"popShow"}],staticClass:"select-content"},[s("div",{staticClass:"close-btn",on:{click:t.close}},[s("img",{attrs:{src:"static/image/mall/close.png"}})]),s("div",{staticClass:"font-medium-l-x title"},[t._v(t._s(t.initData.title?t.initData.title:"请选择区域"))]),s("div",{staticClass:"selected-item font-medium"},[t._l(t.selectedItems,(function(e,i){return s("div",{staticClass:"item-div",on:{click:function(e){return t.reSelect(i)}}},[s("div",{staticClass:"item-text"},[t._v(t._s(e.name))])])})),t.cusOptions.length>0?s("div",{staticClass:"item-div"},[s("div",{staticClass:"item-text item-selected theme_font_red"},[t._v("请选择")])]):t._e()],2),s("div",{staticClass:"options-div"},t._l(t.cusOptions,(function(e,i){return s("div",{staticClass:"option",on:{click:function(s){return t.selectOption(e,i)}}},[t._v(t._s(e.name))])})),0)])])],1)},a=[],n=(s("4795"),s("a434"),s("b0c0"),{name:"",props:{initData:{type:Object,default:{}}},data:function(){return{popShow:!1,selectedIndexs:[],selectedItems:[],dataCache:[],cusOptions:[],cusIndex:0,initAreas:[],myTimeout:null}},methods:{close:function(){var t=this;this.popShow=!1,this.myTimeout&&(clearTimeout(this.myTimeout),this.myTimeout=null),this.myTimeout=setTimeout((function(){t.$emit("closeEvent","")}),240)},reSelect:function(t){if(1!=this.initData.canNotReselect){var e=this.selectedItems.length-t;this.selectedItems.splice(t,e),this.selectedIndexs.splice(t,e);var s=this.dataCache[t];this.dataCache.splice(t+1,e),this.cusOptions=s}},selectOption:function(t,e){this.cusIndex=e,this.selectedItems.push(t),this.selectedIndexs.push(e),this.cusOptions=[];var s={item:t,selecteds:this.selectedItems};this.$emit("selectedItemsEvent",s)},pushCustomOptions:function(t){if(0==this.selectedIndexs.length&&(this.selectedIndexs=[],this.selectedItems=[],this.dataCache=[],this.cusIndex=0),this.dataCache.push(t),this.cusOptions=t,this.initAreas&&this.initAreas.length>0){for(var e=this.initAreas.shift(),s=!1,i=0;i<t.length;i++){var a=t[i];if(this.$util.areaEqual(e,a.name)){s=!0,this.selectOption(a,i);break}}0==s&&(this.initAreas=[])}},reset:function(t){this.selectedIndexs=[],this.selectedItems=[],this.cusIndex=0,t?(this.dataCache=[],this.dataCache.push(t),this.cusOptions=t):(this.cusOptions=this.dataCache[0],this.dataCache=[],this.dataCache.push(this.cusOptions))}},created:function(){try{this.initAreas=JSON.parse(JSON.stringify(this.initData.initAreas))}catch(t){this.initAreas=[]}},mounted:function(){this.popShow=!0}}),o=n,c=(s("1d33"),s("0c7c")),r=Object(c["a"])(o,i,a,!1,null,"6251ae42",null);e["default"]=r.exports},a6be:function(t,e,s){},b651:function(t,e,s){"use strict";s("35b9")}}]);