(window.webpackJsonp=window.webpackJsonp||[]).push([[736],{GOGu:function(t,o,e){},IDQE:function(t,o,e){"use strict";var n=e("GOGu");e.n(n).a},atC7:function(t,o,e){"use strict";e.r(o),e("5+UC");var n=e("05lO"),i=e("lH8D"),a=e("qUbg"),s={name:"index",mixins:[{methods:{applyData:function(t){return this.$http.post("/app/json/micro_store_front_end/getCollectMicroStoreByUserId",t)},upData:function(t){return this.$http.post("/app/json/micro_store_front_end/sortOrCancelMicroStoreCollect",t)},collectionData:function(t){return this.$http.post("/app/json/micro_store_front_end/addOrCancelMicroStoreCollect",t)}}}],components:{Recommend:i.a},data:function(){return{proList:[],loaded:!1,isShowCollect:!1,isShowshop:!0,scrollValue:0,active:0,show:!1,show1:!1,storeList:[],actions:[{name:"置顶"},{name:"取消收藏"}],actions1:[{name:"取消置顶"},{name:"取消收藏"}],page:0,loading:!1,finished:!1,topType:"",operationId:"",isLoading:!0,isFinished:!1,queryBrandPage:0,brandList:[]}},methods:{goBack:function(){this.$route.query.backApp?a.a.navigatorBack({url:"0"}).then((function(t){console.log(t)})):this.$router.go(-1)},collectEvent:function(t){var o=this,e={token:this.$store.state.login.token,id:t.id,skuId:t.skuId,deliveryType:t.deliveryType,storeOuCode:t.storeOuCode};this.$http.post("/app/json/user_pro_collect/addOrCancelUserProCollect",e).then((function(t){var e=t.data;0==e.status?o._getCollectionData():o.$Toast(e.info)}),(function(t){o.$Toast("请求数据失败！")}))},dataProcessing:function(t){var o=this.$mallCommon.priceFromItem(t);t.dpedData=o},_getCollectionData:function(){var t=this;this.proList=[];var o={token:this.$store.state.login.token};this.$Loading.open(),this.$http.post("/app/json/product/loadUserProCollectList",o).then((function(o){t.$Loading.close();var e=o.data;0==e.status?(t.proList=e.data,t.proList.length>0?t.isShowCollect=!0:t.isShowCollect=!1,t.loaded=!0):(t.$Toast(e.info),t.isShowCollect=!1)}),(function(o){t.$Loading.close(),t.$Toast("请求数据失败！"),t.isShowCollect=!1}))},productEvent:function(t){var o="/mall2/detail/"+this.$util.getDataString();2==t.productType&&(o="/mall2/ticketdetail"),this.$router.push({path:o,query:{id:t.id,skuId:t.skuId,lastPath:this.$route.path,productType:t.productType}})},onSelect:function(t){this.show=!1,this.show1=!1,"置顶"==t.name?(console.log(11),this.upFun(),console.log(33)):"取消置顶"==t.name?this.upFun():"取消收藏"==t.name&&this.collectionFun()},operation:function(t){console.log("sortVal值",t),this.operationId=t.storeId,1==t.sortVal?(this.show=!1,this.show1=!0,this.topType=2):2==t.sortVal&&(this.show1=!1,this.show=!0,this.topType=1)},upFun:function(){var t=this,o={token:this.$store.state.login.token,id:t.operationId,topType:t.topType};t.upData(o).then((function(o){console.log(666,o),"success"===o.data.result&&(t.finished=!1,t.page=0,t.storeList=[],t.collectionStore())}))},collectionFun:function(){var t=this,o={token:this.$store.state.login.token,storeId:this.operationId};t.collectionData(o).then((function(o){"success"===o.data.result&&(t.finished=!1,t.page=0,t.storeList=[],t.collectionStore())}))},collectionStore:function(){var t=this;t.page=t.page+1;var o={token:this.$store.state.login.token,page:t.page,rows:10};t.loading=!0,t.applyData(o).then((function(o){if("success"===o.data.result){var e=o.data.data||[];t.storeList=t.storeList.concat(e)||[],t.page>=o.data.totalPages&&(t.finished=!0)}else Object(n.a)(o.data.info);t.loading=!1}))},getBrandList:function(){var t=this;this.$Loading.open(),this.queryBrandPage++,this.isLoading=!0,this.$http.post("/app/json/product/loadUserBrandCollectList",{page:this.queryBrandPage,rows:20,collectType:3}).then((function(o){t.isLoading=!1;var e,n=o.data;0==n.status?n.data instanceof Array?((e=t.brandList).push.apply(e,function(t){if(Array.isArray(t)){for(var o=0,e=Array(t.length);o<t.length;o++)e[o]=t[o];return e}return Array.from(t)}(n.data)),t.brandList.length>=n.totalRecords&&(t.isFinished=!0)):t.isFinished=!0:t.$Toast(n.info),t.$Loading.close()})).catch((function(o){t.$Toast("loadUserProCollectList err "+o),t.$Loading.close()}))},cancelCollection:function(t){var o=this;console.log(t),this.$http.post("/app/json/user_pro_collect/addOrCancelUserProCollect",{collectType:3,brandId:t.brandId,brandName:t.brandName,logoUrl:t.logoUrl}).then((function(t){var e=t.data;0==e.status?(o.$Toast("已取消收藏"),o.isLoading=!0,o.finished=!1,o.brandList=[],o.getBrandList()):o.$Toast(e.info)}),(function(t){o.$Toast("请求数据失败！")}))},brandClick:function(t){this.$router.push({path:"/brand_prod_list",query:{brandId:t.brandId}})},changeTabs:function(t){2==t&&(this.queryBrandPage=0,this.isFinished=!1,this.isLoading=!0,this.brandList=[],this.getBrandList())}},created:function(){this.active=this.$route.query.active?Number(this.$route.query.active):0},mounted:function(){},activated:function(){this._getCollectionData()},beforeRouteLeave:function(t,o,e){this.$keepaliveHelper.deleteCache(this),e()}},c=(e("IDQE"),e("KHd+")),l=Object(c.a)(s,(function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{staticClass:"index"},[e("nav-top",{on:{backEvent:t.goBack}}),t._v(" "),t.loaded?e("nav-content",[e("div",{ref:"collection",staticClass:"no-collection"},[e("van-tabs",{staticClass:"van-tab-container",on:{change:t.changeTabs},model:{value:t.active,callback:function(o){t.active=o},expression:"active"}},[e("van-tab",{attrs:{title:"收藏的商品"}},[e("div",[t.isShowCollect?t._e():e("div",[e("img",{staticClass:"no-collection-img",attrs:{src:"static/image/mall2/collection.png"}}),t._v(" "),e("div",{staticClass:"recommend-div"},[e("Recommend")],1)]),t._v(" "),t.isShowCollect?e("div",t._l(t.proList,(function(o,n){return e("div",{staticClass:"row theme_bg_white",on:{click:function(e){return t.productEvent(o)}}},[t._v("\n                "+t._s(t.dataProcessing(o))+"\n                "),e("mt-cell-swipe",{staticClass:"cell-swipe",attrs:{right:[{content:"取消收藏",style:{padding:"20px 14px",background:"#F80F16",color:"white",display:"flex",alignItems:"center"},handler:function(){return t.collectEvent(o,n)}}]}},[e("div",{attrs:{slot:"title"},slot:"title"},[e("div",{staticClass:"img-div"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:o.phMainUrl,expression:"item.phMainUrl"}]})]),t._v(" "),e("div",{staticClass:"info-div"},[e("div",{staticClass:"title theme_font_black double-line"},[t._v(t._s(o.skuName))]),t._v(" "),e("div",{staticClass:"info-row price"},[e("span",{staticClass:"price-x theme_font_red"},[t._v("￥")]),t._v(" "),e("span",{staticClass:"left-no-space price-z theme_font_red"},[t._v(t._s(o.dpedData.integer))]),t._v(" "),e("span",{staticClass:"left-no-space price-x theme_font_red"},[t._v("."+t._s(o.dpedData.decimals))]),t._v(" "),o.dpedData.linePrice?e("span",{staticClass:"font-small theme_font_tint line-through"},[t._v("￥"+t._s(o.dpedData.linePrice))]):t._e()])])])])],1)})),0):t._e()])]),t._v(" "),e("van-tab",{attrs:{title:"收藏的微店"}},[e("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.collectionStore},model:{value:t.loading,callback:function(o){t.loading=o},expression:"loading"}},[e("div",t._l(t.storeList,(function(o,n){return e("div",{key:n},[e("ul",[e("li",{on:{click:function(e){return t.operation(o)}}},[1==o.microStoreAttentionInfo.topFlag?e("p",{staticClass:"top"},[t._v("置顶")]):t._e(),t._v(" "),e("div",{staticClass:"contain"},[e("div",{staticClass:"div1"},[e("img",{attrs:{src:o.pictureUrl?o.pictureUrl:"/static/image/microShop/head@2x.png",alt:""}}),t._v(" "),e("div",{staticClass:"containDiv"},[e("p",{staticClass:"user"},[t._v(t._s(o.storeName))]),t._v(" "),e("div",{staticClass:"code"},[t._v("关注店铺："+t._s(o.microStoreAttentionInfo.id))]),t._v(" "),e("div",{staticClass:"count"},[e("p",[t._v("关注"),e("span",[t._v(t._s(o.microStoreAttentionInfo.attentionCount))])]),t._v(" "),e("p",[t._v("订单"),e("span",[t._v(t._s(o.microStoreAttentionInfo.orderCount))]),t._v("笔")]),t._v(" "),e("p",[t._v("成交额"),e("span",[t._v(t._s(o.microStoreAttentionInfo.sellAmount))]),t._v("元")])])])]),t._v(" "),e("span",{staticClass:"iconfont mall-gengduo"})])])])])})),0)])],1),t._v(" "),e("van-tab",{attrs:{title:"收藏的品牌"}},[e("div",{staticClass:"brand-list-container"},[e("van-list",{attrs:{finished:t.isFinished,"finished-text":"没有更多了",offset:200},on:{load:t.getBrandList},model:{value:t.isLoading,callback:function(o){t.isLoading=o},expression:"isLoading"}},t._l(t.brandList,(function(o,n){return e("van-swipe-cell",{key:n,staticClass:"brand-item",scopedSlots:t._u([{key:"right",fn:function(){return[e("van-button",{staticClass:"cancel-collection",attrs:{type:"danger",text:"取消收藏"},on:{click:function(e){return e.stopPropagation(),t.cancelCollection(o)}}})]},proxy:!0}],null,!0)},[e("div",{staticClass:"item",on:{click:function(e){return e.stopPropagation(),t.brandClick(o)}}},[e("img",{staticClass:"logo",attrs:{src:o.logoUrl,alt:""}}),t._v(" "),e("p",{staticClass:"brand-name"},[t._v(t._s(o.brandName))])])])})),1)],1)])],1)],1)]):t._e(),t._v(" "),e("van-action-sheet",{attrs:{actions:t.actions},on:{select:t.onSelect},model:{value:t.show,callback:function(o){t.show=o},expression:"show"}}),t._v(" "),e("van-action-sheet",{attrs:{actions:t.actions1},on:{select:t.onSelect},model:{value:t.show1,callback:function(o){t.show1=o},expression:"show1"}})],1)}),[],!1,null,"80fd5bf6",null);o.default=l.exports}}]);