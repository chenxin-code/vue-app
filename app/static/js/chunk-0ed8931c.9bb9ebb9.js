(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ed8931c"],{"35e5":function(t,a,n){"use strict";n.r(a);var i=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",[n("nav-top",{attrs:{title:"先享卡详情"},on:{backEvent:t.goback}}),n("nav-content",[n("div",{staticClass:"header"},[n("div",{staticClass:"icon",class:{icon2:2==t.iconType,icon3:3==t.iconType}}),n("div",{staticClass:"info"},[t._v(" "+t._s(t.stateText())+" ")]),n("h2",[t._v(t._s(t.timeInfo))])]),n("div",{staticClass:"state-warp"},[n("h2",[t._v("约定内容")]),n("div",{staticClass:"card top"},[n("div",{staticClass:"detail"},[n("div",{staticClass:"time"},[t._v(" "+t._s(t.dataInfo.actEffEndTime)+"前 ")]),n("h3",[t._v(" "+t._s(t.dataInfo.totalObjective)+" ")]),t.dataInfo.remark?n("div",{staticClass:"info"},[t._v(" "+t._s(t.dataInfo.remark)+" ")]):t._e(),n("div",{staticClass:"state"},[t.stateInfo?n("span",{staticClass:"btn"},[t._v(t._s(t.stateInfo))]):t._e(),n("span",[t._v("已完成"+t._s(t.dataInfo.completeCnt||0)+"次，待完成"+t._s(t.unDone(t.dataInfo.objectiveCnt,t.dataInfo.completeCnt))+"次")])]),n("van-progress",{attrs:{percentage:t.range(t.dataInfo.objectiveCnt,t.dataInfo.completeCnt),color:"#F02C2D","show-pivot":!1}})],1),n("van-notice-bar",{attrs:{scrollable:"",text:"若未完成约定，仅扣回已享优惠不吃亏"}})],1),t.recordList.length?n("h2",[t._v("先享卡享受优惠记录")]):t._e(),t.recordList.length?n("div",{staticClass:"card bottom"},t._l(t.recordList,(function(a,i){return n("div",{key:i,staticClass:"record"},[n("div",{staticClass:"r-time"},[t._v(" "+t._s(a.tradeTime)+" ")]),2==a.type?n("div",[t._v(" 领取先享卡成功 ")]):3==a.type?n("div",[t._v(" "+t._s(a.info)+" ")]):n("div",{staticClass:"r-info"},[t._v(" 使用奖励优惠1次，已享优惠"+t._s(a.discountAmount)+" 元 ")])])})),0):t._e()])])],1)},s=[],e=(n("99af"),n("e25e"),n("ffc1"),{data:function(){return{dataInfo:{},timeInfo:"",stateInfo:"",iconType:1,recordList:[]}},created:function(){var t=this;this.$Loading.open();var a={id:this.$route.query.id};this.$http.post("/app/json/wx_discount_card/loadDiscountCardDetail",a).then((function(a){t.$Loading.close();var n=a.data;0==n.status?(t.dataInfo=n.data,t.recordList=t.dataInfo.detail||[],t.dataInfo.getTime&&(t.recordList.unshift({tradeTime:t.dataInfo.getTime,type:3,info:t.stateText()}),t.recordList.push({tradeTime:t.dataInfo.getTime,type:2}))):t.$toast(n.info)}))["catch"]((function(a){t.$Loading.close()}))},methods:{goback:function(){this.$router.go(-1)},stateText:function(){if("APPLY"==this.dataInfo.state)return this.stateInfo="先享卡申请中",this.stateInfo;if("ONGOING"==this.dataInfo.state)return this.timeInfo="履约截止时间：".concat(this.dataInfo.actEffEndTime),this.stateInfo="约定进行中","".concat(this.stateInfo,"，已享优惠").concat(this.dataInfo.discountAmount||0,"元");if("CHECKING"==this.dataInfo.state)return this.stateInfo="约定到期核对中",stateInfo;if("FINISHED"==this.dataInfo.state)return this.iconType=2,this.timeInfo="".concat(this.dataInfo.finishedTime,"已完成约定"),this.stateInfo="已完成约定","".concat(this.stateInfo,"，已享优惠").concat(this.dataInfo.discountAmount||0,"元");if("UNFINISHED"==this.dataInfo.state){if(this.iconType=3,"PAYING"==this.dataInfo.payState)return this.timeInfo="".concat(this.dataInfo.finishedTime,"履约时间结束"),this.stateInfo="未完成约定","".concat(this.stateInfo,"，奖励退还中");if("PAID"==this.dataInfo.payState)return"DUE_TO_QUIT"==this.dataInfo.unfinishedReason?this.timeInfo="".concat(this.dataInfo.finishedTime,"履约时间结束"):"EARLY_QUIT"==this.dataInfo.unfinishedReason&&(this.timeInfo="".concat(this.dataInfo.finishedTime,"提前退出约定")),this.stateInfo="未完成约定","".concat(this.stateInfo,"，已退款").concat(this.dataInfo.discountAmount||0,"元")}},unDone:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t||0,i=a||0;return n-i},range:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t||0,i=a||0;if(!n&&!i)return 100;var s=parseInt(i/t*100);return s}}}),o=e,c=(n("950ef"),n("0c7c")),d=Object(c["a"])(o,i,s,!1,null,"dd9e7140",null);a["default"]=d.exports},3872:function(t,a,n){},"950ef":function(t,a,n){"use strict";n("3872")}}]);