(window.webpackJsonp=window.webpackJsonp||[]).push([[693],{Sm1I:function(t,e,a){},sFGP:function(t,e,a){"use strict";a.r(e);var i=a("Qyje"),s=a.n(i),n=a("sxGJ"),r=a.n(n),o=a("qTUu"),c={name:"activity",data:function(){return{state:1,showShare:!1,options:[{name:"微信",icon:"wechat"}],copybtn:null,tabTitle:[{title:"全部"},{title:"进行中"},{title:"未开始"},{title:"已结束"}],currentTab:0,allList:[],loading:!1,finished:!1,refreshing:!1,error:!1,currentPage:0,totalPage:0,userData:{},shareItemData:{},link:"",getDataOk:!1,page:1}},created:function(){var t=this;this.allList=[],this.$http.get("/app/json/group_buying_head_info/findSelfInfo").then((function(e){"success"==e.data.result&&(t.userData=e.data.data)})),this.getlist()},methods:{changesTab:function(t){this.currentTab=t,this.currentPage=0,this.allList=[],this.finished=!1,this.loading=!0,this.getDataOk=!1,this.getlist()},goBack:function(){this.$router.go(-1)},getlist:function(){var t=this,e=this.currentPage;e+=1,this.currentPage=e,this.refreshing=!1;var a={pageIndex:this.page,groupbuyActivityStatus:0==this.currentTab?void 0:1==this.currentTab?1:2==this.currentTab?0:3==this.currentTab?2:void 0};this.$http.post("/app/json/groupbuying_activity_app/list",s.a.stringify(a)).then((function(e){"success"==e.data.result?(t.allList=t.allList.concat(e.data.data),t.page=e.data.page,t.totalPage=e.data.totalPages,t.loading=!1,t.getDataOk=!0):(t.loading=!1,t.error=!0)})).catch((function(e){t.$toast("请求失败，点击重新加载"),t.loading=!1,t.error=!0}))},onLoad:function(){this.getDataOk&&(this.page<this.totalPage?this.getlist():this.finished=!0)},onRefresh:function(){this.allList=[],this.finished=!1,this.page=1,this.getlist()},share:function(t){this.shareItemData=t,this.showShare=!0},onShare:function(t){var e=this;"wechat"==t.icon?3==this.$store.state.webtype||2==this.$store.state.webtype?(console.log("当前是小程序~~~"),this.options=[{name:"复制链接",icon:"link"}]):0!=this.$store.state.webtype&&1!=this.$store.state.webtype||o.a.shareForOpenWXMiniProgram({userName:"gh_28d617271c97",path:"pages/common/home/index?redirect="+encodeURIComponent("/app-vue/app/index.html#/bulk_share?purchaseId="+this.shareItemData.id+"&chiefId="+this.userData.teamLeaderNo+"&userId="+this.userData.userNo+"&activityName="+this.shareItemData.groupbuyActivityName),title:"微信分享商品",desc:"test",link:"https://www.baidu.com",imageurl:this.shareItemData.groupbuyActivityPicurl,miniProgramType:"production"==this.$store.state.environment?0:2,__event__:function(t){}}).then((function(t){})):"link"==t.icon&&this.$http.post("/app/json/app_group_buying_share_home/generateShareLink",{path:"/pages/homePage/temporaryCapture",query:"redirect="+encodeURIComponent("/app-vue/app/index.html#/bulk_share?purchaseId="+this.shareItemData.id+"&chiefId="+this.userData.teamLeaderNo+"&userId="+this.userData.userNo)}).then((function(t){0==t.data.data.errcode&&(e.link=t.data.data.openlink,new r.a(".btn",{text:function(t){return this.link}}))})),this.showShare=!1},navToDetail:function(t){this.$router.push({path:"/groupOrder",query:{id:JSON.stringify(t)}})},goToDeatil:function(t){this.$router.push({path:"/bulkDetails",query:{activityNo:JSON.stringify(t)}})}}},u=(a("xVml"),a("KHd+")),h=Object(u.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"body"},[a("van-sticky",[a("div",{staticClass:"heard"},[a("div",{staticClass:"tab"},[a("div",{staticClass:"tab_back",on:{click:function(e){return t.goBack()}}},[a("van-icon",{staticClass:"arrow_left",attrs:{name:"arrow-left",color:"#000000",size:"0.471467rem"}})],1),t._v(" "),a("div",{staticClass:"tab_item_box"},t._l(t.tabTitle,(function(e,i){return a("div",{key:i,staticClass:"tab_item",class:t.currentTab==i?"current_tab":"",on:{click:function(e){return t.changesTab(i)}}},[t._v("\n            "+t._s(e.title)+"\n          ")])})),0)])])]),t._v(" "),a("van-pull-refresh",{staticStyle:{"min-height":"400px"},on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",error:t.error,"error-text":"请求失败，点击重新加载"},on:{load:t.onLoad,"update:error":function(e){t.error=e}},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.allList,(function(e,i){return a("div",{key:i,staticClass:"box",on:{click:function(a){return t.goToDeatil(e.id)}}},[a("div",{staticClass:"div1"},[a("div",[a("span",[t._v(t._s(e.groupbuyActivityName))])])]),t._v(" "),a("div",{staticClass:"div2"},[a("img",{attrs:{src:e.groupbuyActivityPicurl,alt:""}}),t._v(" "),a("div",[a("p",[t._v("截止日期："+t._s(e.groupbuyEndDatetime))]),t._v(" "),a("p",[a("span",[t._v(t._s(0==e.groupbuyActivityStatus?"未开始":1==e.groupbuyActivityStatus?"进行中":"已结束"))]),t._v(" "),a("span",[t._v("共"+t._s(e.productCount)+"件商品")]),t._v(" "),a("span",[a("van-icon",{attrs:{name:"arrow"}})],1)]),t._v(" "),a("p",[a("span",{directives:[{name:"show",rawName:"v-show",value:1==e.groupbuyActivityStatus,expression:"item.groupbuyActivityStatus == 1"}],on:{click:function(a){return a.stopPropagation(),t.share(e)}}},[t._v("分享")]),t._v(" "),a("span",{on:{click:function(a){return a.stopPropagation(),t.navToDetail(e.id)}}},[t._v("本团订单")])])])])])})),0)],1),t._v(" "),a("van-share-sheet",{staticClass:"copyData",attrs:{title:"分享到",options:t.options,"cancel-text":""},on:{select:t.onShare},model:{value:t.showShare,callback:function(e){t.showShare=e},expression:"showShare"}})],1)}),[],!1,null,"0f9be406",null);e.default=h.exports},xVml:function(t,e,a){"use strict";var i=a("Sm1I");a.n(i).a}}]);