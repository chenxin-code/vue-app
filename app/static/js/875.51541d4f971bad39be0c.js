(window.webpackJsonp=window.webpackJsonp||[]).push([[875],{"6pUB":function(e,t,n){},"82TB":function(e,t,n){"use strict";n.r(t);var o={name:"modify-pwd",data:function(){return{phone:this.$store.state.userInfo.phone,oldPhone:this.$store.state.userInfo.phone,newPhone:"",smsCode:"",newSmsCode:"",step:1}},computed:{reg:function(){return""==this.$store.state.phoneSection.reg?/^1[0-9]{10}$/:this.$store.state.phoneSection.phoneRule}},created:function(){},methods:{validPhone:function(){/^1[23456789]\d{9}$/.test(this.phone)||this.$Toast("手机号码格式不正确")},nextStep:function(){/^1[23456789]\d{9}$/.test(this.phone)?this.smsCode?(this.step=2,this.$refs.countBtn.resetClock()):this.$Toast("请输入验证码！"):this.$Toast("请输入正确的手机号码！")},back:function(){1===this.step?this.$router.go(-1):this.step=1},getMsgCode:function(e,t){var n=this,o=void 0;if(1===this.step){if(!/^1[23456789]\d{9}$/.test(this.phone))return void this.$Toast("请输入正确的手机号码！");o=this.phone}else{if(!/^1[23456789]\d{9}$/.test(this.phone))return void this.$Toast("请输入正确的手机号码！");o=this.newPhone}this.$refs.countBtn.startTime(),this.$Loading.open(),this.$http.post("/app/json/login/sendSms",{phone:o,smsType:"1030",imgVerifyCode:e,uuid:t}).then((function(e){n.$Loading.close();var t=e.data,o=t.status,s=(t.result,t.info);0==o?n.$Toast("获取验证码成功"):(n.$refs.countBtn.resetClock(),n.$Toast(s))})).catch((function(e){console.log("err>>>>"+e),n.$Loading.close(),n.$refs.countBtn.resetClock(),n.$Toast("系统运行过程中遇到问题，请稍候再试")}))},confirm:function(){var e=this;/^1[23456789]\d{9}$/.test(this.phone)?/^1[23456789]\d{9}$/.test(this.phone)?this.newPhone!=this.phone?this.smsCode&&this.newSmsCode?(this.$Loading.open(),this.$http.post("/app/json/user/modifyPhone",{loginChannel:6,regChannel:5,phone:this.newPhone,smsVerifyCode:this.newSmsCode,originalPhone:this.phone,originalVerifyCode:this.smsCode}).then((function(t){e.$Loading.close();var n=t.data,o=n.status,s=(n.result,n.info);0===o?(e.$Toast("修改成功"),e.$router.go(-1)):(e.$refs.countBtn.resetClock(),e.$Toast(s))})).catch((function(t){console.log("err>>>>"+t),e.$Loading.close(),e.$Toast("系统运行过程中遇到问题，请稍候再试")}))):this.$Toast("请输入验证码！"):this.$Toast("新手机号不能和原手机号相同"):this.$Toast("请输入正确的新手机号码！"):this.$Toast("请输入正确的原手机号码！")}},components:{CountButton:n("uQt8").a}},s=(n("id5D"),n("KHd+")),i=Object(s.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"modify-phone"},[n("nav-top",{on:{backEvent:e.back}}),e._v(" "),n("nav-content",[n("div",{staticClass:"sms-root"},[n("div",{staticClass:"phone-row"},[1===e.step?n("div",{staticClass:"sms-input line_radius"},[n("van-field",{attrs:{readonly:!!(e.oldPhone&&e.oldPhone.length>0),disabled:!!(e.oldPhone&&e.oldPhone.length>0),type:"tel",placeholder:"请输入手机号",maxlength:"11",size:"16",onkeypress:"return( /[\\d]/.test(String.fromCharCode(event.keyCode)))",pattern:"[0-9]*"},on:{input:function(t){e.phone=/^\d+/.exec(e.phone)?/^\d+/.exec(e.phone)[0]:""},blur:e.validPhone},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}})],1):e._e(),e._v(" "),2===e.step?n("div",{staticClass:"sms-input line_radius"},[n("van-field",{attrs:{type:"tel",placeholder:"请输入新手机号",maxlength:"11",size:"16",onkeypress:"return( /[\\d]/.test(String.fromCharCode(event.keyCode)))",pattern:"[0-9]*"},on:{input:function(t){e.newPhone=/^\d+/.exec(e.newPhone)?/^\d+/.exec(e.newPhone)[0]:""},blur:e.validPhone},model:{value:e.newPhone,callback:function(t){e.newPhone=t},expression:"newPhone"}})],1):e._e()]),e._v(" "),n("div",{staticClass:"sms-input line_radius"},[1===e.step?n("van-field",{attrs:{type:"phone",maxlength:"6",border:!1,pattern:"[0-9]*",placeholder:"请输入验证码"},model:{value:e.smsCode,callback:function(t){e.smsCode=t},expression:"smsCode"}}):n("van-field",{attrs:{type:"phone",border:!1,pattern:"[0-9]*",maxlength:"6",placeholder:"请输入验证码"},model:{value:e.newSmsCode,callback:function(t){e.newSmsCode=t},expression:"newSmsCode"}}),e._v(" "),n("div",{staticClass:"forget-btn"},[n("CountButton",{ref:"countBtn",staticClass:"verif-code-btn",attrs:{slot:"button",phone:1===e.step?e.phone:e.newPhone},on:{getSmsEvent:e.getMsgCode},slot:"button"})],1)],1),e._v(" "),1===e.step?n("div",{staticClass:"next-btn theme_standard_bg",on:{click:e.nextStep}},[e._v("下一步")]):n("div",{staticClass:"next-btn theme_standard_bg",on:{click:e.confirm}},[e._v("提交")])])])],1)}),[],!1,null,"762fca2f",null);t.default=i.exports},id5D:function(e,t,n){"use strict";var o=n("6pUB");n.n(o).a}}]);