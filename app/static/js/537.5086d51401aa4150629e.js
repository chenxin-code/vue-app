(window.webpackJsonp=window.webpackJsonp||[]).push([[537],{CEw4:function(t,e,a){"use strict";e.a={methods:{exportinvoiceData:function(t){return this.$http.post("/app/json/user_invoice_assistant/importUserInvoiceHead",t)},golddetailData:function(t){return this.$http.post("/app/json/user_invoice_assistant/detailsOfInvoiceInfo",t)},invoicetipData:function(t){return this.$http.post("/app/json/news/getNewsList",t)},refundData:function(t){return this.$http.post("/app/json/user_invoice_assistant/invoiceRushRed",t)},cardMoData:function(t){return this.$http.post("/app/json/card/getUserCardList",t)},mingxiData:function(t){return this.$http.post("/app/json/user_invoice_assistant/detailsOfInvoiceList",t)},malldetailData:function(t){return this.$http.post("/app/json/app_shopping_order/detail",t)},shopdetailData:function(t){return this.$http.post("/app/json/user_invoice_assistant/convenienceStoredetail",t)},oildetailData:function(t){return this.$http.post("/app/json/refuel_center/detail",t)},hisdetailData:function(t){return this.$http.post("/app/json/user_invoice_assistant/invoiceContentDetails",t)},hisData:function(t){return this.$http.post("/app/json/user_invoice_assistant/invoiceContentDetailsList",t)},mallData:function(t){return this.$http.post("/app/json/app_shopping_order/queryOrder",t)},storeData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryConvenienceStoreOrder",t)},appData:function(t){return this.$http.post("/app/json/refuel_center/queryOrder",t)},goldData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryCashIn",t)},walletData:function(t){return this.$http.post("/app/json/user_invoice_assistant/sinopecWalletInvoiceList",t)},cardData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryUserRefuelingCardInfoList",t)},commitselfinvoiceData:function(t){return this.$http.post("/app/json/user_invoice_assistant/orderInvoicingInMall",t)},commitselfcardinvoiceData:function(t){return this.$http.post("/app/json/user_invoice_assistant/gasCardInvoice",t)},commitselfgoldinvoiceData:function(t){return this.$http.post("/app/json/user_invoice_assistant/cashInInvoicing",t)},emailData:function(t){return this.$http.post("/app/json/user_invoice_assistant/invoiceModifyMailbox",t)},histroydetailData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryInvoiceDetails",t)},histroyData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryInvoicedList",t)},riseData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryUserInvoiceHeadList",t)},openedData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryInvoicedList",t)},commitData:function(t){return this.$http.post("/app/json/user_invoice_assistant/addOrUpdateUserInvoiceHead",t)},delData:function(t){return this.$http.post("/app/json/user_invoice_assistant/deleteUserInvoiceHead",t)},morenData:function(t){return this.$http.post("/app/json/user_invoice_assistant/setDefaultUserInvoiceHead",t)},detailData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryInvoiceDetails",t)},souData:function(t){return this.$http.post("/app/json/user_invoice_assistant/searchInvoiceList",t)},soudetailData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryUserInvoiceHeadDetails",t)},tijiaoData:function(t){return this.$http.post("/app/json/user_invoice_assistant/addInvoicing",t)},saoData:function(t){return this.$http.post("/app/json/user_invoice_assistant/getResultFromQrcode",t)},morentitleData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryDefaultTittle",t)},daikaiData:function(t){return this.$http.post("/app/json/user_invoice_assistant/unInvoicingList",t)},chakanData:function(t){return this.$http.post("/app/json/user_invoice_assistant/queryUserInvoiceHeadDetails",t)}}}},RvLt:function(t,e,a){"use strict";a.r(e),a("5+UC");var s=a("05lO"),o=a("CEw4"),i=(a("ygAv"),a("F8w7"),{name:"openinvoiceDetail",mixins:[o.a],data:function(){return{userInvoiceHeadModels:[],radio:"",checked:!1,companyAddress:"",userEmail:"",orgTaxNo:"",idDetail:"",title:"",openView:!0,openingBank:"",userPhone:"",bankAccount:"",toCardView:!1,people:"",opentext:"展开",typeObj:{titleType:5},paramsPersonData:{titleType:4},paramsData:{titleType:5},open:"",dropDown:!1,detailObj:{},isText:[],titleId:"",type:"",shoppingOrderModels:{},ids:"",orderType:"",cardNo:"",nodeNo:"",cardType:"",startTime:"",endTime:"",lastPath:"",prohibitDis:!1,isPhone:"",phoneView:!0,isShow:"",showPaperticketButton:-1}},created:function(){console.log(this.$route.query),this.shoppingOrderModels=this.$route.query.orderList?JSON.parse(this.$route.query.orderList):[],this.paramsData.totalMoney=this.$route.query.totalMoney,this.paramsPersonData.totalMoney=this.$route.query.totalMoney,this.ids=this.$route.query.idArray||"",this.cardNo=this.$route.query.cardNo,this.nodeNo=this.$route.query.nodeNo,this.cardType=this.$route.query.cardType,this.orderType=this.$route.query.type,this.startTime=this.$route.query.startTime,this.endTime=this.$route.query.endTime,this.lastPath=this.$route.query.lastPath,this.isPhone=this.$store.state.globalConfig.isShowInvoicePhoneNumber,console.log(this.orderType,"-------------"),"1"===this.isPhone?this.phoneView=!0:"0"===this.isPhone?this.phoneView=!1:this.phoneView=!0,"cardOrder"==this.orderType&&(this.toCardView=!0,"03"==this.cardType||"04"==this.cardType?this.prohibitDis=!1:this.prohibitDis=!0)},beforeRouteLeave:function(t,e,a){t.path==this.lastPath&&this.$keepaliveHelper.deleteCache(this),a()},mounted:function(){"cardOrder"==this.orderType?this.defaultcardTitle():"mallOrder"!=this.orderType&&"appOrder"!=this.orderType&&"goldOrder"!=this.orderType&&"storeOrder"!=this.orderType||this.defaultTitle(),1==this.$store.state.globalConfig.papertickets&&(this.isShow=this.dateCompare(new Date,this.shoppingOrderModels[0].refuelTakeDate),this.showPaperticketsBtn())},methods:{showPaperticketsBtn:function(){var t=this;this.$request.post("/app/json/user_invoice_assistant/querShowPaperticketButton",{storeOuCode:this.shoppingOrderModels[0].storeOuCode}).then((function(e){0==e.status?1==e.data&&1==t.isShow?t.showPaperticketButton=1:t.showPaperticketButton=-1:t.$Toast(e.info)}))},dateCompare:function(t,e){var a=new Date(e),s=new Date(a.getTime()+18e5);return t.valueOf()>s.valueOf()?(console.log("已过期"),-1):t.valueOf()<s.valueOf()?(console.log("未过期"),1):void 0},close:function(){this.dropDown=!1},seeView:function(){},goHistory:function(){this.$router.push("/open_invoice_history")},openPaperTickets:function(){var t=this;console.log(this.shoppingOrderModels),this.$request.post("/app/json/user_invoice_assistant/unLockInvoiceMark",{storeBranchOrgOuCode:this.shoppingOrderModels[0].storeBranchOrgOuCode,shoppingOrderId:this.shoppingOrderModels[0].shoppingOrderId,storeStandCode:this.shoppingOrderModels[0].storeStandCode,refuelRecordId:this.shoppingOrderModels[0].refuelRecordId,userId:this.shoppingOrderModels[0].userId}).then((function(e){0==e.status?t.$Toast(e.info?e.info:"开票成功"):t.$Toast(e.info?e.info:"获取我的拼团失败")}))},defaultTitle:function(){var t=this,e={token:this.$store.state.login.token};t.morentitleData(e).then((function(e){var a=e.data.data||{};t.typeObj.titleType=a.titleType,4==t.typeObj.titleType?(t.paramsPersonData=a,t.paramsPersonData.totalMoney=t.$route.query.totalMoney,t.paramsData.totalMoney=t.$route.query.totalMoney):5==t.typeObj.titleType&&(t.paramsData=a,t.paramsData.totalMoney=t.$route.query.totalMoney,t.paramsPersonData.totalMoney=t.$route.query.totalMoney)}))},defaultcardTitle:function(){var t=this;t.page=t.page+1;var e={token:this.$store.state.login.token,startTime:t.startTime,endTime:t.endTime,cardNo:t.cardNo,needDetail:1};t.cardData(e).then((function(e){e.data.result&&(t.typeObj.titleType=e.data.data.userInvoiceHeadModels[0].titleType,t.userInvoiceHeadModels=e.data.data.userInvoiceHeadModels,4==t.typeObj.titleType?(t.paramsPersonData=e.data.data.userInvoiceHeadModels[0],t.paramsData.totalMoney=t.$route.query.totalMoney,t.paramsPersonData.totalMoney=t.$route.query.totalMoney):5==t.typeObj.titleType&&(t.paramsData=e.data.data.userInvoiceHeadModels[0],t.paramsPersonData.totalMoney=t.$route.query.totalMoney,t.paramsData.totalMoney=t.$route.query.totalMoney))}))},clickField:function(){"cardOrder"==this.$route.query.type&&1==this.$store.state.globalConfig.isEditCardInvoiceTitle&&(this.isText=this.userInvoiceHeadModels,this.dropDown=!0)},monitor:function(t){console.log(t);var e=this,a={token:this.$store.state.login.token,title:t};e.souData(a).then((function(t){t.data.data.length>0?(e.isText=t.data.data,e.dropDown=!0):e.dropDown=!1}))},detailData:function(t){4==t.titleType?(this.typeObj.titleType=4,this.paramsData={},this.paramsPersonData=t,this.paramsData.totalMoney=this.$route.query.totalMoney,this.paramsPersonData.totalMoney=this.$route.query.totalMoney):5==t.titleType&&(this.typeObj.titleType=5,this.paramsPersonData={},this.paramsData=t,this.paramsData.totalMoney=this.$route.query.totalMoney,this.paramsPersonData.totalMoney=this.$route.query.totalMoney)},commit:function(){var t=this,e=this,a={};if(4==e.typeObj.titleType?(e.paramsPersonData.titleType=4,Object.assign(a,e.paramsPersonData)):5==e.typeObj.titleType&&(e.paramsData.titleType=5,Object.assign(a,e.paramsData)),a.telephone=a.telephone?a.telephone.toString().replace(/\s*/g,""):"",console.log(333,a),a.title)if(5!=a.titleType||a.orgTaxNo){if(1==e.phoneView){if(!a.userEmail&&!a.userPhone)return void Object(s.a)({message:"请输入邮箱或者手机号",duration:2e3});if(a.userPhone&&!/^(?:(?:\+|00)86)?1[3-9]\d{9}$/.test(a.userPhone))return void Object(s.a)({message:"请输入正确的手机号",duration:2e3})}else if(!a.userEmail)return void Object(s.a)({message:"请输入邮箱",duration:2e3});if(!a.userEmail||/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(a.userEmail))if(5!=a.titleType||(console.log("电话号",a.telephone),!a.telephone||/^0\d{2,3}-\d{7,8}$/.test(a.telephone)||/^1(3|6|4|5|7|8|9)\d{9}$/.test(a.telephone)))if(this.$Loading.open(),"cardOrder"==e.orderType)e.commitselfcardinvoiceData({token:this.$store.state.login.token,refuelingCardInfoModels:e.shoppingOrderModels,userInvoiceHeadModel:a,cardNo:e.cardNo,stnCode:e.nodeNo}).then((function(a){t.$Loading.close(),"success"===a.data.result?(s.a.success("开票成功"),e.$router.go(-1)):Object(s.a)(a.data.info)}));else if("goldOrder"==e.orderType)e.commitselfgoldinvoiceData({token:this.$store.state.login.token,shoppingOrderModels:e.shoppingOrderModels,userInvoiceHeadModel:a}).then((function(a){t.$Loading.close(),"success"===a.data.result?(s.a.success(a.data.data),e.$router.go(-1)):Object(s.a)(a.data.info)}));else if("electronicCard"==e.orderType){var o={cardNo:a.totalMoney,titleType:a.titleType,orgTaxNo:a.orgTaxNo,phone:a.userPhone,titleEmail:a.userEmail,title:a.title,openingBank:a.openingBank,companyAddress:a.companyAddress,bankAccount:a.bankAccount,mobile:a.telephone};this.$http.post("/app/json/app_user_ele_card_invoice/eleCardInvoice",o).then((function(a){t.$Loading.close(),"success"===a.data.result?e.$router.replace({path:"/electronic_refund_result",query:{type:3}}):Object(s.a)(a.data.info)}))}else e.commitselfinvoiceData({token:this.$store.state.login.token,shoppingOrderModels:e.shoppingOrderModels,userInvoiceHeadModel:a}).then((function(a){t.$Loading.close(),"success"===a.data.result?(s.a.success(a.data.data),e.$router.go(-1)):Object(s.a)(a.data.info)}));else Object(s.a)({message:"请输入正确的电话号",duration:2e3});else Object(s.a)({message:"请输入正确的邮箱",duration:2e3})}else Object(s.a)({message:"请输入税号",duration:2e3});else Object(s.a)({message:"请输入发票抬头",duration:2e3})}}}),n=(a("r6mD"),a("KHd+")),r=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"body"},["electronicCard"==t.orderType?a("div",{staticClass:"history",on:{click:t.goHistory}},[t._v("\n      开票历史\n    ")]):t._e(),t._v(" "),a("nav-top",{attrs:{title:"自助开票"},on:{backEvent:function(e){return t.$router.go(-1)}}}),t._v(" "),a("nav-content",[a("van-notice-bar",{attrs:{scrollable:!1}},[t._v("提示：将为您开具增值税电子普通发票！")]),t._v(" "),a("div",{on:{click:t.close}},[a("div",{staticClass:"divTitle"},[t._v("发票详情")]),t._v(" "),a("div",{staticClass:"publicInvoice"},[a("van-radio-group",{staticClass:"radioBtn",attrs:{disabled:t.prohibitDis},model:{value:t.typeObj.titleType,callback:function(e){t.$set(t.typeObj,"titleType",e)},expression:"typeObj.titleType"}},[a("span",[t._v("抬头类型")]),t._v(" "),a("div",{staticClass:"radioBtnDiv"},[a("van-radio",{attrs:{name:4,"checked-color":"#f44"}},[t._v("个人/非企业单位")]),t._v(" "),a("van-radio",{attrs:{name:5,"checked-color":"#f44"}},[t._v("企业")])],1)])],1),t._v(" "),4==t.typeObj.titleType?a("div",{staticClass:"publicInvoice"},[a("van-cell-group",{staticStyle:{position:"relative"}},[a("van-field",{staticClass:"paragraph",attrs:{disabled:"cardOrder"==t.$route.query.type&&1==t.$store.state.globalConfig.isEditCardInvoiceTitle,label:"发票抬头",placeholder:"请输入发票抬头"},on:{click:function(e){return e.stopPropagation(),t.clickField(e)},input:t.monitor},model:{value:t.paramsPersonData.title,callback:function(e){t.$set(t.paramsPersonData,"title","string"==typeof e?e.trim():e)},expression:"paramsPersonData.title"}}),t._v(" "),a("div",{class:{divPut:1==t.dropDown,nothing:0==t.dropDown}},[a("div",{staticClass:"divPut1"}),t._v(" "),a("div",{staticClass:"divPut2"},[a("ul",t._l(t.isText,(function(e,s){return t.dropDown?a("li",{key:s,on:{click:function(a){return t.detailData(e)}}},[t._v(t._s(e.title))]):t._e()})),0)])]),t._v(" "),t.toCardView||"electronicCard"===t.$route.query.type?t._e():a("router-link",{staticStyle:{position:"relative"},attrs:{to:{path:"/orderList",query:{ids:t.ids,type:t.orderType,source:t.$route.query.source}}}},[a("div",{staticClass:"openBox"},[a("div",{staticClass:"openBox1"},[a("span",[t._v("发票内容")])]),t._v(" "),a("div",[a("span",{staticClass:"span"},[t._v("查看明细")])])])]),t._v(" "),a("van-field",{attrs:{label:"发票金额",placeholder:"请输入发票金额",disabled:""},model:{value:t.paramsPersonData.totalMoney,callback:function(e){t.$set(t.paramsPersonData,"totalMoney",e)},expression:"paramsPersonData.totalMoney"}})],1)],1):t._e(),t._v(" "),4==t.typeObj.titleType?a("div",{staticClass:"publicInvoice"},[a("van-cell-group")],1):t._e(),t._v(" "),4==t.typeObj.titleType?a("div",{staticClass:"divTitle"},[t._v("邮寄信息")]):t._e(),t._v(" "),4==t.typeObj.titleType?a("div",{staticClass:"publicInvoice"},[a("van-cell-group",[t.phoneView?a("van-field",{attrs:{label:"手机号",placeholder:"请输入手机号"},model:{value:t.paramsPersonData.userPhone,callback:function(e){t.$set(t.paramsPersonData,"userPhone","string"==typeof e?e.trim():e)},expression:"paramsPersonData.userPhone"}}):t._e(),t._v(" "),a("van-field",{attrs:{label:"邮箱",placeholder:"请输入邮箱"},model:{value:t.paramsPersonData.userEmail,callback:function(e){t.$set(t.paramsPersonData,"userEmail","string"==typeof e?e.trim():e)},expression:"paramsPersonData.userEmail"}}),t._v(" "),"cardOrder"!=t.$route.query.type?a("van-field",{attrs:{maxlength:"100",rows:"1",autosize:"",label:"备注",type:"textarea",placeholder:"请输入备注"},model:{value:t.paramsPersonData.customerRemark,callback:function(e){t.$set(t.paramsPersonData,"customerRemark",e)},expression:"paramsPersonData.customerRemark"}}):t._e()],1)],1):t._e(),t._v(" "),5==t.typeObj.titleType?a("div",{staticClass:"publicInvoice"},[a("van-cell-group",{staticStyle:{position:"relative"}},[a("van-field",{staticClass:"paragraph",attrs:{disabled:"cardOrder"==t.$route.query.type&&1==t.$store.state.globalConfig.isEditCardInvoiceTitle,readonly:t.prohibitDis,label:"发票抬头",placeholder:"请输入发票抬头"},on:{click:function(e){return e.stopPropagation(),t.clickField(e)},input:t.monitor},model:{value:t.paramsData.title,callback:function(e){t.$set(t.paramsData,"title","string"==typeof e?e.trim():e)},expression:"paramsData.title"}}),t._v(" "),a("div",{class:{divPut:1==t.dropDown,nothing:0==t.dropDown}},[a("div",{staticClass:"divPut1"}),t._v(" "),a("div",{staticClass:"divPut2"},[a("ul",t._l(t.isText,(function(e,s){return t.dropDown?a("li",{on:{click:function(a){return t.detailData(e)}}},[t._v(t._s(e.title))]):t._e()})),0)])]),t._v(" "),a("van-field",{attrs:{label:"税号",placeholder:"请输入税号"},model:{value:t.paramsData.orgTaxNo,callback:function(e){t.$set(t.paramsData,"orgTaxNo","string"==typeof e?e.trim():e)},expression:"paramsData.orgTaxNo"}}),t._v(" "),t.toCardView?t._e():a("router-link",{staticStyle:{position:"relative"},attrs:{to:{path:"/orderList",query:{ids:t.ids,type:t.orderType,source:t.$route.query.source}}}},[a("div",{staticClass:"openBox",on:{click:t.seeView}},[a("div",{staticClass:"openBox1"},[a("span",[t._v("发票内容")])]),t._v(" "),a("div",[a("span",{staticClass:"span"},[t._v("查看明细")])])])]),t._v(" "),a("van-field",{attrs:{label:"发票金额",placeholder:"请输入发票金额",disabled:""},model:{value:t.paramsData.totalMoney,callback:function(e){t.$set(t.paramsData,"totalMoney",e)},expression:"paramsData.totalMoney"}})],1)],1):t._e(),t._v(" "),5==t.typeObj.titleType?a("div",{staticClass:"publicInvoice"},[a("van-cell-group",[a("div",{staticClass:"openBox"},[a("div",{staticClass:"openBox1"},[a("span",[t._v("更多信息")]),t._v(" "),a("span",[t._v("开户行和账号等（非必填）")])]),t._v(" "),a("div",{on:{click:function(e){t.openView=!t.openView}}},[a("span",{staticClass:"span"},[t._v(t._s(t.openView?"展开":"收起"))])])]),t._v(" "),t.openView?t._e():a("div",[a("van-field",{attrs:{label:"地址",placeholder:"请输入地址"},model:{value:t.paramsData.companyAddress,callback:function(e){t.$set(t.paramsData,"companyAddress",e)},expression:"paramsData.companyAddress"}}),t._v(" "),a("van-field",{attrs:{label:"电话"},model:{value:t.paramsData.telephone,callback:function(e){t.$set(t.paramsData,"telephone","string"==typeof e?e.trim():e)},expression:"paramsData.telephone"}}),t._v(" "),a("van-field",{attrs:{label:"开户行",placeholder:"请输入开户行"},model:{value:t.paramsData.openingBank,callback:function(e){t.$set(t.paramsData,"openingBank",e)},expression:"paramsData.openingBank"}}),t._v(" "),a("van-field",{attrs:{label:"账户",placeholder:"请输入账户"},model:{value:t.paramsData.bankAccount,callback:function(e){t.$set(t.paramsData,"bankAccount",e)},expression:"paramsData.bankAccount"}})],1)])],1):t._e(),t._v(" "),5==t.typeObj.titleType?a("div",{staticClass:"divTitle"},[t._v("邮寄信息")]):t._e(),t._v(" "),5==t.typeObj.titleType?a("div",{staticClass:"publicInvoice"},[a("van-cell-group",[t.phoneView?a("van-field",{attrs:{label:"手机号",placeholder:"请输入手机号"},model:{value:t.paramsData.userPhone,callback:function(e){t.$set(t.paramsData,"userPhone","string"==typeof e?e.trim():e)},expression:"paramsData.userPhone"}}):t._e(),t._v(" "),a("van-field",{attrs:{label:"邮箱",placeholder:"请输入邮箱"},model:{value:t.paramsData.userEmail,callback:function(e){t.$set(t.paramsData,"userEmail","string"==typeof e?e.trim():e)},expression:"paramsData.userEmail"}}),t._v(" "),"cardOrder"!=t.$route.query.type?a("van-field",{attrs:{maxlength:"100",rows:"1",autosize:"",label:"备注",type:"textarea",placeholder:"请输入备注"},model:{value:t.paramsData.customerRemark,callback:function(e){t.$set(t.paramsData,"customerRemark",e)},expression:"paramsData.customerRemark"}}):t._e()],1)],1):t._e(),t._v(" "),1==t.showPaperticketButton?a("div",{staticClass:"open-paper-tickets",on:{click:t.openPaperTickets}},[a("span",[t._v("我要开纸票")])]):t._e(),t._v(" "),a("div",{staticClass:"answer theme_bg_red",on:{click:t.commit}},[t._v("提交")])])],1)],1)}),[],!1,null,"6e444de1",null);e.default=r.exports},elz5:function(t,e,a){},r6mD:function(t,e,a){"use strict";var s=a("elz5");a.n(s).a}}]);