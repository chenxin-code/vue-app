(window.webpackJsonp=window.webpackJsonp||[]).push([[325],{"89IG":function(t,e,s){"use strict";var a={name:"member-level",components:{},data:function(){return{refresh:!0,value_style:"",show:!1,equityName:"",equityList:[]}},methods:{showEquity:function(t){var e=this;if("/mall2/membershipinterests"==this.$route.path){this.show=!0,this.equityName=t.name;var s={token:this.$store.state.login.token,levelNo:t.id};this.$http.post("/app/equity_member/queryLevelEquity",s).then((function(t){var s=t.data;0==s.status?e.equityList=s.data:e.$Toast("获取会员权益失败")}))}},checkEquity:function(t){var e=this;if(1==t.type){var s={token:this.$store.state.login.token,equityType:t.equityType,equityId:t.equityId};this.$http.post("/app/equity_member/queryMyEquityRecord",s).then((function(t){var s=t.data;if(0==s.status){var a=String(s.data.equityType).substr(0,1),i=s.data.equityType;"1"==a||"2"==a||"4"==a?e.$router.push({path:"/equity/have_equity",query:{detail:JSON.stringify(s.data)}}):"31"==i?e.$router.push({path:"/equity/question",query:{detail:JSON.stringify(s.data)}}):"32"==i?e.$router.push({path:"/equity/game_equity",query:{detail:JSON.stringify(s.data)}}):"33"==i?e.$router.push({path:"/equity/couponList",query:{detail:JSON.stringify(s.data)}}):"5"==a&&e.$router.push({path:"/equity/third_services",query:{detail:JSON.stringify(s.data)}})}else e.$Toast("获取我的权益失败")}))}else this.$router.push({path:"/equity/magnification",query:{equityType:t.equityType}})},hasDian:function(t,e){if(this.$store.state.mall2.myAssets.levSurplusPoints>=t)return!1;var s=this.$store.state.memberLevel[e-1];return s?this.$store.state.mall2.myAssets.levSurplusPoints>=s.pointAmount:void 0},getWlineStyle:function(t,e){if(this.$store.state.mall2.myAssets.levSurplusPoints>=t)return"width: 100%";var s=this.$store.state.memberLevel[e-1];if(s){var a=t-s.pointAmount,i=this.$store.state.mall2.myAssets.levSurplusPoints-s.pointAmount;if(a>0)return"width: "+i/a*100+"%"}},getLevelImg:function(t,e){return this.$store.state.mall2.myAssets.levSurplusPoints>=t?"static/images/mycenter/m_"+e+"_1.png":"static/images/mycenter/m_"+e+"_0.png"},refreshStyle:function(){var t=this.$refs.bubbleDiv;if(t){var e=t[0];if(e){var s=-e.offsetWidth/2;this.value_style="margin-left: "+s+"px;",console.log("this.value_style",this.value_style)}}}},watch:{"$store.state.mall2.myAssets.levSurplusPoints":function(){var t=this;this.refresh=!1,this.$nextTick((function(){t.refresh=!0}))}},mounted:function(){}},i=(s("XIWT"),s("KHd+")),n=Object(i.a)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.refresh?s("div",{ref:"theComponent",staticClass:"member-level"},[t._l(t.$store.state.memberLevel,(function(e,a){return s("div",{staticClass:"item",class:{own:e.pointAmount<=t.$store.state.mall2.myAssets.levSurplusPoints}},[s("div",{staticClass:"name"},[t._v(t._s(e.name))]),t._v(" "),s("div",{staticClass:"img-div"},[s("img",{attrs:{src:t.getLevelImg(e.pointAmount,a+1)},on:{click:function(s){return t.showEquity(e)}}})]),t._v(" "),s("div",{staticClass:"points"},[t._v(t._s(e.pointAmount))]),t._v(" "),0!=a?s("div",{staticClass:"line-div"},[s("div",{staticClass:"line-w",style:t.getWlineStyle(e.pointAmount,a)},[t.hasDian(e.pointAmount,a)?s("div",{staticClass:"show-value"}):t._e(),t._v(" "),t.hasDian(e.pointAmount,a)?s("img",{staticClass:"dian",attrs:{src:"static/images/mycenter/dian.png"}}):t._e()])]):t._e()])})),t._v(" "),s("van-popup",{model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("p",{staticClass:"p1"},[t._v(t._s(t.equityName)+"会员权益")]),t._v(" "),s("div",{staticClass:"ulBox"},[s("div",{staticClass:"ul"},[s("ul",t._l(t.equityList,(function(e){return s("li",{on:{click:function(s){return t.checkEquity(e)}}},[s("img",{attrs:{src:e.equityPic,alt:""}}),t._v(" "),s("div",[s("p",{staticClass:"ul_p"},[t._v(t._s(e.equityName.substr(0,4)))])])])})),0)])]),t._v(" "),s("span",{staticClass:"fill",on:{click:function(e){t.show=!1}}},[t._v("关闭")])])],2):t._e()}),[],!1,null,"4503cd06",null);e.a=n.exports},BngH:function(t,e,s){},XIWT:function(t,e,s){"use strict";var a=s("kiCv");s.n(a).a},kiCv:function(t,e,s){},"p+j1":function(t,e,s){"use strict";s.r(e);var a=s("89IG"),i=s("A8ay"),n=s("L2JU"),r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(t[a]=s[a])}return t},l={name:"member-levels",components:{MemberLevel:a.a},props:["myIndex","usePorpData","propData","barHeight"],computed:r({},Object(n.e)(["deployType"]),{pageData:function(){return 1==this.usePorpData?this.propData:this.$store.state.pageData},moduleData:function(){return this.pageData.moduleList[this.myIndex].data}}),watch:{"$store.state.mall2.myAssets":function(t,e){this.getNextDistance()}},mixins:[i.a],data:function(){return{nextLevelValue:0,nextLevelName:""}},methods:{toMemberLevel:function(){5==this.deployType&&this.$market.customPush({path:"/memberlevel"})},getNextDistance:function(){var t=this.$store.state.mall2.myAssets.levSurplusPoints,e=this.$store.state.memberLevel||[],s=this.$store.state.mall2.myAssets.levelNo;this.nextLevelValue=0;for(var a=0;a<e.length;a++)if(s==e[a].rankCode){if(a==e.length-1)return"";var i=e[a+1].pointAmount;return 5==this.deployType?(this.nextLevelValue=Math.floor(i-t),void(this.nextLevelName=e[a+1].name)):i-t}return"0"},getBgStyle:function(){var t="",e=this.moduleData.bgImgUrl;""!=e&&(t+="background: url('"+e+"') no-repeat center center / 100% 100%;");var s=this.moduleData.bgColor;return""!=s&&(t+="background-color: "+s+";"),t},getFloatUp:function(){var t="",e=this.moduleData.floatUp;e>0&&(t+="margin-top: -"+e+"%;");var s=this.moduleData.upMargin,a=this.moduleData.downMargin;s>0&&(t+="margin-top: "+s+"%;"),a>0&&(t+="margin-bottom: "+a+"%;");var i=this.moduleData.sidesMargin;return i>0&&(t+="margin-left: "+i+"%; margin-right: "+i+"%;"),t},getMyAssets:function(){var t=this,e=this.$market.apiBaseURL()+"/app/json/user/getUserWallet",s={token:this.$store.state.login.token};this.$http.post(e,s).then((function(e){var s=e.data;0==s.status&&(t.$store.state.mall2.myAssets=s.data,t.getNextDistance())}),(function(t){}))},getUserRank:function(){var t=this;this.$http.post("/app/json/user_rights/getUserRank",{}).then((function(e){var s=e.data;0==s.status&&""!=s.data&&s.data.length>0&&(t.$store.state.memberLevel=s.data)}),(function(t){}))}},created:function(){5==this.deployType&&(this.getUserRank(),""!=this.$store.state.login.token&&this.getMyAssets())}},o=(s("xMCV"),s("KHd+")),u=Object(o.a)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"member-levels",class:{"div-zm":5==t.deployType},style:t.getBgStyle()},[5==t.deployType?[s("div",{staticClass:"member-level-div",style:t.getFloatUp(),on:{click:t.toMemberLevel}},[t.$store.state.mall2.myAssets.levelEndDate&&"0001"!=t.$store.state.mall2.myAssets.levelNo?s("div",{staticClass:"tip"},[s("span",[t._v(t._s(t.$t("loginRegisterLang.levalEffectDate")))]),t._v(" "),s("span",[t._v(t._s(t.$store.state.mall2.myAssets.levelEndDate))])]):t._e(),t._v(" "),s("MemberLevel",{attrs:{type:"zm"}}),t._v(" "),"en_US"==t.$store.state.language&&t.nextLevelName?s("div",{staticClass:"tip1"},[t._v(t._s(t.$t("loginRegisterLang.nextLevelTip1"))+" "+t._s(t.nextLevelName)+" "+t._s(t.$t("loginRegisterLang.nextLevelTip2"))+" "+t._s(t.nextLevelValue)+" RMB")]):t.nextLevelName?s("div",{staticClass:"tip1"},[t._v(t._s(t.$t("loginRegisterLang.nextLevelTip1"))+" "+t._s(t.nextLevelValue)+" "+t._s(t.$t("loginRegisterLang.nextLevelTip2"))+" "+t._s(t.nextLevelName))]):t._e()],1)]:[s("div",{staticClass:"member-level-div",class:t.hotareaClass({idCode:t.moduleData.idCode}),style:t.getFloatUp(),on:{click:function(e){t.hotEvent(),t.toMemberLevel()}}},[s("MemberLevel",{attrs:{type:"zm"}}),t._v(" "),s("div",{staticClass:"tip"},[t._v("距离下一级别还有"),s("span",{staticClass:"point"},[t._v(t._s(t.getNextDistance()))]),t._v("元距离")])],1)]],2)}),[],!1,null,"97b6c044",null);e.default=u.exports},xMCV:function(t,e,s){"use strict";var a=s("BngH");s.n(a).a}}]);