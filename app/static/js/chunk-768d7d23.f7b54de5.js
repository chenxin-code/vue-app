(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-768d7d23"],{"2e7b":function(t,e,i){"use strict";i("a863")},"539f":function(t,e,i){"use strict";i("7a03")},"7a03":function(t,e,i){},a863:function(t,e,i){},aa86:function(t,e,i){},d92c:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"user-info"},[i("nav-top",{on:{backEvent:t.backEvent}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showRightBtn,expression:"showRightBtn"}],staticClass:"right-btn",staticStyle:{right:"0px",height:"44px",top:"0px","padding-right":"10px","font-size":"12px"},on:{click:t.saveInfo}},[t._v("保存")])]),i("nav-content",[i("div",{staticClass:"center"},[i("ul",{staticClass:"setting-list mine-box-shodow"},t._l(t.settingList,(function(e,s){return i("li",{staticClass:"setting-item public-bar border-bottom info-cellpad",class:{"icon-more":!e.disabled},on:{click:function(i){return t.jumpUrl(e,s)}}},[i("span",{staticClass:"left-text"},[t._v(t._s(e.name))]),i("div",{staticClass:"right-text"},[0==e.type?i("img",{attrs:{src:t.getItemLb(e)}}):t._e(),1==e.type?i("div",{staticClass:"right-title"},[t._v(" "+t._s(t.getItemLb(e))+" ")]):t._e()])])})),0)])]),i("UpdateMark",{ref:"updateMark",on:{submitData:t.infoChanged}}),i("mt-datetime-picker",{ref:"picker",attrs:{type:"date",startDate:new Date(1930,0,1),endDate:new Date,"year-format":"{value}","month-format":"{value}","date-format":"{value}"},on:{confirm:t.changetime},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}}),i("van-popup",{attrs:{position:"bottom"},model:{value:t.sexShow,callback:function(e){t.sexShow=e},expression:"sexShow"}},[i("van-picker",{attrs:{"show-toolbar":"",title:"请选择性别",columns:t.columns},on:{cancel:function(e){t.sexShow=!1},confirm:t.onConfirm}})],1)],1)},n=[],a=i("5530"),o=(i("5f5f"),i("f253")),r=(i("8a58"),i("e41f")),c=(i("0d03"),i("99af"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.showMark?i("div",{staticClass:"mark",on:{click:function(e){return e.stopPropagation(),t.closeMark.apply(null,arguments)}}},[i("div",{staticClass:"mark-center"},[i("p",{staticClass:"mark-title"},[t._v(t._s(t.title))]),i("div",{staticClass:"input-text"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],attrs:{placeholder:t.placeholder},domProps:{value:t.text},on:{click:function(e){return e.stopPropagation(),t.stopP.apply(null,arguments)},input:[function(e){e.target.composing||(t.text=e.target.value)},t.textInputChange]}})]),i("div",{staticClass:"btn"},[i("span",{staticClass:"btn-c",on:{click:t.closeMark}},[t._v("取消")]),i("span",{staticClass:"btn-s",on:{click:t.submit}},[t._v("提交")])])])]):t._e()}),h=[],u=(i("fb6a"),{name:"",components:{},props:[],data:function(){return{text:"",placeholder:"",title:"",item:{},showMark:!1}},methods:{textInputChange:function(t){if("nickName"==this.item.key){var e=t.target.value;e.length>10&&(e=e.slice(0,10),this.$Toast("最大输入10个字")),this.text=e}},showMarkFun:function(t,e,i){this.item=t,this.title=e,this.placeholder=i,this.showMark=!0},closeMark:function(){this.showMark=!1,this.text=""},submit:function(){""!=this.text?"email"!=this.item.key||this.$util.checkMail(this.text)?this.$emit("submitData",this.item,this.text):this.$Toast("请输入正确的邮箱"):this.$Toast(this.placeholder)},stopP:function(t){}},created:function(){}}),f=u,l=(i("539f"),i("0c7c")),d=Object(l["a"])(f,c,h,!1,null,"261f2fe0",null),p=d.exports,m=i("f0ba"),g=i("76a0"),k=i("2f62"),v={name:"setting",components:{UpdateMark:p,DatetimePicker:g["DatetimePicker"],Popup:r["a"],Picker:o["a"]},computed:Object(a["a"])({},Object(k["c"])(["userInfo"])),data:function(){var t=1==this.$store.state.globalConfig.appUserInfoPhoneDisabled;return{settingList:[{name:"头像",id:"0",key:"headImg",type:0},{name:"姓名",id:"1",key:"nickName",type:1},{name:"邮箱",id:"3",key:"email",type:1},{name:"生日",id:"4",key:"birthday",type:1},{name:"性别",id:"9",key:"gender",type:1},{name:"手机号",id:"8",key:"phone",type:1,disabled:t}],userInfoCP:{},currentDate:new Date,selectIndex:-1,showRightBtn:!1,columns:[{text:"男",value:1},{text:"女",value:2}],sexShow:!1}},methods:{onConfirm:function(t,e){this.sexShow=!1,this.userInfoCP["gender"]=t["value"],this.checkModify()&&(this.showRightBtn=!0)},checkModify:function(){return this.userInfoCP.headImg!=this.userInfo.headImg||this.userInfoCP.nickName!=this.userInfo.nickName||this.userInfoCP.email!=this.userInfo.email||this.userInfoCP.birthday!=this.userInfo.birthday||this.userInfoCP.gender!=this.userInfo.gender},infoChanged:function(t,e){this.userInfoCP[t.key]=e,this.$refs.updateMark.closeMark(),this.checkModify()&&(this.showRightBtn=!0)},saveInfo:function(){this.submitData(!1)},backEvent:function(){var t=this;this.checkModify()?this.$MessageBox.confirm("您还有已修改的信息未保存，是否保存信息!","提示",{cancelButtonText:"直接返回",confirmButtonText:"保存并返回"}).then((function(e){t.submitData(!0)}))["catch"]((function(e){t.$router.go(-1)})):this.$router.go(-1)},getItemLb:function(t){var e=t.key;return 0==t.type?this.userInfoCP[e]?this.userInfoCP.headImg:"2"==this.userInfoCP.gender?"static/image/setting/setting-img.png":"static/image/setting/setting-img-man.png":"gender"!=t.key?this.userInfoCP[e]:"1"==this.userInfoCP[e]?"男":"2"==this.userInfoCP[e]?"女":""},jumpUrl:function(t,e){if(!t.disabled)if(this.selectIndex=e,"0"==t.id)m["a"].open({linkFunc:this.linkFunc,token:this.$store.state.login.token});else if("1"==t.id)this.$refs.updateMark.showMarkFun(t,"修改姓名","请输入姓名");else if("2"==t.id);else if("3"==t.id)this.$refs.updateMark.showMarkFun(t,"修改邮箱","请输入邮箱");else if("4"==t.id){if(""!=this.userInfoCP.birthday&&"1"==this.$store.state.globalConfig.can_not_modify_birthday)return void this.$Toast("不支持生日修改！");this.$refs.picker.open()}else"5"==t.id?this.$router.push({path:"/aqgl"}):"6"==t.id||"7"==t.id||("8"==t.id?this.$router.push({path:"/usercenter/choseway"}):"9"==t.id&&(this.sexShow=!0))},changetime:function(t){var e=t.getFullYear(),i=t.getMonth()+1,s=t.getDate(),n="".concat(e,"-").concat(this.bl(i),"-").concat(this.bl(s));this.userInfoCP["birthday"]=n,this.$refs.updateMark.closeMark(),this.checkModify()&&(this.showRightBtn=!0)},bl:function(t){return t<10&&(t="0"+t),t},submitData:function(t){var e=this;this.$Loading.open();var i="/app/json/user/modifyUserInfo",s={token:this.$store.state.login.token};s.avtUrl=this.userInfoCP.headImg,s.nickName=this.userInfoCP.nickName,s.email=this.userInfoCP.email,s.birthday=this.userInfoCP.birthday,s.gender=this.userInfoCP.gender,this.$http.post(i,s).then((function(i){e.$Loading.close();var s=i.data;0==s.status?(e.$store.state.userInfo=e.userInfoCP,e.$bridgefunc.vuexStorage(),e.$Toast("修改成功"),t&&e.$router.go(-1)):e.$Toast(s.info?s.info:"修改失败")}),(function(t){e.$Loading.close(),e.$Toast("系统运行过程中遇到问题，请稍候再试")}))},linkFunc:function(t,e){this.$set(this.userInfoCP,"headImg",t),this.checkModify()&&(this.showRightBtn=!0)},modifyHeadImg:function(t){var e=this;this.$Loading.open();var i="/app/json/user/modifyHeadImg",s={token:this.$store.state.login.token,headImg:t};this.$http.post(i,s).then((function(i){e.$Loading.close();var s=i.data;if(0==s.status){var n=e.settingList[e.selectIndex];e.$store.state.userInfo[n.key]=t,e.$bridgefunc.vuexStorage(),e.$Toast("修改头像成功")}else e.$Toast(s.info?s.info:"修改失败")}),(function(t){e.$Loading.close(),e.$Toast("系统运行过程中遇到问题，请稍候再试")}))},getMyInfo:function(){var t=this;this.$Loading.open();var e="/app/json/user/getUserInfo";this.$http.post(e,{}).then((function(e){t.$Loading.close();var i=e.data;0==i.status?(t.$store.state.userInfo=i.data,t.currentDate=new Date(i.data.birthday),t.$bridgefunc.vuexStorage()):t.$Toast(i.info?i.info:"获取个人信息失败")}),(function(e){t.$Loading.close(),t.$Toast("系统运行过程中遇到问题，请稍候再试")}))}},created:function(){this.userInfoCP=JSON.parse(JSON.stringify(this.userInfo)),this.getMyInfo()}},I=v,b=(i("2e7b"),i("da8c"),Object(l["a"])(I,s,n,!1,null,"4c308505",null));e["default"]=b.exports},da8c:function(t,e,i){"use strict";i("aa86")}}]);